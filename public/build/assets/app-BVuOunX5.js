var l6=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var TNe=l6((aLe,Ry)=>{function Az(t,e){return function(){return t.apply(e,arguments)}}const{toString:c6}=Object.prototype,{getPrototypeOf:gA}=Object,{iterator:eS,toStringTag:Iz}=Symbol,tS=(t=>e=>{const n=c6.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ho=t=>(t=t.toLowerCase(),e=>tS(e)===t),nS=t=>e=>typeof e===t,{isArray:$f}=Array,Cf=nS("undefined");function Kp(t){return t!==null&&!Cf(t)&&t.constructor!==null&&!Cf(t.constructor)&&Tr(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const Oz=ho("ArrayBuffer");function u6(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&Oz(t.buffer),e}const h6=nS("string"),Tr=nS("function"),Hz=nS("number"),Xp=t=>t!==null&&typeof t=="object",d6=t=>t===!0||t===!1,Yb=t=>{if(tS(t)!=="object")return!1;const e=gA(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Iz in t)&&!(eS in t)},f6=t=>{if(!Xp(t)||Kp(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},g6=ho("Date"),m6=ho("File"),p6=ho("Blob"),w6=ho("FileList"),v6=t=>Xp(t)&&Tr(t.pipe),b6=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Tr(t.append)&&((e=tS(t))==="formdata"||e==="object"&&Tr(t.toString)&&t.toString()==="[object FormData]"))},y6=ho("URLSearchParams"),[C6,S6,R6,_6]=["ReadableStream","Request","Response","Headers"].map(ho),E6=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Jp(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let i,r;if(typeof t!="object"&&(t=[t]),$f(t))for(i=0,r=t.length;i<r;i++)e.call(null,t[i],i,t);else{if(Kp(t))return;const s=n?Object.getOwnPropertyNames(t):Object.keys(t),o=s.length;let a;for(i=0;i<o;i++)a=s[i],e.call(null,t[a],a,t)}}function kz(t,e){if(Kp(t))return null;e=e.toLowerCase();const n=Object.keys(t);let i=n.length,r;for(;i-- >0;)if(r=n[i],e===r.toLowerCase())return r;return null}const Yu=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Dz=t=>!Cf(t)&&t!==Yu;function RM(){const{caseless:t,skipUndefined:e}=Dz(this)&&this||{},n={},i=(r,s)=>{const o=t&&kz(n,s)||s;Yb(n[o])&&Yb(r)?n[o]=RM(n[o],r):Yb(r)?n[o]=RM({},r):$f(r)?n[o]=r.slice():(!e||!Cf(r))&&(n[o]=r)};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&Jp(arguments[r],i);return n}const x6=(t,e,n,{allOwnKeys:i}={})=>(Jp(e,(r,s)=>{n&&Tr(r)?t[s]=Az(r,n):t[s]=r},{allOwnKeys:i}),t),T6=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),M6=(t,e,n,i)=>{t.prototype=Object.create(e.prototype,i),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},P6=(t,e,n,i)=>{let r,s,o;const a={};if(e=e||{},t==null)return e;do{for(r=Object.getOwnPropertyNames(t),s=r.length;s-- >0;)o=r[s],(!i||i(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=n!==!1&&gA(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},A6=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const i=t.indexOf(e,n);return i!==-1&&i===n},I6=t=>{if(!t)return null;if($f(t))return t;let e=t.length;if(!Hz(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},O6=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&gA(Uint8Array)),H6=(t,e)=>{const i=(t&&t[eS]).call(t);let r;for(;(r=i.next())&&!r.done;){const s=r.value;e.call(t,s[0],s[1])}},k6=(t,e)=>{let n;const i=[];for(;(n=t.exec(e))!==null;)i.push(n);return i},D6=ho("HTMLFormElement"),N6=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,i,r){return i.toUpperCase()+r}),rD=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),L6=ho("RegExp"),Nz=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),i={};Jp(n,(r,s)=>{let o;(o=e(r,s,t))!==!1&&(i[s]=o||r)}),Object.defineProperties(t,i)},$6=t=>{Nz(t,(e,n)=>{if(Tr(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const i=t[n];if(Tr(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},F6=(t,e)=>{const n={},i=r=>{r.forEach(s=>{n[s]=!0})};return $f(t)?i(t):i(String(t).split(e)),n},V6=()=>{},B6=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function W6(t){return!!(t&&Tr(t.append)&&t[Iz]==="FormData"&&t[eS])}const j6=t=>{const e=new Array(10),n=(i,r)=>{if(Xp(i)){if(e.indexOf(i)>=0)return;if(Kp(i))return i;if(!("toJSON"in i)){e[r]=i;const s=$f(i)?[]:{};return Jp(i,(o,a)=>{const l=n(o,r+1);!Cf(l)&&(s[a]=l)}),e[r]=void 0,s}}return i};return n(t,0)},z6=ho("AsyncFunction"),U6=t=>t&&(Xp(t)||Tr(t))&&Tr(t.then)&&Tr(t.catch),Lz=((t,e)=>t?setImmediate:e?((n,i)=>(Yu.addEventListener("message",({source:r,data:s})=>{r===Yu&&s===n&&i.length&&i.shift()()},!1),r=>{i.push(r),Yu.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Tr(Yu.postMessage)),Y6=typeof queueMicrotask<"u"?queueMicrotask.bind(Yu):typeof process<"u"&&process.nextTick||Lz,G6=t=>t!=null&&Tr(t[eS]),Y={isArray:$f,isArrayBuffer:Oz,isBuffer:Kp,isFormData:b6,isArrayBufferView:u6,isString:h6,isNumber:Hz,isBoolean:d6,isObject:Xp,isPlainObject:Yb,isEmptyObject:f6,isReadableStream:C6,isRequest:S6,isResponse:R6,isHeaders:_6,isUndefined:Cf,isDate:g6,isFile:m6,isBlob:p6,isRegExp:L6,isFunction:Tr,isStream:v6,isURLSearchParams:y6,isTypedArray:O6,isFileList:w6,forEach:Jp,merge:RM,extend:x6,trim:E6,stripBOM:T6,inherits:M6,toFlatObject:P6,kindOf:tS,kindOfTest:ho,endsWith:A6,toArray:I6,forEachEntry:H6,matchAll:k6,isHTMLForm:D6,hasOwnProperty:rD,hasOwnProp:rD,reduceDescriptors:Nz,freezeMethods:$6,toObjectSet:F6,toCamelCase:N6,noop:V6,toFiniteNumber:B6,findKey:kz,global:Yu,isContextDefined:Dz,isSpecCompliantForm:W6,toJSONObject:j6,isAsyncFn:z6,isThenable:U6,setImmediate:Lz,asap:Y6,isIterable:G6};function Be(t,e,n,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}Y.inherits(Be,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Y.toJSONObject(this.config),code:this.code,status:this.status}}});const $z=Be.prototype,Fz={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Fz[t]={value:t}});Object.defineProperties(Be,Fz);Object.defineProperty($z,"isAxiosError",{value:!0});Be.from=(t,e,n,i,r,s)=>{const o=Object.create($z);Y.toFlatObject(t,o,function(u){return u!==Error.prototype},c=>c!=="isAxiosError");const a=t&&t.message?t.message:"Error",l=e==null&&t?t.code:e;return Be.call(o,a,l,n,i,r),t&&o.cause==null&&Object.defineProperty(o,"cause",{value:t,configurable:!0}),o.name=t&&t.name||"Error",s&&Object.assign(o,s),o};const q6=null;function _M(t){return Y.isPlainObject(t)||Y.isArray(t)}function Vz(t){return Y.endsWith(t,"[]")?t.slice(0,-2):t}function sD(t,e,n){return t?t.concat(e).map(function(r,s){return r=Vz(r),!n&&s?"["+r+"]":r}).join(n?".":""):e}function K6(t){return Y.isArray(t)&&!t.some(_M)}const X6=Y.toFlatObject(Y,{},null,function(e){return/^is[A-Z]/.test(e)});function iS(t,e,n){if(!Y.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=Y.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,p){return!Y.isUndefined(p[m])});const i=n.metaTokens,r=n.visitor||u,s=n.dots,o=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&Y.isSpecCompliantForm(e);if(!Y.isFunction(r))throw new TypeError("visitor must be a function");function c(g){if(g===null)return"";if(Y.isDate(g))return g.toISOString();if(Y.isBoolean(g))return g.toString();if(!l&&Y.isBlob(g))throw new Be("Blob is not supported. Use a Buffer instead.");return Y.isArrayBuffer(g)||Y.isTypedArray(g)?l&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function u(g,m,p){let v=g;if(g&&!p&&typeof g=="object"){if(Y.endsWith(m,"{}"))m=i?m:m.slice(0,-2),g=JSON.stringify(g);else if(Y.isArray(g)&&K6(g)||(Y.isFileList(g)||Y.endsWith(m,"[]"))&&(v=Y.toArray(g)))return m=Vz(m),v.forEach(function(R,S){!(Y.isUndefined(R)||R===null)&&e.append(o===!0?sD([m],S,s):o===null?m:m+"[]",c(R))}),!1}return _M(g)?!0:(e.append(sD(p,m,s),c(g)),!1)}const h=[],d=Object.assign(X6,{defaultVisitor:u,convertValue:c,isVisitable:_M});function f(g,m){if(!Y.isUndefined(g)){if(h.indexOf(g)!==-1)throw Error("Circular reference detected in "+m.join("."));h.push(g),Y.forEach(g,function(v,b){(!(Y.isUndefined(v)||v===null)&&r.call(e,v,Y.isString(b)?b.trim():b,m,d))===!0&&f(v,m?m.concat(b):[b])}),h.pop()}}if(!Y.isObject(t))throw new TypeError("data must be an object");return f(t),e}function oD(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function mA(t,e){this._pairs=[],t&&iS(t,this,e)}const Bz=mA.prototype;Bz.append=function(e,n){this._pairs.push([e,n])};Bz.toString=function(e){const n=e?function(i){return e.call(this,i,oD)}:oD;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};function J6(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function Wz(t,e,n){if(!e)return t;const i=n&&n.encode||J6;Y.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let s;if(r?s=r(e,n):s=Y.isURLSearchParams(e)?e.toString():new mA(e,n).toString(i),s){const o=t.indexOf("#");o!==-1&&(t=t.slice(0,o)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class aD{constructor(){this.handlers=[]}use(e,n,i){return this.handlers.push({fulfilled:e,rejected:n,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Y.forEach(this.handlers,function(i){i!==null&&e(i)})}}const jz={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Z6=typeof URLSearchParams<"u"?URLSearchParams:mA,Q6=typeof FormData<"u"?FormData:null,e7=typeof Blob<"u"?Blob:null,t7={isBrowser:!0,classes:{URLSearchParams:Z6,FormData:Q6,Blob:e7},protocols:["http","https","file","blob","url","data"]},pA=typeof window<"u"&&typeof document<"u",EM=typeof navigator=="object"&&navigator||void 0,n7=pA&&(!EM||["ReactNative","NativeScript","NS"].indexOf(EM.product)<0),i7=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",r7=pA&&window.location.href||"http://localhost",s7=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:pA,hasStandardBrowserEnv:n7,hasStandardBrowserWebWorkerEnv:i7,navigator:EM,origin:r7},Symbol.toStringTag,{value:"Module"})),ki={...s7,...t7};function o7(t,e){return iS(t,new ki.classes.URLSearchParams,{visitor:function(n,i,r,s){return ki.isNode&&Y.isBuffer(n)?(this.append(i,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...e})}function a7(t){return Y.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function l7(t){const e={},n=Object.keys(t);let i;const r=n.length;let s;for(i=0;i<r;i++)s=n[i],e[s]=t[s];return e}function zz(t){function e(n,i,r,s){let o=n[s++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=s>=n.length;return o=!o&&Y.isArray(r)?r.length:o,l?(Y.hasOwnProp(r,o)?r[o]=[r[o],i]:r[o]=i,!a):((!r[o]||!Y.isObject(r[o]))&&(r[o]=[]),e(n,i,r[o],s)&&Y.isArray(r[o])&&(r[o]=l7(r[o])),!a)}if(Y.isFormData(t)&&Y.isFunction(t.entries)){const n={};return Y.forEachEntry(t,(i,r)=>{e(a7(i),r,n,0)}),n}return null}function c7(t,e,n){if(Y.isString(t))try{return(e||JSON.parse)(t),Y.trim(t)}catch(i){if(i.name!=="SyntaxError")throw i}return(n||JSON.stringify)(t)}const Zp={transitional:jz,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const i=n.getContentType()||"",r=i.indexOf("application/json")>-1,s=Y.isObject(e);if(s&&Y.isHTMLForm(e)&&(e=new FormData(e)),Y.isFormData(e))return r?JSON.stringify(zz(e)):e;if(Y.isArrayBuffer(e)||Y.isBuffer(e)||Y.isStream(e)||Y.isFile(e)||Y.isBlob(e)||Y.isReadableStream(e))return e;if(Y.isArrayBufferView(e))return e.buffer;if(Y.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(i.indexOf("application/x-www-form-urlencoded")>-1)return o7(e,this.formSerializer).toString();if((a=Y.isFileList(e))||i.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return iS(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||r?(n.setContentType("application/json",!1),c7(e)):e}],transformResponse:[function(e){const n=this.transitional||Zp.transitional,i=n&&n.forcedJSONParsing,r=this.responseType==="json";if(Y.isResponse(e)||Y.isReadableStream(e))return e;if(e&&Y.isString(e)&&(i&&!this.responseType||r)){const o=!(n&&n.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch(a){if(o)throw a.name==="SyntaxError"?Be.from(a,Be.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ki.classes.FormData,Blob:ki.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Y.forEach(["delete","get","head","post","put","patch"],t=>{Zp.headers[t]={}});const u7=Y.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),h7=t=>{const e={};let n,i,r;return t&&t.split(`
`).forEach(function(o){r=o.indexOf(":"),n=o.substring(0,r).trim().toLowerCase(),i=o.substring(r+1).trim(),!(!n||e[n]&&u7[n])&&(n==="set-cookie"?e[n]?e[n].push(i):e[n]=[i]:e[n]=e[n]?e[n]+", "+i:i)}),e},lD=Symbol("internals");function dg(t){return t&&String(t).trim().toLowerCase()}function Gb(t){return t===!1||t==null?t:Y.isArray(t)?t.map(Gb):String(t)}function d7(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(t);)e[i[1]]=i[2];return e}const f7=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function I0(t,e,n,i,r){if(Y.isFunction(i))return i.call(this,e,n);if(r&&(e=n),!!Y.isString(e)){if(Y.isString(i))return e.indexOf(i)!==-1;if(Y.isRegExp(i))return i.test(e)}}function g7(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,i)=>n.toUpperCase()+i)}function m7(t,e){const n=Y.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(t,i+n,{value:function(r,s,o){return this[i].call(this,e,r,s,o)},configurable:!0})})}let Mr=class{constructor(e){e&&this.set(e)}set(e,n,i){const r=this;function s(a,l,c){const u=dg(l);if(!u)throw new Error("header name must be a non-empty string");const h=Y.findKey(r,u);(!h||r[h]===void 0||c===!0||c===void 0&&r[h]!==!1)&&(r[h||l]=Gb(a))}const o=(a,l)=>Y.forEach(a,(c,u)=>s(c,u,l));if(Y.isPlainObject(e)||e instanceof this.constructor)o(e,n);else if(Y.isString(e)&&(e=e.trim())&&!f7(e))o(h7(e),n);else if(Y.isObject(e)&&Y.isIterable(e)){let a={},l,c;for(const u of e){if(!Y.isArray(u))throw TypeError("Object iterator must return a key-value pair");a[c=u[0]]=(l=a[c])?Y.isArray(l)?[...l,u[1]]:[l,u[1]]:u[1]}o(a,n)}else e!=null&&s(n,e,i);return this}get(e,n){if(e=dg(e),e){const i=Y.findKey(this,e);if(i){const r=this[i];if(!n)return r;if(n===!0)return d7(r);if(Y.isFunction(n))return n.call(this,r,i);if(Y.isRegExp(n))return n.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=dg(e),e){const i=Y.findKey(this,e);return!!(i&&this[i]!==void 0&&(!n||I0(this,this[i],i,n)))}return!1}delete(e,n){const i=this;let r=!1;function s(o){if(o=dg(o),o){const a=Y.findKey(i,o);a&&(!n||I0(i,i[a],a,n))&&(delete i[a],r=!0)}}return Y.isArray(e)?e.forEach(s):s(e),r}clear(e){const n=Object.keys(this);let i=n.length,r=!1;for(;i--;){const s=n[i];(!e||I0(this,this[s],s,e,!0))&&(delete this[s],r=!0)}return r}normalize(e){const n=this,i={};return Y.forEach(this,(r,s)=>{const o=Y.findKey(i,s);if(o){n[o]=Gb(r),delete n[s];return}const a=e?g7(s):String(s).trim();a!==s&&delete n[s],n[a]=Gb(r),i[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return Y.forEach(this,(i,r)=>{i!=null&&i!==!1&&(n[r]=e&&Y.isArray(i)?i.join(", "):i)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const i=new this(e);return n.forEach(r=>i.set(r)),i}static accessor(e){const i=(this[lD]=this[lD]={accessors:{}}).accessors,r=this.prototype;function s(o){const a=dg(o);i[a]||(m7(r,o),i[a]=!0)}return Y.isArray(e)?e.forEach(s):s(e),this}};Mr.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Y.reduceDescriptors(Mr.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(i){this[n]=i}}});Y.freezeMethods(Mr);function O0(t,e){const n=this||Zp,i=e||n,r=Mr.from(i.headers);let s=i.data;return Y.forEach(t,function(a){s=a.call(n,s,r.normalize(),e?e.status:void 0)}),r.normalize(),s}function Uz(t){return!!(t&&t.__CANCEL__)}function Ff(t,e,n){Be.call(this,t??"canceled",Be.ERR_CANCELED,e,n),this.name="CanceledError"}Y.inherits(Ff,Be,{__CANCEL__:!0});function Yz(t,e,n){const i=n.config.validateStatus;!n.status||!i||i(n.status)?t(n):e(new Be("Request failed with status code "+n.status,[Be.ERR_BAD_REQUEST,Be.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function p7(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function w7(t,e){t=t||10;const n=new Array(t),i=new Array(t);let r=0,s=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),u=i[s];o||(o=c),n[r]=l,i[r]=c;let h=s,d=0;for(;h!==r;)d+=n[h++],h=h%t;if(r=(r+1)%t,r===s&&(s=(s+1)%t),c-o<e)return;const f=u&&c-u;return f?Math.round(d*1e3/f):void 0}}function v7(t,e){let n=0,i=1e3/e,r,s;const o=(c,u=Date.now())=>{n=u,r=null,s&&(clearTimeout(s),s=null),t(...c)};return[(...c)=>{const u=Date.now(),h=u-n;h>=i?o(c,u):(r=c,s||(s=setTimeout(()=>{s=null,o(r)},i-h)))},()=>r&&o(r)]}const _y=(t,e,n=3)=>{let i=0;const r=w7(50,250);return v7(s=>{const o=s.loaded,a=s.lengthComputable?s.total:void 0,l=o-i,c=r(l),u=o<=a;i=o;const h={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&u?(a-o)/c:void 0,event:s,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(h)},n)},cD=(t,e)=>{const n=t!=null;return[i=>e[0]({lengthComputable:n,total:t,loaded:i}),e[1]]},uD=t=>(...e)=>Y.asap(()=>t(...e)),b7=ki.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,ki.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(ki.origin),ki.navigator&&/(msie|trident)/i.test(ki.navigator.userAgent)):()=>!0,y7=ki.hasStandardBrowserEnv?{write(t,e,n,i,r,s,o){if(typeof document>"u")return;const a=[`${t}=${encodeURIComponent(e)}`];Y.isNumber(n)&&a.push(`expires=${new Date(n).toUTCString()}`),Y.isString(i)&&a.push(`path=${i}`),Y.isString(r)&&a.push(`domain=${r}`),s===!0&&a.push("secure"),Y.isString(o)&&a.push(`SameSite=${o}`),document.cookie=a.join("; ")},read(t){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function C7(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function S7(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function Gz(t,e,n){let i=!C7(e);return t&&(i||n==!1)?S7(t,e):e}const hD=t=>t instanceof Mr?{...t}:t;function wh(t,e){e=e||{};const n={};function i(c,u,h,d){return Y.isPlainObject(c)&&Y.isPlainObject(u)?Y.merge.call({caseless:d},c,u):Y.isPlainObject(u)?Y.merge({},u):Y.isArray(u)?u.slice():u}function r(c,u,h,d){if(Y.isUndefined(u)){if(!Y.isUndefined(c))return i(void 0,c,h,d)}else return i(c,u,h,d)}function s(c,u){if(!Y.isUndefined(u))return i(void 0,u)}function o(c,u){if(Y.isUndefined(u)){if(!Y.isUndefined(c))return i(void 0,c)}else return i(void 0,u)}function a(c,u,h){if(h in e)return i(c,u);if(h in t)return i(void 0,c)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,u,h)=>r(hD(c),hD(u),h,!0)};return Y.forEach(Object.keys({...t,...e}),function(u){const h=l[u]||r,d=h(t[u],e[u],u);Y.isUndefined(d)&&h!==a||(n[u]=d)}),n}const qz=t=>{const e=wh({},t);let{data:n,withXSRFToken:i,xsrfHeaderName:r,xsrfCookieName:s,headers:o,auth:a}=e;if(e.headers=o=Mr.from(o),e.url=Wz(Gz(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),Y.isFormData(n)){if(ki.hasStandardBrowserEnv||ki.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(Y.isFunction(n.getHeaders)){const l=n.getHeaders(),c=["content-type","content-length"];Object.entries(l).forEach(([u,h])=>{c.includes(u.toLowerCase())&&o.set(u,h)})}}if(ki.hasStandardBrowserEnv&&(i&&Y.isFunction(i)&&(i=i(e)),i||i!==!1&&b7(e.url))){const l=r&&s&&y7.read(s);l&&o.set(r,l)}return e},R7=typeof XMLHttpRequest<"u",_7=R7&&function(t){return new Promise(function(n,i){const r=qz(t);let s=r.data;const o=Mr.from(r.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:c}=r,u,h,d,f,g;function m(){f&&f(),g&&g(),r.cancelToken&&r.cancelToken.unsubscribe(u),r.signal&&r.signal.removeEventListener("abort",u)}let p=new XMLHttpRequest;p.open(r.method.toUpperCase(),r.url,!0),p.timeout=r.timeout;function v(){if(!p)return;const R=Mr.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders()),x={data:!a||a==="text"||a==="json"?p.responseText:p.response,status:p.status,statusText:p.statusText,headers:R,config:t,request:p};Yz(function(T){n(T),m()},function(T){i(T),m()},x),p=null}"onloadend"in p?p.onloadend=v:p.onreadystatechange=function(){!p||p.readyState!==4||p.status===0&&!(p.responseURL&&p.responseURL.indexOf("file:")===0)||setTimeout(v)},p.onabort=function(){p&&(i(new Be("Request aborted",Be.ECONNABORTED,t,p)),p=null)},p.onerror=function(S){const x=S&&S.message?S.message:"Network Error",M=new Be(x,Be.ERR_NETWORK,t,p);M.event=S||null,i(M),p=null},p.ontimeout=function(){let S=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const x=r.transitional||jz;r.timeoutErrorMessage&&(S=r.timeoutErrorMessage),i(new Be(S,x.clarifyTimeoutError?Be.ETIMEDOUT:Be.ECONNABORTED,t,p)),p=null},s===void 0&&o.setContentType(null),"setRequestHeader"in p&&Y.forEach(o.toJSON(),function(S,x){p.setRequestHeader(x,S)}),Y.isUndefined(r.withCredentials)||(p.withCredentials=!!r.withCredentials),a&&a!=="json"&&(p.responseType=r.responseType),c&&([d,g]=_y(c,!0),p.addEventListener("progress",d)),l&&p.upload&&([h,f]=_y(l),p.upload.addEventListener("progress",h),p.upload.addEventListener("loadend",f)),(r.cancelToken||r.signal)&&(u=R=>{p&&(i(!R||R.type?new Ff(null,t,p):R),p.abort(),p=null)},r.cancelToken&&r.cancelToken.subscribe(u),r.signal&&(r.signal.aborted?u():r.signal.addEventListener("abort",u)));const b=p7(r.url);if(b&&ki.protocols.indexOf(b)===-1){i(new Be("Unsupported protocol "+b+":",Be.ERR_BAD_REQUEST,t));return}p.send(s||null)})},E7=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let i=new AbortController,r;const s=function(c){if(!r){r=!0,a();const u=c instanceof Error?c:this.reason;i.abort(u instanceof Be?u:new Ff(u instanceof Error?u.message:u))}};let o=e&&setTimeout(()=>{o=null,s(new Be(`timeout ${e} of ms exceeded`,Be.ETIMEDOUT))},e);const a=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(c=>{c.unsubscribe?c.unsubscribe(s):c.removeEventListener("abort",s)}),t=null)};t.forEach(c=>c.addEventListener("abort",s));const{signal:l}=i;return l.unsubscribe=()=>Y.asap(a),l}},x7=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let i=0,r;for(;i<n;)r=i+e,yield t.slice(i,r),i=r},T7=async function*(t,e){for await(const n of M7(t))yield*x7(n,e)},M7=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:i}=await e.read();if(n)break;yield i}}finally{await e.cancel()}},dD=(t,e,n,i)=>{const r=T7(t,e);let s=0,o,a=l=>{o||(o=!0,i&&i(l))};return new ReadableStream({async pull(l){try{const{done:c,value:u}=await r.next();if(c){a(),l.close();return}let h=u.byteLength;if(n){let d=s+=h;n(d)}l.enqueue(new Uint8Array(u))}catch(c){throw a(c),c}},cancel(l){return a(l),r.return()}},{highWaterMark:2})},fD=64*1024,{isFunction:jw}=Y,P7=(({Request:t,Response:e})=>({Request:t,Response:e}))(Y.global),{ReadableStream:gD,TextEncoder:mD}=Y.global,pD=(t,...e)=>{try{return!!t(...e)}catch{return!1}},A7=t=>{t=Y.merge.call({skipUndefined:!0},P7,t);const{fetch:e,Request:n,Response:i}=t,r=e?jw(e):typeof fetch=="function",s=jw(n),o=jw(i);if(!r)return!1;const a=r&&jw(gD),l=r&&(typeof mD=="function"?(g=>m=>g.encode(m))(new mD):async g=>new Uint8Array(await new n(g).arrayBuffer())),c=s&&a&&pD(()=>{let g=!1;const m=new n(ki.origin,{body:new gD,method:"POST",get duplex(){return g=!0,"half"}}).headers.has("Content-Type");return g&&!m}),u=o&&a&&pD(()=>Y.isReadableStream(new i("").body)),h={stream:u&&(g=>g.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(g=>{!h[g]&&(h[g]=(m,p)=>{let v=m&&m[g];if(v)return v.call(m);throw new Be(`Response type '${g}' is not supported`,Be.ERR_NOT_SUPPORT,p)})});const d=async g=>{if(g==null)return 0;if(Y.isBlob(g))return g.size;if(Y.isSpecCompliantForm(g))return(await new n(ki.origin,{method:"POST",body:g}).arrayBuffer()).byteLength;if(Y.isArrayBufferView(g)||Y.isArrayBuffer(g))return g.byteLength;if(Y.isURLSearchParams(g)&&(g=g+""),Y.isString(g))return(await l(g)).byteLength},f=async(g,m)=>{const p=Y.toFiniteNumber(g.getContentLength());return p??d(m)};return async g=>{let{url:m,method:p,data:v,signal:b,cancelToken:R,timeout:S,onDownloadProgress:x,onUploadProgress:M,responseType:T,headers:O,withCredentials:W="same-origin",fetchOptions:N}=qz(g),G=e||fetch;T=T?(T+"").toLowerCase():"text";let j=E7([b,R&&R.toAbortSignal()],S),ne=null;const ee=j&&j.unsubscribe&&(()=>{j.unsubscribe()});let Q;try{if(M&&c&&p!=="get"&&p!=="head"&&(Q=await f(O,v))!==0){let Te=new n(m,{method:"POST",body:v,duplex:"half"}),$e;if(Y.isFormData(v)&&($e=Te.headers.get("content-type"))&&O.setContentType($e),Te.body){const[Me,X]=cD(Q,_y(uD(M)));v=dD(Te.body,fD,Me,X)}}Y.isString(W)||(W=W?"include":"omit");const me=s&&"credentials"in n.prototype,fe={...N,signal:j,method:p.toUpperCase(),headers:O.normalize().toJSON(),body:v,duplex:"half",credentials:me?W:void 0};ne=s&&new n(m,fe);let ye=await(s?G(ne,N):G(m,fe));const Oe=u&&(T==="stream"||T==="response");if(u&&(x||Oe&&ee)){const Te={};["status","statusText","headers"].forEach(w=>{Te[w]=ye[w]});const $e=Y.toFiniteNumber(ye.headers.get("content-length")),[Me,X]=x&&cD($e,_y(uD(x),!0))||[];ye=new i(dD(ye.body,fD,Me,()=>{X&&X(),ee&&ee()}),Te)}T=T||"text";let Ce=await h[Y.findKey(h,T)||"text"](ye,g);return!Oe&&ee&&ee(),await new Promise((Te,$e)=>{Yz(Te,$e,{data:Ce,headers:Mr.from(ye.headers),status:ye.status,statusText:ye.statusText,config:g,request:ne})})}catch(me){throw ee&&ee(),me&&me.name==="TypeError"&&/Load failed|fetch/i.test(me.message)?Object.assign(new Be("Network Error",Be.ERR_NETWORK,g,ne),{cause:me.cause||me}):Be.from(me,me&&me.code,g,ne)}}},I7=new Map,Kz=t=>{let e=t&&t.env||{};const{fetch:n,Request:i,Response:r}=e,s=[i,r,n];let o=s.length,a=o,l,c,u=I7;for(;a--;)l=s[a],c=u.get(l),c===void 0&&u.set(l,c=a?new Map:A7(e)),u=c;return c};Kz();const wA={http:q6,xhr:_7,fetch:{get:Kz}};Y.forEach(wA,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const wD=t=>`- ${t}`,O7=t=>Y.isFunction(t)||t===null||t===!1;function H7(t,e){t=Y.isArray(t)?t:[t];const{length:n}=t;let i,r;const s={};for(let o=0;o<n;o++){i=t[o];let a;if(r=i,!O7(i)&&(r=wA[(a=String(i)).toLowerCase()],r===void 0))throw new Be(`Unknown adapter '${a}'`);if(r&&(Y.isFunction(r)||(r=r.get(e))))break;s[a||"#"+o]=r}if(!r){const o=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let a=n?o.length>1?`since :
`+o.map(wD).join(`
`):" "+wD(o[0]):"as no adapter specified";throw new Be("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return r}const Xz={getAdapter:H7,adapters:wA};function H0(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Ff(null,t)}function vD(t){return H0(t),t.headers=Mr.from(t.headers),t.data=O0.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Xz.getAdapter(t.adapter||Zp.adapter,t)(t).then(function(i){return H0(t),i.data=O0.call(t,t.transformResponse,i),i.headers=Mr.from(i.headers),i},function(i){return Uz(i)||(H0(t),i&&i.response&&(i.response.data=O0.call(t,t.transformResponse,i.response),i.response.headers=Mr.from(i.response.headers))),Promise.reject(i)})}const Jz="1.13.2",rS={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{rS[t]=function(i){return typeof i===t||"a"+(e<1?"n ":" ")+t}});const bD={};rS.transitional=function(e,n,i){function r(s,o){return"[Axios v"+Jz+"] Transitional option '"+s+"'"+o+(i?". "+i:"")}return(s,o,a)=>{if(e===!1)throw new Be(r(o," has been removed"+(n?" in "+n:"")),Be.ERR_DEPRECATED);return n&&!bD[o]&&(bD[o]=!0,console.warn(r(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(s,o,a):!0}};rS.spelling=function(e){return(n,i)=>(console.warn(`${i} is likely a misspelling of ${e}`),!0)};function k7(t,e,n){if(typeof t!="object")throw new Be("options must be an object",Be.ERR_BAD_OPTION_VALUE);const i=Object.keys(t);let r=i.length;for(;r-- >0;){const s=i[r],o=e[s];if(o){const a=t[s],l=a===void 0||o(a,s,t);if(l!==!0)throw new Be("option "+s+" must be "+l,Be.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Be("Unknown option "+s,Be.ERR_BAD_OPTION)}}const qb={assertOptions:k7,validators:rS},vo=qb.validators;let sh=class{constructor(e){this.defaults=e||{},this.interceptors={request:new aD,response:new aD}}async request(e,n){try{return await this._request(e,n)}catch(i){if(i instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const s=r.stack?r.stack.replace(/^.+\n/,""):"";try{i.stack?s&&!String(i.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+s):i.stack=s}catch{}}throw i}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=wh(this.defaults,n);const{transitional:i,paramsSerializer:r,headers:s}=n;i!==void 0&&qb.assertOptions(i,{silentJSONParsing:vo.transitional(vo.boolean),forcedJSONParsing:vo.transitional(vo.boolean),clarifyTimeoutError:vo.transitional(vo.boolean)},!1),r!=null&&(Y.isFunction(r)?n.paramsSerializer={serialize:r}:qb.assertOptions(r,{encode:vo.function,serialize:vo.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),qb.assertOptions(n,{baseUrl:vo.spelling("baseURL"),withXsrfToken:vo.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=s&&Y.merge(s.common,s[n.method]);s&&Y.forEach(["delete","get","head","post","put","patch","common"],g=>{delete s[g]}),n.headers=Mr.concat(o,s);const a=[];let l=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(n)===!1||(l=l&&m.synchronous,a.unshift(m.fulfilled,m.rejected))});const c=[];this.interceptors.response.forEach(function(m){c.push(m.fulfilled,m.rejected)});let u,h=0,d;if(!l){const g=[vD.bind(this),void 0];for(g.unshift(...a),g.push(...c),d=g.length,u=Promise.resolve(n);h<d;)u=u.then(g[h++],g[h++]);return u}d=a.length;let f=n;for(;h<d;){const g=a[h++],m=a[h++];try{f=g(f)}catch(p){m.call(this,p);break}}try{u=vD.call(this,f)}catch(g){return Promise.reject(g)}for(h=0,d=c.length;h<d;)u=u.then(c[h++],c[h++]);return u}getUri(e){e=wh(this.defaults,e);const n=Gz(e.baseURL,e.url,e.allowAbsoluteUrls);return Wz(n,e.params,e.paramsSerializer)}};Y.forEach(["delete","get","head","options"],function(e){sh.prototype[e]=function(n,i){return this.request(wh(i||{},{method:e,url:n,data:(i||{}).data}))}});Y.forEach(["post","put","patch"],function(e){function n(i){return function(s,o,a){return this.request(wh(a||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}sh.prototype[e]=n(),sh.prototype[e+"Form"]=n(!0)});let D7=class Zz{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const i=this;this.promise.then(r=>{if(!i._listeners)return;let s=i._listeners.length;for(;s-- >0;)i._listeners[s](r);i._listeners=null}),this.promise.then=r=>{let s;const o=new Promise(a=>{i.subscribe(a),s=a}).then(r);return o.cancel=function(){i.unsubscribe(s)},o},e(function(s,o,a){i.reason||(i.reason=new Ff(s,o,a),n(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=i=>{e.abort(i)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new Zz(function(r){e=r}),cancel:e}}};function N7(t){return function(n){return t.apply(null,n)}}function L7(t){return Y.isObject(t)&&t.isAxiosError===!0}const xM={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(xM).forEach(([t,e])=>{xM[e]=t});function Qz(t){const e=new sh(t),n=Az(sh.prototype.request,e);return Y.extend(n,sh.prototype,e,{allOwnKeys:!0}),Y.extend(n,e,null,{allOwnKeys:!0}),n.create=function(r){return Qz(wh(t,r))},n}const In=Qz(Zp);In.Axios=sh;In.CanceledError=Ff;In.CancelToken=D7;In.isCancel=Uz;In.VERSION=Jz;In.toFormData=iS;In.AxiosError=Be;In.Cancel=In.CanceledError;In.all=function(e){return Promise.all(e)};In.spread=N7;In.isAxiosError=L7;In.mergeConfig=wh;In.AxiosHeaders=Mr;In.formToJSON=t=>zz(Y.isHTMLForm(t)?new FormData(t):t);In.getAdapter=Xz.getAdapter;In.HttpStatusCode=xM;In.default=In;const{Axios:INe,AxiosError:ONe,CanceledError:HNe,isCancel:kNe,CancelToken:DNe,VERSION:NNe,all:LNe,Cancel:$Ne,isAxiosError:FNe,spread:VNe,toFormData:BNe,AxiosHeaders:WNe,HttpStatusCode:jNe,formToJSON:zNe,getAdapter:UNe,mergeConfig:YNe}=In;window.axios=In;window.axios.defaults.headers.common["X-Requested-With"]="XMLHttpRequest";var TM=!1,MM=!1,oh=[],PM=-1;function $7(t){F7(t)}function F7(t){oh.includes(t)||oh.push(t),B7()}function V7(t){let e=oh.indexOf(t);e!==-1&&e>PM&&oh.splice(e,1)}function B7(){!MM&&!TM&&(TM=!0,queueMicrotask(W7))}function W7(){TM=!1,MM=!0;for(let t=0;t<oh.length;t++)oh[t](),PM=t;oh.length=0,PM=-1,MM=!1}var Vf,Hh,Bf,eU,AM=!0;function j7(t){AM=!1,t(),AM=!0}function z7(t){Vf=t.reactive,Bf=t.release,Hh=e=>t.effect(e,{scheduler:n=>{AM?$7(n):n()}}),eU=t.raw}function yD(t){Hh=t}function U7(t){let e=()=>{};return[i=>{let r=Hh(i);return t._x_effects||(t._x_effects=new Set,t._x_runEffects=()=>{t._x_effects.forEach(s=>s())}),t._x_effects.add(r),e=()=>{r!==void 0&&(t._x_effects.delete(r),Bf(r))},r},()=>{e()}]}function tU(t,e){let n=!0,i,r=Hh(()=>{let s=t();JSON.stringify(s),n?i=s:queueMicrotask(()=>{e(s,i),i=s}),n=!1});return()=>Bf(r)}var nU=[],iU=[],rU=[];function Y7(t){rU.push(t)}function vA(t,e){typeof e=="function"?(t._x_cleanups||(t._x_cleanups=[]),t._x_cleanups.push(e)):(e=t,iU.push(e))}function sU(t){nU.push(t)}function oU(t,e,n){t._x_attributeCleanups||(t._x_attributeCleanups={}),t._x_attributeCleanups[e]||(t._x_attributeCleanups[e]=[]),t._x_attributeCleanups[e].push(n)}function aU(t,e){t._x_attributeCleanups&&Object.entries(t._x_attributeCleanups).forEach(([n,i])=>{(e===void 0||e.includes(n))&&(i.forEach(r=>r()),delete t._x_attributeCleanups[n])})}function G7(t){for(t._x_effects?.forEach(V7);t._x_cleanups?.length;)t._x_cleanups.pop()()}var bA=new MutationObserver(RA),yA=!1;function CA(){bA.observe(document,{subtree:!0,childList:!0,attributes:!0,attributeOldValue:!0}),yA=!0}function lU(){q7(),bA.disconnect(),yA=!1}var fg=[];function q7(){let t=bA.takeRecords();fg.push(()=>t.length>0&&RA(t));let e=fg.length;queueMicrotask(()=>{if(fg.length===e)for(;fg.length>0;)fg.shift()()})}function un(t){if(!yA)return t();lU();let e=t();return CA(),e}var SA=!1,Ey=[];function K7(){SA=!0}function X7(){SA=!1,RA(Ey),Ey=[]}function RA(t){if(SA){Ey=Ey.concat(t);return}let e=[],n=new Set,i=new Map,r=new Map;for(let s=0;s<t.length;s++)if(!t[s].target._x_ignoreMutationObserver&&(t[s].type==="childList"&&(t[s].removedNodes.forEach(o=>{o.nodeType===1&&o._x_marker&&n.add(o)}),t[s].addedNodes.forEach(o=>{if(o.nodeType===1){if(n.has(o)){n.delete(o);return}o._x_marker||e.push(o)}})),t[s].type==="attributes")){let o=t[s].target,a=t[s].attributeName,l=t[s].oldValue,c=()=>{i.has(o)||i.set(o,[]),i.get(o).push({name:a,value:o.getAttribute(a)})},u=()=>{r.has(o)||r.set(o,[]),r.get(o).push(a)};o.hasAttribute(a)&&l===null?c():o.hasAttribute(a)?(u(),c()):u()}r.forEach((s,o)=>{aU(o,s)}),i.forEach((s,o)=>{nU.forEach(a=>a(o,s))});for(let s of n)e.some(o=>o.contains(s))||iU.forEach(o=>o(s));for(let s of e)s.isConnected&&rU.forEach(o=>o(s));e=null,n=null,i=null,r=null}function cU(t){return bh(vh(t))}function Qp(t,e,n){return t._x_dataStack=[e,...vh(n||t)],()=>{t._x_dataStack=t._x_dataStack.filter(i=>i!==e)}}function vh(t){return t._x_dataStack?t._x_dataStack:typeof ShadowRoot=="function"&&t instanceof ShadowRoot?vh(t.host):t.parentNode?vh(t.parentNode):[]}function bh(t){return new Proxy({objects:t},J7)}var J7={ownKeys({objects:t}){return Array.from(new Set(t.flatMap(e=>Object.keys(e))))},has({objects:t},e){return e==Symbol.unscopables?!1:t.some(n=>Object.prototype.hasOwnProperty.call(n,e)||Reflect.has(n,e))},get({objects:t},e,n){return e=="toJSON"?Z7:Reflect.get(t.find(i=>Reflect.has(i,e))||{},e,n)},set({objects:t},e,n,i){const r=t.find(o=>Object.prototype.hasOwnProperty.call(o,e))||t[t.length-1],s=Object.getOwnPropertyDescriptor(r,e);return s?.set&&s?.get?s.set.call(i,n)||!0:Reflect.set(r,e,n)}};function Z7(){return Reflect.ownKeys(this).reduce((e,n)=>(e[n]=Reflect.get(this,n),e),{})}function _A(t){let e=i=>typeof i=="object"&&!Array.isArray(i)&&i!==null,n=(i,r="")=>{Object.entries(Object.getOwnPropertyDescriptors(i)).forEach(([s,{value:o,enumerable:a}])=>{if(a===!1||o===void 0||typeof o=="object"&&o!==null&&o.__v_skip)return;let l=r===""?s:`${r}.${s}`;typeof o=="object"&&o!==null&&o._x_interceptor?i[s]=o.initialize(t,l,s):e(o)&&o!==i&&!(o instanceof Element)&&n(o,l)})};return n(t)}function uU(t,e=()=>{}){let n={initialValue:void 0,_x_interceptor:!0,initialize(i,r,s){return t(this.initialValue,()=>Q7(i,r),o=>IM(i,r,o),r,s)}};return e(n),i=>{if(typeof i=="object"&&i!==null&&i._x_interceptor){let r=n.initialize.bind(n);n.initialize=(s,o,a)=>{let l=i.initialize(s,o,a);return n.initialValue=l,r(s,o,a)}}else n.initialValue=i;return n}}function Q7(t,e){return e.split(".").reduce((n,i)=>n[i],t)}function IM(t,e,n){if(typeof e=="string"&&(e=e.split(".")),e.length===1)t[e[0]]=n;else{if(e.length===0)throw error;return t[e[0]]||(t[e[0]]={}),IM(t[e[0]],e.slice(1),n)}}var hU={};function fo(t,e){hU[t]=e}function wp(t,e){let n=e8(e);return Object.entries(hU).forEach(([i,r])=>{Object.defineProperty(t,`$${i}`,{get(){return r(e,n)},enumerable:!1})}),t}function e8(t){let[e,n]=bU(t),i={interceptor:uU,...e};return vA(t,n),i}function t8(t,e,n,...i){try{return n(...i)}catch(r){vp(r,t,e)}}function vp(...t){return dU(...t)}var dU=i8;function n8(t){dU=t}function i8(t,e,n=void 0){t=Object.assign(t??{message:"No error message given."},{el:e,expression:n}),console.warn(`Alpine Expression Error: ${t.message}

${n?'Expression: "'+n+`"

`:""}`,e),setTimeout(()=>{throw t},0)}var lf=!0;function fU(t){let e=lf;lf=!1;let n=t();return lf=e,n}function ah(t,e,n={}){let i;return er(t,e)(r=>i=r,n),i}function er(...t){return gU(...t)}var gU=pU;function r8(t){gU=t}var mU;function s8(t){mU=t}function pU(t,e){let n={};wp(n,t);let i=[n,...vh(t)],r=typeof e=="function"?o8(i,e):l8(i,e,t);return t8.bind(null,t,e,r)}function o8(t,e){return(n=()=>{},{scope:i={},params:r=[],context:s}={})=>{if(!lf){bp(n,e,bh([i,...t]),r);return}let o=e.apply(bh([i,...t]),r);bp(n,o)}}var k0={};function a8(t,e){if(k0[t])return k0[t];let n=Object.getPrototypeOf(async function(){}).constructor,i=/^[\n\s]*if.*\(.*\)/.test(t.trim())||/^(let|const)\s/.test(t.trim())?`(async()=>{ ${t} })()`:t,s=(()=>{try{let o=new n(["__self","scope"],`with (scope) { __self.result = ${i} }; __self.finished = true; return __self.result;`);return Object.defineProperty(o,"name",{value:`[Alpine] ${t}`}),o}catch(o){return vp(o,e,t),Promise.resolve()}})();return k0[t]=s,s}function l8(t,e,n){let i=a8(e,n);return(r=()=>{},{scope:s={},params:o=[],context:a}={})=>{i.result=void 0,i.finished=!1;let l=bh([s,...t]);if(typeof i=="function"){let c=i.call(a,i,l).catch(u=>vp(u,n,e));i.finished?(bp(r,i.result,l,o,n),i.result=void 0):c.then(u=>{bp(r,u,l,o,n)}).catch(u=>vp(u,n,e)).finally(()=>i.result=void 0)}}}function bp(t,e,n,i,r){if(lf&&typeof e=="function"){let s=e.apply(n,i);s instanceof Promise?s.then(o=>bp(t,o,n,i)).catch(o=>vp(o,r,e)):t(s)}else typeof e=="object"&&e instanceof Promise?e.then(s=>t(s)):t(e)}function c8(...t){return mU(...t)}function u8(t,e,n={}){let i={};wp(i,t);let r=[i,...vh(t)],s=bh([n.scope??{},...r]),o=n.params??[];if(e.includes("await")){let a=Object.getPrototypeOf(async function(){}).constructor,l=/^[\n\s]*if.*\(.*\)/.test(e.trim())||/^(let|const)\s/.test(e.trim())?`(async()=>{ ${e} })()`:e;return new a(["scope"],`with (scope) { let __result = ${l}; return __result }`).call(n.context,s)}else{let a=/^[\n\s]*if.*\(.*\)/.test(e.trim())||/^(let|const)\s/.test(e.trim())?`(()=>{ ${e} })()`:e,c=new Function(["scope"],`with (scope) { let __result = ${a}; return __result }`).call(n.context,s);return typeof c=="function"&&lf?c.apply(s,o):c}}var EA="x-";function Wf(t=""){return EA+t}function h8(t){EA=t}var xy={};function Wn(t,e){return xy[t]=e,{before(n){if(!xy[n]){console.warn(String.raw`Cannot find directive \`${n}\`. \`${t}\` will use the default order of execution`);return}const i=Gu.indexOf(n);Gu.splice(i>=0?i:Gu.indexOf("DEFAULT"),0,t)}}}function d8(t){return Object.keys(xy).includes(t)}function xA(t,e,n){if(e=Array.from(e),t._x_virtualDirectives){let s=Object.entries(t._x_virtualDirectives).map(([a,l])=>({name:a,value:l})),o=wU(s);s=s.map(a=>o.find(l=>l.name===a.name)?{name:`x-bind:${a.name}`,value:`"${a.value}"`}:a),e=e.concat(s)}let i={};return e.map(SU((s,o)=>i[s]=o)).filter(_U).map(m8(i,n)).sort(p8).map(s=>g8(t,s))}function wU(t){return Array.from(t).map(SU()).filter(e=>!_U(e))}var OM=!1,Rm=new Map,vU=Symbol();function f8(t){OM=!0;let e=Symbol();vU=e,Rm.set(e,[]);let n=()=>{for(;Rm.get(e).length;)Rm.get(e).shift()();Rm.delete(e)},i=()=>{OM=!1,n()};t(n),i()}function bU(t){let e=[],n=a=>e.push(a),[i,r]=U7(t);return e.push(r),[{Alpine:zf,effect:i,cleanup:n,evaluateLater:er.bind(er,t),evaluate:ah.bind(ah,t)},()=>e.forEach(a=>a())]}function g8(t,e){let n=()=>{},i=xy[e.type]||n,[r,s]=bU(t);oU(t,e.original,s);let o=()=>{t._x_ignore||t._x_ignoreSelf||(i.inline&&i.inline(t,e,r),i=i.bind(i,t,e,r),OM?Rm.get(vU).push(i):i())};return o.runCleanups=s,o}var yU=(t,e)=>({name:n,value:i})=>(n.startsWith(t)&&(n=n.replace(t,e)),{name:n,value:i}),CU=t=>t;function SU(t=()=>{}){return({name:e,value:n})=>{let{name:i,value:r}=RU.reduce((s,o)=>o(s),{name:e,value:n});return i!==e&&t(i,e),{name:i,value:r}}}var RU=[];function TA(t){RU.push(t)}function _U({name:t}){return EU().test(t)}var EU=()=>new RegExp(`^${EA}([^:^.]+)\\b`);function m8(t,e){return({name:n,value:i})=>{let r=n.match(EU()),s=n.match(/:([a-zA-Z0-9\-_:]+)/),o=n.match(/\.[^.\]]+(?=[^\]]*$)/g)||[],a=e||t[n]||n;return{type:r?r[1]:null,value:s?s[1]:null,modifiers:o.map(l=>l.replace(".","")),expression:i,original:a}}}var HM="DEFAULT",Gu=["ignore","ref","data","id","anchor","bind","init","for","model","modelable","transition","show","if",HM,"teleport"];function p8(t,e){let n=Gu.indexOf(t.type)===-1?HM:t.type,i=Gu.indexOf(e.type)===-1?HM:e.type;return Gu.indexOf(n)-Gu.indexOf(i)}function Fm(t,e,n={}){t.dispatchEvent(new CustomEvent(e,{detail:n,bubbles:!0,composed:!0,cancelable:!0}))}function yh(t,e){if(typeof ShadowRoot=="function"&&t instanceof ShadowRoot){Array.from(t.children).forEach(r=>yh(r,e));return}let n=!1;if(e(t,()=>n=!0),n)return;let i=t.firstElementChild;for(;i;)yh(i,e),i=i.nextElementSibling}function xs(t,...e){console.warn(`Alpine Warning: ${t}`,...e)}var CD=!1;function w8(){CD&&xs("Alpine has already been initialized on this page. Calling Alpine.start() more than once can cause problems."),CD=!0,document.body||xs("Unable to initialize. Trying to load Alpine before `<body>` is available. Did you forget to add `defer` in Alpine's `<script>` tag?"),Fm(document,"alpine:init"),Fm(document,"alpine:initializing"),CA(),Y7(e=>sl(e,yh)),vA(e=>jf(e)),sU((e,n)=>{xA(e,n).forEach(i=>i())});let t=e=>!sS(e.parentElement,!0);Array.from(document.querySelectorAll(MU().join(","))).filter(t).forEach(e=>{sl(e)}),Fm(document,"alpine:initialized"),setTimeout(()=>{C8()})}var MA=[],xU=[];function TU(){return MA.map(t=>t())}function MU(){return MA.concat(xU).map(t=>t())}function PU(t){MA.push(t)}function AU(t){xU.push(t)}function sS(t,e=!1){return Ch(t,n=>{if((e?MU():TU()).some(r=>n.matches(r)))return!0})}function Ch(t,e){if(t){if(e(t))return t;if(t._x_teleportBack&&(t=t._x_teleportBack),t.parentNode instanceof ShadowRoot)return Ch(t.parentNode.host,e);if(t.parentElement)return Ch(t.parentElement,e)}}function v8(t){return TU().some(e=>t.matches(e))}var IU=[];function b8(t){IU.push(t)}var y8=1;function sl(t,e=yh,n=()=>{}){Ch(t,i=>i._x_ignore)||f8(()=>{e(t,(i,r)=>{i._x_marker||(n(i,r),IU.forEach(s=>s(i,r)),xA(i,i.attributes).forEach(s=>s()),i._x_ignore||(i._x_marker=y8++),i._x_ignore&&r())})})}function jf(t,e=yh){e(t,n=>{G7(n),aU(n),delete n._x_marker})}function C8(){[["ui","dialog",["[x-dialog], [x-popover]"]],["anchor","anchor",["[x-anchor]"]],["sort","sort",["[x-sort]"]]].forEach(([e,n,i])=>{d8(n)||i.some(r=>{if(document.querySelector(r))return xs(`found "${r}", but missing ${e} plugin`),!0})})}var kM=[],PA=!1;function AA(t=()=>{}){return queueMicrotask(()=>{PA||setTimeout(()=>{DM()})}),new Promise(e=>{kM.push(()=>{t(),e()})})}function DM(){for(PA=!1;kM.length;)kM.shift()()}function S8(){PA=!0}function IA(t,e){return Array.isArray(e)?SD(t,e.join(" ")):typeof e=="object"&&e!==null?R8(t,e):typeof e=="function"?IA(t,e()):SD(t,e)}function SD(t,e){let n=r=>r.split(" ").filter(s=>!t.classList.contains(s)).filter(Boolean),i=r=>(t.classList.add(...r),()=>{t.classList.remove(...r)});return e=e===!0?e="":e||"",i(n(e))}function R8(t,e){let n=a=>a.split(" ").filter(Boolean),i=Object.entries(e).flatMap(([a,l])=>l?n(a):!1).filter(Boolean),r=Object.entries(e).flatMap(([a,l])=>l?!1:n(a)).filter(Boolean),s=[],o=[];return r.forEach(a=>{t.classList.contains(a)&&(t.classList.remove(a),o.push(a))}),i.forEach(a=>{t.classList.contains(a)||(t.classList.add(a),s.push(a))}),()=>{o.forEach(a=>t.classList.add(a)),s.forEach(a=>t.classList.remove(a))}}function oS(t,e){return typeof e=="object"&&e!==null?_8(t,e):E8(t,e)}function _8(t,e){let n={};return Object.entries(e).forEach(([i,r])=>{n[i]=t.style[i],i.startsWith("--")||(i=x8(i)),t.style.setProperty(i,r)}),setTimeout(()=>{t.style.length===0&&t.removeAttribute("style")}),()=>{oS(t,n)}}function E8(t,e){let n=t.getAttribute("style",e);return t.setAttribute("style",e),()=>{t.setAttribute("style",n||"")}}function x8(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function NM(t,e=()=>{}){let n=!1;return function(){n?e.apply(this,arguments):(n=!0,t.apply(this,arguments))}}Wn("transition",(t,{value:e,modifiers:n,expression:i},{evaluate:r})=>{typeof i=="function"&&(i=r(i)),i!==!1&&(!i||typeof i=="boolean"?M8(t,n,e):T8(t,i,e))});function T8(t,e,n){OU(t,IA,""),{enter:r=>{t._x_transition.enter.during=r},"enter-start":r=>{t._x_transition.enter.start=r},"enter-end":r=>{t._x_transition.enter.end=r},leave:r=>{t._x_transition.leave.during=r},"leave-start":r=>{t._x_transition.leave.start=r},"leave-end":r=>{t._x_transition.leave.end=r}}[n](e)}function M8(t,e,n){OU(t,oS);let i=!e.includes("in")&&!e.includes("out")&&!n,r=i||e.includes("in")||["enter"].includes(n),s=i||e.includes("out")||["leave"].includes(n);e.includes("in")&&!i&&(e=e.filter((v,b)=>b<e.indexOf("out"))),e.includes("out")&&!i&&(e=e.filter((v,b)=>b>e.indexOf("out")));let o=!e.includes("opacity")&&!e.includes("scale"),a=o||e.includes("opacity"),l=o||e.includes("scale"),c=a?0:1,u=l?gg(e,"scale",95)/100:1,h=gg(e,"delay",0)/1e3,d=gg(e,"origin","center"),f="opacity, transform",g=gg(e,"duration",150)/1e3,m=gg(e,"duration",75)/1e3,p="cubic-bezier(0.4, 0.0, 0.2, 1)";r&&(t._x_transition.enter.during={transformOrigin:d,transitionDelay:`${h}s`,transitionProperty:f,transitionDuration:`${g}s`,transitionTimingFunction:p},t._x_transition.enter.start={opacity:c,transform:`scale(${u})`},t._x_transition.enter.end={opacity:1,transform:"scale(1)"}),s&&(t._x_transition.leave.during={transformOrigin:d,transitionDelay:`${h}s`,transitionProperty:f,transitionDuration:`${m}s`,transitionTimingFunction:p},t._x_transition.leave.start={opacity:1,transform:"scale(1)"},t._x_transition.leave.end={opacity:c,transform:`scale(${u})`})}function OU(t,e,n={}){t._x_transition||(t._x_transition={enter:{during:n,start:n,end:n},leave:{during:n,start:n,end:n},in(i=()=>{},r=()=>{}){LM(t,e,{during:this.enter.during,start:this.enter.start,end:this.enter.end},i,r)},out(i=()=>{},r=()=>{}){LM(t,e,{during:this.leave.during,start:this.leave.start,end:this.leave.end},i,r)}})}window.Element.prototype._x_toggleAndCascadeWithTransitions=function(t,e,n,i){const r=document.visibilityState==="visible"?requestAnimationFrame:setTimeout;let s=()=>r(n);if(e){t._x_transition&&(t._x_transition.enter||t._x_transition.leave)?t._x_transition.enter&&(Object.entries(t._x_transition.enter.during).length||Object.entries(t._x_transition.enter.start).length||Object.entries(t._x_transition.enter.end).length)?t._x_transition.in(n):s():t._x_transition?t._x_transition.in(n):s();return}t._x_hidePromise=t._x_transition?new Promise((o,a)=>{t._x_transition.out(()=>{},()=>o(i)),t._x_transitioning&&t._x_transitioning.beforeCancel(()=>a({isFromCancelledTransition:!0}))}):Promise.resolve(i),queueMicrotask(()=>{let o=HU(t);o?(o._x_hideChildren||(o._x_hideChildren=[]),o._x_hideChildren.push(t)):r(()=>{let a=l=>{let c=Promise.all([l._x_hidePromise,...(l._x_hideChildren||[]).map(a)]).then(([u])=>u?.());return delete l._x_hidePromise,delete l._x_hideChildren,c};a(t).catch(l=>{if(!l.isFromCancelledTransition)throw l})})})};function HU(t){let e=t.parentNode;if(e)return e._x_hidePromise?e:HU(e)}function LM(t,e,{during:n,start:i,end:r}={},s=()=>{},o=()=>{}){if(t._x_transitioning&&t._x_transitioning.cancel(),Object.keys(n).length===0&&Object.keys(i).length===0&&Object.keys(r).length===0){s(),o();return}let a,l,c;P8(t,{start(){a=e(t,i)},during(){l=e(t,n)},before:s,end(){a(),c=e(t,r)},after:o,cleanup(){l(),c()}})}function P8(t,e){let n,i,r,s=NM(()=>{un(()=>{n=!0,i||e.before(),r||(e.end(),DM()),e.after(),t.isConnected&&e.cleanup(),delete t._x_transitioning})});t._x_transitioning={beforeCancels:[],beforeCancel(o){this.beforeCancels.push(o)},cancel:NM(function(){for(;this.beforeCancels.length;)this.beforeCancels.shift()();s()}),finish:s},un(()=>{e.start(),e.during()}),S8(),requestAnimationFrame(()=>{if(n)return;let o=Number(getComputedStyle(t).transitionDuration.replace(/,.*/,"").replace("s",""))*1e3,a=Number(getComputedStyle(t).transitionDelay.replace(/,.*/,"").replace("s",""))*1e3;o===0&&(o=Number(getComputedStyle(t).animationDuration.replace("s",""))*1e3),un(()=>{e.before()}),i=!0,requestAnimationFrame(()=>{n||(un(()=>{e.end()}),DM(),setTimeout(t._x_transitioning.finish,o+a),r=!0)})})}function gg(t,e,n){if(t.indexOf(e)===-1)return n;const i=t[t.indexOf(e)+1];if(!i||e==="scale"&&isNaN(i))return n;if(e==="duration"||e==="delay"){let r=i.match(/([0-9]+)ms/);if(r)return r[1]}return e==="origin"&&["top","right","left","center","bottom"].includes(t[t.indexOf(e)+2])?[i,t[t.indexOf(e)+2]].join(" "):i}var Cc=!1;function Oc(t,e=()=>{}){return(...n)=>Cc?e(...n):t(...n)}function A8(t){return(...e)=>Cc&&t(...e)}var kU=[];function aS(t){kU.push(t)}function I8(t,e){kU.forEach(n=>n(t,e)),Cc=!0,DU(()=>{sl(e,(n,i)=>{i(n,()=>{})})}),Cc=!1}var $M=!1;function O8(t,e){e._x_dataStack||(e._x_dataStack=t._x_dataStack),Cc=!0,$M=!0,DU(()=>{H8(e)}),Cc=!1,$M=!1}function H8(t){let e=!1;sl(t,(i,r)=>{yh(i,(s,o)=>{if(e&&v8(s))return o();e=!0,r(s,o)})})}function DU(t){let e=Hh;yD((n,i)=>{let r=e(n);return Bf(r),()=>{}}),t(),yD(e)}function NU(t,e,n,i=[]){switch(t._x_bindings||(t._x_bindings=Vf({})),t._x_bindings[e]=n,e=i.includes("camel")?B8(e):e,e){case"value":k8(t,n);break;case"style":N8(t,n);break;case"class":D8(t,n);break;case"selected":case"checked":L8(t,e,n);break;default:LU(t,e,n);break}}function k8(t,e){if(VU(t))t.attributes.value===void 0&&(t.value=e),window.fromModel&&(typeof e=="boolean"?t.checked=Kb(t.value)===e:t.checked=RD(t.value,e));else if(OA(t))Number.isInteger(e)?t.value=e:!Array.isArray(e)&&typeof e!="boolean"&&![null,void 0].includes(e)?t.value=String(e):Array.isArray(e)?t.checked=e.some(n=>RD(n,t.value)):t.checked=!!e;else if(t.tagName==="SELECT")V8(t,e);else{if(t.value===e)return;t.value=e===void 0?"":e}}function D8(t,e){t._x_undoAddedClasses&&t._x_undoAddedClasses(),t._x_undoAddedClasses=IA(t,e)}function N8(t,e){t._x_undoAddedStyles&&t._x_undoAddedStyles(),t._x_undoAddedStyles=oS(t,e)}function L8(t,e,n){LU(t,e,n),F8(t,e,n)}function LU(t,e,n){[null,void 0,!1].includes(n)&&j8(e)?t.removeAttribute(e):($U(e)&&(n=e),$8(t,e,n))}function $8(t,e,n){t.getAttribute(e)!=n&&t.setAttribute(e,n)}function F8(t,e,n){t[e]!==n&&(t[e]=n)}function V8(t,e){const n=[].concat(e).map(i=>i+"");Array.from(t.options).forEach(i=>{i.selected=n.includes(i.value)})}function B8(t){return t.toLowerCase().replace(/-(\w)/g,(e,n)=>n.toUpperCase())}function RD(t,e){return t==e}function Kb(t){return[1,"1","true","on","yes",!0].includes(t)?!0:[0,"0","false","off","no",!1].includes(t)?!1:t?!!t:null}var W8=new Set(["allowfullscreen","async","autofocus","autoplay","checked","controls","default","defer","disabled","formnovalidate","inert","ismap","itemscope","loop","multiple","muted","nomodule","novalidate","open","playsinline","readonly","required","reversed","selected","shadowrootclonable","shadowrootdelegatesfocus","shadowrootserializable"]);function $U(t){return W8.has(t)}function j8(t){return!["aria-pressed","aria-checked","aria-expanded","aria-selected"].includes(t)}function z8(t,e,n){return t._x_bindings&&t._x_bindings[e]!==void 0?t._x_bindings[e]:FU(t,e,n)}function U8(t,e,n,i=!0){if(t._x_bindings&&t._x_bindings[e]!==void 0)return t._x_bindings[e];if(t._x_inlineBindings&&t._x_inlineBindings[e]!==void 0){let r=t._x_inlineBindings[e];return r.extract=i,fU(()=>ah(t,r.expression))}return FU(t,e,n)}function FU(t,e,n){let i=t.getAttribute(e);return i===null?typeof n=="function"?n():n:i===""?!0:$U(e)?!![e,"true"].includes(i):i}function OA(t){return t.type==="checkbox"||t.localName==="ui-checkbox"||t.localName==="ui-switch"}function VU(t){return t.type==="radio"||t.localName==="ui-radio"}function BU(t,e){let n;return function(){const i=this,r=arguments,s=function(){n=null,t.apply(i,r)};clearTimeout(n),n=setTimeout(s,e)}}function WU(t,e){let n;return function(){let i=this,r=arguments;n||(t.apply(i,r),n=!0,setTimeout(()=>n=!1,e))}}function jU({get:t,set:e},{get:n,set:i}){let r=!0,s,o=Hh(()=>{let a=t(),l=n();if(r)i(D0(a)),r=!1;else{let c=JSON.stringify(a),u=JSON.stringify(l);c!==s?i(D0(a)):c!==u&&e(D0(l))}s=JSON.stringify(t()),JSON.stringify(n())});return()=>{Bf(o)}}function D0(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Y8(t){(Array.isArray(t)?t:[t]).forEach(n=>n(zf))}var Ou={},_D=!1;function G8(t,e){if(_D||(Ou=Vf(Ou),_D=!0),e===void 0)return Ou[t];Ou[t]=e,_A(Ou[t]),typeof e=="object"&&e!==null&&e.hasOwnProperty("init")&&typeof e.init=="function"&&Ou[t].init()}function q8(){return Ou}var zU={};function K8(t,e){let n=typeof e!="function"?()=>e:e;return t instanceof Element?UU(t,n()):(zU[t]=n,()=>{})}function X8(t){return Object.entries(zU).forEach(([e,n])=>{Object.defineProperty(t,e,{get(){return(...i)=>n(...i)}})}),t}function UU(t,e,n){let i=[];for(;i.length;)i.pop()();let r=Object.entries(e).map(([o,a])=>({name:o,value:a})),s=wU(r);return r=r.map(o=>s.find(a=>a.name===o.name)?{name:`x-bind:${o.name}`,value:`"${o.value}"`}:o),xA(t,r,n).map(o=>{i.push(o.runCleanups),o()}),()=>{for(;i.length;)i.pop()()}}var YU={};function J8(t,e){YU[t]=e}function Z8(t,e){return Object.entries(YU).forEach(([n,i])=>{Object.defineProperty(t,n,{get(){return(...r)=>i.bind(e)(...r)},enumerable:!1})}),t}var Q8={get reactive(){return Vf},get release(){return Bf},get effect(){return Hh},get raw(){return eU},version:"3.15.3",flushAndStopDeferringMutations:X7,dontAutoEvaluateFunctions:fU,disableEffectScheduling:j7,startObservingMutations:CA,stopObservingMutations:lU,setReactivityEngine:z7,onAttributeRemoved:oU,onAttributesAdded:sU,closestDataStack:vh,skipDuringClone:Oc,onlyDuringClone:A8,addRootSelector:PU,addInitSelector:AU,setErrorHandler:n8,interceptClone:aS,addScopeToNode:Qp,deferMutations:K7,mapAttributes:TA,evaluateLater:er,interceptInit:b8,initInterceptors:_A,injectMagics:wp,setEvaluator:r8,setRawEvaluator:s8,mergeProxies:bh,extractProp:U8,findClosest:Ch,onElRemoved:vA,closestRoot:sS,destroyTree:jf,interceptor:uU,transition:LM,setStyles:oS,mutateDom:un,directive:Wn,entangle:jU,throttle:WU,debounce:BU,evaluate:ah,evaluateRaw:c8,initTree:sl,nextTick:AA,prefixed:Wf,prefix:h8,plugin:Y8,magic:fo,store:G8,start:w8,clone:O8,cloneNode:I8,bound:z8,$data:cU,watch:tU,walk:yh,data:J8,bind:K8},zf=Q8;function e9(t,e){const n=Object.create(null),i=t.split(",");for(let r=0;r<i.length;r++)n[i[r]]=!0;return r=>!!n[r]}var t9=Object.freeze({}),n9=Object.prototype.hasOwnProperty,lS=(t,e)=>n9.call(t,e),lh=Array.isArray,Vm=t=>GU(t)==="[object Map]",i9=t=>typeof t=="string",HA=t=>typeof t=="symbol",cS=t=>t!==null&&typeof t=="object",r9=Object.prototype.toString,GU=t=>r9.call(t),qU=t=>GU(t).slice(8,-1),kA=t=>i9(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,s9=t=>{const e=Object.create(null);return n=>e[n]||(e[n]=t(n))},o9=s9(t=>t.charAt(0).toUpperCase()+t.slice(1)),KU=(t,e)=>t!==e&&(t===t||e===e),FM=new WeakMap,mg=[],Go,ch=Symbol("iterate"),VM=Symbol("Map key iterate");function a9(t){return t&&t._isEffect===!0}function l9(t,e=t9){a9(t)&&(t=t.raw);const n=h9(t,e);return e.lazy||n(),n}function c9(t){t.active&&(XU(t),t.options.onStop&&t.options.onStop(),t.active=!1)}var u9=0;function h9(t,e){const n=function(){if(!n.active)return t();if(!mg.includes(n)){XU(n);try{return f9(),mg.push(n),Go=n,t()}finally{mg.pop(),JU(),Go=mg[mg.length-1]}}};return n.id=u9++,n.allowRecurse=!!e.allowRecurse,n._isEffect=!0,n.active=!0,n.raw=t,n.deps=[],n.options=e,n}function XU(t){const{deps:e}=t;if(e.length){for(let n=0;n<e.length;n++)e[n].delete(t);e.length=0}}var Sf=!0,DA=[];function d9(){DA.push(Sf),Sf=!1}function f9(){DA.push(Sf),Sf=!0}function JU(){const t=DA.pop();Sf=t===void 0?!0:t}function oo(t,e,n){if(!Sf||Go===void 0)return;let i=FM.get(t);i||FM.set(t,i=new Map);let r=i.get(n);r||i.set(n,r=new Set),r.has(Go)||(r.add(Go),Go.deps.push(r),Go.options.onTrack&&Go.options.onTrack({effect:Go,target:t,type:e,key:n}))}function Sc(t,e,n,i,r,s){const o=FM.get(t);if(!o)return;const a=new Set,l=u=>{u&&u.forEach(h=>{(h!==Go||h.allowRecurse)&&a.add(h)})};if(e==="clear")o.forEach(l);else if(n==="length"&&lh(t))o.forEach((u,h)=>{(h==="length"||h>=i)&&l(u)});else switch(n!==void 0&&l(o.get(n)),e){case"add":lh(t)?kA(n)&&l(o.get("length")):(l(o.get(ch)),Vm(t)&&l(o.get(VM)));break;case"delete":lh(t)||(l(o.get(ch)),Vm(t)&&l(o.get(VM)));break;case"set":Vm(t)&&l(o.get(ch));break}const c=u=>{u.options.onTrigger&&u.options.onTrigger({effect:u,target:t,key:n,type:e,newValue:i,oldValue:r,oldTarget:s}),u.options.scheduler?u.options.scheduler(u):u()};a.forEach(c)}var g9=e9("__proto__,__v_isRef,__isVue"),ZU=new Set(Object.getOwnPropertyNames(Symbol).map(t=>Symbol[t]).filter(HA)),m9=QU(),p9=QU(!0),ED=w9();function w9(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...n){const i=jt(this);for(let s=0,o=this.length;s<o;s++)oo(i,"get",s+"");const r=i[e](...n);return r===-1||r===!1?i[e](...n.map(jt)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...n){d9();const i=jt(this)[e].apply(this,n);return JU(),i}}),t}function QU(t=!1,e=!1){return function(i,r,s){if(r==="__v_isReactive")return!t;if(r==="__v_isReadonly")return t;if(r==="__v_raw"&&s===(t?e?I9:iY:e?A9:nY).get(i))return i;const o=lh(i);if(!t&&o&&lS(ED,r))return Reflect.get(ED,r,s);const a=Reflect.get(i,r,s);return(HA(r)?ZU.has(r):g9(r))||(t||oo(i,"get",r),e)?a:BM(a)?!o||!kA(r)?a.value:a:cS(a)?t?rY(a):FA(a):a}}var v9=b9();function b9(t=!1){return function(n,i,r,s){let o=n[i];if(!t&&(r=jt(r),o=jt(o),!lh(n)&&BM(o)&&!BM(r)))return o.value=r,!0;const a=lh(n)&&kA(i)?Number(i)<n.length:lS(n,i),l=Reflect.set(n,i,r,s);return n===jt(s)&&(a?KU(r,o)&&Sc(n,"set",i,r,o):Sc(n,"add",i,r)),l}}function y9(t,e){const n=lS(t,e),i=t[e],r=Reflect.deleteProperty(t,e);return r&&n&&Sc(t,"delete",e,void 0,i),r}function C9(t,e){const n=Reflect.has(t,e);return(!HA(e)||!ZU.has(e))&&oo(t,"has",e),n}function S9(t){return oo(t,"iterate",lh(t)?"length":ch),Reflect.ownKeys(t)}var R9={get:m9,set:v9,deleteProperty:y9,has:C9,ownKeys:S9},_9={get:p9,set(t,e){return console.warn(`Set operation on key "${String(e)}" failed: target is readonly.`,t),!0},deleteProperty(t,e){return console.warn(`Delete operation on key "${String(e)}" failed: target is readonly.`,t),!0}},NA=t=>cS(t)?FA(t):t,LA=t=>cS(t)?rY(t):t,$A=t=>t,uS=t=>Reflect.getPrototypeOf(t);function zw(t,e,n=!1,i=!1){t=t.__v_raw;const r=jt(t),s=jt(e);e!==s&&!n&&oo(r,"get",e),!n&&oo(r,"get",s);const{has:o}=uS(r),a=i?$A:n?LA:NA;if(o.call(r,e))return a(t.get(e));if(o.call(r,s))return a(t.get(s));t!==r&&t.get(e)}function Uw(t,e=!1){const n=this.__v_raw,i=jt(n),r=jt(t);return t!==r&&!e&&oo(i,"has",t),!e&&oo(i,"has",r),t===r?n.has(t):n.has(t)||n.has(r)}function Yw(t,e=!1){return t=t.__v_raw,!e&&oo(jt(t),"iterate",ch),Reflect.get(t,"size",t)}function xD(t){t=jt(t);const e=jt(this);return uS(e).has.call(e,t)||(e.add(t),Sc(e,"add",t,t)),this}function TD(t,e){e=jt(e);const n=jt(this),{has:i,get:r}=uS(n);let s=i.call(n,t);s?tY(n,i,t):(t=jt(t),s=i.call(n,t));const o=r.call(n,t);return n.set(t,e),s?KU(e,o)&&Sc(n,"set",t,e,o):Sc(n,"add",t,e),this}function MD(t){const e=jt(this),{has:n,get:i}=uS(e);let r=n.call(e,t);r?tY(e,n,t):(t=jt(t),r=n.call(e,t));const s=i?i.call(e,t):void 0,o=e.delete(t);return r&&Sc(e,"delete",t,void 0,s),o}function PD(){const t=jt(this),e=t.size!==0,n=Vm(t)?new Map(t):new Set(t),i=t.clear();return e&&Sc(t,"clear",void 0,void 0,n),i}function Gw(t,e){return function(i,r){const s=this,o=s.__v_raw,a=jt(o),l=e?$A:t?LA:NA;return!t&&oo(a,"iterate",ch),o.forEach((c,u)=>i.call(r,l(c),l(u),s))}}function qw(t,e,n){return function(...i){const r=this.__v_raw,s=jt(r),o=Vm(s),a=t==="entries"||t===Symbol.iterator&&o,l=t==="keys"&&o,c=r[t](...i),u=n?$A:e?LA:NA;return!e&&oo(s,"iterate",l?VM:ch),{next(){const{value:h,done:d}=c.next();return d?{value:h,done:d}:{value:a?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function yl(t){return function(...e){{const n=e[0]?`on key "${e[0]}" `:"";console.warn(`${o9(t)} operation ${n}failed: target is readonly.`,jt(this))}return t==="delete"?!1:this}}function E9(){const t={get(s){return zw(this,s)},get size(){return Yw(this)},has:Uw,add:xD,set:TD,delete:MD,clear:PD,forEach:Gw(!1,!1)},e={get(s){return zw(this,s,!1,!0)},get size(){return Yw(this)},has:Uw,add:xD,set:TD,delete:MD,clear:PD,forEach:Gw(!1,!0)},n={get(s){return zw(this,s,!0)},get size(){return Yw(this,!0)},has(s){return Uw.call(this,s,!0)},add:yl("add"),set:yl("set"),delete:yl("delete"),clear:yl("clear"),forEach:Gw(!0,!1)},i={get(s){return zw(this,s,!0,!0)},get size(){return Yw(this,!0)},has(s){return Uw.call(this,s,!0)},add:yl("add"),set:yl("set"),delete:yl("delete"),clear:yl("clear"),forEach:Gw(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{t[s]=qw(s,!1,!1),n[s]=qw(s,!0,!1),e[s]=qw(s,!1,!0),i[s]=qw(s,!0,!0)}),[t,n,e,i]}var[x9,T9]=E9();function eY(t,e){const n=t?T9:x9;return(i,r,s)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?i:Reflect.get(lS(n,r)&&r in i?n:i,r,s)}var M9={get:eY(!1)},P9={get:eY(!0)};function tY(t,e,n){const i=jt(n);if(i!==n&&e.call(t,i)){const r=qU(t);console.warn(`Reactive ${r} contains both the raw and reactive versions of the same object${r==="Map"?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}var nY=new WeakMap,A9=new WeakMap,iY=new WeakMap,I9=new WeakMap;function O9(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function H9(t){return t.__v_skip||!Object.isExtensible(t)?0:O9(qU(t))}function FA(t){return t&&t.__v_isReadonly?t:sY(t,!1,R9,M9,nY)}function rY(t){return sY(t,!0,_9,P9,iY)}function sY(t,e,n,i,r){if(!cS(t))return console.warn(`value cannot be made reactive: ${String(t)}`),t;if(t.__v_raw&&!(e&&t.__v_isReactive))return t;const s=r.get(t);if(s)return s;const o=H9(t);if(o===0)return t;const a=new Proxy(t,o===2?i:n);return r.set(t,a),a}function jt(t){return t&&jt(t.__v_raw)||t}function BM(t){return!!(t&&t.__v_isRef===!0)}fo("nextTick",()=>AA);fo("dispatch",t=>Fm.bind(Fm,t));fo("watch",(t,{evaluateLater:e,cleanup:n})=>(i,r)=>{let s=e(i),a=tU(()=>{let l;return s(c=>l=c),l},r);n(a)});fo("store",q8);fo("data",t=>cU(t));fo("root",t=>sS(t));fo("refs",t=>(t._x_refs_proxy||(t._x_refs_proxy=bh(k9(t))),t._x_refs_proxy));function k9(t){let e=[];return Ch(t,n=>{n._x_refs&&e.push(n._x_refs)}),e}var N0={};function oY(t){return N0[t]||(N0[t]=0),++N0[t]}function D9(t,e){return Ch(t,n=>{if(n._x_ids&&n._x_ids[e])return!0})}function N9(t,e){t._x_ids||(t._x_ids={}),t._x_ids[e]||(t._x_ids[e]=oY(e))}fo("id",(t,{cleanup:e})=>(n,i=null)=>{let r=`${n}${i?`-${i}`:""}`;return L9(t,r,e,()=>{let s=D9(t,n),o=s?s._x_ids[n]:oY(n);return i?`${n}-${o}-${i}`:`${n}-${o}`})});aS((t,e)=>{t._x_id&&(e._x_id=t._x_id)});function L9(t,e,n,i){if(t._x_id||(t._x_id={}),t._x_id[e])return t._x_id[e];let r=i();return t._x_id[e]=r,n(()=>{delete t._x_id[e]}),r}fo("el",t=>t);aY("Focus","focus","focus");aY("Persist","persist","persist");function aY(t,e,n){fo(e,i=>xs(`You can't use [$${e}] without first installing the "${t}" plugin here: https://alpinejs.dev/plugins/${n}`,i))}Wn("modelable",(t,{expression:e},{effect:n,evaluateLater:i,cleanup:r})=>{let s=i(e),o=()=>{let u;return s(h=>u=h),u},a=i(`${e} = __placeholder`),l=u=>a(()=>{},{scope:{__placeholder:u}}),c=o();l(c),queueMicrotask(()=>{if(!t._x_model)return;t._x_removeModelListeners.default();let u=t._x_model.get,h=t._x_model.set,d=jU({get(){return u()},set(f){h(f)}},{get(){return o()},set(f){l(f)}});r(d)})});Wn("teleport",(t,{modifiers:e,expression:n},{cleanup:i})=>{t.tagName.toLowerCase()!=="template"&&xs("x-teleport can only be used on a <template> tag",t);let r=AD(n),s=t.content.cloneNode(!0).firstElementChild;t._x_teleport=s,s._x_teleportBack=t,t.setAttribute("data-teleport-template",!0),s.setAttribute("data-teleport-target",!0),t._x_forwardEvents&&t._x_forwardEvents.forEach(a=>{s.addEventListener(a,l=>{l.stopPropagation(),t.dispatchEvent(new l.constructor(l.type,l))})}),Qp(s,{},t);let o=(a,l,c)=>{c.includes("prepend")?l.parentNode.insertBefore(a,l):c.includes("append")?l.parentNode.insertBefore(a,l.nextSibling):l.appendChild(a)};un(()=>{o(s,r,e),Oc(()=>{sl(s)})()}),t._x_teleportPutBack=()=>{let a=AD(n);un(()=>{o(t._x_teleport,a,e)})},i(()=>un(()=>{s.remove(),jf(s)}))});var $9=document.createElement("div");function AD(t){let e=Oc(()=>document.querySelector(t),()=>$9)();return e||xs(`Cannot find x-teleport element for selector: "${t}"`),e}var lY=()=>{};lY.inline=(t,{modifiers:e},{cleanup:n})=>{e.includes("self")?t._x_ignoreSelf=!0:t._x_ignore=!0,n(()=>{e.includes("self")?delete t._x_ignoreSelf:delete t._x_ignore})};Wn("ignore",lY);Wn("effect",Oc((t,{expression:e},{effect:n})=>{n(er(t,e))}));function WM(t,e,n,i){let r=t,s=l=>i(l),o={},a=(l,c)=>u=>c(l,u);if(n.includes("dot")&&(e=F9(e)),n.includes("camel")&&(e=V9(e)),n.includes("passive")&&(o.passive=!0),n.includes("capture")&&(o.capture=!0),n.includes("window")&&(r=window),n.includes("document")&&(r=document),n.includes("debounce")){let l=n[n.indexOf("debounce")+1]||"invalid-wait",c=Ty(l.split("ms")[0])?Number(l.split("ms")[0]):250;s=BU(s,c)}if(n.includes("throttle")){let l=n[n.indexOf("throttle")+1]||"invalid-wait",c=Ty(l.split("ms")[0])?Number(l.split("ms")[0]):250;s=WU(s,c)}return n.includes("prevent")&&(s=a(s,(l,c)=>{c.preventDefault(),l(c)})),n.includes("stop")&&(s=a(s,(l,c)=>{c.stopPropagation(),l(c)})),n.includes("once")&&(s=a(s,(l,c)=>{l(c),r.removeEventListener(e,s,o)})),(n.includes("away")||n.includes("outside"))&&(r=document,s=a(s,(l,c)=>{t.contains(c.target)||c.target.isConnected!==!1&&(t.offsetWidth<1&&t.offsetHeight<1||t._x_isShown!==!1&&l(c))})),n.includes("self")&&(s=a(s,(l,c)=>{c.target===t&&l(c)})),(W9(e)||cY(e))&&(s=a(s,(l,c)=>{j9(c,n)||l(c)})),r.addEventListener(e,s,o),()=>{r.removeEventListener(e,s,o)}}function F9(t){return t.replace(/-/g,".")}function V9(t){return t.toLowerCase().replace(/-(\w)/g,(e,n)=>n.toUpperCase())}function Ty(t){return!Array.isArray(t)&&!isNaN(t)}function B9(t){return[" ","_"].includes(t)?t:t.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[_\s]/,"-").toLowerCase()}function W9(t){return["keydown","keyup"].includes(t)}function cY(t){return["contextmenu","click","mouse"].some(e=>t.includes(e))}function j9(t,e){let n=e.filter(s=>!["window","document","prevent","stop","once","capture","self","away","outside","passive","preserve-scroll"].includes(s));if(n.includes("debounce")){let s=n.indexOf("debounce");n.splice(s,Ty((n[s+1]||"invalid-wait").split("ms")[0])?2:1)}if(n.includes("throttle")){let s=n.indexOf("throttle");n.splice(s,Ty((n[s+1]||"invalid-wait").split("ms")[0])?2:1)}if(n.length===0||n.length===1&&ID(t.key).includes(n[0]))return!1;const r=["ctrl","shift","alt","meta","cmd","super"].filter(s=>n.includes(s));return n=n.filter(s=>!r.includes(s)),!(r.length>0&&r.filter(o=>((o==="cmd"||o==="super")&&(o="meta"),t[`${o}Key`])).length===r.length&&(cY(t.type)||ID(t.key).includes(n[0])))}function ID(t){if(!t)return[];t=B9(t);let e={ctrl:"control",slash:"/",space:" ",spacebar:" ",cmd:"meta",esc:"escape",up:"arrow-up",down:"arrow-down",left:"arrow-left",right:"arrow-right",period:".",comma:",",equal:"=",minus:"-",underscore:"_"};return e[t]=t,Object.keys(e).map(n=>{if(e[n]===t)return n}).filter(n=>n)}Wn("model",(t,{modifiers:e,expression:n},{effect:i,cleanup:r})=>{let s=t;e.includes("parent")&&(s=t.parentNode);let o=er(s,n),a;typeof n=="string"?a=er(s,`${n} = __placeholder`):typeof n=="function"&&typeof n()=="string"?a=er(s,`${n()} = __placeholder`):a=()=>{};let l=()=>{let d;return o(f=>d=f),OD(d)?d.get():d},c=d=>{let f;o(g=>f=g),OD(f)?f.set(d):a(()=>{},{scope:{__placeholder:d}})};typeof n=="string"&&t.type==="radio"&&un(()=>{t.hasAttribute("name")||t.setAttribute("name",n)});let u=t.tagName.toLowerCase()==="select"||["checkbox","radio"].includes(t.type)||e.includes("lazy")?"change":"input",h=Cc?()=>{}:WM(t,u,e,d=>{c(L0(t,e,d,l()))});if(e.includes("fill")&&([void 0,null,""].includes(l())||OA(t)&&Array.isArray(l())||t.tagName.toLowerCase()==="select"&&t.multiple)&&c(L0(t,e,{target:t},l())),t._x_removeModelListeners||(t._x_removeModelListeners={}),t._x_removeModelListeners.default=h,r(()=>t._x_removeModelListeners.default()),t.form){let d=WM(t.form,"reset",[],f=>{AA(()=>t._x_model&&t._x_model.set(L0(t,e,{target:t},l())))});r(()=>d())}t._x_model={get(){return l()},set(d){c(d)}},t._x_forceModelUpdate=d=>{d===void 0&&typeof n=="string"&&n.match(/\./)&&(d=""),window.fromModel=!0,un(()=>NU(t,"value",d)),delete window.fromModel},i(()=>{let d=l();e.includes("unintrusive")&&document.activeElement.isSameNode(t)||t._x_forceModelUpdate(d)})});function L0(t,e,n,i){return un(()=>{if(n instanceof CustomEvent&&n.detail!==void 0)return n.detail!==null&&n.detail!==void 0?n.detail:n.target.value;if(OA(t))if(Array.isArray(i)){let r=null;return e.includes("number")?r=$0(n.target.value):e.includes("boolean")?r=Kb(n.target.value):r=n.target.value,n.target.checked?i.includes(r)?i:i.concat([r]):i.filter(s=>!z9(s,r))}else return n.target.checked;else{if(t.tagName.toLowerCase()==="select"&&t.multiple)return e.includes("number")?Array.from(n.target.selectedOptions).map(r=>{let s=r.value||r.text;return $0(s)}):e.includes("boolean")?Array.from(n.target.selectedOptions).map(r=>{let s=r.value||r.text;return Kb(s)}):Array.from(n.target.selectedOptions).map(r=>r.value||r.text);{let r;return VU(t)?n.target.checked?r=n.target.value:r=i:r=n.target.value,e.includes("number")?$0(r):e.includes("boolean")?Kb(r):e.includes("trim")?r.trim():r}}})}function $0(t){let e=t?parseFloat(t):null;return U9(e)?e:t}function z9(t,e){return t==e}function U9(t){return!Array.isArray(t)&&!isNaN(t)}function OD(t){return t!==null&&typeof t=="object"&&typeof t.get=="function"&&typeof t.set=="function"}Wn("cloak",t=>queueMicrotask(()=>un(()=>t.removeAttribute(Wf("cloak")))));AU(()=>`[${Wf("init")}]`);Wn("init",Oc((t,{expression:e},{evaluate:n})=>typeof e=="string"?!!e.trim()&&n(e,{},!1):n(e,{},!1)));Wn("text",(t,{expression:e},{effect:n,evaluateLater:i})=>{let r=i(e);n(()=>{r(s=>{un(()=>{t.textContent=s})})})});Wn("html",(t,{expression:e},{effect:n,evaluateLater:i})=>{let r=i(e);n(()=>{r(s=>{un(()=>{t.innerHTML=s,t._x_ignoreSelf=!0,sl(t),delete t._x_ignoreSelf})})})});TA(yU(":",CU(Wf("bind:"))));var uY=(t,{value:e,modifiers:n,expression:i,original:r},{effect:s,cleanup:o})=>{if(!e){let l={};X8(l),er(t,i)(u=>{UU(t,u,r)},{scope:l});return}if(e==="key")return Y9(t,i);if(t._x_inlineBindings&&t._x_inlineBindings[e]&&t._x_inlineBindings[e].extract)return;let a=er(t,i);s(()=>a(l=>{l===void 0&&typeof i=="string"&&i.match(/\./)&&(l=""),un(()=>NU(t,e,l,n))})),o(()=>{t._x_undoAddedClasses&&t._x_undoAddedClasses(),t._x_undoAddedStyles&&t._x_undoAddedStyles()})};uY.inline=(t,{value:e,modifiers:n,expression:i})=>{e&&(t._x_inlineBindings||(t._x_inlineBindings={}),t._x_inlineBindings[e]={expression:i,extract:!1})};Wn("bind",uY);function Y9(t,e){t._x_keyExpression=e}PU(()=>`[${Wf("data")}]`);Wn("data",(t,{expression:e},{cleanup:n})=>{if(G9(t))return;e=e===""?"{}":e;let i={};wp(i,t);let r={};Z8(r,i);let s=ah(t,e,{scope:r});(s===void 0||s===!0)&&(s={}),wp(s,t);let o=Vf(s);_A(o);let a=Qp(t,o);o.init&&ah(t,o.init),n(()=>{o.destroy&&ah(t,o.destroy),a()})});aS((t,e)=>{t._x_dataStack&&(e._x_dataStack=t._x_dataStack,e.setAttribute("data-has-alpine-state",!0))});function G9(t){return Cc?$M?!0:t.hasAttribute("data-has-alpine-state"):!1}Wn("show",(t,{modifiers:e,expression:n},{effect:i})=>{let r=er(t,n);t._x_doHide||(t._x_doHide=()=>{un(()=>{t.style.setProperty("display","none",e.includes("important")?"important":void 0)})}),t._x_doShow||(t._x_doShow=()=>{un(()=>{t.style.length===1&&t.style.display==="none"?t.removeAttribute("style"):t.style.removeProperty("display")})});let s=()=>{t._x_doHide(),t._x_isShown=!1},o=()=>{t._x_doShow(),t._x_isShown=!0},a=()=>setTimeout(o),l=NM(h=>h?o():s(),h=>{typeof t._x_toggleAndCascadeWithTransitions=="function"?t._x_toggleAndCascadeWithTransitions(t,h,o,s):h?a():s()}),c,u=!0;i(()=>r(h=>{!u&&h===c||(e.includes("immediate")&&(h?a():s()),l(h),c=h,u=!1)}))});Wn("for",(t,{expression:e},{effect:n,cleanup:i})=>{let r=K9(e),s=er(t,r.items),o=er(t,t._x_keyExpression||"index");t._x_prevKeys=[],t._x_lookup={},n(()=>q9(t,r,s,o)),i(()=>{Object.values(t._x_lookup).forEach(a=>un(()=>{jf(a),a.remove()})),delete t._x_prevKeys,delete t._x_lookup})});function q9(t,e,n,i){let r=o=>typeof o=="object"&&!Array.isArray(o),s=t;n(o=>{X9(o)&&o>=0&&(o=Array.from(Array(o).keys(),p=>p+1)),o===void 0&&(o=[]);let a=t._x_lookup,l=t._x_prevKeys,c=[],u=[];if(r(o))o=Object.entries(o).map(([p,v])=>{let b=HD(e,v,p,o);i(R=>{u.includes(R)&&xs("Duplicate key on x-for",t),u.push(R)},{scope:{index:p,...b}}),c.push(b)});else for(let p=0;p<o.length;p++){let v=HD(e,o[p],p,o);i(b=>{u.includes(b)&&xs("Duplicate key on x-for",t),u.push(b)},{scope:{index:p,...v}}),c.push(v)}let h=[],d=[],f=[],g=[];for(let p=0;p<l.length;p++){let v=l[p];u.indexOf(v)===-1&&f.push(v)}l=l.filter(p=>!f.includes(p));let m="template";for(let p=0;p<u.length;p++){let v=u[p],b=l.indexOf(v);if(b===-1)l.splice(p,0,v),h.push([m,p]);else if(b!==p){let R=l.splice(p,1)[0],S=l.splice(b-1,1)[0];l.splice(p,0,S),l.splice(b,0,R),d.push([R,S])}else g.push(v);m=v}for(let p=0;p<f.length;p++){let v=f[p];v in a&&(un(()=>{jf(a[v]),a[v].remove()}),delete a[v])}for(let p=0;p<d.length;p++){let[v,b]=d[p],R=a[v],S=a[b],x=document.createElement("div");un(()=>{S||xs('x-for ":key" is undefined or invalid',s,b,a),S.after(x),R.after(S),S._x_currentIfEl&&S.after(S._x_currentIfEl),x.before(R),R._x_currentIfEl&&R.after(R._x_currentIfEl),x.remove()}),S._x_refreshXForScope(c[u.indexOf(b)])}for(let p=0;p<h.length;p++){let[v,b]=h[p],R=v==="template"?s:a[v];R._x_currentIfEl&&(R=R._x_currentIfEl);let S=c[b],x=u[b],M=document.importNode(s.content,!0).firstElementChild,T=Vf(S);Qp(M,T,s),M._x_refreshXForScope=O=>{Object.entries(O).forEach(([W,N])=>{T[W]=N})},un(()=>{R.after(M),Oc(()=>sl(M))()}),typeof x=="object"&&xs("x-for key cannot be an object, it must be a string or an integer",s),a[x]=M}for(let p=0;p<g.length;p++)a[g[p]]._x_refreshXForScope(c[u.indexOf(g[p])]);s._x_prevKeys=u})}function K9(t){let e=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,n=/^\s*\(|\)\s*$/g,i=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,r=t.match(i);if(!r)return;let s={};s.items=r[2].trim();let o=r[1].replace(n,"").trim(),a=o.match(e);return a?(s.item=o.replace(e,"").trim(),s.index=a[1].trim(),a[2]&&(s.collection=a[2].trim())):s.item=o,s}function HD(t,e,n,i){let r={};return/^\[.*\]$/.test(t.item)&&Array.isArray(e)?t.item.replace("[","").replace("]","").split(",").map(o=>o.trim()).forEach((o,a)=>{r[o]=e[a]}):/^\{.*\}$/.test(t.item)&&!Array.isArray(e)&&typeof e=="object"?t.item.replace("{","").replace("}","").split(",").map(o=>o.trim()).forEach(o=>{r[o]=e[o]}):r[t.item]=e,t.index&&(r[t.index]=n),t.collection&&(r[t.collection]=i),r}function X9(t){return!Array.isArray(t)&&!isNaN(t)}function hY(){}hY.inline=(t,{expression:e},{cleanup:n})=>{let i=sS(t);i._x_refs||(i._x_refs={}),i._x_refs[e]=t,n(()=>delete i._x_refs[e])};Wn("ref",hY);Wn("if",(t,{expression:e},{effect:n,cleanup:i})=>{t.tagName.toLowerCase()!=="template"&&xs("x-if can only be used on a <template> tag",t);let r=er(t,e),s=()=>{if(t._x_currentIfEl)return t._x_currentIfEl;let a=t.content.cloneNode(!0).firstElementChild;return Qp(a,{},t),un(()=>{t.after(a),Oc(()=>sl(a))()}),t._x_currentIfEl=a,t._x_undoIf=()=>{un(()=>{jf(a),a.remove()}),delete t._x_currentIfEl},a},o=()=>{t._x_undoIf&&(t._x_undoIf(),delete t._x_undoIf)};n(()=>r(a=>{a?s():o()})),i(()=>t._x_undoIf&&t._x_undoIf())});Wn("id",(t,{expression:e},{evaluate:n})=>{n(e).forEach(r=>N9(t,r))});aS((t,e)=>{t._x_ids&&(e._x_ids=t._x_ids)});TA(yU("@",CU(Wf("on:"))));Wn("on",Oc((t,{value:e,modifiers:n,expression:i},{cleanup:r})=>{let s=i?er(t,i):()=>{};t.tagName.toLowerCase()==="template"&&(t._x_forwardEvents||(t._x_forwardEvents=[]),t._x_forwardEvents.includes(e)||t._x_forwardEvents.push(e));let o=WM(t,e,n,a=>{s(()=>{},{scope:{$event:a},params:[a]})});r(()=>o())}));hS("Collapse","collapse","collapse");hS("Intersect","intersect","intersect");hS("Focus","trap","focus");hS("Mask","mask","mask");function hS(t,e,n){Wn(e,i=>xs(`You can't use [x-${e}] without first installing the "${t}" plugin here: https://alpinejs.dev/plugins/${n}`,i))}zf.setEvaluator(pU);zf.setRawEvaluator(u8);zf.setReactivityEngine({reactive:FA,effect:l9,release:c9,raw:jt});var J9=zf,dY=J9;function ew(t){return t+.5|0}const tc=(t,e,n)=>Math.max(Math.min(t,n),e);function _m(t){return tc(ew(t*2.55),0,255)}function mc(t){return tc(ew(t*255),0,255)}function Ua(t){return tc(ew(t/2.55)/100,0,1)}function kD(t){return tc(ew(t*100),0,100)}const ls={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},jM=[..."0123456789ABCDEF"],Z9=t=>jM[t&15],Q9=t=>jM[(t&240)>>4]+jM[t&15],Kw=t=>(t&240)>>4===(t&15),eJ=t=>Kw(t.r)&&Kw(t.g)&&Kw(t.b)&&Kw(t.a);function tJ(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&ls[t[1]]*17,g:255&ls[t[2]]*17,b:255&ls[t[3]]*17,a:e===5?ls[t[4]]*17:255}:(e===7||e===9)&&(n={r:ls[t[1]]<<4|ls[t[2]],g:ls[t[3]]<<4|ls[t[4]],b:ls[t[5]]<<4|ls[t[6]],a:e===9?ls[t[7]]<<4|ls[t[8]]:255})),n}const nJ=(t,e)=>t<255?e(t):"";function iJ(t){var e=eJ(t)?Z9:Q9;return t?"#"+e(t.r)+e(t.g)+e(t.b)+nJ(t.a,e):void 0}const rJ=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function fY(t,e,n){const i=e*Math.min(n,1-n),r=(s,o=(s+t/30)%12)=>n-i*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function sJ(t,e,n){const i=(r,s=(r+t/60)%6)=>n-n*e*Math.max(Math.min(s,4-s,1),0);return[i(5),i(3),i(1)]}function oJ(t,e,n){const i=fY(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)i[r]*=1-e-n,i[r]+=e;return i}function aJ(t,e,n,i,r){return t===r?(e-n)/i+(e<n?6:0):e===r?(n-t)/i+2:(t-e)/i+4}function VA(t){const n=t.r/255,i=t.g/255,r=t.b/255,s=Math.max(n,i,r),o=Math.min(n,i,r),a=(s+o)/2;let l,c,u;return s!==o&&(u=s-o,c=a>.5?u/(2-s-o):u/(s+o),l=aJ(n,i,r,u,s),l=l*60+.5),[l|0,c||0,a]}function BA(t,e,n,i){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,i)).map(mc)}function WA(t,e,n){return BA(fY,t,e,n)}function lJ(t,e,n){return BA(oJ,t,e,n)}function cJ(t,e,n){return BA(sJ,t,e,n)}function gY(t){return(t%360+360)%360}function uJ(t){const e=rJ.exec(t);let n=255,i;if(!e)return;e[5]!==i&&(n=e[6]?_m(+e[5]):mc(+e[5]));const r=gY(+e[2]),s=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?i=lJ(r,s,o):e[1]==="hsv"?i=cJ(r,s,o):i=WA(r,s,o),{r:i[0],g:i[1],b:i[2],a:n}}function hJ(t,e){var n=VA(t);n[0]=gY(n[0]+e),n=WA(n),t.r=n[0],t.g=n[1],t.b=n[2]}function dJ(t){if(!t)return;const e=VA(t),n=e[0],i=kD(e[1]),r=kD(e[2]);return t.a<255?`hsla(${n}, ${i}%, ${r}%, ${Ua(t.a)})`:`hsl(${n}, ${i}%, ${r}%)`}const DD={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},ND={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function fJ(){const t={},e=Object.keys(ND),n=Object.keys(DD);let i,r,s,o,a;for(i=0;i<e.length;i++){for(o=a=e[i],r=0;r<n.length;r++)s=n[r],a=a.replace(s,DD[s]);s=parseInt(ND[o],16),t[a]=[s>>16&255,s>>8&255,s&255]}return t}let Xw;function gJ(t){Xw||(Xw=fJ(),Xw.transparent=[0,0,0,0]);const e=Xw[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const mJ=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function pJ(t){const e=mJ.exec(t);let n=255,i,r,s;if(e){if(e[7]!==i){const o=+e[7];n=e[8]?_m(o):tc(o*255,0,255)}return i=+e[1],r=+e[3],s=+e[5],i=255&(e[2]?_m(i):tc(i,0,255)),r=255&(e[4]?_m(r):tc(r,0,255)),s=255&(e[6]?_m(s):tc(s,0,255)),{r:i,g:r,b:s,a:n}}}function wJ(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Ua(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const F0=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,qh=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function vJ(t,e,n){const i=qh(Ua(t.r)),r=qh(Ua(t.g)),s=qh(Ua(t.b));return{r:mc(F0(i+n*(qh(Ua(e.r))-i))),g:mc(F0(r+n*(qh(Ua(e.g))-r))),b:mc(F0(s+n*(qh(Ua(e.b))-s))),a:t.a+n*(e.a-t.a)}}function Jw(t,e,n){if(t){let i=VA(t);i[e]=Math.max(0,Math.min(i[e]+i[e]*n,e===0?360:1)),i=WA(i),t.r=i[0],t.g=i[1],t.b=i[2]}}function mY(t,e){return t&&Object.assign(e||{},t)}function LD(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=mc(t[3]))):(e=mY(t,{r:0,g:0,b:0,a:1}),e.a=mc(e.a)),e}function bJ(t){return t.charAt(0)==="r"?pJ(t):uJ(t)}class yp{constructor(e){if(e instanceof yp)return e;const n=typeof e;let i;n==="object"?i=LD(e):n==="string"&&(i=tJ(e)||gJ(e)||bJ(e)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var e=mY(this._rgb);return e&&(e.a=Ua(e.a)),e}set rgb(e){this._rgb=LD(e)}rgbString(){return this._valid?wJ(this._rgb):void 0}hexString(){return this._valid?iJ(this._rgb):void 0}hslString(){return this._valid?dJ(this._rgb):void 0}mix(e,n){if(e){const i=this.rgb,r=e.rgb;let s;const o=n===s?.5:n,a=2*o-1,l=i.a-r.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;s=1-c,i.r=255&c*i.r+s*r.r+.5,i.g=255&c*i.g+s*r.g+.5,i.b=255&c*i.b+s*r.b+.5,i.a=o*i.a+(1-o)*r.a,this.rgb=i}return this}interpolate(e,n){return e&&(this._rgb=vJ(this._rgb,e._rgb,n)),this}clone(){return new yp(this.rgb)}alpha(e){return this._rgb.a=mc(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=ew(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Jw(this._rgb,2,e),this}darken(e){return Jw(this._rgb,2,-e),this}saturate(e){return Jw(this._rgb,1,e),this}desaturate(e){return Jw(this._rgb,1,-e),this}rotate(e){return hJ(this._rgb,e),this}}function ba(){}const yJ=(()=>{let t=0;return()=>t++})();function it(t){return t==null}function Zt(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function st(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function Cn(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function jr(t,e){return Cn(t)?t:e}function Ne(t,e){return typeof t>"u"?e:t}const CJ=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,pY=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Dt(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function Mt(t,e,n,i){let r,s,o;if(Zt(t))for(s=t.length,r=0;r<s;r++)e.call(n,t[r],r);else if(st(t))for(o=Object.keys(t),s=o.length,r=0;r<s;r++)e.call(n,t[o[r]],o[r])}function My(t,e){let n,i,r,s;if(!t||!e||t.length!==e.length)return!1;for(n=0,i=t.length;n<i;++n)if(r=t[n],s=e[n],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function Py(t){if(Zt(t))return t.map(Py);if(st(t)){const e=Object.create(null),n=Object.keys(t),i=n.length;let r=0;for(;r<i;++r)e[n[r]]=Py(t[n[r]]);return e}return t}function wY(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function SJ(t,e,n,i){if(!wY(t))return;const r=e[t],s=n[t];st(r)&&st(s)?Cp(r,s,i):e[t]=Py(s)}function Cp(t,e,n){const i=Zt(e)?e:[e],r=i.length;if(!st(t))return t;n=n||{};const s=n.merger||SJ;let o;for(let a=0;a<r;++a){if(o=i[a],!st(o))continue;const l=Object.keys(o);for(let c=0,u=l.length;c<u;++c)s(l[c],t,o,n)}return t}function Bm(t,e){return Cp(t,e,{merger:RJ})}function RJ(t,e,n){if(!wY(t))return;const i=e[t],r=n[t];st(i)&&st(r)?Bm(i,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=Py(r))}const $D={"":t=>t,x:t=>t.x,y:t=>t.y};function _J(t){const e=t.split("."),n=[];let i="";for(const r of e)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(n.push(i),i="");return n}function EJ(t){const e=_J(t);return n=>{for(const i of e){if(i==="")break;n=n&&n[i]}return n}}function Rc(t,e){return($D[e]||($D[e]=EJ(e)))(t)}function jA(t){return t.charAt(0).toUpperCase()+t.slice(1)}const Sp=t=>typeof t<"u",_c=t=>typeof t=="function",FD=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function xJ(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const ft=Math.PI,Wt=2*ft,TJ=Wt+ft,Ay=Number.POSITIVE_INFINITY,MJ=ft/180,Pn=ft/2,Wc=ft/4,VD=ft*2/3,nc=Math.log10,na=Math.sign;function Wm(t,e,n){return Math.abs(t-e)<n}function BD(t){const e=Math.round(t);t=Wm(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(nc(t))),i=t/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function PJ(t){const e=[],n=Math.sqrt(t);let i;for(i=1;i<n;i++)t%i===0&&(e.push(i),e.push(t/i));return n===(n|0)&&e.push(n),e.sort((r,s)=>r-s).pop(),e}function AJ(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function Rf(t){return!AJ(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function IJ(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function vY(t,e,n){let i,r,s;for(i=0,r=t.length;i<r;i++)s=t[i][n],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function no(t){return t*(ft/180)}function zA(t){return t*(180/ft)}function WD(t){if(!Cn(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function bY(t,e){const n=e.x-t.x,i=e.y-t.y,r=Math.sqrt(n*n+i*i);let s=Math.atan2(i,n);return s<-.5*ft&&(s+=Wt),{angle:s,distance:r}}function zM(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function OJ(t,e){return(t-e+TJ)%Wt-ft}function Ii(t){return(t%Wt+Wt)%Wt}function Rp(t,e,n,i){const r=Ii(t),s=Ii(e),o=Ii(n),a=Ii(s-r),l=Ii(o-r),c=Ii(r-s),u=Ii(r-o);return r===s||r===o||i&&s===o||a>l&&c<u}function hi(t,e,n){return Math.max(e,Math.min(n,t))}function HJ(t){return hi(t,-32768,32767)}function Ya(t,e,n,i=1e-6){return t>=Math.min(e,n)-i&&t<=Math.max(e,n)+i}function UA(t,e,n){n=n||(o=>t[o]<e);let i=t.length-1,r=0,s;for(;i-r>1;)s=r+i>>1,n(s)?r=s:i=s;return{lo:r,hi:i}}const Ga=(t,e,n,i)=>UA(t,n,i?r=>{const s=t[r][e];return s<n||s===n&&t[r+1][e]===n}:r=>t[r][e]<n),kJ=(t,e,n)=>UA(t,n,i=>t[i][e]>=n);function DJ(t,e,n){let i=0,r=t.length;for(;i<r&&t[i]<e;)i++;for(;r>i&&t[r-1]>n;)r--;return i>0||r<t.length?t.slice(i,r):t}const yY=["push","pop","shift","splice","unshift"];function NJ(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),yY.forEach(n=>{const i="_onData"+jA(n),r=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...s){const o=r.apply(this,s);return t._chartjs.listeners.forEach(a=>{typeof a[i]=="function"&&a[i](...s)}),o}})})}function jD(t,e){const n=t._chartjs;if(!n)return;const i=n.listeners,r=i.indexOf(e);r!==-1&&i.splice(r,1),!(i.length>0)&&(yY.forEach(s=>{delete t[s]}),delete t._chartjs)}function CY(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const SY=(function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame})();function RY(t,e){let n=[],i=!1;return function(...r){n=r,i||(i=!0,SY.call(window,()=>{i=!1,t.apply(e,n)}))}}function LJ(t,e){let n;return function(...i){return e?(clearTimeout(n),n=setTimeout(t,e,i)):t.apply(this,i),e}}const YA=t=>t==="start"?"left":t==="end"?"right":"center",Pi=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,$J=(t,e,n,i)=>t===(i?"left":"right")?n:t==="center"?(e+n)/2:e;function _Y(t,e,n){const i=e.length;let r=0,s=i;if(t._sorted){const{iScale:o,vScale:a,_parsed:l}=t,c=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null,u=o.axis,{min:h,max:d,minDefined:f,maxDefined:g}=o.getUserBounds();if(f){if(r=Math.min(Ga(l,u,h).lo,n?i:Ga(e,u,o.getPixelForValue(h)).lo),c){const m=l.slice(0,r+1).reverse().findIndex(p=>!it(p[a.axis]));r-=Math.max(0,m)}r=hi(r,0,i-1)}if(g){let m=Math.max(Ga(l,o.axis,d,!0).hi+1,n?0:Ga(e,u,o.getPixelForValue(d),!0).hi+1);if(c){const p=l.slice(m-1).findIndex(v=>!it(v[a.axis]));m+=Math.max(0,p)}s=hi(m,r,i)-r}else s=i-r}return{start:r,count:s}}function EY(t){const{xScale:e,yScale:n,_scaleRanges:i}=t,r={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!i)return t._scaleRanges=r,!0;const s=i.xmin!==e.min||i.xmax!==e.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,r),s}const Zw=t=>t===0||t===1,zD=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Wt/n)),UD=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Wt/n)+1,jm={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Pn)+1,easeOutSine:t=>Math.sin(t*Pn),easeInOutSine:t=>-.5*(Math.cos(ft*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>Zw(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>Zw(t)?t:zD(t,.075,.3),easeOutElastic:t=>Zw(t)?t:UD(t,.075,.3),easeInOutElastic(t){return Zw(t)?t:t<.5?.5*zD(t*2,.1125,.45):.5+.5*UD(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-jm.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?jm.easeInBounce(t*2)*.5:jm.easeOutBounce(t*2-1)*.5+.5};function GA(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function YD(t){return GA(t)?t:new yp(t)}function V0(t){return GA(t)?t:new yp(t).saturate(.5).darken(.1).hexString()}const FJ=["x","y","borderWidth","radius","tension"],VJ=["color","borderColor","backgroundColor"];function BJ(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:VJ},numbers:{type:"number",properties:FJ}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function WJ(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const GD=new Map;function jJ(t,e){e=e||{};const n=t+JSON.stringify(e);let i=GD.get(n);return i||(i=new Intl.NumberFormat(t,e),GD.set(n,i)),i}function tw(t,e,n){return jJ(e,n).format(t)}const xY={values(t){return Zt(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const i=this.chart.options.locale;let r,s=t;if(n.length>1){const c=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(c<1e-4||c>1e15)&&(r="scientific"),s=zJ(t,n)}const o=nc(Math.abs(s)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),tw(t,i,l)},logarithmic(t,e,n){if(t===0)return"0";const i=n[e].significand||t/Math.pow(10,Math.floor(nc(t)));return[1,2,3,5,10,15].includes(i)||e>.8*n.length?xY.numeric.call(this,t,e,n):""}};function zJ(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var dS={formatters:xY};function UJ(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:dS.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Sh=Object.create(null),UM=Object.create(null);function zm(t,e){if(!e)return t;const n=e.split(".");for(let i=0,r=n.length;i<r;++i){const s=n[i];t=t[s]||(t[s]=Object.create(null))}return t}function B0(t,e,n){return typeof e=="string"?Cp(zm(t,e),n):Cp(zm(t,""),e)}class YJ{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,r)=>V0(r.backgroundColor),this.hoverBorderColor=(i,r)=>V0(r.borderColor),this.hoverColor=(i,r)=>V0(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return B0(this,e,n)}get(e){return zm(this,e)}describe(e,n){return B0(UM,e,n)}override(e,n){return B0(Sh,e,n)}route(e,n,i,r){const s=zm(this,e),o=zm(this,i),a="_"+n;Object.defineProperties(s,{[a]:{value:s[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[a],c=o[r];return st(l)?Object.assign({},c,l):Ne(l,c)},set(l){this[a]=l}}})}apply(e){e.forEach(n=>n(this))}}var Qt=new YJ({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[BJ,WJ,UJ]);function GJ(t){return!t||it(t.size)||it(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function Iy(t,e,n,i,r){let s=e[r];return s||(s=e[r]=t.measureText(r).width,n.push(r)),s>i&&(i=s),i}function qJ(t,e,n,i){i=i||{};let r=i.data=i.data||{},s=i.garbageCollect=i.garbageCollect||[];i.font!==e&&(r=i.data={},s=i.garbageCollect=[],i.font=e),t.save(),t.font=e;let o=0;const a=n.length;let l,c,u,h,d;for(l=0;l<a;l++)if(h=n[l],h!=null&&!Zt(h))o=Iy(t,r,s,o,h);else if(Zt(h))for(c=0,u=h.length;c<u;c++)d=h[c],d!=null&&!Zt(d)&&(o=Iy(t,r,s,o,d));t.restore();const f=s.length/2;if(f>n.length){for(l=0;l<f;l++)delete r[s[l]];s.splice(0,f)}return o}function jc(t,e,n){const i=t.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((e-r)*i)/i+r}function qD(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function YM(t,e,n,i){TY(t,e,n,i,null)}function TY(t,e,n,i,r){let s,o,a,l,c,u,h,d;const f=e.pointStyle,g=e.rotation,m=e.radius;let p=(g||0)*MJ;if(f&&typeof f=="object"&&(s=f.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){t.save(),t.translate(n,i),t.rotate(p),t.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),t.restore();return}if(!(isNaN(m)||m<=0)){switch(t.beginPath(),f){default:r?t.ellipse(n,i,r/2,m,0,0,Wt):t.arc(n,i,m,0,Wt),t.closePath();break;case"triangle":u=r?r/2:m,t.moveTo(n+Math.sin(p)*u,i-Math.cos(p)*m),p+=VD,t.lineTo(n+Math.sin(p)*u,i-Math.cos(p)*m),p+=VD,t.lineTo(n+Math.sin(p)*u,i-Math.cos(p)*m),t.closePath();break;case"rectRounded":c=m*.516,l=m-c,o=Math.cos(p+Wc)*l,h=Math.cos(p+Wc)*(r?r/2-c:l),a=Math.sin(p+Wc)*l,d=Math.sin(p+Wc)*(r?r/2-c:l),t.arc(n-h,i-a,c,p-ft,p-Pn),t.arc(n+d,i-o,c,p-Pn,p),t.arc(n+h,i+a,c,p,p+Pn),t.arc(n-d,i+o,c,p+Pn,p+ft),t.closePath();break;case"rect":if(!g){l=Math.SQRT1_2*m,u=r?r/2:l,t.rect(n-u,i-l,2*u,2*l);break}p+=Wc;case"rectRot":h=Math.cos(p)*(r?r/2:m),o=Math.cos(p)*m,a=Math.sin(p)*m,d=Math.sin(p)*(r?r/2:m),t.moveTo(n-h,i-a),t.lineTo(n+d,i-o),t.lineTo(n+h,i+a),t.lineTo(n-d,i+o),t.closePath();break;case"crossRot":p+=Wc;case"cross":h=Math.cos(p)*(r?r/2:m),o=Math.cos(p)*m,a=Math.sin(p)*m,d=Math.sin(p)*(r?r/2:m),t.moveTo(n-h,i-a),t.lineTo(n+h,i+a),t.moveTo(n+d,i-o),t.lineTo(n-d,i+o);break;case"star":h=Math.cos(p)*(r?r/2:m),o=Math.cos(p)*m,a=Math.sin(p)*m,d=Math.sin(p)*(r?r/2:m),t.moveTo(n-h,i-a),t.lineTo(n+h,i+a),t.moveTo(n+d,i-o),t.lineTo(n-d,i+o),p+=Wc,h=Math.cos(p)*(r?r/2:m),o=Math.cos(p)*m,a=Math.sin(p)*m,d=Math.sin(p)*(r?r/2:m),t.moveTo(n-h,i-a),t.lineTo(n+h,i+a),t.moveTo(n+d,i-o),t.lineTo(n-d,i+o);break;case"line":o=r?r/2:Math.cos(p)*m,a=Math.sin(p)*m,t.moveTo(n-o,i-a),t.lineTo(n+o,i+a);break;case"dash":t.moveTo(n,i),t.lineTo(n+Math.cos(p)*(r?r/2:m),i+Math.sin(p)*m);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function qa(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function fS(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function gS(t){t.restore()}function KJ(t,e,n,i,r){if(!e)return t.lineTo(n.x,n.y);if(r==="middle"){const s=(e.x+n.x)/2;t.lineTo(s,e.y),t.lineTo(s,n.y)}else r==="after"!=!!i?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function XJ(t,e,n,i){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(i?e.cp1x:e.cp2x,i?e.cp1y:e.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function JJ(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),it(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function ZJ(t,e,n,i,r){if(r.strikethrough||r.underline){const s=t.measureText(i),o=e-s.actualBoundingBoxLeft,a=e+s.actualBoundingBoxRight,l=n-s.actualBoundingBoxAscent,c=n+s.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(o,u),t.lineTo(a,u),t.stroke()}}function QJ(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function Rh(t,e,n,i,r,s={}){const o=Zt(e)?e:[e],a=s.strokeWidth>0&&s.strokeColor!=="";let l,c;for(t.save(),t.font=r.string,JJ(t,s),l=0;l<o.length;++l)c=o[l],s.backdrop&&QJ(t,s.backdrop),a&&(s.strokeColor&&(t.strokeStyle=s.strokeColor),it(s.strokeWidth)||(t.lineWidth=s.strokeWidth),t.strokeText(c,n,i,s.maxWidth)),t.fillText(c,n,i,s.maxWidth),ZJ(t,n,i,c,s),i+=Number(r.lineHeight);t.restore()}function _p(t,e){const{x:n,y:i,w:r,h:s,radius:o}=e;t.arc(n+o.topLeft,i+o.topLeft,o.topLeft,1.5*ft,ft,!0),t.lineTo(n,i+s-o.bottomLeft),t.arc(n+o.bottomLeft,i+s-o.bottomLeft,o.bottomLeft,ft,Pn,!0),t.lineTo(n+r-o.bottomRight,i+s),t.arc(n+r-o.bottomRight,i+s-o.bottomRight,o.bottomRight,Pn,0,!0),t.lineTo(n+r,i+o.topRight),t.arc(n+r-o.topRight,i+o.topRight,o.topRight,0,-Pn,!0),t.lineTo(n+o.topLeft,i)}const eZ=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,tZ=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function nZ(t,e){const n=(""+t).match(eZ);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const iZ=t=>+t||0;function qA(t,e){const n={},i=st(e),r=i?Object.keys(e):e,s=st(t)?i?o=>Ne(t[o],t[e[o]]):o=>t[o]:()=>t;for(const o of r)n[o]=iZ(s(o));return n}function MY(t){return qA(t,{top:"y",right:"x",bottom:"y",left:"x"})}function uh(t){return qA(t,["topLeft","topRight","bottomLeft","bottomRight"])}function Li(t){const e=MY(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Zn(t,e){t=t||{},e=e||Qt.font;let n=Ne(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let i=Ne(t.style,e.style);i&&!(""+i).match(tZ)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const r={family:Ne(t.family,e.family),lineHeight:nZ(Ne(t.lineHeight,e.lineHeight),n),size:n,style:i,weight:Ne(t.weight,e.weight),string:""};return r.string=GJ(r),r}function Em(t,e,n,i){let r,s,o;for(r=0,s=t.length;r<s;++r)if(o=t[r],o!==void 0&&o!==void 0)return o}function rZ(t,e,n){const{min:i,max:r}=t,s=pY(e,(r-i)/2),o=(a,l)=>n&&a===0?0:a+l;return{min:o(i,-Math.abs(s)),max:o(r,s)}}function Hc(t,e){return Object.assign(Object.create(t),e)}function KA(t,e=[""],n,i,r=()=>t[0]){const s=n||t;typeof i>"u"&&(i=OY("_fallback",t));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:s,_fallback:i,_getTarget:r,override:a=>KA([a,...t],e,s,i)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete t[0][l],!0},get(a,l){return AY(a,l,()=>dZ(l,e,t,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(a,l){return XD(a).includes(l)},ownKeys(a){return XD(a)},set(a,l,c){const u=a._storage||(a._storage=r());return a[l]=u[l]=c,delete a._keys,!0}})}function _f(t,e,n,i){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:PY(t,i),setContext:s=>_f(t,s,n,i),override:s=>_f(t.override(s),e,n,i)};return new Proxy(r,{deleteProperty(s,o){return delete s[o],delete t[o],!0},get(s,o,a){return AY(s,o,()=>oZ(s,o,a))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(t,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,o)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(s,o){return Reflect.has(t,o)},ownKeys(){return Reflect.ownKeys(t)},set(s,o,a){return t[o]=a,delete s[o],!0}})}function PY(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:i=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:i,isScriptable:_c(n)?n:()=>n,isIndexable:_c(i)?i:()=>i}}const sZ=(t,e)=>t?t+jA(e):e,XA=(t,e)=>st(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function AY(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const i=n();return t[e]=i,i}function oZ(t,e,n){const{_proxy:i,_context:r,_subProxy:s,_descriptors:o}=t;let a=i[e];return _c(a)&&o.isScriptable(e)&&(a=aZ(e,a,t,n)),Zt(a)&&a.length&&(a=lZ(e,a,t,o.isIndexable)),XA(e,a)&&(a=_f(a,r,s&&s[e],o)),a}function aZ(t,e,n,i){const{_proxy:r,_context:s,_subProxy:o,_stack:a}=n;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(s,o||i);return a.delete(t),XA(t,l)&&(l=JA(r._scopes,r,t,l)),l}function lZ(t,e,n,i){const{_proxy:r,_context:s,_subProxy:o,_descriptors:a}=n;if(typeof s.index<"u"&&i(t))return e[s.index%e.length];if(st(e[0])){const l=e,c=r._scopes.filter(u=>u!==l);e=[];for(const u of l){const h=JA(c,r,t,u);e.push(_f(h,s,o&&o[t],a))}}return e}function IY(t,e,n){return _c(t)?t(e,n):t}const cZ=(t,e)=>t===!0?e:typeof t=="string"?Rc(e,t):void 0;function uZ(t,e,n,i,r){for(const s of e){const o=cZ(n,s);if(o){t.add(o);const a=IY(o._fallback,n,r);if(typeof a<"u"&&a!==n&&a!==i)return a}else if(o===!1&&typeof i<"u"&&n!==i)return null}return!1}function JA(t,e,n,i){const r=e._rootScopes,s=IY(e._fallback,n,i),o=[...t,...r],a=new Set;a.add(i);let l=KD(a,o,n,s||n,i);return l===null||typeof s<"u"&&s!==n&&(l=KD(a,o,s,l,i),l===null)?!1:KA(Array.from(a),[""],r,s,()=>hZ(e,n,i))}function KD(t,e,n,i,r){for(;n;)n=uZ(t,e,n,i,r);return n}function hZ(t,e,n){const i=t._getTarget();e in i||(i[e]={});const r=i[e];return Zt(r)&&st(n)?n:r||{}}function dZ(t,e,n,i){let r;for(const s of e)if(r=OY(sZ(s,t),n),typeof r<"u")return XA(t,r)?JA(n,i,t,r):r}function OY(t,e){for(const n of e){if(!n)continue;const i=n[t];if(typeof i<"u")return i}}function XD(t){let e=t._keys;return e||(e=t._keys=fZ(t._scopes)),e}function fZ(t){const e=new Set;for(const n of t)for(const i of Object.keys(n).filter(r=>!r.startsWith("_")))e.add(i);return Array.from(e)}function HY(t,e,n,i){const{iScale:r}=t,{key:s="r"}=this._parsing,o=new Array(i);let a,l,c,u;for(a=0,l=i;a<l;++a)c=a+n,u=e[c],o[a]={r:r.parse(Rc(u,s),c)};return o}const gZ=Number.EPSILON||1e-14,Ef=(t,e)=>e<t.length&&!t[e].skip&&t[e],kY=t=>t==="x"?"y":"x";function mZ(t,e,n,i){const r=t.skip?e:t,s=e,o=n.skip?e:n,a=zM(s,r),l=zM(o,s);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const h=i*c,d=i*u;return{previous:{x:s.x-h*(o.x-r.x),y:s.y-h*(o.y-r.y)},next:{x:s.x+d*(o.x-r.x),y:s.y+d*(o.y-r.y)}}}function pZ(t,e,n){const i=t.length;let r,s,o,a,l,c=Ef(t,0);for(let u=0;u<i-1;++u)if(l=c,c=Ef(t,u+1),!(!l||!c)){if(Wm(e[u],0,gZ)){n[u]=n[u+1]=0;continue}r=n[u]/e[u],s=n[u+1]/e[u],a=Math.pow(r,2)+Math.pow(s,2),!(a<=9)&&(o=3/Math.sqrt(a),n[u]=r*o*e[u],n[u+1]=s*o*e[u])}}function wZ(t,e,n="x"){const i=kY(n),r=t.length;let s,o,a,l=Ef(t,0);for(let c=0;c<r;++c){if(o=a,a=l,l=Ef(t,c+1),!a)continue;const u=a[n],h=a[i];o&&(s=(u-o[n])/3,a[`cp1${n}`]=u-s,a[`cp1${i}`]=h-s*e[c]),l&&(s=(l[n]-u)/3,a[`cp2${n}`]=u+s,a[`cp2${i}`]=h+s*e[c])}}function vZ(t,e="x"){const n=kY(e),i=t.length,r=Array(i).fill(0),s=Array(i);let o,a,l,c=Ef(t,0);for(o=0;o<i;++o)if(a=l,l=c,c=Ef(t,o+1),!!l){if(c){const u=c[e]-l[e];r[o]=u!==0?(c[n]-l[n])/u:0}s[o]=a?c?na(r[o-1])!==na(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}pZ(t,r,s),wZ(t,s,e)}function Qw(t,e,n){return Math.max(Math.min(t,n),e)}function bZ(t,e){let n,i,r,s,o,a=qa(t[0],e);for(n=0,i=t.length;n<i;++n)o=s,s=a,a=n<i-1&&qa(t[n+1],e),s&&(r=t[n],o&&(r.cp1x=Qw(r.cp1x,e.left,e.right),r.cp1y=Qw(r.cp1y,e.top,e.bottom)),a&&(r.cp2x=Qw(r.cp2x,e.left,e.right),r.cp2y=Qw(r.cp2y,e.top,e.bottom)))}function yZ(t,e,n,i,r){let s,o,a,l;if(e.spanGaps&&(t=t.filter(c=>!c.skip)),e.cubicInterpolationMode==="monotone")vZ(t,r);else{let c=i?t[t.length-1]:t[0];for(s=0,o=t.length;s<o;++s)a=t[s],l=mZ(c,a,t[Math.min(s+1,o-(i?0:1))%o],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}e.capBezierPoints&&bZ(t,n)}function ZA(){return typeof window<"u"&&typeof document<"u"}function QA(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Oy(t,e,n){let i;return typeof t=="string"?(i=parseInt(t,10),t.indexOf("%")!==-1&&(i=i/100*e.parentNode[n])):i=t,i}const mS=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function CZ(t,e){return mS(t).getPropertyValue(e)}const SZ=["top","right","bottom","left"];function hh(t,e,n){const i={};n=n?"-"+n:"";for(let r=0;r<4;r++){const s=SZ[r];i[s]=parseFloat(t[e+"-"+s+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const RZ=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function _Z(t,e){const n=t.touches,i=n&&n.length?n[0]:t,{offsetX:r,offsetY:s}=i;let o=!1,a,l;if(RZ(r,s,t.target))a=r,l=s;else{const c=e.getBoundingClientRect();a=i.clientX-c.left,l=i.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function Hu(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:i}=e,r=mS(n),s=r.boxSizing==="border-box",o=hh(r,"padding"),a=hh(r,"border","width"),{x:l,y:c,box:u}=_Z(t,n),h=o.left+(u&&a.left),d=o.top+(u&&a.top);let{width:f,height:g}=e;return s&&(f-=o.width+a.width,g-=o.height+a.height),{x:Math.round((l-h)/f*n.width/i),y:Math.round((c-d)/g*n.height/i)}}function EZ(t,e,n){let i,r;if(e===void 0||n===void 0){const s=t&&QA(t);if(!s)e=t.clientWidth,n=t.clientHeight;else{const o=s.getBoundingClientRect(),a=mS(s),l=hh(a,"border","width"),c=hh(a,"padding");e=o.width-c.width-l.width,n=o.height-c.height-l.height,i=Oy(a.maxWidth,s,"clientWidth"),r=Oy(a.maxHeight,s,"clientHeight")}}return{width:e,height:n,maxWidth:i||Ay,maxHeight:r||Ay}}const ic=t=>Math.round(t*10)/10;function xZ(t,e,n,i){const r=mS(t),s=hh(r,"margin"),o=Oy(r.maxWidth,t,"clientWidth")||Ay,a=Oy(r.maxHeight,t,"clientHeight")||Ay,l=EZ(t,e,n);let{width:c,height:u}=l;if(r.boxSizing==="content-box"){const d=hh(r,"border","width"),f=hh(r,"padding");c-=f.width+d.width,u-=f.height+d.height}return c=Math.max(0,c-s.width),u=Math.max(0,i?c/i:u-s.height),c=ic(Math.min(c,o,l.maxWidth)),u=ic(Math.min(u,a,l.maxHeight)),c&&!u&&(u=ic(c/2)),(e!==void 0||n!==void 0)&&i&&l.height&&u>l.height&&(u=l.height,c=ic(Math.floor(u*i))),{width:c,height:u}}function JD(t,e,n){const i=e||1,r=ic(t.height*i),s=ic(t.width*i);t.height=ic(t.height),t.width=ic(t.width);const o=t.canvas;return o.style&&(n||!o.style.height&&!o.style.width)&&(o.style.height=`${t.height}px`,o.style.width=`${t.width}px`),t.currentDevicePixelRatio!==i||o.height!==r||o.width!==s?(t.currentDevicePixelRatio=i,o.height=r,o.width=s,t.ctx.setTransform(i,0,0,i,0,0),!0):!1}const TZ=(function(){let t=!1;try{const e={get passive(){return t=!0,!1}};ZA()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t})();function ZD(t,e){const n=CZ(t,e),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function ku(t,e,n,i){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function MZ(t,e,n,i){return{x:t.x+n*(e.x-t.x),y:i==="middle"?n<.5?t.y:e.y:i==="after"?n<1?t.y:e.y:n>0?e.y:t.y}}function PZ(t,e,n,i){const r={x:t.cp2x,y:t.cp2y},s={x:e.cp1x,y:e.cp1y},o=ku(t,r,n),a=ku(r,s,n),l=ku(s,e,n),c=ku(o,a,n),u=ku(a,l,n);return ku(c,u,n)}const AZ=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,i){return n-i},leftForLtr(n,i){return n-i}}},IZ=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function cf(t,e,n){return t?AZ(e,n):IZ()}function DY(t,e){let n,i;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=i)}function NY(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function LY(t){return t==="angle"?{between:Rp,compare:OJ,normalize:Ii}:{between:Ya,compare:(e,n)=>e-n,normalize:e=>e}}function QD({start:t,end:e,count:n,loop:i,style:r}){return{start:t%n,end:e%n,loop:i&&(e-t+1)%n===0,style:r}}function OZ(t,e,n){const{property:i,start:r,end:s}=n,{between:o,normalize:a}=LY(i),l=e.length;let{start:c,end:u,loop:h}=t,d,f;if(h){for(c+=l,u+=l,d=0,f=l;d<f&&o(a(e[c%l][i]),r,s);++d)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:h,style:t.style}}function $Y(t,e,n){if(!n)return[t];const{property:i,start:r,end:s}=n,o=e.length,{compare:a,between:l,normalize:c}=LY(i),{start:u,end:h,loop:d,style:f}=OZ(t,e,n),g=[];let m=!1,p=null,v,b,R;const S=()=>l(r,R,v)&&a(r,R)!==0,x=()=>a(s,v)===0||l(s,R,v),M=()=>m||S(),T=()=>!m||x();for(let O=u,W=u;O<=h;++O)b=e[O%o],!b.skip&&(v=c(b[i]),v!==R&&(m=l(v,r,s),p===null&&M()&&(p=a(v,r)===0?O:W),p!==null&&T()&&(g.push(QD({start:p,end:O,loop:d,count:o,style:f})),p=null),W=O,R=v));return p!==null&&g.push(QD({start:p,end:h,loop:d,count:o,style:f})),g}function FY(t,e){const n=[],i=t.segments;for(let r=0;r<i.length;r++){const s=$Y(i[r],t.points,e);s.length&&n.push(...s)}return n}function HZ(t,e,n,i){let r=0,s=e-1;if(n&&!i)for(;r<e&&!t[r].skip;)r++;for(;r<e&&t[r].skip;)r++;for(r%=e,n&&(s+=r);s>r&&t[s%e].skip;)s--;return s%=e,{start:r,end:s}}function kZ(t,e,n,i){const r=t.length,s=[];let o=e,a=t[e],l;for(l=e+1;l<=n;++l){const c=t[l%r];c.skip||c.stop?a.skip||(i=!1,s.push({start:e%r,end:(l-1)%r,loop:i}),e=o=c.stop?l:null):(o=l,a.skip&&(e=l)),a=c}return o!==null&&s.push({start:e%r,end:o%r,loop:i}),s}function DZ(t,e){const n=t.points,i=t.options.spanGaps,r=n.length;if(!r)return[];const s=!!t._loop,{start:o,end:a}=HZ(n,r,s,i);if(i===!0)return eN(t,[{start:o,end:a,loop:s}],n,e);const l=a<o?a+r:a,c=!!t._fullLoop&&o===0&&a===r-1;return eN(t,kZ(n,o,l,c),n,e)}function eN(t,e,n,i){return!i||!i.setContext||!n?e:NZ(t,e,n,i)}function NZ(t,e,n,i){const r=t._chart.getContext(),s=tN(t.options),{_datasetIndex:o,options:{spanGaps:a}}=t,l=n.length,c=[];let u=s,h=e[0].start,d=h;function f(g,m,p,v){const b=a?-1:1;if(g!==m){for(g+=l;n[g%l].skip;)g-=b;for(;n[m%l].skip;)m+=b;g%l!==m%l&&(c.push({start:g%l,end:m%l,loop:p,style:v}),u=v,h=m%l)}}for(const g of e){h=a?h:g.start;let m=n[h%l],p;for(d=h+1;d<=g.end;d++){const v=n[d%l];p=tN(i.setContext(Hc(r,{type:"segment",p0:m,p1:v,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:o}))),LZ(p,u)&&f(h,d-1,g.loop,u),m=v,u=p}h<d-1&&f(h,d-1,g.loop,u)}return c}function tN(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function LZ(t,e){if(!e)return!1;const n=[],i=function(r,s){return GA(s)?(n.includes(s)||n.push(s),n.indexOf(s)):s};return JSON.stringify(t,i)!==JSON.stringify(e,i)}function ev(t,e,n){return t.options.clip?t[n]:e[n]}function $Z(t,e){const{xScale:n,yScale:i}=t;return n&&i?{left:ev(n,e,"left"),right:ev(n,e,"right"),top:ev(i,e,"top"),bottom:ev(i,e,"bottom")}:e}function VY(t,e){const n=e._clip;if(n.disabled)return!1;const i=$Z(e,t.chartArea);return{left:n.left===!1?0:i.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:i.right+(n.right===!0?0:n.right),top:n.top===!1?0:i.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:i.bottom+(n.bottom===!0?0:n.bottom)}}class FZ{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,i,r){const s=n.listeners[r],o=n.duration;s.forEach(a=>a({chart:e,initial:n.initial,numSteps:o,currentStep:Math.min(i-n.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=SY.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((i,r)=>{if(!i.running||!i.items.length)return;const s=i.items;let o=s.length-1,a=!1,l;for(;o>=0;--o)l=s[o],l._active?(l._total>i.duration&&(i.duration=l._total),l.tick(e),a=!0):(s[o]=s[s.length-1],s.pop());a&&(r.draw(),this._notify(r,i,e,"progress")),s.length||(i.running=!1,this._notify(r,i,e,"complete"),i.initial=!1),n+=s.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let i=n.get(e);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,i)),i}listen(e,n,i){this._getAnims(e).listeners[n].push(i)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((i,r)=>Math.max(i,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const i=n.items;let r=i.length-1;for(;r>=0;--r)i[r].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Da=new FZ;const nN="transparent",VZ={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const i=YD(t||nN),r=i.valid&&YD(e||nN);return r&&r.valid?r.mix(i,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class BZ{constructor(e,n,i,r){const s=n[i];r=Em([e.to,r,s,e.from]);const o=Em([e.from,s,r]);this._active=!0,this._fn=e.fn||VZ[e.type||typeof o],this._easing=jm[e.easing]||jm.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=i,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,n,i){if(this._active){this._notify(!1);const r=this._target[this._prop],s=i-this._start,o=this._duration-s;this._start=i,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=Em([e.to,n,r,e.from]),this._from=Em([e.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,i=this._duration,r=this._prop,s=this._from,o=this._loop,a=this._to;let l;if(this._active=s!==a&&(o||n<i),!this._active){this._target[r]=a,this._notify(!0);return}if(n<0){this._target[r]=s;return}l=n/i%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(s,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,i)=>{e.push({res:n,rej:i})})}_notify(e){const n=e?"res":"rej",i=this._promises||[];for(let r=0;r<i.length;r++)i[r][n]()}}class BY{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!st(e))return;const n=Object.keys(Qt.animation),i=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const s=e[r];if(!st(s))return;const o={};for(const a of n)o[a]=s[a];(Zt(s.properties)&&s.properties||[r]).forEach(a=>{(a===r||!i.has(a))&&i.set(a,o)})})}_animateOptions(e,n){const i=n.options,r=jZ(e,i);if(!r)return[];const s=this._createAnimations(r,i);return i.$shared&&WZ(e.options.$animations,i).then(()=>{e.options=i},()=>{}),s}_createAnimations(e,n){const i=this._properties,r=[],s=e.$animations||(e.$animations={}),o=Object.keys(n),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){r.push(...this._animateOptions(e,n));continue}const u=n[c];let h=s[c];const d=i.get(c);if(h)if(d&&h.active()){h.update(d,u,a);continue}else h.cancel();if(!d||!d.duration){e[c]=u;continue}s[c]=h=new BZ(d,e,c,u),r.push(h)}return r}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const i=this._createAnimations(e,n);if(i.length)return Da.add(this._chart,i),!0}}function WZ(t,e){const n=[],i=Object.keys(e);for(let r=0;r<i.length;r++){const s=t[i[r]];s&&s.active()&&n.push(s.wait())}return Promise.all(n)}function jZ(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function iN(t,e){const n=t&&t.options||{},i=n.reverse,r=n.min===void 0?e:0,s=n.max===void 0?e:0;return{start:i?s:r,end:i?r:s}}function zZ(t,e,n){if(n===!1)return!1;const i=iN(t,n),r=iN(e,n);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}function UZ(t){let e,n,i,r;return st(t)?(e=t.top,n=t.right,i=t.bottom,r=t.left):e=n=i=r=t,{top:e,right:n,bottom:i,left:r,disabled:t===!1}}function WY(t,e){const n=[],i=t._getSortedDatasetMetas(e);let r,s;for(r=0,s=i.length;r<s;++r)n.push(i[r].index);return n}function rN(t,e,n,i={}){const r=t.keys,s=i.mode==="single";let o,a,l,c;if(e===null)return;let u=!1;for(o=0,a=r.length;o<a;++o){if(l=+r[o],l===n){if(u=!0,i.all)continue;break}c=t.values[l],Cn(c)&&(s||e===0||na(e)===na(c))&&(e+=c)}return!u&&!i.all?0:e}function YZ(t,e){const{iScale:n,vScale:i}=e,r=n.axis==="x"?"x":"y",s=i.axis==="x"?"x":"y",o=Object.keys(t),a=new Array(o.length);let l,c,u;for(l=0,c=o.length;l<c;++l)u=o[l],a[l]={[r]:u,[s]:t[u]};return a}function W0(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function GZ(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function qZ(t){const{min:e,max:n,minDefined:i,maxDefined:r}=t.getUserBounds();return{min:i?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function KZ(t,e,n){const i=t[e]||(t[e]={});return i[n]||(i[n]={})}function sN(t,e,n,i){for(const r of e.getMatchingVisibleMetas(i).reverse()){const s=t[r.index];if(n&&s>0||!n&&s<0)return r.index}return null}function oN(t,e){const{chart:n,_cachedMeta:i}=t,r=n._stacks||(n._stacks={}),{iScale:s,vScale:o,index:a}=i,l=s.axis,c=o.axis,u=GZ(s,o,i),h=e.length;let d;for(let f=0;f<h;++f){const g=e[f],{[l]:m,[c]:p}=g,v=g._stacks||(g._stacks={});d=v[c]=KZ(r,u,m),d[a]=p,d._top=sN(d,o,!0,i.type),d._bottom=sN(d,o,!1,i.type);const b=d._visualValues||(d._visualValues={});b[a]=p}}function j0(t,e){const n=t.scales;return Object.keys(n).filter(i=>n[i].axis===e).shift()}function XZ(t,e){return Hc(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function JZ(t,e,n){return Hc(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function pg(t,e){const n=t.controller.index,i=t.vScale&&t.vScale.axis;if(i){e=e||t._parsed;for(const r of e){const s=r._stacks;if(!s||s[i]===void 0||s[i][n]===void 0)return;delete s[i][n],s[i]._visualValues!==void 0&&s[i]._visualValues[n]!==void 0&&delete s[i]._visualValues[n]}}}const z0=t=>t==="reset"||t==="none",aN=(t,e)=>e?t:Object.assign({},t),ZZ=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:WY(n,!0),values:null};class kc{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=W0(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&pg(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,i=this.getDataset(),r=(h,d,f,g)=>h==="x"?d:h==="r"?g:f,s=n.xAxisID=Ne(i.xAxisID,j0(e,"x")),o=n.yAxisID=Ne(i.yAxisID,j0(e,"y")),a=n.rAxisID=Ne(i.rAxisID,j0(e,"r")),l=n.indexAxis,c=n.iAxisID=r(l,s,o,a),u=n.vAxisID=r(l,o,s,a);n.xScale=this.getScaleForId(s),n.yScale=this.getScaleForId(o),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(c),n.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&jD(this._data,this),e._stacked&&pg(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),i=this._data;if(st(n)){const r=this._cachedMeta;this._data=YZ(n,r)}else if(i!==n){if(i){jD(i,this);const r=this._cachedMeta;pg(r),r._parsed=[]}n&&Object.isExtensible(n)&&NJ(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,i=this.getDataset();let r=!1;this._dataCheck();const s=n._stacked;n._stacked=W0(n.vScale,n),n.stack!==i.stack&&(r=!0,pg(n),n.stack=i.stack),this._resyncElements(e),(r||s!==n._stacked)&&(oN(this,n._parsed),n._stacked=W0(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),i=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:i,_data:r}=this,{iScale:s,_stacked:o}=i,a=s.axis;let l=e===0&&n===r.length?!0:i._sorted,c=e>0&&i._parsed[e-1],u,h,d;if(this._parsing===!1)i._parsed=r,i._sorted=!0,d=r;else{Zt(r[e])?d=this.parseArrayData(i,r,e,n):st(r[e])?d=this.parseObjectData(i,r,e,n):d=this.parsePrimitiveData(i,r,e,n);const f=()=>h[a]===null||c&&h[a]<c[a];for(u=0;u<n;++u)i._parsed[u+e]=h=d[u],l&&(f()&&(l=!1),c=h);i._sorted=l}o&&oN(this,d)}parsePrimitiveData(e,n,i,r){const{iScale:s,vScale:o}=e,a=s.axis,l=o.axis,c=s.getLabels(),u=s===o,h=new Array(r);let d,f,g;for(d=0,f=r;d<f;++d)g=d+i,h[d]={[a]:u||s.parse(c[g],g),[l]:o.parse(n[g],g)};return h}parseArrayData(e,n,i,r){const{xScale:s,yScale:o}=e,a=new Array(r);let l,c,u,h;for(l=0,c=r;l<c;++l)u=l+i,h=n[u],a[l]={x:s.parse(h[0],u),y:o.parse(h[1],u)};return a}parseObjectData(e,n,i,r){const{xScale:s,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(r);let u,h,d,f;for(u=0,h=r;u<h;++u)d=u+i,f=n[d],c[u]={x:s.parse(Rc(f,a),d),y:o.parse(Rc(f,l),d)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,i){const r=this.chart,s=this._cachedMeta,o=n[e.axis],a={keys:WY(r,!0),values:n._stacks[e.axis]._visualValues};return rN(a,o,s.index,{mode:i})}updateRangeFromParsed(e,n,i,r){const s=i[n.axis];let o=s===null?NaN:s;const a=r&&i._stacks[n.axis];r&&a&&(r.values=a,o=rN(r,s,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,n){const i=this._cachedMeta,r=i._parsed,s=i._sorted&&e===i.iScale,o=r.length,a=this._getOtherScale(e),l=ZZ(n,i,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:h}=qZ(a);let d,f;function g(){f=r[d];const m=f[a.axis];return!Cn(f[e.axis])||u>m||h<m}for(d=0;d<o&&!(!g()&&(this.updateRangeFromParsed(c,e,f,l),s));++d);if(s){for(d=o-1;d>=0;--d)if(!g()){this.updateRangeFromParsed(c,e,f,l);break}}return c}getAllParsedValues(e){const n=this._cachedMeta._parsed,i=[];let r,s,o;for(r=0,s=n.length;r<s;++r)o=n[r][e.axis],Cn(o)&&i.push(o);return i}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,i=n.iScale,r=n.vScale,s=this.getParsed(e);return{label:i?""+i.getLabelForValue(s[i.axis]):"",value:r?""+r.getLabelForValue(s[r.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=UZ(Ne(this.options.clip,zZ(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,i=this._cachedMeta,r=i.data||[],s=n.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||r.length-a,c=this.options.drawActiveElementsOnTop;let u;for(i.dataset&&i.dataset.draw(e,s,a,l),u=a;u<a+l;++u){const h=r[u];h.hidden||(h.active&&c?o.push(h):h.draw(e,s))}for(u=0;u<o.length;++u)o[u].draw(e,s)}getStyle(e,n){const i=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(e||0,i)}getContext(e,n,i){const r=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];s=o.$context||(o.$context=JZ(this.getContext(),e,o)),s.parsed=this.getParsed(e),s.raw=r.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=XZ(this.chart.getContext(),this.index)),s.dataset=r,s.index=s.datasetIndex=this.index;return s.active=!!n,s.mode=i,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",i){const r=n==="active",s=this._cachedDataOpts,o=e+"-"+n,a=s[o],l=this.enableOptionSharing&&Sp(i);if(a)return aN(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,e),h=r?[`${e}Hover`,"hover",e,""]:[e,""],d=c.getOptionScopes(this.getDataset(),u),f=Object.keys(Qt.elements[e]),g=()=>this.getContext(i,r,n),m=c.resolveNamedOptions(d,f,g,h);return m.$shared&&(m.$shared=l,s[o]=Object.freeze(aN(m,l))),m}_resolveAnimations(e,n,i){const r=this.chart,s=this._cachedDataOpts,o=`animation-${n}`,a=s[o];if(a)return a;let l;if(r.options.animation!==!1){const u=this.chart.config,h=u.datasetAnimationScopeKeys(this._type,n),d=u.getOptionScopes(this.getDataset(),h);l=u.createResolver(d,this.getContext(e,i,n))}const c=new BY(r,l&&l.animations);return l&&l._cacheable&&(s[o]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||z0(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const i=this.resolveDataElementOptions(e,n),r=this._sharedOptions,s=this.getSharedOptions(i),o=this.includeOptions(n,s)||s!==r;return this.updateSharedOptions(s,n,i),{sharedOptions:s,includeOptions:o}}updateElement(e,n,i,r){z0(r)?Object.assign(e,i):this._resolveAnimations(n,r).update(e,i)}updateSharedOptions(e,n,i){e&&!z0(n)&&this._resolveAnimations(void 0,n).update(e,i)}_setStyle(e,n,i,r){e.active=r;const s=this.getStyle(n,r);this._resolveAnimations(n,i,r).update(e,{options:!r&&this.getSharedOptions(s)||s})}removeHoverStyle(e,n,i){this._setStyle(e,i,"active",!1)}setHoverStyle(e,n,i){this._setStyle(e,i,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,i=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const r=i.length,s=n.length,o=Math.min(s,r);o&&this.parse(0,o),s>r?this._insertElements(r,s-r,e):s<r&&this._removeElements(s,r-s)}_insertElements(e,n,i=!0){const r=this._cachedMeta,s=r.data,o=e+n;let a;const l=c=>{for(c.length+=n,a=c.length-1;a>=o;a--)c[a]=c[a-n]};for(l(s),a=e;a<o;++a)s[a]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(e,n),i&&this.updateElements(s,e,n,"reset")}updateElements(e,n,i,r){}_removeElements(e,n){const i=this._cachedMeta;if(this._parsing){const r=i._parsed.splice(e,n);i._stacked&&pg(i,r)}i.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,i,r]=e;this[n](i,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const i=arguments.length-2;i&&this._sync(["_insertElements",e,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function QZ(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let i=[];for(let r=0,s=n.length;r<s;r++)i=i.concat(n[r].controller.getAllParsedValues(t));t._cache.$bar=CY(i.sort((r,s)=>r-s))}return t._cache.$bar}function eQ(t){const e=t.iScale,n=QZ(e,t.type);let i=e._length,r,s,o,a;const l=()=>{o===32767||o===-32768||(Sp(a)&&(i=Math.min(i,Math.abs(o-a)||i)),a=o)};for(r=0,s=n.length;r<s;++r)o=e.getPixelForValue(n[r]),l();for(a=void 0,r=0,s=e.ticks.length;r<s;++r)o=e.getPixelForTick(r),l();return i}function tQ(t,e,n,i){const r=n.barThickness;let s,o;return it(r)?(s=e.min*n.categoryPercentage,o=n.barPercentage):(s=r*i,o=1),{chunk:s/i,ratio:o,start:e.pixels[t]-s/2}}function nQ(t,e,n,i){const r=e.pixels,s=r[t];let o=t>0?r[t-1]:null,a=t<r.length-1?r[t+1]:null;const l=n.categoryPercentage;o===null&&(o=s-(a===null?e.end-e.start:a-s)),a===null&&(a=s+s-o);const c=s-(s-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/i,ratio:n.barPercentage,start:c}}function iQ(t,e,n,i){const r=n.parse(t[0],i),s=n.parse(t[1],i),o=Math.min(r,s),a=Math.max(r,s);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),e[n.axis]=c,e._custom={barStart:l,barEnd:c,start:r,end:s,min:o,max:a}}function jY(t,e,n,i){return Zt(t)?iQ(t,e,n,i):e[n.axis]=n.parse(t,i),e}function lN(t,e,n,i){const r=t.iScale,s=t.vScale,o=r.getLabels(),a=r===s,l=[];let c,u,h,d;for(c=n,u=n+i;c<u;++c)d=e[c],h={},h[r.axis]=a||r.parse(o[c],c),l.push(jY(d,h,s,c));return l}function U0(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function rQ(t,e,n){return t!==0?na(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function sQ(t){let e,n,i,r,s;return t.horizontal?(e=t.base>t.x,n="left",i="right"):(e=t.base<t.y,n="bottom",i="top"),e?(r="end",s="start"):(r="start",s="end"),{start:n,end:i,reverse:e,top:r,bottom:s}}function oQ(t,e,n,i){let r=e.borderSkipped;const s={};if(!r){t.borderSkipped=s;return}if(r===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:c,bottom:u}=sQ(t);r==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===i?r=c:(n._bottom||0)===i?r=u:(s[cN(u,o,a,l)]=!0,r=c)),s[cN(r,o,a,l)]=!0,t.borderSkipped=s}function cN(t,e,n,i){return i?(t=aQ(t,e,n),t=uN(t,n,e)):t=uN(t,e,n),t}function aQ(t,e,n){return t===e?n:t===n?e:t}function uN(t,e,n){return t==="start"?e:t==="end"?n:t}function lQ(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class cQ extends kc{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,n,i,r){return lN(e,n,i,r)}parseArrayData(e,n,i,r){return lN(e,n,i,r)}parseObjectData(e,n,i,r){const{iScale:s,vScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=s.axis==="x"?a:l,u=o.axis==="x"?a:l,h=[];let d,f,g,m;for(d=i,f=i+r;d<f;++d)m=n[d],g={},g[s.axis]=s.parse(Rc(m,c),d),h.push(jY(Rc(m,u),g,o,d));return h}updateRangeFromParsed(e,n,i,r){super.updateRangeFromParsed(e,n,i,r);const s=i._custom;s&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:i,vScale:r}=n,s=this.getParsed(e),o=s._custom,a=U0(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(s[r.axis]);return{label:""+i.getLabelForValue(s[i.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,i,r){const s=r==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),u=this._getRuler(),{sharedOptions:h,includeOptions:d}=this._getSharedOptions(n,r);for(let f=n;f<n+i;f++){const g=this.getParsed(f),m=s||it(g[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(f),p=this._calculateBarIndexPixels(f,u),v=(g._stacks||{})[a.axis],b={horizontal:c,base:m.base,enableBorderRadius:!v||U0(g._custom)||o===v._top||o===v._bottom,x:c?m.head:p.center,y:c?p.center:m.head,height:c?p.size:Math.abs(m.size),width:c?Math.abs(m.size):p.size};d&&(b.options=h||this.resolveDataElementOptions(f,e[f].active?"active":r));const R=b.options||e[f].options;oQ(b,R,v,o),lQ(b,R,u.ratio),this.updateElement(e[f],f,b,r)}}_getStacks(e,n){const{iScale:i}=this._cachedMeta,r=i.getMatchingVisibleMetas(this._type).filter(u=>u.controller.options.grouped),s=i.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(n),l=a&&a[i.axis],c=u=>{const h=u._parsed.find(f=>f[i.axis]===l),d=h&&h[u.vScale.axis];if(it(d)||isNaN(d))return!0};for(const u of r)if(!(n!==void 0&&c(u))&&((s===!1||o.indexOf(u.stack)===-1||s===void 0&&u.stack===void 0)&&o.push(u.stack),u.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(i=>e[i].axis===n).shift()}_getAxis(){const e={},n=this.getFirstScaleIdForIndexAxis();for(const i of this.chart.data.datasets)e[Ne(this.chart.options.indexAxis==="x"?i.xAxisID:i.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,i){const r=this._getStacks(e,i),s=n!==void 0?r.indexOf(n):-1;return s===-1?r.length-1:s}_getRuler(){const e=this.options,n=this._cachedMeta,i=n.iScale,r=[];let s,o;for(s=0,o=n.data.length;s<o;++s)r.push(i.getPixelForValue(this.getParsed(s)[i.axis],s));const a=e.barThickness;return{min:a||eQ(n),pixels:r,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:i,index:r},options:{base:s,minBarLength:o}}=this,a=s||0,l=this.getParsed(e),c=l._custom,u=U0(c);let h=l[n.axis],d=0,f=i?this.applyStack(n,l,i):h,g,m;f!==h&&(d=f-h,f=h),u&&(h=c.barStart,f=c.barEnd-c.barStart,h!==0&&na(h)!==na(c.barEnd)&&(d=0),d+=h);const p=!it(s)&&!u?s:d;let v=n.getPixelForValue(p);if(this.chart.getDataVisibility(e)?g=n.getPixelForValue(d+f):g=v,m=g-v,Math.abs(m)<o){m=rQ(m,n,a)*o,h===a&&(v-=m/2);const b=n.getPixelForDecimal(0),R=n.getPixelForDecimal(1),S=Math.min(b,R),x=Math.max(b,R);v=Math.max(Math.min(v,x),S),g=v+m,i&&!u&&(l._stacks[n.axis]._visualValues[r]=n.getValueForPixel(g)-n.getValueForPixel(v))}if(v===n.getPixelForValue(a)){const b=na(m)*n.getLineWidthForValue(a)/2;v+=b,m-=b}return{size:m,base:v,head:g,center:g+m/2}}_calculateBarIndexPixels(e,n){const i=n.scale,r=this.options,s=r.skipNull,o=Ne(r.maxBarThickness,1/0);let a,l;const c=this._getAxisCount();if(n.grouped){const u=s?this._getStackCount(e):n.stackCount,h=r.barThickness==="flex"?nQ(e,n,r,u*c):tQ(e,n,r,u*c),d=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,f=this._getAxis().indexOf(Ne(d,this.getFirstScaleIdForIndexAxis())),g=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0)+f;a=h.start+h.chunk*g+h.chunk/2,l=Math.min(o,h.chunk*h.ratio)}else a=i.getPixelForValue(this.getParsed(e)[i.axis],e),l=Math.min(o,n.min*n.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,n=e.vScale,i=e.data,r=i.length;let s=0;for(;s<r;++s)this.getParsed(s)[n.axis]!==null&&!i[s].hidden&&i[s].draw(this._ctx)}}class uQ extends kc{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,n,i,r){const s=super.parsePrimitiveData(e,n,i,r);for(let o=0;o<s.length;o++)s[o]._custom=this.resolveDataElementOptions(o+i).radius;return s}parseArrayData(e,n,i,r){const s=super.parseArrayData(e,n,i,r);for(let o=0;o<s.length;o++){const a=n[i+o];s[o]._custom=Ne(a[2],this.resolveDataElementOptions(o+i).radius)}return s}parseObjectData(e,n,i,r){const s=super.parseObjectData(e,n,i,r);for(let o=0;o<s.length;o++){const a=n[i+o];s[o]._custom=Ne(a&&a.r&&+a.r,this.resolveDataElementOptions(o+i).radius)}return s}getMaxOverflow(){const e=this._cachedMeta.data;let n=0;for(let i=e.length-1;i>=0;--i)n=Math.max(n,e[i].size(this.resolveDataElementOptions(i))/2);return n>0&&n}getLabelAndValue(e){const n=this._cachedMeta,i=this.chart.data.labels||[],{xScale:r,yScale:s}=n,o=this.getParsed(e),a=r.getLabelForValue(o.x),l=s.getLabelForValue(o.y),c=o._custom;return{label:i[e]||"",value:"("+a+", "+l+(c?", "+c:"")+")"}}update(e){const n=this._cachedMeta.data;this.updateElements(n,0,n.length,e)}updateElements(e,n,i,r){const s=r==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(n,r),u=o.axis,h=a.axis;for(let d=n;d<n+i;d++){const f=e[d],g=!s&&this.getParsed(d),m={},p=m[u]=s?o.getPixelForDecimal(.5):o.getPixelForValue(g[u]),v=m[h]=s?a.getBasePixel():a.getPixelForValue(g[h]);m.skip=isNaN(p)||isNaN(v),c&&(m.options=l||this.resolveDataElementOptions(d,f.active?"active":r),s&&(m.options.radius=0)),this.updateElement(f,d,m,r)}}resolveDataElementOptions(e,n){const i=this.getParsed(e);let r=super.resolveDataElementOptions(e,n);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const s=r.radius;return n!=="active"&&(r.radius=0),r.radius+=Ne(i&&i._custom,s),r}}function hQ(t,e,n){let i=1,r=1,s=0,o=0;if(e<Wt){const a=t,l=a+e,c=Math.cos(a),u=Math.sin(a),h=Math.cos(l),d=Math.sin(l),f=(R,S,x)=>Rp(R,a,l,!0)?1:Math.max(S,S*n,x,x*n),g=(R,S,x)=>Rp(R,a,l,!0)?-1:Math.min(S,S*n,x,x*n),m=f(0,c,h),p=f(Pn,u,d),v=g(ft,c,h),b=g(ft+Pn,u,d);i=(m-v)/2,r=(p-b)/2,s=-(m+v)/2,o=-(p+b)/2}return{ratioX:i,ratioY:r,offsetX:s,offsetY:o}}class eI extends kc{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data,{labels:{pointStyle:i,textAlign:r,color:s,useBorderRadius:o,borderRadius:a}}=e.legend.options;return n.labels.length&&n.datasets.length?n.labels.map((l,c)=>{const h=e.getDatasetMeta(0).controller.getStyle(c);return{text:l,fillStyle:h.backgroundColor,fontColor:s,hidden:!e.getDataVisibility(c),lineDash:h.borderDash,lineDashOffset:h.borderDashOffset,lineJoin:h.borderJoinStyle,lineWidth:h.borderWidth,strokeStyle:h.borderColor,textAlign:r,pointStyle:i,borderRadius:o&&(a||h.borderRadius),index:c}}):[]}},onClick(e,n,i){i.chart.toggleDataVisibility(n.index),i.chart.update()}}}};constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const i=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=i;else{let s=l=>+i[l];if(st(i[e])){const{key:l="value"}=this._parsing;s=c=>+Rc(i[c],l)}let o,a;for(o=e,a=e+n;o<a;++o)r._parsed[o]=s(o)}}_getRotation(){return no(this.options.rotation-90)}_getCircumference(){return no(this.options.circumference)}_getRotationExtents(){let e=Wt,n=-Wt;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){const r=this.chart.getDatasetMeta(i).controller,s=r._getRotation(),o=r._getCircumference();e=Math.min(e,s),n=Math.max(n,s+o)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:i}=n,r=this._cachedMeta,s=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,a=Math.max((Math.min(i.width,i.height)-o)/2,0),l=Math.min(CJ(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:d,ratioY:f,offsetX:g,offsetY:m}=hQ(h,u,l),p=(i.width-o)/d,v=(i.height-o)/f,b=Math.max(Math.min(p,v)/2,0),R=pY(this.options.radius,b),S=Math.max(R*l,0),x=(R-S)/this._getVisibleDatasetWeightTotal();this.offsetX=g*R,this.offsetY=m*R,r.total=this.calculateTotal(),this.outerRadius=R-x*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-x*c,0),this.updateElements(s,0,s.length,e)}_circumference(e,n){const i=this.options,r=this._cachedMeta,s=this._getCircumference();return n&&i.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*s/Wt)}updateElements(e,n,i,r){const s=r==="reset",o=this.chart,a=o.chartArea,c=o.options.animation,u=(a.left+a.right)/2,h=(a.top+a.bottom)/2,d=s&&c.animateScale,f=d?0:this.innerRadius,g=d?0:this.outerRadius,{sharedOptions:m,includeOptions:p}=this._getSharedOptions(n,r);let v=this._getRotation(),b;for(b=0;b<n;++b)v+=this._circumference(b,s);for(b=n;b<n+i;++b){const R=this._circumference(b,s),S=e[b],x={x:u+this.offsetX,y:h+this.offsetY,startAngle:v,endAngle:v+R,circumference:R,outerRadius:g,innerRadius:f};p&&(x.options=m||this.resolveDataElementOptions(b,S.active?"active":r)),v+=R,this.updateElement(S,b,x,r)}}calculateTotal(){const e=this._cachedMeta,n=e.data;let i=0,r;for(r=0;r<n.length;r++){const s=e._parsed[r];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(i+=Math.abs(s))}return i}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?Wt*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,i=this.chart,r=i.data.labels||[],s=tw(n._parsed[e],i.options.locale);return{label:r[e]||"",value:s}}getMaxBorderWidth(e){let n=0;const i=this.chart;let r,s,o,a,l;if(!e){for(r=0,s=i.data.datasets.length;r<s;++r)if(i.isDatasetVisible(r)){o=i.getDatasetMeta(r),e=o.data,a=o.controller;break}}if(!e)return 0;for(r=0,s=e.length;r<s;++r)l=a.resolveDataElementOptions(r),l.borderAlign!=="inner"&&(n=Math.max(n,l.borderWidth||0,l.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let i=0,r=e.length;i<r;++i){const s=this.resolveDataElementOptions(i);n=Math.max(n,s.offset||0,s.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let i=0;i<e;++i)this.chart.isDatasetVisible(i)&&(n+=this._getRingWeight(i));return n}_getRingWeight(e){return Math.max(Ne(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class dQ extends kc{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const n=this._cachedMeta,{dataset:i,data:r=[],_dataset:s}=n,o=this.chart._animationsDisabled;let{start:a,count:l}=_Y(n,r,o);this._drawStart=a,this._drawCount=l,EY(n)&&(a=0,l=r.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!s._decimated,i.points=r;const c=this.resolveDatasetElementOptions(e);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(i,void 0,{animated:!o,options:c},e),this.updateElements(r,a,l,e)}updateElements(e,n,i,r){const s=r==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:h}=this._getSharedOptions(n,r),d=o.axis,f=a.axis,{spanGaps:g,segment:m}=this.options,p=Rf(g)?g:Number.POSITIVE_INFINITY,v=this.chart._animationsDisabled||s||r==="none",b=n+i,R=e.length;let S=n>0&&this.getParsed(n-1);for(let x=0;x<R;++x){const M=e[x],T=v?M:{};if(x<n||x>=b){T.skip=!0;continue}const O=this.getParsed(x),W=it(O[f]),N=T[d]=o.getPixelForValue(O[d],x),G=T[f]=s||W?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,O,l):O[f],x);T.skip=isNaN(N)||isNaN(G)||W,T.stop=x>0&&Math.abs(O[d]-S[d])>p,m&&(T.parsed=O,T.raw=c.data[x]),h&&(T.options=u||this.resolveDataElementOptions(x,M.active?"active":r)),v||this.updateElement(M,x,T,r),S=O}}getMaxOverflow(){const e=this._cachedMeta,n=e.dataset,i=n.options&&n.options.borderWidth||0,r=e.data||[];if(!r.length)return i;const s=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(i,s,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}class zY extends kc{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:i,color:r}}=e.legend.options;return n.labels.map((s,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:s,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:r,lineWidth:l.borderWidth,pointStyle:i,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,n,i){i.chart.toggleDataVisibility(n.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(e,n){super(e,n),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){const n=this._cachedMeta,i=this.chart,r=i.data.labels||[],s=tw(n._parsed[e].r,i.options.locale);return{label:r[e]||"",value:s}}parseObjectData(e,n,i,r){return HY.bind(this)(e,n,i,r)}update(e){const n=this._cachedMeta.data;this._updateRadius(),this.updateElements(n,0,n.length,e)}getMinMax(){const e=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((i,r)=>{const s=this.getParsed(r).r;!isNaN(s)&&this.chart.getDataVisibility(r)&&(s<n.min&&(n.min=s),s>n.max&&(n.max=s))}),n}_updateRadius(){const e=this.chart,n=e.chartArea,i=e.options,r=Math.min(n.right-n.left,n.bottom-n.top),s=Math.max(r/2,0),o=Math.max(i.cutoutPercentage?s/100*i.cutoutPercentage:1,0),a=(s-o)/e.getVisibleDatasetCount();this.outerRadius=s-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(e,n,i,r){const s=r==="reset",o=this.chart,l=o.options.animation,c=this._cachedMeta.rScale,u=c.xCenter,h=c.yCenter,d=c.getIndexAngle(0)-.5*ft;let f=d,g;const m=360/this.countVisibleElements();for(g=0;g<n;++g)f+=this._computeAngle(g,r,m);for(g=n;g<n+i;g++){const p=e[g];let v=f,b=f+this._computeAngle(g,r,m),R=o.getDataVisibility(g)?c.getDistanceFromCenterForValue(this.getParsed(g).r):0;f=b,s&&(l.animateScale&&(R=0),l.animateRotate&&(v=b=d));const S={x:u,y:h,innerRadius:0,outerRadius:R,startAngle:v,endAngle:b,options:this.resolveDataElementOptions(g,p.active?"active":r)};this.updateElement(p,g,S,r)}}countVisibleElements(){const e=this._cachedMeta;let n=0;return e.data.forEach((i,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&n++}),n}_computeAngle(e,n,i){return this.chart.getDataVisibility(e)?no(this.resolveDataElementOptions(e,n).angle||i):0}}class fQ extends eI{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class gQ extends kc{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(e){const n=this._cachedMeta.vScale,i=this.getParsed(e);return{label:n.getLabels()[e],value:""+n.getLabelForValue(i[n.axis])}}parseObjectData(e,n,i,r){return HY.bind(this)(e,n,i,r)}update(e){const n=this._cachedMeta,i=n.dataset,r=n.data||[],s=n.iScale.getLabels();if(i.points=r,e!=="resize"){const o=this.resolveDatasetElementOptions(e);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:s.length===r.length,options:o};this.updateElement(i,void 0,a,e)}this.updateElements(r,0,r.length,e)}updateElements(e,n,i,r){const s=this._cachedMeta.rScale,o=r==="reset";for(let a=n;a<n+i;a++){const l=e[a],c=this.resolveDataElementOptions(a,l.active?"active":r),u=s.getPointPositionForValue(a,this.getParsed(a).r),h=o?s.xCenter:u.x,d=o?s.yCenter:u.y,f={x:h,y:d,angle:u.angle,skip:isNaN(h)||isNaN(d),options:c};this.updateElement(l,a,f,r)}}}class mQ extends kc{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(e){const n=this._cachedMeta,i=this.chart.data.labels||[],{xScale:r,yScale:s}=n,o=this.getParsed(e),a=r.getLabelForValue(o.x),l=s.getLabelForValue(o.y);return{label:i[e]||"",value:"("+a+", "+l+")"}}update(e){const n=this._cachedMeta,{data:i=[]}=n,r=this.chart._animationsDisabled;let{start:s,count:o}=_Y(n,i,r);if(this._drawStart=s,this._drawCount=o,EY(n)&&(s=0,o=i.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:l}=n;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!l._decimated,a.points=i;const c=this.resolveDatasetElementOptions(e);c.segment=this.options.segment,this.updateElement(a,void 0,{animated:!r,options:c},e)}else this.datasetElementType&&(delete n.dataset,this.datasetElementType=!1);this.updateElements(i,s,o,e)}addElements(){const{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,n,i,r){const s=r==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,u=this.resolveDataElementOptions(n,r),h=this.getSharedOptions(u),d=this.includeOptions(r,h),f=o.axis,g=a.axis,{spanGaps:m,segment:p}=this.options,v=Rf(m)?m:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||s||r==="none";let R=n>0&&this.getParsed(n-1);for(let S=n;S<n+i;++S){const x=e[S],M=this.getParsed(S),T=b?x:{},O=it(M[g]),W=T[f]=o.getPixelForValue(M[f],S),N=T[g]=s||O?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,M,l):M[g],S);T.skip=isNaN(W)||isNaN(N)||O,T.stop=S>0&&Math.abs(M[f]-R[f])>v,p&&(T.parsed=M,T.raw=c.data[S]),d&&(T.options=h||this.resolveDataElementOptions(S,x.active?"active":r)),b||this.updateElement(x,S,T,r),R=M}this.updateSharedOptions(h,r,u)}getMaxOverflow(){const e=this._cachedMeta,n=e.data||[];if(!this.options.showLine){let a=0;for(let l=n.length-1;l>=0;--l)a=Math.max(a,n[l].size(this.resolveDataElementOptions(l))/2);return a>0&&a}const i=e.dataset,r=i.options&&i.options.borderWidth||0;if(!n.length)return r;const s=n[0].size(this.resolveDataElementOptions(0)),o=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(r,s,o)/2}}var pQ=Object.freeze({__proto__:null,BarController:cQ,BubbleController:uQ,DoughnutController:eI,LineController:dQ,PieController:fQ,PolarAreaController:zY,RadarController:gQ,ScatterController:mQ});function zc(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class tI{static override(e){Object.assign(tI.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return zc()}parse(){return zc()}format(){return zc()}add(){return zc()}diff(){return zc()}startOf(){return zc()}endOf(){return zc()}}var wQ={_date:tI};function vQ(t,e,n,i){const{controller:r,data:s,_sorted:o}=t,a=r._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&s.length){const c=a._reversePixels?kJ:Ga;if(i){if(r._sharedOptions){const u=s[0],h=typeof u.getRange=="function"&&u.getRange(e);if(h){const d=c(s,e,n-h),f=c(s,e,n+h);return{lo:d.lo,hi:f.hi}}}}else{const u=c(s,e,n);if(l){const{vScale:h}=r._cachedMeta,{_parsed:d}=t,f=d.slice(0,u.lo+1).reverse().findIndex(m=>!it(m[h.axis]));u.lo-=Math.max(0,f);const g=d.slice(u.hi).findIndex(m=>!it(m[h.axis]));u.hi+=Math.max(0,g)}return u}}return{lo:0,hi:s.length-1}}function pS(t,e,n,i,r){const s=t.getSortedVisibleDatasetMetas(),o=n[e];for(let a=0,l=s.length;a<l;++a){const{index:c,data:u}=s[a],{lo:h,hi:d}=vQ(s[a],e,o,r);for(let f=h;f<=d;++f){const g=u[f];g.skip||i(g,c,f)}}}function bQ(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(i,r){const s=e?Math.abs(i.x-r.x):0,o=n?Math.abs(i.y-r.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function Y0(t,e,n,i,r){const s=[];return!r&&!t.isPointInArea(e)||pS(t,n,e,function(a,l,c){!r&&!qa(a,t.chartArea,0)||a.inRange(e.x,e.y,i)&&s.push({element:a,datasetIndex:l,index:c})},!0),s}function yQ(t,e,n,i){let r=[];function s(o,a,l){const{startAngle:c,endAngle:u}=o.getProps(["startAngle","endAngle"],i),{angle:h}=bY(o,{x:e.x,y:e.y});Rp(h,c,u)&&r.push({element:o,datasetIndex:a,index:l})}return pS(t,n,e,s),r}function CQ(t,e,n,i,r,s){let o=[];const a=bQ(n);let l=Number.POSITIVE_INFINITY;function c(u,h,d){const f=u.inRange(e.x,e.y,r);if(i&&!f)return;const g=u.getCenterPoint(r);if(!(!!s||t.isPointInArea(g))&&!f)return;const p=a(e,g);p<l?(o=[{element:u,datasetIndex:h,index:d}],l=p):p===l&&o.push({element:u,datasetIndex:h,index:d})}return pS(t,n,e,c),o}function G0(t,e,n,i,r,s){return!s&&!t.isPointInArea(e)?[]:n==="r"&&!i?yQ(t,e,n,r):CQ(t,e,n,i,r,s)}function hN(t,e,n,i,r){const s=[],o=n==="x"?"inXRange":"inYRange";let a=!1;return pS(t,n,e,(l,c,u)=>{l[o]&&l[o](e[n],r)&&(s.push({element:l,datasetIndex:c,index:u}),a=a||l.inRange(e.x,e.y,r))}),i&&!a?[]:s}var SQ={modes:{index(t,e,n,i){const r=Hu(e,t),s=n.axis||"x",o=n.includeInvisible||!1,a=n.intersect?Y0(t,r,s,i,o):G0(t,r,s,!1,i,o),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(c=>{const u=a[0].index,h=c.data[u];h&&!h.skip&&l.push({element:h,datasetIndex:c.index,index:u})}),l):[]},dataset(t,e,n,i){const r=Hu(e,t),s=n.axis||"xy",o=n.includeInvisible||!1;let a=n.intersect?Y0(t,r,s,i,o):G0(t,r,s,!1,i,o);if(a.length>0){const l=a[0].datasetIndex,c=t.getDatasetMeta(l).data;a=[];for(let u=0;u<c.length;++u)a.push({element:c[u],datasetIndex:l,index:u})}return a},point(t,e,n,i){const r=Hu(e,t),s=n.axis||"xy",o=n.includeInvisible||!1;return Y0(t,r,s,i,o)},nearest(t,e,n,i){const r=Hu(e,t),s=n.axis||"xy",o=n.includeInvisible||!1;return G0(t,r,s,n.intersect,i,o)},x(t,e,n,i){const r=Hu(e,t);return hN(t,r,"x",n.intersect,i)},y(t,e,n,i){const r=Hu(e,t);return hN(t,r,"y",n.intersect,i)}}};const UY=["left","top","right","bottom"];function wg(t,e){return t.filter(n=>n.pos===e)}function dN(t,e){return t.filter(n=>UY.indexOf(n.pos)===-1&&n.box.axis===e)}function vg(t,e){return t.sort((n,i)=>{const r=e?i:n,s=e?n:i;return r.weight===s.weight?r.index-s.index:r.weight-s.weight})}function RQ(t){const e=[];let n,i,r,s,o,a;for(n=0,i=(t||[]).length;n<i;++n)r=t[n],{position:s,options:{stack:o,stackWeight:a=1}}=r,e.push({index:n,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&s+o,stackWeight:a});return e}function _Q(t){const e={};for(const n of t){const{stack:i,pos:r,stackWeight:s}=n;if(!i||!UY.includes(r))continue;const o=e[i]||(e[i]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return e}function EQ(t,e){const n=_Q(t),{vBoxMaxWidth:i,hBoxMaxHeight:r}=e;let s,o,a;for(s=0,o=t.length;s<o;++s){a=t[s];const{fullSize:l}=a.box,c=n[a.stack],u=c&&a.stackWeight/c.weight;a.horizontal?(a.width=u?u*i:l&&e.availableWidth,a.height=r):(a.width=i,a.height=u?u*r:l&&e.availableHeight)}return n}function xQ(t){const e=RQ(t),n=vg(e.filter(c=>c.box.fullSize),!0),i=vg(wg(e,"left"),!0),r=vg(wg(e,"right")),s=vg(wg(e,"top"),!0),o=vg(wg(e,"bottom")),a=dN(e,"x"),l=dN(e,"y");return{fullSize:n,leftAndTop:i.concat(s),rightAndBottom:r.concat(l).concat(o).concat(a),chartArea:wg(e,"chartArea"),vertical:i.concat(r).concat(l),horizontal:s.concat(o).concat(a)}}function fN(t,e,n,i){return Math.max(t[n],e[n])+Math.max(t[i],e[i])}function YY(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function TQ(t,e,n,i){const{pos:r,box:s}=n,o=t.maxPadding;if(!st(r)){n.size&&(t[r]-=n.size);const h=i[n.stack]||{size:0,count:1};h.size=Math.max(h.size,n.horizontal?s.height:s.width),n.size=h.size/h.count,t[r]+=n.size}s.getPadding&&YY(o,s.getPadding());const a=Math.max(0,e.outerWidth-fN(o,t,"left","right")),l=Math.max(0,e.outerHeight-fN(o,t,"top","bottom")),c=a!==t.w,u=l!==t.h;return t.w=a,t.h=l,n.horizontal?{same:c,other:u}:{same:u,other:c}}function MQ(t){const e=t.maxPadding;function n(i){const r=Math.max(e[i]-t[i],0);return t[i]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function PQ(t,e){const n=e.maxPadding;function i(r){const s={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{s[o]=Math.max(e[o],n[o])}),s}return i(t?["left","right"]:["top","bottom"])}function xm(t,e,n,i){const r=[];let s,o,a,l,c,u;for(s=0,o=t.length,c=0;s<o;++s){a=t[s],l=a.box,l.update(a.width||e.w,a.height||e.h,PQ(a.horizontal,e));const{same:h,other:d}=TQ(e,n,a,i);c|=h&&r.length,u=u||d,l.fullSize||r.push(a)}return c&&xm(r,e,n,i)||u}function tv(t,e,n,i,r){t.top=n,t.left=e,t.right=e+i,t.bottom=n+r,t.width=i,t.height=r}function gN(t,e,n,i){const r=n.padding;let{x:s,y:o}=e;for(const a of t){const l=a.box,c=i[a.stack]||{placed:0,weight:1},u=a.stackWeight/c.weight||1;if(a.horizontal){const h=e.w*u,d=c.size||l.height;Sp(c.start)&&(o=c.start),l.fullSize?tv(l,r.left,o,n.outerWidth-r.right-r.left,d):tv(l,e.left+c.placed,o,h,d),c.start=o,c.placed+=h,o=l.bottom}else{const h=e.h*u,d=c.size||l.width;Sp(c.start)&&(s=c.start),l.fullSize?tv(l,s,r.top,d,n.outerHeight-r.bottom-r.top):tv(l,s,e.top+c.placed,d,h),c.start=s,c.placed+=h,s=l.right}}e.x=s,e.y=o}var Di={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,i){if(!t)return;const r=Li(t.options.layout.padding),s=Math.max(e-r.width,0),o=Math.max(n-r.height,0),a=xQ(t.boxes),l=a.vertical,c=a.horizontal;Mt(t.boxes,m=>{typeof m.beforeLayout=="function"&&m.beforeLayout()});const u=l.reduce((m,p)=>p.box.options&&p.box.options.display===!1?m:m+1,0)||1,h=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/u,hBoxMaxHeight:o/2}),d=Object.assign({},r);YY(d,Li(i));const f=Object.assign({maxPadding:d,w:s,h:o,x:r.left,y:r.top},r),g=EQ(l.concat(c),h);xm(a.fullSize,f,h,g),xm(l,f,h,g),xm(c,f,h,g)&&xm(l,f,h,g),MQ(f),gN(a.leftAndTop,f,h,g),f.x+=f.w,f.y+=f.h,gN(a.rightAndBottom,f,h,g),t.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},Mt(a.chartArea,m=>{const p=m.box;Object.assign(p,t.chartArea),p.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}};class GY{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,i){}removeEventListener(e,n,i){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,i,r){return n=Math.max(0,n||e.width),i=i||e.height,{width:n,height:Math.max(0,r?Math.floor(n/r):i)}}isAttached(e){return!0}updateConfig(e){}}class AQ extends GY{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Xb="$chartjs",IQ={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},mN=t=>t===null||t==="";function OQ(t,e){const n=t.style,i=t.getAttribute("height"),r=t.getAttribute("width");if(t[Xb]={initial:{height:i,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",mN(r)){const s=ZD(t,"width");s!==void 0&&(t.width=s)}if(mN(i))if(t.style.height==="")t.height=t.width/(e||2);else{const s=ZD(t,"height");s!==void 0&&(t.height=s)}return t}const qY=TZ?{passive:!0}:!1;function HQ(t,e,n){t&&t.addEventListener(e,n,qY)}function kQ(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,qY)}function DQ(t,e){const n=IQ[t.type]||t.type,{x:i,y:r}=Hu(t,e);return{type:n,chart:e,native:t,x:i!==void 0?i:null,y:r!==void 0?r:null}}function Hy(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function NQ(t,e,n){const i=t.canvas,r=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||Hy(a.addedNodes,i),o=o&&!Hy(a.removedNodes,i);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function LQ(t,e,n){const i=t.canvas,r=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||Hy(a.removedNodes,i),o=o&&!Hy(a.addedNodes,i);o&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const Ep=new Map;let pN=0;function KY(){const t=window.devicePixelRatio;t!==pN&&(pN=t,Ep.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function $Q(t,e){Ep.size||window.addEventListener("resize",KY),Ep.set(t,e)}function FQ(t){Ep.delete(t),Ep.size||window.removeEventListener("resize",KY)}function VQ(t,e,n){const i=t.canvas,r=i&&QA(i);if(!r)return;const s=RY((a,l)=>{const c=r.clientWidth;n(a,l),c<r.clientWidth&&n()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||s(c,u)});return o.observe(r),$Q(t,s),o}function q0(t,e,n){n&&n.disconnect(),e==="resize"&&FQ(t)}function BQ(t,e,n){const i=t.canvas,r=RY(s=>{t.ctx!==null&&n(DQ(s,t))},t);return HQ(i,e,r),r}class WQ extends GY{acquireContext(e,n){const i=e&&e.getContext&&e.getContext("2d");return i&&i.canvas===e?(OQ(e,n),i):null}releaseContext(e){const n=e.canvas;if(!n[Xb])return!1;const i=n[Xb].initial;["height","width"].forEach(s=>{const o=i[s];it(o)?n.removeAttribute(s):n.setAttribute(s,o)});const r=i.style||{};return Object.keys(r).forEach(s=>{n.style[s]=r[s]}),n.width=n.width,delete n[Xb],!0}addEventListener(e,n,i){this.removeEventListener(e,n);const r=e.$proxies||(e.$proxies={}),o={attach:NQ,detach:LQ,resize:VQ}[n]||BQ;r[n]=o(e,n,i)}removeEventListener(e,n){const i=e.$proxies||(e.$proxies={}),r=i[n];if(!r)return;({attach:q0,detach:q0,resize:q0}[n]||kQ)(e,n,r),i[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,i,r){return xZ(e,n,i,r)}isAttached(e){const n=e&&QA(e);return!!(n&&n.isConnected)}}function jQ(t){return!ZA()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?AQ:WQ}let hl=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:n,y:i}=this.getProps(["x","y"],e);return{x:n,y:i}}hasValue(){return Rf(this.x)&&Rf(this.y)}getProps(e,n){const i=this.$animations;if(!n||!i)return this;const r={};return e.forEach(s=>{r[s]=i[s]&&i[s].active()?i[s]._to:this[s]}),r}};function zQ(t,e){const n=t.options.ticks,i=UQ(t),r=Math.min(n.maxTicksLimit||i,i),s=n.major.enabled?GQ(e):[],o=s.length,a=s[0],l=s[o-1],c=[];if(o>r)return qQ(e,c,s,o/r),c;const u=YQ(s,e,r);if(o>0){let h,d;const f=o>1?Math.round((l-a)/(o-1)):null;for(nv(e,c,u,it(f)?0:a-f,a),h=0,d=o-1;h<d;h++)nv(e,c,u,s[h],s[h+1]);return nv(e,c,u,l,it(f)?e.length:l+f),c}return nv(e,c,u),c}function UQ(t){const e=t.options.offset,n=t._tickSize(),i=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(i,r))}function YQ(t,e,n){const i=KQ(t),r=e.length/n;if(!i)return Math.max(r,1);const s=PJ(i);for(let o=0,a=s.length-1;o<a;o++){const l=s[o];if(l>r)return l}return Math.max(r,1)}function GQ(t){const e=[];let n,i;for(n=0,i=t.length;n<i;n++)t[n].major&&e.push(n);return e}function qQ(t,e,n,i){let r=0,s=n[0],o;for(i=Math.ceil(i),o=0;o<t.length;o++)o===s&&(e.push(t[o]),r++,s=n[r*i])}function nv(t,e,n,i,r){const s=Ne(i,0),o=Math.min(Ne(r,t.length),t.length);let a=0,l,c,u;for(n=Math.ceil(n),r&&(l=r-i,n=l/Math.floor(l/n)),u=s;u<0;)a++,u=Math.round(s+a*n);for(c=Math.max(s,0);c<o;c++)c===u&&(e.push(t[c]),a++,u=Math.round(s+a*n))}function KQ(t){const e=t.length;let n,i;if(e<2)return!1;for(i=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==i)return!1;return i}const XQ=t=>t==="left"?"right":t==="right"?"left":t,wN=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,vN=(t,e)=>Math.min(e||t,t);function bN(t,e){const n=[],i=t.length/e,r=t.length;let s=0;for(;s<r;s+=i)n.push(t[Math.floor(s)]);return n}function JQ(t,e,n){const i=t.ticks.length,r=Math.min(e,i-1),s=t._startPixel,o=t._endPixel,a=1e-6;let l=t.getPixelForTick(r),c;if(!(n&&(i===1?c=Math.max(l-s,o-l):e===0?c=(t.getPixelForTick(1)-l)/2:c=(l-t.getPixelForTick(r-1))/2,l+=r<e?c:-c,l<s-a||l>o+a)))return l}function ZQ(t,e){Mt(t,n=>{const i=n.gc,r=i.length/2;let s;if(r>e){for(s=0;s<r;++s)delete n.data[i[s]];i.splice(0,r)}})}function bg(t){return t.drawTicks?t.tickLength:0}function yN(t,e){if(!t.display)return 0;const n=Zn(t.font,e),i=Li(t.padding);return(Zt(t.text)?t.text.length:1)*n.lineHeight+i.height}function QQ(t,e){return Hc(t,{scale:e,type:"scale"})}function eee(t,e,n){return Hc(t,{tick:n,index:e,type:"tick"})}function tee(t,e,n){let i=YA(t);return(n&&e!=="right"||!n&&e==="right")&&(i=XQ(i)),i}function nee(t,e,n,i){const{top:r,left:s,bottom:o,right:a,chart:l}=t,{chartArea:c,scales:u}=l;let h=0,d,f,g;const m=o-r,p=a-s;if(t.isHorizontal()){if(f=Pi(i,s,a),st(n)){const v=Object.keys(n)[0],b=n[v];g=u[v].getPixelForValue(b)+m-e}else n==="center"?g=(c.bottom+c.top)/2+m-e:g=wN(t,n,e);d=a-s}else{if(st(n)){const v=Object.keys(n)[0],b=n[v];f=u[v].getPixelForValue(b)-p+e}else n==="center"?f=(c.left+c.right)/2-p+e:f=wN(t,n,e);g=Pi(i,o,r),h=n==="left"?-Pn:Pn}return{titleX:f,titleY:g,maxWidth:d,rotation:h}}class kh extends hl{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:i,_suggestedMax:r}=this;return e=jr(e,Number.POSITIVE_INFINITY),n=jr(n,Number.NEGATIVE_INFINITY),i=jr(i,Number.POSITIVE_INFINITY),r=jr(r,Number.NEGATIVE_INFINITY),{min:jr(e,i),max:jr(n,r),minDefined:Cn(e),maxDefined:Cn(n)}}getMinMax(e){let{min:n,max:i,minDefined:r,maxDefined:s}=this.getUserBounds(),o;if(r&&s)return{min:n,max:i};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,e),r||(n=Math.min(n,o.min)),s||(i=Math.max(i,o.max));return n=s&&n>i?i:n,i=r&&n>i?n:i,{min:jr(n,jr(i,n)),max:jr(i,jr(n,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Dt(this.options.beforeUpdate,[this])}update(e,n,i){const{beginAtZero:r,grace:s,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=rZ(this,s,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?bN(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=zQ(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,i;this.isHorizontal()?(n=this.left,i=this.right):(n=this.top,i=this.bottom,e=!e),this._startPixel=n,this._endPixel=i,this._reversePixels=e,this._length=i-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Dt(this.options.afterUpdate,[this])}beforeSetDimensions(){Dt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Dt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Dt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Dt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let i,r,s;for(i=0,r=e.length;i<r;i++)s=e[i],s.label=Dt(n.callback,[s.value,i,e],this)}afterTickToLabelConversion(){Dt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Dt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,i=vN(this.ticks.length,e.ticks.maxTicksLimit),r=n.minRotation||0,s=n.maxRotation;let o=r,a,l,c;if(!this._isVisible()||!n.display||r>=s||i<=1||!this.isHorizontal()){this.labelRotation=r;return}const u=this._getLabelSizes(),h=u.widest.width,d=u.highest.height,f=hi(this.chart.width-h,0,this.maxWidth);a=e.offset?this.maxWidth/i:f/(i-1),h+6>a&&(a=f/(i-(e.offset?.5:1)),l=this.maxHeight-bg(e.grid)-n.padding-yN(e.title,this.chart.options.font),c=Math.sqrt(h*h+d*d),o=zA(Math.min(Math.asin(hi((u.highest.height+6)/a,-1,1)),Math.asin(hi(l/c,-1,1))-Math.asin(hi(d/c,-1,1)))),o=Math.max(r,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){Dt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Dt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:i,title:r,grid:s}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=yN(r,n.options.font);if(a?(e.width=this.maxWidth,e.height=bg(s)+l):(e.height=this.maxHeight,e.width=bg(s)+l),i.display&&this.ticks.length){const{first:c,last:u,widest:h,highest:d}=this._getLabelSizes(),f=i.padding*2,g=no(this.labelRotation),m=Math.cos(g),p=Math.sin(g);if(a){const v=i.mirror?0:p*h.width+m*d.height;e.height=Math.min(this.maxHeight,e.height+v+f)}else{const v=i.mirror?0:m*h.width+p*d.height;e.width=Math.min(this.maxWidth,e.width+v+f)}this._calculatePadding(c,u,p,m)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,i,r){const{ticks:{align:s,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,f=0;l?c?(d=r*e.width,f=i*n.height):(d=i*e.height,f=r*n.width):s==="start"?f=n.width:s==="end"?d=e.width:s!=="inner"&&(d=e.width/2,f=n.width/2),this.paddingLeft=Math.max((d-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((f-h+o)*this.width/(this.width-h),0)}else{let u=n.height/2,h=e.height/2;s==="start"?(u=0,h=e.height):s==="end"&&(u=n.height,h=0),this.paddingTop=u+o,this.paddingBottom=h+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Dt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,i;for(n=0,i=e.length;n<i;n++)it(e[n].label)&&(e.splice(n,1),i--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let i=this.ticks;n<i.length&&(i=bN(i,n)),this._labelSizes=e=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,i){const{ctx:r,_longestTextCache:s}=this,o=[],a=[],l=Math.floor(n/vN(n,i));let c=0,u=0,h,d,f,g,m,p,v,b,R,S,x;for(h=0;h<n;h+=l){if(g=e[h].label,m=this._resolveTickFontOptions(h),r.font=p=m.string,v=s[p]=s[p]||{data:{},gc:[]},b=m.lineHeight,R=S=0,!it(g)&&!Zt(g))R=Iy(r,v.data,v.gc,R,g),S=b;else if(Zt(g))for(d=0,f=g.length;d<f;++d)x=g[d],!it(x)&&!Zt(x)&&(R=Iy(r,v.data,v.gc,R,x),S+=b);o.push(R),a.push(S),c=Math.max(R,c),u=Math.max(S,u)}ZQ(s,n);const M=o.indexOf(c),T=a.indexOf(u),O=W=>({width:o[W]||0,height:a[W]||0});return{first:O(0),last:O(n-1),widest:O(M),highest:O(T),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return HJ(this._alignToPixels?jc(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const i=n[e];return i.$context||(i.$context=eee(this.getContext(),e,i))}return this.$context||(this.$context=QQ(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=no(this.labelRotation),i=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),s=this._getLabelSizes(),o=e.autoSkipPadding||0,a=s?s.widest.width+o:0,l=s?s.highest.height+o:0;return this.isHorizontal()?l*i>a*r?a/i:l/r:l*r<a*i?l/i:a/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,i=this.chart,r=this.options,{grid:s,position:o,border:a}=r,l=s.offset,c=this.isHorizontal(),h=this.ticks.length+(l?1:0),d=bg(s),f=[],g=a.setContext(this.getContext()),m=g.display?g.width:0,p=m/2,v=function(me){return jc(i,me,m)};let b,R,S,x,M,T,O,W,N,G,j,ne;if(o==="top")b=v(this.bottom),T=this.bottom-d,W=b-p,G=v(e.top)+p,ne=e.bottom;else if(o==="bottom")b=v(this.top),G=e.top,ne=v(e.bottom)-p,T=b+p,W=this.top+d;else if(o==="left")b=v(this.right),M=this.right-d,O=b-p,N=v(e.left)+p,j=e.right;else if(o==="right")b=v(this.left),N=e.left,j=v(e.right)-p,M=b+p,O=this.left+d;else if(n==="x"){if(o==="center")b=v((e.top+e.bottom)/2+.5);else if(st(o)){const me=Object.keys(o)[0],fe=o[me];b=v(this.chart.scales[me].getPixelForValue(fe))}G=e.top,ne=e.bottom,T=b+p,W=T+d}else if(n==="y"){if(o==="center")b=v((e.left+e.right)/2);else if(st(o)){const me=Object.keys(o)[0],fe=o[me];b=v(this.chart.scales[me].getPixelForValue(fe))}M=b-p,O=M-d,N=e.left,j=e.right}const ee=Ne(r.ticks.maxTicksLimit,h),Q=Math.max(1,Math.ceil(h/ee));for(R=0;R<h;R+=Q){const me=this.getContext(R),fe=s.setContext(me),ye=a.setContext(me),Oe=fe.lineWidth,Ce=fe.color,Te=ye.dash||[],$e=ye.dashOffset,Me=fe.tickWidth,X=fe.tickColor,w=fe.tickBorderDash||[],C=fe.tickBorderDashOffset;S=JQ(this,R,l),S!==void 0&&(x=jc(i,S,Oe),c?M=O=N=j=x:T=W=G=ne=x,f.push({tx1:M,ty1:T,tx2:O,ty2:W,x1:N,y1:G,x2:j,y2:ne,width:Oe,color:Ce,borderDash:Te,borderDashOffset:$e,tickWidth:Me,tickColor:X,tickBorderDash:w,tickBorderDashOffset:C}))}return this._ticksLength=h,this._borderValue=b,f}_computeLabelItems(e){const n=this.axis,i=this.options,{position:r,ticks:s}=i,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:h}=s,d=bg(i.grid),f=d+u,g=h?-u:f,m=-no(this.labelRotation),p=[];let v,b,R,S,x,M,T,O,W,N,G,j,ne="middle";if(r==="top")M=this.bottom-g,T=this._getXAxisLabelAlignment();else if(r==="bottom")M=this.top+g,T=this._getXAxisLabelAlignment();else if(r==="left"){const Q=this._getYAxisLabelAlignment(d);T=Q.textAlign,x=Q.x}else if(r==="right"){const Q=this._getYAxisLabelAlignment(d);T=Q.textAlign,x=Q.x}else if(n==="x"){if(r==="center")M=(e.top+e.bottom)/2+f;else if(st(r)){const Q=Object.keys(r)[0],me=r[Q];M=this.chart.scales[Q].getPixelForValue(me)+f}T=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")x=(e.left+e.right)/2-f;else if(st(r)){const Q=Object.keys(r)[0],me=r[Q];x=this.chart.scales[Q].getPixelForValue(me)}T=this._getYAxisLabelAlignment(d).textAlign}n==="y"&&(l==="start"?ne="top":l==="end"&&(ne="bottom"));const ee=this._getLabelSizes();for(v=0,b=a.length;v<b;++v){R=a[v],S=R.label;const Q=s.setContext(this.getContext(v));O=this.getPixelForTick(v)+s.labelOffset,W=this._resolveTickFontOptions(v),N=W.lineHeight,G=Zt(S)?S.length:1;const me=G/2,fe=Q.color,ye=Q.textStrokeColor,Oe=Q.textStrokeWidth;let Ce=T;o?(x=O,T==="inner"&&(v===b-1?Ce=this.options.reverse?"left":"right":v===0?Ce=this.options.reverse?"right":"left":Ce="center"),r==="top"?c==="near"||m!==0?j=-G*N+N/2:c==="center"?j=-ee.highest.height/2-me*N+N:j=-ee.highest.height+N/2:c==="near"||m!==0?j=N/2:c==="center"?j=ee.highest.height/2-me*N:j=ee.highest.height-G*N,h&&(j*=-1),m!==0&&!Q.showLabelBackdrop&&(x+=N/2*Math.sin(m))):(M=O,j=(1-G)*N/2);let Te;if(Q.showLabelBackdrop){const $e=Li(Q.backdropPadding),Me=ee.heights[v],X=ee.widths[v];let w=j-$e.top,C=0-$e.left;switch(ne){case"middle":w-=Me/2;break;case"bottom":w-=Me;break}switch(T){case"center":C-=X/2;break;case"right":C-=X;break;case"inner":v===b-1?C-=X:v>0&&(C-=X/2);break}Te={left:C,top:w,width:X+$e.width,height:Me+$e.height,color:Q.backdropColor}}p.push({label:S,font:W,textOffset:j,options:{rotation:m,color:fe,strokeColor:ye,strokeWidth:Oe,textAlign:Ce,textBaseline:ne,translation:[x,M],backdrop:Te}})}return p}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-no(this.labelRotation))return e==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:i,mirror:r,padding:s}}=this.options,o=this._getLabelSizes(),a=e+s,l=o.widest.width;let c,u;return n==="left"?r?(u=this.right+s,i==="near"?c="left":i==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-a,i==="near"?c="right":i==="center"?(c="center",u-=l/2):(c="left",u=this.left)):n==="right"?r?(u=this.left+s,i==="near"?c="right":i==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+a,i==="near"?c="left":i==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:i,top:r,width:s,height:o}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(i,r,s,o),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(s=>s.value===e);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const n=this.options.grid,i=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,o;const a=(l,c,u)=>{!u.width||!u.color||(i.save(),i.lineWidth=u.width,i.strokeStyle=u.color,i.setLineDash(u.borderDash||[]),i.lineDashOffset=u.borderDashOffset,i.beginPath(),i.moveTo(l.x,l.y),i.lineTo(c.x,c.y),i.stroke(),i.restore())};if(n.display)for(s=0,o=r.length;s<o;++s){const l=r[s];n.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:i,grid:r}}=this,s=i.setContext(this.getContext()),o=i.display?s.width:0;if(!o)return;const a=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,h,d;this.isHorizontal()?(c=jc(e,this.left,o)-o/2,u=jc(e,this.right,a)+a/2,h=d=l):(h=jc(e,this.top,o)-o/2,d=jc(e,this.bottom,a)+a/2,c=u=l),n.save(),n.lineWidth=s.width,n.strokeStyle=s.color,n.beginPath(),n.moveTo(c,h),n.lineTo(u,d),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const i=this.ctx,r=this._computeLabelArea();r&&fS(i,r);const s=this.getLabelItems(e);for(const o of s){const a=o.options,l=o.font,c=o.label,u=o.textOffset;Rh(i,c,0,u,l,a)}r&&gS(i)}drawTitle(){const{ctx:e,options:{position:n,title:i,reverse:r}}=this;if(!i.display)return;const s=Zn(i.font),o=Li(i.padding),a=i.align;let l=s.lineHeight/2;n==="bottom"||n==="center"||st(n)?(l+=o.bottom,Zt(i.text)&&(l+=s.lineHeight*(i.text.length-1))):l+=o.top;const{titleX:c,titleY:u,maxWidth:h,rotation:d}=nee(this,l,n,a);Rh(e,i.text,0,0,s,{color:i.color,maxWidth:h,rotation:d,textAlign:tee(a,n,r),textBaseline:"middle",translation:[c,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,i=Ne(e.grid&&e.grid.z,-1),r=Ne(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==kh.prototype.draw?[{z:n,draw:s=>{this.draw(s)}}]:[{z:i,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",r=[];let s,o;for(s=0,o=n.length;s<o;++s){const a=n[s];a[i]===this.id&&(!e||a.type===e)&&r.push(a)}return r}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return Zn(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class iv{constructor(e,n,i){this.type=e,this.scope=n,this.override=i,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let i;see(n)&&(i=this.register(n));const r=this.items,s=e.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in r||(r[s]=e,iee(e,o,i),this.override&&Qt.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const n=this.items,i=e.id,r=this.scope;i in n&&delete n[i],r&&i in Qt[r]&&(delete Qt[r][i],this.override&&delete Sh[i])}}function iee(t,e,n){const i=Cp(Object.create(null),[n?Qt.get(n):{},Qt.get(e),t.defaults]);Qt.set(e,i),t.defaultRoutes&&ree(e,t.defaultRoutes),t.descriptors&&Qt.describe(e,t.descriptors)}function ree(t,e){Object.keys(e).forEach(n=>{const i=n.split("."),r=i.pop(),s=[t].concat(i).join("."),o=e[n].split("."),a=o.pop(),l=o.join(".");Qt.route(s,r,l,a)})}function see(t){return"id"in t&&"defaults"in t}class oee{constructor(){this.controllers=new iv(kc,"datasets",!0),this.elements=new iv(hl,"elements"),this.plugins=new iv(Object,"plugins"),this.scales=new iv(kh,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,i){[...n].forEach(r=>{const s=i||this._getRegistryForType(r);i||s.isForType(r)||s===this.plugins&&r.id?this._exec(e,s,r):Mt(r,o=>{const a=i||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,n,i){const r=jA(e);Dt(i["before"+r],[],i),n[e](i),Dt(i["after"+r],[],i)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const i=this._typedRegistries[n];if(i.isForType(e))return i}return this.plugins}_get(e,n,i){const r=n.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+i+".");return r}}var Wo=new oee;class aee{constructor(){this._init=void 0}notify(e,n,i,r){if(n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const s=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(s,e,n,i);return n==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,n,i,r){r=r||{};for(const s of e){const o=s.plugin,a=o[i],l=[n,r,s.options];if(Dt(a,l,o)===!1&&r.cancelable)return!1}return!0}invalidate(){it(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const i=e&&e.config,r=Ne(i.options&&i.options.plugins,{}),s=lee(i);return r===!1&&!n?[]:uee(e,s,r,n)}_notifyStateChanges(e){const n=this._oldCache||[],i=this._cache,r=(s,o)=>s.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(r(n,i),e,"stop"),this._notify(r(i,n),e,"start")}}function lee(t){const e={},n=[],i=Object.keys(Wo.plugins.items);for(let s=0;s<i.length;s++)n.push(Wo.getPlugin(i[s]));const r=t.plugins||[];for(let s=0;s<r.length;s++){const o=r[s];n.indexOf(o)===-1&&(n.push(o),e[o.id]=!0)}return{plugins:n,localIds:e}}function cee(t,e){return!e&&t===!1?null:t===!0?{}:t}function uee(t,{plugins:e,localIds:n},i,r){const s=[],o=t.getContext();for(const a of e){const l=a.id,c=cee(i[l],r);c!==null&&s.push({plugin:a,options:hee(t.config,{plugin:a,local:n[l]},c,o)})}return s}function hee(t,{plugin:e,local:n},i,r){const s=t.pluginScopeKeys(e),o=t.getOptionScopes(i,s);return n&&e.defaults&&o.push(e.defaults),t.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function GM(t,e){const n=Qt.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function dee(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function fee(t,e){return t===e?"_index_":"_value_"}function CN(t){if(t==="x"||t==="y"||t==="r")return t}function gee(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function qM(t,...e){if(CN(t))return t;for(const n of e){const i=n.axis||gee(n.position)||t.length>1&&CN(t[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function SN(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function mee(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(i=>i.xAxisID===t||i.yAxisID===t);if(n.length)return SN(t,"x",n[0])||SN(t,"y",n[0])}return{}}function pee(t,e){const n=Sh[t.type]||{scales:{}},i=e.scales||{},r=GM(t.type,e),s=Object.create(null);return Object.keys(i).forEach(o=>{const a=i[o];if(!st(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=qM(o,a,mee(o,t),Qt.scales[a.type]),c=fee(l,r),u=n.scales||{};s[o]=Bm(Object.create(null),[{axis:l},a,u[l],u[c]])}),t.data.datasets.forEach(o=>{const a=o.type||t.type,l=o.indexAxis||GM(a,e),u=(Sh[a]||{}).scales||{};Object.keys(u).forEach(h=>{const d=dee(h,l),f=o[d+"AxisID"]||d;s[f]=s[f]||Object.create(null),Bm(s[f],[{axis:d},i[f],u[h]])})}),Object.keys(s).forEach(o=>{const a=s[o];Bm(a,[Qt.scales[a.type],Qt.scale])}),s}function XY(t){const e=t.options||(t.options={});e.plugins=Ne(e.plugins,{}),e.scales=pee(t,e)}function JY(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function wee(t){return t=t||{},t.data=JY(t.data),XY(t),t}const RN=new Map,ZY=new Set;function rv(t,e){let n=RN.get(t);return n||(n=e(),RN.set(t,n),ZY.add(n)),n}const yg=(t,e,n)=>{const i=Rc(e,n);i!==void 0&&t.add(i)};class vee{constructor(e){this._config=wee(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=JY(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),XY(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return rv(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return rv(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return rv(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,i=this.type;return rv(`${i}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const i=this._scopeCache;let r=i.get(e);return(!r||n)&&(r=new Map,i.set(e,r)),r}getOptionScopes(e,n,i){const{options:r,type:s}=this,o=this._cachedScopes(e,i),a=o.get(n);if(a)return a;const l=new Set;n.forEach(u=>{e&&(l.add(e),u.forEach(h=>yg(l,e,h))),u.forEach(h=>yg(l,r,h)),u.forEach(h=>yg(l,Sh[s]||{},h)),u.forEach(h=>yg(l,Qt,h)),u.forEach(h=>yg(l,UM,h))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),ZY.has(n)&&o.set(n,c),c}chartOptionScopes(){const{options:e,type:n}=this;return[e,Sh[n]||{},Qt.datasets[n]||{},{type:n},Qt,UM]}resolveNamedOptions(e,n,i,r=[""]){const s={$shared:!0},{resolver:o,subPrefixes:a}=_N(this._resolverCache,e,r);let l=o;if(yee(o,n)){s.$shared=!1,i=_c(i)?i():i;const c=this.createResolver(e,i,a);l=_f(o,i,c)}for(const c of n)s[c]=l[c];return s}createResolver(e,n,i=[""],r){const{resolver:s}=_N(this._resolverCache,e,i);return st(n)?_f(s,n,void 0,r):s}}function _N(t,e,n){let i=t.get(e);i||(i=new Map,t.set(e,i));const r=n.join();let s=i.get(r);return s||(s={resolver:KA(e,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},i.set(r,s)),s}const bee=t=>st(t)&&Object.getOwnPropertyNames(t).some(e=>_c(t[e]));function yee(t,e){const{isScriptable:n,isIndexable:i}=PY(t);for(const r of e){const s=n(r),o=i(r),a=(o||s)&&t[r];if(s&&(_c(a)||bee(a))||o&&Zt(a))return!0}return!1}var Cee="4.5.1";const See=["top","bottom","left","right","chartArea"];function EN(t,e){return t==="top"||t==="bottom"||See.indexOf(t)===-1&&e==="x"}function xN(t,e){return function(n,i){return n[t]===i[t]?n[e]-i[e]:n[t]-i[t]}}function TN(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),Dt(n&&n.onComplete,[t],e)}function Ree(t){const e=t.chart,n=e.options.animation;Dt(n&&n.onProgress,[t],e)}function QY(t){return ZA()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const Jb={},MN=t=>{const e=QY(t);return Object.values(Jb).filter(n=>n.canvas===e).pop()};function _ee(t,e,n){const i=Object.keys(t);for(const r of i){const s=+r;if(s>=e){const o=t[r];delete t[r],(n>0||s>e)&&(t[s+n]=o)}}}function Eee(t,e,n,i){return!n||t.type==="mouseout"?null:i?e:t}class nI{static defaults=Qt;static instances=Jb;static overrides=Sh;static registry=Wo;static version=Cee;static getChart=MN;static register(...e){Wo.add(...e),PN()}static unregister(...e){Wo.remove(...e),PN()}constructor(e,n){const i=this.config=new vee(n),r=QY(e),s=MN(r);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||jQ(r)),this.platform.updateConfig(i);const a=this.platform.acquireContext(r,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,u=l&&l.width;if(this.id=yJ(),this.ctx=a,this.canvas=l,this.width=u,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new aee,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=LJ(h=>this.update(h),o.resizeDelay||0),this._dataChanges=[],Jb[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Da.listen(this,"complete",TN),Da.listen(this,"progress",Ree),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:i,height:r,_aspectRatio:s}=this;return it(e)?n&&s?s:r?i/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Wo}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():JD(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return qD(this.canvas,this.ctx),this}stop(){return Da.stop(this),this}resize(e,n){Da.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const i=this.options,r=this.canvas,s=i.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,n,s),a=i.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,JD(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),Dt(i.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Mt(n,(i,r)=>{i.id=r})}buildOrUpdateScales(){const e=this.options,n=e.scales,i=this.scales,r=Object.keys(i).reduce((o,a)=>(o[a]=!1,o),{});let s=[];n&&(s=s.concat(Object.keys(n).map(o=>{const a=n[o],l=qM(o,a),c=l==="r",u=l==="x";return{options:a,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),Mt(s,o=>{const a=o.options,l=a.id,c=qM(l,a),u=Ne(a.type,o.dtype);(a.position===void 0||EN(a.position,c)!==EN(o.dposition))&&(a.position=o.dposition),r[l]=!0;let h=null;if(l in i&&i[l].type===u)h=i[l];else{const d=Wo.getScale(u);h=new d({id:l,type:u,ctx:this.ctx,chart:this}),i[h.id]=h}h.init(a,e)}),Mt(r,(o,a)=>{o||delete i[a]}),Mt(i,o=>{Di.configure(this,o,o.options),Di.addBox(this,o)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,i=e.length;if(e.sort((r,s)=>r.index-s.index),i>n){for(let r=n;r<i;++r)this._destroyDatasetMeta(r);e.splice(n,i-n)}this._sortedMetasets=e.slice(0).sort(xN("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((i,r)=>{n.filter(s=>s===i._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let i,r;for(this._removeUnreferencedMetasets(),i=0,r=n.length;i<r;i++){const s=n[i];let o=this.getDatasetMeta(i);const a=s.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(i),o=this.getDatasetMeta(i)),o.type=a,o.indexAxis=s.indexAxis||GM(a,this.options),o.order=s.order||0,o.index=i,o.label=""+s.label,o.visible=this.isDatasetVisible(i),o.controller)o.controller.updateIndex(i),o.controller.linkScales();else{const l=Wo.getController(a),{datasetElementType:c,dataElementType:u}=Qt.datasets[a];Object.assign(l,{dataElementType:Wo.getElement(u),datasetElementType:c&&Wo.getElement(c)}),o.controller=new l(this,i),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){Mt(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const i=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:h}=this.getDatasetMeta(c),d=!r&&s.indexOf(h)===-1;h.buildOrUpdateElements(d),o=Math.max(+h.getMaxOverflow(),o)}o=this._minPadding=i.layout.autoPadding?o:0,this._updateLayout(o),r||Mt(s,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(xN("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){Mt(this.scales,e=>{Di.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),i=new Set(e.events);(!FD(n,i)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:i,start:r,count:s}of n){const o=i==="_removeElements"?-s:s;_ee(e,r,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,i=s=>new Set(e.filter(o=>o[0]===s).map((o,a)=>a+","+o.splice(1).join(","))),r=i(0);for(let s=1;s<n;s++)if(!FD(r,i(s)))return;return Array.from(r).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Di.update(this,this.width,this.height,e);const n=this.chartArea,i=n.width<=0||n.height<=0;this._layers=[],Mt(this.boxes,r=>{i&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,s)=>{r._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,i=this.data.datasets.length;n<i;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,i=this.data.datasets.length;n<i;++n)this._updateDataset(n,_c(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const i=this.getDatasetMeta(e),r={meta:i,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(i.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Da.has(this)?this.attached&&!Da.running(this)&&Da.start(this):(this.draw(),TN({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:i,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,i=[];let r,s;for(r=0,s=n.length;r<s;++r){const o=n[r];(!e||o.visible)&&i.push(o)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,i={meta:e,index:e.index,cancelable:!0},r=VY(this,e);this.notifyPlugins("beforeDatasetDraw",i)!==!1&&(r&&fS(n,r),e.controller.draw(),r&&gS(n),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}isPointInArea(e){return qa(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,i,r){const s=SQ.modes[n];return typeof s=="function"?s(this,e,i,r):[]}getDatasetMeta(e){const n=this.data.datasets[e],i=this._metasets;let r=i.filter(s=>s&&s._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},i.push(r)),r}getContext(){return this.$context||(this.$context=Hc(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const i=this.getDatasetMeta(e);return typeof i.hidden=="boolean"?!i.hidden:!n.hidden}setDatasetVisibility(e,n){const i=this.getDatasetMeta(e);i.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,i){const r=i?"show":"hide",s=this.getDatasetMeta(e),o=s.controller._resolveAnimations(void 0,r);Sp(n)?(s.data[n].hidden=!i,this.update()):(this.setDatasetVisibility(e,i),o.update(s,{visible:i}),this.update(a=>a.datasetIndex===e?r:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),Da.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),qD(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete Jb[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,i=(s,o)=>{n.addEventListener(this,s,o),e[s]=o},r=(s,o,a)=>{s.offsetX=o,s.offsetY=a,this._eventHandler(s)};Mt(this.options.events,s=>i(s,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,i=(l,c)=>{n.addEventListener(this,l,c),e[l]=c},r=(l,c)=>{e[l]&&(n.removeEventListener(this,l,c),delete e[l])},s=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{r("attach",a),this.attached=!0,this.resize(),i("resize",s),i("detach",o)};o=()=>{this.attached=!1,r("resize",s),this._stop(),this._resize(0,0),i("attach",a)},n.isAttached(this.canvas)?a():o()}unbindEvents(){Mt(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},Mt(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,i){const r=i?"set":"remove";let s,o,a,l;for(n==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+r+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],i=e.map(({datasetIndex:s,index:o})=>{const a=this.getDatasetMeta(s);if(!a)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:a.data[o],index:o}});!My(i,n)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,n))}notifyPlugins(e,n,i){return this._plugins.notify(this,e,n,i)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,i){const r=this.options.hover,s=(l,c)=>l.filter(u=>!c.some(h=>u.datasetIndex===h.datasetIndex&&u.index===h.index)),o=s(n,e),a=i?e:s(e,n);o.length&&this.updateHoverStyle(o,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}_eventHandler(e,n){const i={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},r=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",i,r)===!1)return;const s=this._handleEvent(e,n,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,r),(s||i.changed)&&this.render(),this}_handleEvent(e,n,i){const{_active:r=[],options:s}=this,o=n,a=this._getActiveElements(e,r,i,o),l=xJ(e),c=Eee(e,this._lastEvent,i,l);i&&(this._lastEvent=null,Dt(s.onHover,[e,a,this],this),l&&Dt(s.onClick,[e,a,this],this));const u=!My(a,r);return(u||n)&&(this._active=a,this._updateHoverStyles(a,r,n)),this._lastEvent=c,u}_getActiveElements(e,n,i,r){if(e.type==="mouseout")return[];if(!i)return n;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,r)}}function PN(){return Mt(nI.instances,t=>t._plugins.invalidate())}function xee(t,e,n){const{startAngle:i,x:r,y:s,outerRadius:o,innerRadius:a,options:l}=e,{borderWidth:c,borderJoinStyle:u}=l,h=Math.min(c/o,Ii(i-n));if(t.beginPath(),t.arc(r,s,o-c/2,i+h/2,n-h/2),a>0){const d=Math.min(c/a,Ii(i-n));t.arc(r,s,a+c/2,n-d/2,i+d/2,!0)}else{const d=Math.min(c/2,o*Ii(i-n));if(u==="round")t.arc(r,s,d,n-ft/2,i+ft/2,!0);else if(u==="bevel"){const f=2*d*d,g=-f*Math.cos(n+ft/2)+r,m=-f*Math.sin(n+ft/2)+s,p=f*Math.cos(i+ft/2)+r,v=f*Math.sin(i+ft/2)+s;t.lineTo(g,m),t.lineTo(p,v)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function Tee(t,e,n){const{startAngle:i,pixelMargin:r,x:s,y:o,outerRadius:a,innerRadius:l}=e;let c=r/a;t.beginPath(),t.arc(s,o,a,i-c,n+c),l>r?(c=r/l,t.arc(s,o,l,n+c,i-c,!0)):t.arc(s,o,r,n+Pn,i-Pn),t.closePath(),t.clip()}function Mee(t){return qA(t,["outerStart","outerEnd","innerStart","innerEnd"])}function Pee(t,e,n,i){const r=Mee(t.options.borderRadius),s=(n-e)/2,o=Math.min(s,i*e/2),a=l=>{const c=(n-Math.min(s,l))*i/2;return hi(l,0,Math.min(s,c))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:hi(r.innerStart,0,o),innerEnd:hi(r.innerEnd,0,o)}}function Kh(t,e,n,i){return{x:n+t*Math.cos(e),y:i+t*Math.sin(e)}}function ky(t,e,n,i,r,s){const{x:o,y:a,startAngle:l,pixelMargin:c,innerRadius:u}=e,h=Math.max(e.outerRadius+i+n-c,0),d=u>0?u+i+n+c:0;let f=0;const g=r-l;if(i){const Q=u>0?u-i:0,me=h>0?h-i:0,fe=(Q+me)/2,ye=fe!==0?g*fe/(fe+i):g;f=(g-ye)/2}const m=Math.max(.001,g*h-n/ft)/h,p=(g-m)/2,v=l+p+f,b=r-p-f,{outerStart:R,outerEnd:S,innerStart:x,innerEnd:M}=Pee(e,d,h,b-v),T=h-R,O=h-S,W=v+R/T,N=b-S/O,G=d+x,j=d+M,ne=v+x/G,ee=b-M/j;if(t.beginPath(),s){const Q=(W+N)/2;if(t.arc(o,a,h,W,Q),t.arc(o,a,h,Q,N),S>0){const Oe=Kh(O,N,o,a);t.arc(Oe.x,Oe.y,S,N,b+Pn)}const me=Kh(j,b,o,a);if(t.lineTo(me.x,me.y),M>0){const Oe=Kh(j,ee,o,a);t.arc(Oe.x,Oe.y,M,b+Pn,ee+Math.PI)}const fe=(b-M/d+(v+x/d))/2;if(t.arc(o,a,d,b-M/d,fe,!0),t.arc(o,a,d,fe,v+x/d,!0),x>0){const Oe=Kh(G,ne,o,a);t.arc(Oe.x,Oe.y,x,ne+Math.PI,v-Pn)}const ye=Kh(T,v,o,a);if(t.lineTo(ye.x,ye.y),R>0){const Oe=Kh(T,W,o,a);t.arc(Oe.x,Oe.y,R,v-Pn,W)}}else{t.moveTo(o,a);const Q=Math.cos(W)*h+o,me=Math.sin(W)*h+a;t.lineTo(Q,me);const fe=Math.cos(N)*h+o,ye=Math.sin(N)*h+a;t.lineTo(fe,ye)}t.closePath()}function Aee(t,e,n,i,r){const{fullCircles:s,startAngle:o,circumference:a}=e;let l=e.endAngle;if(s){ky(t,e,n,i,l,r);for(let c=0;c<s;++c)t.fill();isNaN(a)||(l=o+(a%Wt||Wt))}return ky(t,e,n,i,l,r),t.fill(),l}function Iee(t,e,n,i,r){const{fullCircles:s,startAngle:o,circumference:a,options:l}=e,{borderWidth:c,borderJoinStyle:u,borderDash:h,borderDashOffset:d,borderRadius:f}=l,g=l.borderAlign==="inner";if(!c)return;t.setLineDash(h||[]),t.lineDashOffset=d,g?(t.lineWidth=c*2,t.lineJoin=u||"round"):(t.lineWidth=c,t.lineJoin=u||"bevel");let m=e.endAngle;if(s){ky(t,e,n,i,m,r);for(let p=0;p<s;++p)t.stroke();isNaN(a)||(m=o+(a%Wt||Wt))}g&&Tee(t,e,m),l.selfJoin&&m-o>=ft&&f===0&&u!=="miter"&&xee(t,e,m),s||(ky(t,e,n,i,m,r),t.stroke())}class Oee extends hl{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,n,i){const r=this.getProps(["x","y"],i),{angle:s,distance:o}=bY(r,{x:e,y:n}),{startAngle:a,endAngle:l,innerRadius:c,outerRadius:u,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),d=(this.options.spacing+this.options.borderWidth)/2,f=Ne(h,l-a),g=Rp(s,a,l)&&a!==l,m=f>=Wt||g,p=Ya(o,c+d,u+d);return m&&p}getCenterPoint(e){const{x:n,y:i,startAngle:r,endAngle:s,innerRadius:o,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:l,spacing:c}=this.options,u=(r+s)/2,h=(o+a+c+l)/2;return{x:n+Math.cos(u)*h,y:i+Math.sin(u)*h}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:n,circumference:i}=this,r=(n.offset||0)/4,s=(n.spacing||0)/2,o=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=i>Wt?Math.floor(i/Wt):0,i===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const a=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(a)*r,Math.sin(a)*r);const l=1-Math.sin(Math.min(ft,i||0)),c=r*l;e.fillStyle=n.backgroundColor,e.strokeStyle=n.borderColor,Aee(e,this,c,s,o),Iee(e,this,c,s,o),e.restore()}}function eG(t,e,n=e){t.lineCap=Ne(n.borderCapStyle,e.borderCapStyle),t.setLineDash(Ne(n.borderDash,e.borderDash)),t.lineDashOffset=Ne(n.borderDashOffset,e.borderDashOffset),t.lineJoin=Ne(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=Ne(n.borderWidth,e.borderWidth),t.strokeStyle=Ne(n.borderColor,e.borderColor)}function Hee(t,e,n){t.lineTo(n.x,n.y)}function kee(t){return t.stepped?KJ:t.tension||t.cubicInterpolationMode==="monotone"?XJ:Hee}function tG(t,e,n={}){const i=t.length,{start:r=0,end:s=i-1}=n,{start:o,end:a}=e,l=Math.max(r,o),c=Math.min(s,a),u=r<o&&s<o||r>a&&s>a;return{count:i,start:l,loop:e.loop,ilen:c<l&&!u?i+c-l:c-l}}function Dee(t,e,n,i){const{points:r,options:s}=e,{count:o,start:a,loop:l,ilen:c}=tG(r,n,i),u=kee(s);let{move:h=!0,reverse:d}=i||{},f,g,m;for(f=0;f<=c;++f)g=r[(a+(d?c-f:f))%o],!g.skip&&(h?(t.moveTo(g.x,g.y),h=!1):u(t,m,g,d,s.stepped),m=g);return l&&(g=r[(a+(d?c:0))%o],u(t,m,g,d,s.stepped)),!!l}function Nee(t,e,n,i){const r=e.points,{count:s,start:o,ilen:a}=tG(r,n,i),{move:l=!0,reverse:c}=i||{};let u=0,h=0,d,f,g,m,p,v;const b=S=>(o+(c?a-S:S))%s,R=()=>{m!==p&&(t.lineTo(u,p),t.lineTo(u,m),t.lineTo(u,v))};for(l&&(f=r[b(0)],t.moveTo(f.x,f.y)),d=0;d<=a;++d){if(f=r[b(d)],f.skip)continue;const S=f.x,x=f.y,M=S|0;M===g?(x<m?m=x:x>p&&(p=x),u=(h*u+S)/++h):(R(),t.lineTo(S,x),g=M,h=0,m=p=x),v=x}R()}function KM(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!n?Nee:Dee}function Lee(t){return t.stepped?MZ:t.tension||t.cubicInterpolationMode==="monotone"?PZ:ku}function $ee(t,e,n,i){let r=e._path;r||(r=e._path=new Path2D,e.path(r,n,i)&&r.closePath()),eG(t,e.options),t.stroke(r)}function Fee(t,e,n,i){const{segments:r,options:s}=e,o=KM(e);for(const a of r)eG(t,s,a.style),t.beginPath(),o(t,e,a,{start:n,end:n+i-1})&&t.closePath(),t.stroke()}const Vee=typeof Path2D=="function";function Bee(t,e,n,i){Vee&&!e.options.segment?$ee(t,e,n,i):Fee(t,e,n,i)}class wS extends hl{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,n){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const r=i.spanGaps?this._loop:this._fullLoop;yZ(this._points,i,e,r,n),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=DZ(this,this.options.segment))}first(){const e=this.segments,n=this.points;return e.length&&n[e[0].start]}last(){const e=this.segments,n=this.points,i=e.length;return i&&n[e[i-1].end]}interpolate(e,n){const i=this.options,r=e[n],s=this.points,o=FY(this,{property:n,start:r,end:r});if(!o.length)return;const a=[],l=Lee(i);let c,u;for(c=0,u=o.length;c<u;++c){const{start:h,end:d}=o[c],f=s[h],g=s[d];if(f===g){a.push(f);continue}const m=Math.abs((r-f[n])/(g[n]-f[n])),p=l(f,g,m,i.stepped);p[n]=e[n],a.push(p)}return a.length===1?a[0]:a}pathSegment(e,n,i){return KM(this)(e,this,n,i)}path(e,n,i){const r=this.segments,s=KM(this);let o=this._loop;n=n||0,i=i||this.points.length-n;for(const a of r)o&=s(e,this,a,{start:n,end:n+i-1});return!!o}draw(e,n,i,r){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),Bee(e,this,i,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function AN(t,e,n,i){const r=t.options,{[n]:s}=t.getProps([n],i);return Math.abs(e-s)<r.radius+r.hitRadius}class Wee extends hl{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,n,i){const r=this.options,{x:s,y:o}=this.getProps(["x","y"],i);return Math.pow(e-s,2)+Math.pow(n-o,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(e,n){return AN(this,e,"x",n)}inYRange(e,n){return AN(this,e,"y",n)}getCenterPoint(e){const{x:n,y:i}=this.getProps(["x","y"],e);return{x:n,y:i}}size(e){e=e||this.options||{};let n=e.radius||0;n=Math.max(n,n&&e.hoverRadius||0);const i=n&&e.borderWidth||0;return(n+i)*2}draw(e,n){const i=this.options;this.skip||i.radius<.1||!qa(this,n,this.size(i)/2)||(e.strokeStyle=i.borderColor,e.lineWidth=i.borderWidth,e.fillStyle=i.backgroundColor,YM(e,i,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function nG(t,e){const{x:n,y:i,base:r,width:s,height:o}=t.getProps(["x","y","base","width","height"],e);let a,l,c,u,h;return t.horizontal?(h=o/2,a=Math.min(n,r),l=Math.max(n,r),c=i-h,u=i+h):(h=s/2,a=n-h,l=n+h,c=Math.min(i,r),u=Math.max(i,r)),{left:a,top:c,right:l,bottom:u}}function rc(t,e,n,i){return t?0:hi(e,n,i)}function jee(t,e,n){const i=t.options.borderWidth,r=t.borderSkipped,s=MY(i);return{t:rc(r.top,s.top,0,n),r:rc(r.right,s.right,0,e),b:rc(r.bottom,s.bottom,0,n),l:rc(r.left,s.left,0,e)}}function zee(t,e,n){const{enableBorderRadius:i}=t.getProps(["enableBorderRadius"]),r=t.options.borderRadius,s=uh(r),o=Math.min(e,n),a=t.borderSkipped,l=i||st(r);return{topLeft:rc(!l||a.top||a.left,s.topLeft,0,o),topRight:rc(!l||a.top||a.right,s.topRight,0,o),bottomLeft:rc(!l||a.bottom||a.left,s.bottomLeft,0,o),bottomRight:rc(!l||a.bottom||a.right,s.bottomRight,0,o)}}function Uee(t){const e=nG(t),n=e.right-e.left,i=e.bottom-e.top,r=jee(t,n/2,i/2),s=zee(t,n/2,i/2);return{outer:{x:e.left,y:e.top,w:n,h:i,radius:s},inner:{x:e.left+r.l,y:e.top+r.t,w:n-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}function K0(t,e,n,i){const r=e===null,s=n===null,a=t&&!(r&&s)&&nG(t,i);return a&&(r||Ya(e,a.left,a.right))&&(s||Ya(n,a.top,a.bottom))}function Yee(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function Gee(t,e){t.rect(e.x,e.y,e.w,e.h)}function X0(t,e,n={}){const i=t.x!==n.x?-e:0,r=t.y!==n.y?-e:0,s=(t.x+t.w!==n.x+n.w?e:0)-i,o=(t.y+t.h!==n.y+n.h?e:0)-r;return{x:t.x+i,y:t.y+r,w:t.w+s,h:t.h+o,radius:t.radius}}class qee extends hl{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:i,backgroundColor:r}}=this,{inner:s,outer:o}=Uee(this),a=Yee(o.radius)?_p:Gee;e.save(),(o.w!==s.w||o.h!==s.h)&&(e.beginPath(),a(e,X0(o,n,s)),e.clip(),a(e,X0(s,-n,o)),e.fillStyle=i,e.fill("evenodd")),e.beginPath(),a(e,X0(s,n)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,n,i){return K0(this,e,n,i)}inXRange(e,n){return K0(this,e,null,n)}inYRange(e,n){return K0(this,null,e,n)}getCenterPoint(e){const{x:n,y:i,base:r,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(n+r)/2:n,y:s?i:(i+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}var Kee=Object.freeze({__proto__:null,ArcElement:Oee,BarElement:qee,LineElement:wS,PointElement:Wee});const XM=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],IN=XM.map(t=>t.replace("rgb(","rgba(").replace(")",", 0.5)"));function iG(t){return XM[t%XM.length]}function rG(t){return IN[t%IN.length]}function Xee(t,e){return t.borderColor=iG(e),t.backgroundColor=rG(e),++e}function Jee(t,e){return t.backgroundColor=t.data.map(()=>iG(e++)),e}function Zee(t,e){return t.backgroundColor=t.data.map(()=>rG(e++)),e}function Qee(t){let e=0;return(n,i)=>{const r=t.getDatasetMeta(i).controller;r instanceof eI?e=Jee(n,e):r instanceof zY?e=Zee(n,e):r&&(e=Xee(n,e))}}function ON(t){let e;for(e in t)if(t[e].borderColor||t[e].backgroundColor)return!0;return!1}function ete(t){return t&&(t.borderColor||t.backgroundColor)}function tte(){return Qt.borderColor!=="rgba(0,0,0,0.1)"||Qt.backgroundColor!=="rgba(0,0,0,0.1)"}var nte={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(t,e,n){if(!n.enabled)return;const{data:{datasets:i},options:r}=t.config,{elements:s}=r,o=ON(i)||ete(r)||s&&ON(s)||tte();if(!n.forceOverride&&o)return;const a=Qee(t);i.forEach(a)}};function ite(t,e,n,i,r){const s=r.samples||i;if(s>=n)return t.slice(e,e+n);const o=[],a=(n-2)/(s-2);let l=0;const c=e+n-1;let u=e,h,d,f,g,m;for(o[l++]=t[u],h=0;h<s-2;h++){let p=0,v=0,b;const R=Math.floor((h+1)*a)+1+e,S=Math.min(Math.floor((h+2)*a)+1,n)+e,x=S-R;for(b=R;b<S;b++)p+=t[b].x,v+=t[b].y;p/=x,v/=x;const M=Math.floor(h*a)+1+e,T=Math.min(Math.floor((h+1)*a)+1,n)+e,{x:O,y:W}=t[u];for(f=g=-1,b=M;b<T;b++)g=.5*Math.abs((O-p)*(t[b].y-W)-(O-t[b].x)*(v-W)),g>f&&(f=g,d=t[b],m=b);o[l++]=d,u=m}return o[l++]=t[c],o}function rte(t,e,n,i){let r=0,s=0,o,a,l,c,u,h,d,f,g,m;const p=[],v=e+n-1,b=t[e].x,S=t[v].x-b;for(o=e;o<e+n;++o){a=t[o],l=(a.x-b)/S*i,c=a.y;const x=l|0;if(x===u)c<g?(g=c,h=o):c>m&&(m=c,d=o),r=(s*r+a.x)/++s;else{const M=o-1;if(!it(h)&&!it(d)){const T=Math.min(h,d),O=Math.max(h,d);T!==f&&T!==M&&p.push({...t[T],x:r}),O!==f&&O!==M&&p.push({...t[O],x:r})}o>0&&M!==f&&p.push(t[M]),p.push(a),u=x,s=0,g=m=c,h=d=f=o}}return p}function sG(t){if(t._decimated){const e=t._data;delete t._decimated,delete t._data,Object.defineProperty(t,"data",{configurable:!0,enumerable:!0,writable:!0,value:e})}}function HN(t){t.data.datasets.forEach(e=>{sG(e)})}function ste(t,e){const n=e.length;let i=0,r;const{iScale:s}=t,{min:o,max:a,minDefined:l,maxDefined:c}=s.getUserBounds();return l&&(i=hi(Ga(e,s.axis,o).lo,0,n-1)),c?r=hi(Ga(e,s.axis,a).hi+1,i,n)-i:r=n-i,{start:i,count:r}}var ote={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(t,e,n)=>{if(!n.enabled){HN(t);return}const i=t.width;t.data.datasets.forEach((r,s)=>{const{_data:o,indexAxis:a}=r,l=t.getDatasetMeta(s),c=o||r.data;if(Em([a,t.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const u=t.scales[l.xAxisID];if(u.type!=="linear"&&u.type!=="time"||t.options.parsing)return;let{start:h,count:d}=ste(l,c);const f=n.threshold||4*i;if(d<=f){sG(r);return}it(o)&&(r._data=c,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(m){this._data=m}}));let g;switch(n.algorithm){case"lttb":g=ite(c,h,d,i,n);break;case"min-max":g=rte(c,h,d,i);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}r._decimated=g})},destroy(t){HN(t)}};function ate(t,e,n){const i=t.segments,r=t.points,s=e.points,o=[];for(const a of i){let{start:l,end:c}=a;c=vS(l,c,r);const u=JM(n,r[l],r[c],a.loop);if(!e.segments){o.push({source:a,target:u,start:r[l],end:r[c]});continue}const h=FY(e,u);for(const d of h){const f=JM(n,s[d.start],s[d.end],d.loop),g=$Y(a,r,f);for(const m of g)o.push({source:m,target:d,start:{[n]:kN(u,f,"start",Math.max)},end:{[n]:kN(u,f,"end",Math.min)}})}}return o}function JM(t,e,n,i){if(i)return;let r=e[t],s=n[t];return t==="angle"&&(r=Ii(r),s=Ii(s)),{property:t,start:r,end:s}}function lte(t,e){const{x:n=null,y:i=null}=t||{},r=e.points,s=[];return e.segments.forEach(({start:o,end:a})=>{a=vS(o,a,r);const l=r[o],c=r[a];i!==null?(s.push({x:l.x,y:i}),s.push({x:c.x,y:i})):n!==null&&(s.push({x:n,y:l.y}),s.push({x:n,y:c.y}))}),s}function vS(t,e,n){for(;e>t;e--){const i=n[e];if(!isNaN(i.x)&&!isNaN(i.y))break}return e}function kN(t,e,n,i){return t&&e?i(t[n],e[n]):t?t[n]:e?e[n]:0}function oG(t,e){let n=[],i=!1;return Zt(t)?(i=!0,n=t):n=lte(t,e),n.length?new wS({points:n,options:{tension:0},_loop:i,_fullLoop:i}):null}function DN(t){return t&&t.fill!==!1}function cte(t,e,n){let r=t[e].fill;const s=[e];let o;if(!n)return r;for(;r!==!1&&s.indexOf(r)===-1;){if(!Cn(r))return r;if(o=t[r],!o)return!1;if(o.visible)return r;s.push(r),r=o.fill}return!1}function ute(t,e,n){const i=gte(t);if(st(i))return isNaN(i.value)?!1:i;let r=parseFloat(i);return Cn(r)&&Math.floor(r)===r?hte(i[0],e,r,n):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function hte(t,e,n,i){return(t==="-"||t==="+")&&(n=e+n),n===e||n<0||n>=i?!1:n}function dte(t,e){let n=null;return t==="start"?n=e.bottom:t==="end"?n=e.top:st(t)?n=e.getPixelForValue(t.value):e.getBasePixel&&(n=e.getBasePixel()),n}function fte(t,e,n){let i;return t==="start"?i=n:t==="end"?i=e.options.reverse?e.min:e.max:st(t)?i=t.value:i=e.getBaseValue(),i}function gte(t){const e=t.options,n=e.fill;let i=Ne(n&&n.target,n);return i===void 0&&(i=!!e.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function mte(t){const{scale:e,index:n,line:i}=t,r=[],s=i.segments,o=i.points,a=pte(e,n);a.push(oG({x:null,y:e.bottom},i));for(let l=0;l<s.length;l++){const c=s[l];for(let u=c.start;u<=c.end;u++)wte(r,o[u],a)}return new wS({points:r,options:{}})}function pte(t,e){const n=[],i=t.getMatchingVisibleMetas("line");for(let r=0;r<i.length;r++){const s=i[r];if(s.index===e)break;s.hidden||n.unshift(s.dataset)}return n}function wte(t,e,n){const i=[];for(let r=0;r<n.length;r++){const s=n[r],{first:o,last:a,point:l}=vte(s,e,"x");if(!(!l||o&&a)){if(o)i.unshift(l);else if(t.push(l),!a)break}}t.push(...i)}function vte(t,e,n){const i=t.interpolate(e,n);if(!i)return{};const r=i[n],s=t.segments,o=t.points;let a=!1,l=!1;for(let c=0;c<s.length;c++){const u=s[c],h=o[u.start][n],d=o[u.end][n];if(Ya(r,h,d)){a=r===h,l=r===d;break}}return{first:a,last:l,point:i}}class aG{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,n,i){const{x:r,y:s,radius:o}=this;return n=n||{start:0,end:Wt},e.arc(r,s,o,n.end,n.start,!0),!i.bounds}interpolate(e){const{x:n,y:i,radius:r}=this,s=e.angle;return{x:n+Math.cos(s)*r,y:i+Math.sin(s)*r,angle:s}}}function bte(t){const{chart:e,fill:n,line:i}=t;if(Cn(n))return yte(e,n);if(n==="stack")return mte(t);if(n==="shape")return!0;const r=Cte(t);return r instanceof aG?r:oG(r,i)}function yte(t,e){const n=t.getDatasetMeta(e);return n&&t.isDatasetVisible(e)?n.dataset:null}function Cte(t){return(t.scale||{}).getPointPositionForValue?Rte(t):Ste(t)}function Ste(t){const{scale:e={},fill:n}=t,i=dte(n,e);if(Cn(i)){const r=e.isHorizontal();return{x:r?i:null,y:r?null:i}}return null}function Rte(t){const{scale:e,fill:n}=t,i=e.options,r=e.getLabels().length,s=i.reverse?e.max:e.min,o=fte(n,e,s),a=[];if(i.grid.circular){const l=e.getPointPositionForValue(0,s);return new aG({x:l.x,y:l.y,radius:e.getDistanceFromCenterForValue(o)})}for(let l=0;l<r;++l)a.push(e.getPointPositionForValue(l,o));return a}function J0(t,e,n){const i=bte(e),{chart:r,index:s,line:o,scale:a,axis:l}=e,c=o.options,u=c.fill,h=c.backgroundColor,{above:d=h,below:f=h}=u||{},g=r.getDatasetMeta(s),m=VY(r,g);i&&o.points.length&&(fS(t,n),_te(t,{line:o,target:i,above:d,below:f,area:n,scale:a,axis:l,clip:m}),gS(t))}function _te(t,e){const{line:n,target:i,above:r,below:s,area:o,scale:a,clip:l}=e,c=n._loop?"angle":e.axis;t.save();let u=s;s!==r&&(c==="x"?(NN(t,i,o.top),Z0(t,{line:n,target:i,color:r,scale:a,property:c,clip:l}),t.restore(),t.save(),NN(t,i,o.bottom)):c==="y"&&(LN(t,i,o.left),Z0(t,{line:n,target:i,color:s,scale:a,property:c,clip:l}),t.restore(),t.save(),LN(t,i,o.right),u=r)),Z0(t,{line:n,target:i,color:u,scale:a,property:c,clip:l}),t.restore()}function NN(t,e,n){const{segments:i,points:r}=e;let s=!0,o=!1;t.beginPath();for(const a of i){const{start:l,end:c}=a,u=r[l],h=r[vS(l,c,r)];s?(t.moveTo(u.x,u.y),s=!1):(t.lineTo(u.x,n),t.lineTo(u.x,u.y)),o=!!e.pathSegment(t,a,{move:o}),o?t.closePath():t.lineTo(h.x,n)}t.lineTo(e.first().x,n),t.closePath(),t.clip()}function LN(t,e,n){const{segments:i,points:r}=e;let s=!0,o=!1;t.beginPath();for(const a of i){const{start:l,end:c}=a,u=r[l],h=r[vS(l,c,r)];s?(t.moveTo(u.x,u.y),s=!1):(t.lineTo(n,u.y),t.lineTo(u.x,u.y)),o=!!e.pathSegment(t,a,{move:o}),o?t.closePath():t.lineTo(n,h.y)}t.lineTo(n,e.first().y),t.closePath(),t.clip()}function Z0(t,e){const{line:n,target:i,property:r,color:s,scale:o,clip:a}=e,l=ate(n,i,r);for(const{source:c,target:u,start:h,end:d}of l){const{style:{backgroundColor:f=s}={}}=c,g=i!==!0;t.save(),t.fillStyle=f,Ete(t,o,a,g&&JM(r,h,d)),t.beginPath();const m=!!n.pathSegment(t,c);let p;if(g){m?t.closePath():$N(t,i,d,r);const v=!!i.pathSegment(t,u,{move:m,reverse:!0});p=m&&v,p||$N(t,i,h,r)}t.closePath(),t.fill(p?"evenodd":"nonzero"),t.restore()}}function Ete(t,e,n,i){const r=e.chart.chartArea,{property:s,start:o,end:a}=i||{};if(s==="x"||s==="y"){let l,c,u,h;s==="x"?(l=o,c=r.top,u=a,h=r.bottom):(l=r.left,c=o,u=r.right,h=a),t.beginPath(),n&&(l=Math.max(l,n.left),u=Math.min(u,n.right),c=Math.max(c,n.top),h=Math.min(h,n.bottom)),t.rect(l,c,u-l,h-c),t.clip()}}function $N(t,e,n,i){const r=e.interpolate(n,i);r&&t.lineTo(r.x,r.y)}var xte={id:"filler",afterDatasetsUpdate(t,e,n){const i=(t.data.datasets||[]).length,r=[];let s,o,a,l;for(o=0;o<i;++o)s=t.getDatasetMeta(o),a=s.dataset,l=null,a&&a.options&&a instanceof wS&&(l={visible:t.isDatasetVisible(o),index:o,fill:ute(a,o,i),chart:t,axis:s.controller.options.indexAxis,scale:s.vScale,line:a}),s.$filler=l,r.push(l);for(o=0;o<i;++o)l=r[o],!(!l||l.fill===!1)&&(l.fill=cte(r,o,n.propagate))},beforeDraw(t,e,n){const i=n.drawTime==="beforeDraw",r=t.getSortedVisibleDatasetMetas(),s=t.chartArea;for(let o=r.length-1;o>=0;--o){const a=r[o].$filler;a&&(a.line.updateControlPoints(s,a.axis),i&&a.fill&&J0(t.ctx,a,s))}},beforeDatasetsDraw(t,e,n){if(n.drawTime!=="beforeDatasetsDraw")return;const i=t.getSortedVisibleDatasetMetas();for(let r=i.length-1;r>=0;--r){const s=i[r].$filler;DN(s)&&J0(t.ctx,s,t.chartArea)}},beforeDatasetDraw(t,e,n){const i=e.meta.$filler;!DN(i)||n.drawTime!=="beforeDatasetDraw"||J0(t.ctx,i,t.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const FN=(t,e)=>{let{boxHeight:n=e,boxWidth:i=e}=t;return t.usePointStyle&&(n=Math.min(n,e),i=t.pointStyleWidth||Math.min(i,e)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(e,n)}},Tte=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class VN extends hl{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,i){this.maxWidth=e,this.maxHeight=n,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=Dt(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(i=>e.filter(i,this.chart.data))),e.sort&&(n=n.sort((i,r)=>e.sort(i,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const i=e.labels,r=Zn(i.font),s=r.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=FN(i,s);let c,u;n.font=r.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(o,s,a,l)+10):(u=this.maxHeight,c=this._fitCols(o,r,a,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,n,i,r){const{ctx:s,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=r+a;let h=e;s.textAlign="left",s.textBaseline="middle";let d=-1,f=-u;return this.legendItems.forEach((g,m)=>{const p=i+n/2+s.measureText(g.text).width;(m===0||c[c.length-1]+p+2*a>o)&&(h+=u,c[c.length-(m>0?0:1)]=0,f+=u,d++),l[m]={left:0,top:f,row:d,width:p,height:r},c[c.length-1]+=p+a}),h}_fitCols(e,n,i,r){const{ctx:s,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=o-e;let h=a,d=0,f=0,g=0,m=0;return this.legendItems.forEach((p,v)=>{const{itemWidth:b,itemHeight:R}=Mte(i,n,s,p,r);v>0&&f+R+2*a>u&&(h+=d+a,c.push({width:d,height:f}),g+=d+a,m++,d=f=0),l[v]={left:g,top:f,col:m,width:b,height:R},d=Math.max(d,b),f+=R+a}),h+=d,c.push({width:d,height:f}),h}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:i,labels:{padding:r},rtl:s}}=this,o=cf(s,this.left,this.width);if(this.isHorizontal()){let a=0,l=Pi(i,this.left+r,this.right-this.lineWidths[a]);for(const c of n)a!==c.row&&(a=c.row,l=Pi(i,this.left+r,this.right-this.lineWidths[a])),c.top+=this.top+e+r,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+r}else{let a=0,l=Pi(i,this.top+e+r,this.bottom-this.columnSizes[a].height);for(const c of n)c.col!==a&&(a=c.col,l=Pi(i,this.top+e+r,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+r,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;fS(e,this),this._draw(),gS(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:i,ctx:r}=this,{align:s,labels:o}=e,a=Qt.color,l=cf(e.rtl,this.left,this.width),c=Zn(o.font),{padding:u}=o,h=c.size,d=h/2;let f;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=c.string;const{boxWidth:g,boxHeight:m,itemHeight:p}=FN(o,h),v=function(M,T,O){if(isNaN(g)||g<=0||isNaN(m)||m<0)return;r.save();const W=Ne(O.lineWidth,1);if(r.fillStyle=Ne(O.fillStyle,a),r.lineCap=Ne(O.lineCap,"butt"),r.lineDashOffset=Ne(O.lineDashOffset,0),r.lineJoin=Ne(O.lineJoin,"miter"),r.lineWidth=W,r.strokeStyle=Ne(O.strokeStyle,a),r.setLineDash(Ne(O.lineDash,[])),o.usePointStyle){const N={radius:m*Math.SQRT2/2,pointStyle:O.pointStyle,rotation:O.rotation,borderWidth:W},G=l.xPlus(M,g/2),j=T+d;TY(r,N,G,j,o.pointStyleWidth&&g)}else{const N=T+Math.max((h-m)/2,0),G=l.leftForLtr(M,g),j=uh(O.borderRadius);r.beginPath(),Object.values(j).some(ne=>ne!==0)?_p(r,{x:G,y:N,w:g,h:m,radius:j}):r.rect(G,N,g,m),r.fill(),W!==0&&r.stroke()}r.restore()},b=function(M,T,O){Rh(r,O.text,M,T+p/2,c,{strikethrough:O.hidden,textAlign:l.textAlign(O.textAlign)})},R=this.isHorizontal(),S=this._computeTitleHeight();R?f={x:Pi(s,this.left+u,this.right-i[0]),y:this.top+u+S,line:0}:f={x:this.left+u,y:Pi(s,this.top+S+u,this.bottom-n[0].height),line:0},DY(this.ctx,e.textDirection);const x=p+u;this.legendItems.forEach((M,T)=>{r.strokeStyle=M.fontColor,r.fillStyle=M.fontColor;const O=r.measureText(M.text).width,W=l.textAlign(M.textAlign||(M.textAlign=o.textAlign)),N=g+d+O;let G=f.x,j=f.y;l.setWidth(this.width),R?T>0&&G+N+u>this.right&&(j=f.y+=x,f.line++,G=f.x=Pi(s,this.left+u,this.right-i[f.line])):T>0&&j+x>this.bottom&&(G=f.x=G+n[f.line].width+u,f.line++,j=f.y=Pi(s,this.top+S+u,this.bottom-n[f.line].height));const ne=l.x(G);if(v(ne,j,M),G=$J(W,G+g+d,R?G+N:this.right,e.rtl),b(l.x(G),j,M),R)f.x+=N+u;else if(typeof M.text!="string"){const ee=c.lineHeight;f.y+=lG(M,ee)+u}else f.y+=x}),NY(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,i=Zn(n.font),r=Li(n.padding);if(!n.display)return;const s=cf(e.rtl,this.left,this.width),o=this.ctx,a=n.position,l=i.size/2,c=r.top+l;let u,h=this.left,d=this.width;if(this.isHorizontal())d=Math.max(...this.lineWidths),u=this.top+c,h=Pi(e.align,h,this.right-d);else{const g=this.columnSizes.reduce((m,p)=>Math.max(m,p.height),0);u=c+Pi(e.align,this.top,this.bottom-g-e.labels.padding-this._computeTitleHeight())}const f=Pi(a,h,h+d);o.textAlign=s.textAlign(YA(a)),o.textBaseline="middle",o.strokeStyle=n.color,o.fillStyle=n.color,o.font=i.string,Rh(o,n.text,f,u,i)}_computeTitleHeight(){const e=this.options.title,n=Zn(e.font),i=Li(e.padding);return e.display?n.lineHeight+i.height:0}_getLegendItemAt(e,n){let i,r,s;if(Ya(e,this.left,this.right)&&Ya(n,this.top,this.bottom)){for(s=this.legendHitBoxes,i=0;i<s.length;++i)if(r=s[i],Ya(e,r.left,r.left+r.width)&&Ya(n,r.top,r.top+r.height))return this.legendItems[i]}return null}handleEvent(e){const n=this.options;if(!Ite(e.type,n))return;const i=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,s=Tte(r,i);r&&!s&&Dt(n.onLeave,[e,r,this],this),this._hoveredItem=i,i&&!s&&Dt(n.onHover,[e,i,this],this)}else i&&Dt(n.onClick,[e,i,this],this)}}function Mte(t,e,n,i,r){const s=Pte(i,t,e,n),o=Ate(r,i,e.lineHeight);return{itemWidth:s,itemHeight:o}}function Pte(t,e,n,i){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((s,o)=>s.length>o.length?s:o)),e+n.size/2+i.measureText(r).width}function Ate(t,e,n){let i=t;return typeof e.text!="string"&&(i=lG(e,n)),i}function lG(t,e){const n=t.text?t.text.length:0;return e*n}function Ite(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var Ote={id:"legend",_element:VN,start(t,e,n){const i=t.legend=new VN({ctx:t.ctx,options:n,chart:t});Di.configure(t,i,n),Di.addBox(t,i)},stop(t){Di.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const i=t.legend;Di.configure(t,i,n),i.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const i=e.datasetIndex,r=n.chart;r.isDatasetVisible(i)?(r.hide(i),e.hidden=!0):(r.show(i),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:r,color:s,useBorderRadius:o,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(n?0:void 0),u=Li(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:s,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:i||c.pointStyle,rotation:c.rotation,textAlign:r||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class iI extends hl{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=n;const r=Zt(i.text)?i.text.length:1;this._padding=Li(i.padding);const s=r*Zn(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:n,left:i,bottom:r,right:s,options:o}=this,a=o.align;let l=0,c,u,h;return this.isHorizontal()?(u=Pi(a,i,s),h=n+e,c=s-i):(o.position==="left"?(u=i+e,h=Pi(a,r,n),l=ft*-.5):(u=s-e,h=Pi(a,n,r),l=ft*.5),c=r-n),{titleX:u,titleY:h,maxWidth:c,rotation:l}}draw(){const e=this.ctx,n=this.options;if(!n.display)return;const i=Zn(n.font),s=i.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(s);Rh(e,n.text,0,0,i,{color:n.color,maxWidth:l,rotation:c,textAlign:YA(n.align),textBaseline:"middle",translation:[o,a]})}}function Hte(t,e){const n=new iI({ctx:t.ctx,options:e,chart:t});Di.configure(t,n,e),Di.addBox(t,n),t.titleBlock=n}var kte={id:"title",_element:iI,start(t,e,n){Hte(t,n)},stop(t){const e=t.titleBlock;Di.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const i=t.titleBlock;Di.configure(t,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const sv=new WeakMap;var Dte={id:"subtitle",start(t,e,n){const i=new iI({ctx:t.ctx,options:n,chart:t});Di.configure(t,i,n),Di.addBox(t,i),sv.set(t,i)},stop(t){Di.removeBox(t,sv.get(t)),sv.delete(t)},beforeUpdate(t,e,n){const i=sv.get(t);Di.configure(t,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Tm={average(t){if(!t.length)return!1;let e,n,i=new Set,r=0,s=0;for(e=0,n=t.length;e<n;++e){const a=t[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();i.add(l.x),r+=l.y,++s}}return s===0||i.size===0?!1:{x:[...i].reduce((a,l)=>a+l)/i.size,y:r/s}},nearest(t,e){if(!t.length)return!1;let n=e.x,i=e.y,r=Number.POSITIVE_INFINITY,s,o,a;for(s=0,o=t.length;s<o;++s){const l=t[s].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=zM(e,c);u<r&&(r=u,a=l)}}if(a){const l=a.tooltipPosition();n=l.x,i=l.y}return{x:n,y:i}}};function Lo(t,e){return e&&(Zt(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function Na(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function Nte(t,e){const{element:n,datasetIndex:i,index:r}=e,s=t.getDatasetMeta(i).controller,{label:o,value:a}=s.getLabelAndValue(r);return{chart:t,label:o,parsed:s.getParsed(r),raw:t.data.datasets[i].data[r],formattedValue:a,dataset:s.getDataset(),dataIndex:r,datasetIndex:i,element:n}}function BN(t,e){const n=t.chart.ctx,{body:i,footer:r,title:s}=t,{boxWidth:o,boxHeight:a}=e,l=Zn(e.bodyFont),c=Zn(e.titleFont),u=Zn(e.footerFont),h=s.length,d=r.length,f=i.length,g=Li(e.padding);let m=g.height,p=0,v=i.reduce((S,x)=>S+x.before.length+x.lines.length+x.after.length,0);if(v+=t.beforeBody.length+t.afterBody.length,h&&(m+=h*c.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),v){const S=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;m+=f*S+(v-f)*l.lineHeight+(v-1)*e.bodySpacing}d&&(m+=e.footerMarginTop+d*u.lineHeight+(d-1)*e.footerSpacing);let b=0;const R=function(S){p=Math.max(p,n.measureText(S).width+b)};return n.save(),n.font=c.string,Mt(t.title,R),n.font=l.string,Mt(t.beforeBody.concat(t.afterBody),R),b=e.displayColors?o+2+e.boxPadding:0,Mt(i,S=>{Mt(S.before,R),Mt(S.lines,R),Mt(S.after,R)}),b=0,n.font=u.string,Mt(t.footer,R),n.restore(),p+=g.width,{width:p,height:m}}function Lte(t,e){const{y:n,height:i}=e;return n<i/2?"top":n>t.height-i/2?"bottom":"center"}function $te(t,e,n,i){const{x:r,width:s}=i,o=n.caretSize+n.caretPadding;if(t==="left"&&r+s+o>e.width||t==="right"&&r-s-o<0)return!0}function Fte(t,e,n,i){const{x:r,width:s}=n,{width:o,chartArea:{left:a,right:l}}=t;let c="center";return i==="center"?c=r<=(a+l)/2?"left":"right":r<=s/2?c="left":r>=o-s/2&&(c="right"),$te(c,t,e,n)&&(c="center"),c}function WN(t,e,n){const i=n.yAlign||e.yAlign||Lte(t,n);return{xAlign:n.xAlign||e.xAlign||Fte(t,e,n,i),yAlign:i}}function Vte(t,e){let{x:n,width:i}=t;return e==="right"?n-=i:e==="center"&&(n-=i/2),n}function Bte(t,e,n){let{y:i,height:r}=t;return e==="top"?i+=n:e==="bottom"?i-=r+n:i-=r/2,i}function jN(t,e,n,i){const{caretSize:r,caretPadding:s,cornerRadius:o}=t,{xAlign:a,yAlign:l}=n,c=r+s,{topLeft:u,topRight:h,bottomLeft:d,bottomRight:f}=uh(o);let g=Vte(e,a);const m=Bte(e,l,c);return l==="center"?a==="left"?g+=c:a==="right"&&(g-=c):a==="left"?g-=Math.max(u,d)+r:a==="right"&&(g+=Math.max(h,f)+r),{x:hi(g,0,i.width-e.width),y:hi(m,0,i.height-e.height)}}function ov(t,e,n){const i=Li(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-i.right:t.x+i.left}function zN(t){return Lo([],Na(t))}function Wte(t,e,n){return Hc(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function UN(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const cG={beforeTitle:ba,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,i=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(i>0&&e.dataIndex<i)return n[e.dataIndex]}return""},afterTitle:ba,beforeBody:ba,beforeLabel:ba,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return it(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:ba,afterBody:ba,beforeFooter:ba,footer:ba,afterFooter:ba};function ar(t,e,n,i){const r=t[e].call(n,i);return typeof r>"u"?cG[e].call(n,i):r}class YN extends hl{static positioners=Tm;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,i=this.options.setContext(this.getContext()),r=i.enabled&&n.options.animation&&i.animations,s=new BY(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=Wte(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:i}=n,r=ar(i,"beforeTitle",this,e),s=ar(i,"title",this,e),o=ar(i,"afterTitle",this,e);let a=[];return a=Lo(a,Na(r)),a=Lo(a,Na(s)),a=Lo(a,Na(o)),a}getBeforeBody(e,n){return zN(ar(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:i}=n,r=[];return Mt(e,s=>{const o={before:[],lines:[],after:[]},a=UN(i,s);Lo(o.before,Na(ar(a,"beforeLabel",this,s))),Lo(o.lines,ar(a,"label",this,s)),Lo(o.after,Na(ar(a,"afterLabel",this,s))),r.push(o)}),r}getAfterBody(e,n){return zN(ar(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:i}=n,r=ar(i,"beforeFooter",this,e),s=ar(i,"footer",this,e),o=ar(i,"afterFooter",this,e);let a=[];return a=Lo(a,Na(r)),a=Lo(a,Na(s)),a=Lo(a,Na(o)),a}_createItems(e){const n=this._active,i=this.chart.data,r=[],s=[],o=[];let a=[],l,c;for(l=0,c=n.length;l<c;++l)a.push(Nte(this.chart,n[l]));return e.filter&&(a=a.filter((u,h,d)=>e.filter(u,h,d,i))),e.itemSort&&(a=a.sort((u,h)=>e.itemSort(u,h,i))),Mt(a,u=>{const h=UN(e.callbacks,u);r.push(ar(h,"labelColor",this,u)),s.push(ar(h,"labelPointStyle",this,u)),o.push(ar(h,"labelTextColor",this,u))}),this.labelColors=r,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=a,a}update(e,n){const i=this.options.setContext(this.getContext()),r=this._active;let s,o=[];if(!r.length)this.opacity!==0&&(s={opacity:0});else{const a=Tm[i.position].call(this,r,this._eventPosition);o=this._createItems(i),this.title=this.getTitle(o,i),this.beforeBody=this.getBeforeBody(o,i),this.body=this.getBody(o,i),this.afterBody=this.getAfterBody(o,i),this.footer=this.getFooter(o,i);const l=this._size=BN(this,i),c=Object.assign({},a,l),u=WN(this.chart,i,c),h=jN(i,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,s={opacity:1,x:h.x,y:h.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,i,r){const s=this.getCaretPosition(e,i,r);n.lineTo(s.x1,s.y1),n.lineTo(s.x2,s.y2),n.lineTo(s.x3,s.y3)}getCaretPosition(e,n,i){const{xAlign:r,yAlign:s}=this,{caretSize:o,cornerRadius:a}=i,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:h}=uh(a),{x:d,y:f}=e,{width:g,height:m}=n;let p,v,b,R,S,x;return s==="center"?(S=f+m/2,r==="left"?(p=d,v=p-o,R=S+o,x=S-o):(p=d+g,v=p+o,R=S-o,x=S+o),b=p):(r==="left"?v=d+Math.max(l,u)+o:r==="right"?v=d+g-Math.max(c,h)-o:v=this.caretX,s==="top"?(R=f,S=R-o,p=v-o,b=v+o):(R=f+m,S=R+o,p=v+o,b=v-o),x=R),{x1:p,x2:v,x3:b,y1:R,y2:S,y3:x}}drawTitle(e,n,i){const r=this.title,s=r.length;let o,a,l;if(s){const c=cf(i.rtl,this.x,this.width);for(e.x=ov(this,i.titleAlign,i),n.textAlign=c.textAlign(i.titleAlign),n.textBaseline="middle",o=Zn(i.titleFont),a=i.titleSpacing,n.fillStyle=i.titleColor,n.font=o.string,l=0;l<s;++l)n.fillText(r[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===s&&(e.y+=i.titleMarginBottom-a)}}_drawColorBox(e,n,i,r,s){const o=this.labelColors[i],a=this.labelPointStyles[i],{boxHeight:l,boxWidth:c}=s,u=Zn(s.bodyFont),h=ov(this,"left",s),d=r.x(h),f=l<u.lineHeight?(u.lineHeight-l)/2:0,g=n.y+f;if(s.usePointStyle){const m={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},p=r.leftForLtr(d,c)+c/2,v=g+l/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,YM(e,m,p,v),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,YM(e,m,p,v)}else{e.lineWidth=st(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const m=r.leftForLtr(d,c),p=r.leftForLtr(r.xPlus(d,1),c-2),v=uh(o.borderRadius);Object.values(v).some(b=>b!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,_p(e,{x:m,y:g,w:c,h:l,radius:v}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),_p(e,{x:p,y:g+1,w:c-2,h:l-2,radius:v}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(m,g,c,l),e.strokeRect(m,g,c,l),e.fillStyle=o.backgroundColor,e.fillRect(p,g+1,c-2,l-2))}e.fillStyle=this.labelTextColors[i]}drawBody(e,n,i){const{body:r}=this,{bodySpacing:s,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=i,h=Zn(i.bodyFont);let d=h.lineHeight,f=0;const g=cf(i.rtl,this.x,this.width),m=function(O){n.fillText(O,g.x(e.x+f),e.y+d/2),e.y+=d+s},p=g.textAlign(o);let v,b,R,S,x,M,T;for(n.textAlign=o,n.textBaseline="middle",n.font=h.string,e.x=ov(this,p,i),n.fillStyle=i.bodyColor,Mt(this.beforeBody,m),f=a&&p!=="right"?o==="center"?c/2+u:c+2+u:0,S=0,M=r.length;S<M;++S){for(v=r[S],b=this.labelTextColors[S],n.fillStyle=b,Mt(v.before,m),R=v.lines,a&&R.length&&(this._drawColorBox(n,e,S,g,i),d=Math.max(h.lineHeight,l)),x=0,T=R.length;x<T;++x)m(R[x]),d=h.lineHeight;Mt(v.after,m)}f=0,d=h.lineHeight,Mt(this.afterBody,m),e.y-=s}drawFooter(e,n,i){const r=this.footer,s=r.length;let o,a;if(s){const l=cf(i.rtl,this.x,this.width);for(e.x=ov(this,i.footerAlign,i),e.y+=i.footerMarginTop,n.textAlign=l.textAlign(i.footerAlign),n.textBaseline="middle",o=Zn(i.footerFont),n.fillStyle=i.footerColor,n.font=o.string,a=0;a<s;++a)n.fillText(r[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+i.footerSpacing}}drawBackground(e,n,i,r){const{xAlign:s,yAlign:o}=this,{x:a,y:l}=e,{width:c,height:u}=i,{topLeft:h,topRight:d,bottomLeft:f,bottomRight:g}=uh(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(a+h,l),o==="top"&&this.drawCaret(e,n,i,r),n.lineTo(a+c-d,l),n.quadraticCurveTo(a+c,l,a+c,l+d),o==="center"&&s==="right"&&this.drawCaret(e,n,i,r),n.lineTo(a+c,l+u-g),n.quadraticCurveTo(a+c,l+u,a+c-g,l+u),o==="bottom"&&this.drawCaret(e,n,i,r),n.lineTo(a+f,l+u),n.quadraticCurveTo(a,l+u,a,l+u-f),o==="center"&&s==="left"&&this.drawCaret(e,n,i,r),n.lineTo(a,l+h),n.quadraticCurveTo(a,l,a+h,l),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,i=this.$animations,r=i&&i.x,s=i&&i.y;if(r||s){const o=Tm[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=BN(this,e),l=Object.assign({},o,this._size),c=WN(n,e,l),u=jN(e,l,c,n);(r._to!==u.x||s._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},s={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const o=Li(n.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&a&&(e.save(),e.globalAlpha=i,this.drawBackground(s,e,r,n),DY(e,n.textDirection),s.y+=o.top,this.drawTitle(s,e,n),this.drawBody(s,e,n),this.drawFooter(s,e,n),NY(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const i=this._active,r=e.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),s=!My(i,r),o=this._positionChanged(r,n);(s||o)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,i=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,s=this._active||[],o=this._getActiveElements(e,s,n,i),a=this._positionChanged(o,e),l=n||!My(o,s)||a;return l&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),l}_getActiveElements(e,n,i,r){const s=this.options;if(e.type==="mouseout")return[];if(!r)return n.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,s.mode,s,i);return s.reverse&&o.reverse(),o}_positionChanged(e,n){const{caretX:i,caretY:r,options:s}=this,o=Tm[s.position].call(this,e,n);return o!==!1&&(i!==o.x||r!==o.y)}}var jte={id:"tooltip",_element:YN,positioners:Tm,afterInit(t,e,n){n&&(t.tooltip=new YN({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:cG},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},zte=Object.freeze({__proto__:null,Colors:nte,Decimation:ote,Filler:xte,Legend:Ote,SubTitle:Dte,Title:kte,Tooltip:jte});const Ute=(t,e,n,i)=>(typeof e=="string"?(n=t.push(e)-1,i.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function Yte(t,e,n,i){const r=t.indexOf(e);if(r===-1)return Ute(t,e,n,i);const s=t.lastIndexOf(e);return r!==s?n:r}const Gte=(t,e)=>t===null?null:hi(Math.round(t),0,e);function GN(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class qte extends kh{static id="category";static defaults={ticks:{callback:GN}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const i=this.getLabels();for(const{index:r,label:s}of n)i[r]===s&&i.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(it(e))return null;const i=this.getLabels();return n=isFinite(n)&&i[n]===e?n:Yte(i,e,Ne(n,e),this._addedLabels),Gte(n,i.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:i,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(i=0),n||(r=this.getLabels().length-1)),this.min=i,this.max=r}buildTicks(){const e=this.min,n=this.max,i=this.options.offset,r=[];let s=this.getLabels();s=e===0&&n===s.length-1?s:s.slice(e,n+1),this._valueRange=Math.max(s.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let o=e;o<=n;o++)r.push({value:o});return r}getLabelForValue(e){return GN.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function Kte(t,e){const n=[],{bounds:r,step:s,min:o,max:a,precision:l,count:c,maxTicks:u,maxDigits:h,includeBounds:d}=t,f=s||1,g=u-1,{min:m,max:p}=e,v=!it(o),b=!it(a),R=!it(c),S=(p-m)/(h+1);let x=BD((p-m)/g/f)*f,M,T,O,W;if(x<1e-14&&!v&&!b)return[{value:m},{value:p}];W=Math.ceil(p/x)-Math.floor(m/x),W>g&&(x=BD(W*x/g/f)*f),it(l)||(M=Math.pow(10,l),x=Math.ceil(x*M)/M),r==="ticks"?(T=Math.floor(m/x)*x,O=Math.ceil(p/x)*x):(T=m,O=p),v&&b&&s&&IJ((a-o)/s,x/1e3)?(W=Math.round(Math.min((a-o)/x,u)),x=(a-o)/W,T=o,O=a):R?(T=v?o:T,O=b?a:O,W=c-1,x=(O-T)/W):(W=(O-T)/x,Wm(W,Math.round(W),x/1e3)?W=Math.round(W):W=Math.ceil(W));const N=Math.max(WD(x),WD(T));M=Math.pow(10,it(l)?N:l),T=Math.round(T*M)/M,O=Math.round(O*M)/M;let G=0;for(v&&(d&&T!==o?(n.push({value:o}),T<o&&G++,Wm(Math.round((T+G*x)*M)/M,o,qN(o,S,t))&&G++):T<o&&G++);G<W;++G){const j=Math.round((T+G*x)*M)/M;if(b&&j>a)break;n.push({value:j})}return b&&d&&O!==a?n.length&&Wm(n[n.length-1].value,a,qN(a,S,t))?n[n.length-1].value=a:n.push({value:a}):(!b||O===a)&&n.push({value:O}),n}function qN(t,e,{horizontal:n,minRotation:i}){const r=no(i),s=(n?Math.sin(r):Math.cos(r))||.001,o=.75*e*(""+t).length;return Math.min(e/s,o)}class Dy extends kh{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return it(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:i}=this.getUserBounds();let{min:r,max:s}=this;const o=l=>r=n?r:l,a=l=>s=i?s:l;if(e){const l=na(r),c=na(s);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(r===s){let l=s===0?1:Math.abs(s*.05);a(s+l),e||o(r-l)}this.min=r,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:i}=e,r;return i?(r=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let i=this.getTickLimit();i=Math.max(2,i);const r={maxTicks:i,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},s=this._range||this,o=Kte(r,s);return e.bounds==="ticks"&&vY(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let n=this.min,i=this.max;if(super.configure(),this.options.offset&&e.length){const r=(i-n)/Math.max(e.length-1,1)/2;n-=r,i+=r}this._startValue=n,this._endValue=i,this._valueRange=i-n}getLabelForValue(e){return tw(e,this.chart.options.locale,this.options.ticks.format)}}class Xte extends Dy{static id="linear";static defaults={ticks:{callback:dS.formatters.numeric}};determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Cn(e)?e:0,this.max=Cn(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,i=no(this.options.ticks.minRotation),r=(e?Math.sin(i):Math.cos(i))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,s.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const xp=t=>Math.floor(nc(t)),Uc=(t,e)=>Math.pow(10,xp(t)+e);function KN(t){return t/Math.pow(10,xp(t))===1}function XN(t,e,n){const i=Math.pow(10,n),r=Math.floor(t/i);return Math.ceil(e/i)-r}function Jte(t,e){const n=e-t;let i=xp(n);for(;XN(t,e,i)>10;)i++;for(;XN(t,e,i)<10;)i--;return Math.min(i,xp(t))}function Zte(t,{min:e,max:n}){e=jr(t.min,e);const i=[],r=xp(e);let s=Jte(e,n),o=s<0?Math.pow(10,Math.abs(s)):1;const a=Math.pow(10,s),l=r>s?Math.pow(10,r):0,c=Math.round((e-l)*o)/o,u=Math.floor((e-l)/a/10)*a*10;let h=Math.floor((c-u)/Math.pow(10,s)),d=jr(t.min,Math.round((l+u+h*Math.pow(10,s))*o)/o);for(;d<n;)i.push({value:d,major:KN(d),significand:h}),h>=10?h=h<15?15:20:h++,h>=20&&(s++,h=2,o=s>=0?1:o),d=Math.round((l+u+h*Math.pow(10,s))*o)/o;const f=jr(t.max,d);return i.push({value:f,major:KN(f),significand:h}),i}class Qte extends kh{static id="logarithmic";static defaults={ticks:{callback:dS.formatters.logarithmic,major:{enabled:!0}}};constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,n){const i=Dy.prototype.parse.apply(this,[e,n]);if(i===0){this._zero=!0;return}return Cn(i)&&i>0?i:null}determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=Cn(e)?Math.max(0,e):null,this.max=Cn(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!Cn(this._userMin)&&(this.min=e===Uc(this.min,0)?Uc(this.min,-1):Uc(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let i=this.min,r=this.max;const s=a=>i=e?i:a,o=a=>r=n?r:a;i===r&&(i<=0?(s(1),o(10)):(s(Uc(i,-1)),o(Uc(r,1)))),i<=0&&s(Uc(r,-1)),r<=0&&o(Uc(i,1)),this.min=i,this.max=r}buildTicks(){const e=this.options,n={min:this._userMin,max:this._userMax},i=Zte(n,this);return e.bounds==="ticks"&&vY(i,this,"value"),e.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(e){return e===void 0?"0":tw(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=nc(e),this._valueRange=nc(this.max)-nc(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(nc(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const n=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+n*this._valueRange)}}function ZM(t){const e=t.ticks;if(e.display&&t.display){const n=Li(e.backdropPadding);return Ne(e.font&&e.font.size,Qt.font.size)+n.height}return 0}function ene(t,e,n){return n=Zt(n)?n:[n],{w:qJ(t,e.string,n),h:n.length*e.lineHeight}}function JN(t,e,n,i,r){return t===i||t===r?{start:e-n/2,end:e+n/2}:t<i||t>r?{start:e-n,end:e}:{start:e,end:e+n}}function tne(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},n=Object.assign({},e),i=[],r=[],s=t._pointLabels.length,o=t.options.pointLabels,a=o.centerPointLabels?ft/s:0;for(let l=0;l<s;l++){const c=o.setContext(t.getPointLabelContext(l));r[l]=c.padding;const u=t.getPointPosition(l,t.drawingArea+r[l],a),h=Zn(c.font),d=ene(t.ctx,h,t._pointLabels[l]);i[l]=d;const f=Ii(t.getIndexAngle(l)+a),g=Math.round(zA(f)),m=JN(g,u.x,d.w,0,180),p=JN(g,u.y,d.h,90,270);nne(n,e,f,m,p)}t.setCenterPoint(e.l-n.l,n.r-e.r,e.t-n.t,n.b-e.b),t._pointLabelItems=sne(t,i,r)}function nne(t,e,n,i,r){const s=Math.abs(Math.sin(n)),o=Math.abs(Math.cos(n));let a=0,l=0;i.start<e.l?(a=(e.l-i.start)/s,t.l=Math.min(t.l,e.l-a)):i.end>e.r&&(a=(i.end-e.r)/s,t.r=Math.max(t.r,e.r+a)),r.start<e.t?(l=(e.t-r.start)/o,t.t=Math.min(t.t,e.t-l)):r.end>e.b&&(l=(r.end-e.b)/o,t.b=Math.max(t.b,e.b+l))}function ine(t,e,n){const i=t.drawingArea,{extra:r,additionalAngle:s,padding:o,size:a}=n,l=t.getPointPosition(e,i+r+o,s),c=Math.round(zA(Ii(l.angle+Pn))),u=lne(l.y,a.h,c),h=one(c),d=ane(l.x,a.w,h);return{visible:!0,x:l.x,y:u,textAlign:h,left:d,top:u,right:d+a.w,bottom:u+a.h}}function rne(t,e){if(!e)return!0;const{left:n,top:i,right:r,bottom:s}=t;return!(qa({x:n,y:i},e)||qa({x:n,y:s},e)||qa({x:r,y:i},e)||qa({x:r,y:s},e))}function sne(t,e,n){const i=[],r=t._pointLabels.length,s=t.options,{centerPointLabels:o,display:a}=s.pointLabels,l={extra:ZM(s)/2,additionalAngle:o?ft/r:0};let c;for(let u=0;u<r;u++){l.padding=n[u],l.size=e[u];const h=ine(t,u,l);i.push(h),a==="auto"&&(h.visible=rne(h,c),h.visible&&(c=h))}return i}function one(t){return t===0||t===180?"center":t<180?"left":"right"}function ane(t,e,n){return n==="right"?t-=e:n==="center"&&(t-=e/2),t}function lne(t,e,n){return n===90||n===270?t-=e/2:(n>270||n<90)&&(t-=e),t}function cne(t,e,n){const{left:i,top:r,right:s,bottom:o}=n,{backdropColor:a}=e;if(!it(a)){const l=uh(e.borderRadius),c=Li(e.backdropPadding);t.fillStyle=a;const u=i-c.left,h=r-c.top,d=s-i+c.width,f=o-r+c.height;Object.values(l).some(g=>g!==0)?(t.beginPath(),_p(t,{x:u,y:h,w:d,h:f,radius:l}),t.fill()):t.fillRect(u,h,d,f)}}function une(t,e){const{ctx:n,options:{pointLabels:i}}=t;for(let r=e-1;r>=0;r--){const s=t._pointLabelItems[r];if(!s.visible)continue;const o=i.setContext(t.getPointLabelContext(r));cne(n,o,s);const a=Zn(o.font),{x:l,y:c,textAlign:u}=s;Rh(n,t._pointLabels[r],l,c+a.lineHeight/2,a,{color:o.color,textAlign:u,textBaseline:"middle"})}}function uG(t,e,n,i){const{ctx:r}=t;if(n)r.arc(t.xCenter,t.yCenter,e,0,Wt);else{let s=t.getPointPosition(0,e);r.moveTo(s.x,s.y);for(let o=1;o<i;o++)s=t.getPointPosition(o,e),r.lineTo(s.x,s.y)}}function hne(t,e,n,i,r){const s=t.ctx,o=e.circular,{color:a,lineWidth:l}=e;!o&&!i||!a||!l||n<0||(s.save(),s.strokeStyle=a,s.lineWidth=l,s.setLineDash(r.dash||[]),s.lineDashOffset=r.dashOffset,s.beginPath(),uG(t,n,o,i),s.closePath(),s.stroke(),s.restore())}function dne(t,e,n){return Hc(t,{label:n,index:e,type:"pointLabel"})}class fne extends Dy{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:dS.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=Li(ZM(this.options)/2),n=this.width=this.maxWidth-e.width,i=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+n/2+e.left),this.yCenter=Math.floor(this.top+i/2+e.top),this.drawingArea=Math.floor(Math.min(n,i)/2)}determineDataLimits(){const{min:e,max:n}=this.getMinMax(!1);this.min=Cn(e)&&!isNaN(e)?e:0,this.max=Cn(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/ZM(this.options))}generateTickLabels(e){Dy.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((n,i)=>{const r=Dt(this.options.pointLabels.callback,[n,i],this);return r||r===0?r:""}).filter((n,i)=>this.chart.getDataVisibility(i))}fit(){const e=this.options;e.display&&e.pointLabels.display?tne(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,n,i,r){this.xCenter+=Math.floor((e-n)/2),this.yCenter+=Math.floor((i-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,n,i,r))}getIndexAngle(e){const n=Wt/(this._pointLabels.length||1),i=this.options.startAngle||0;return Ii(e*n+no(i))}getDistanceFromCenterForValue(e){if(it(e))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*n:(e-this.min)*n}getValueForDistanceFromCenter(e){if(it(e))return NaN;const n=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(e){const n=this._pointLabels||[];if(e>=0&&e<n.length){const i=n[e];return dne(this.getContext(),e,i)}}getPointPosition(e,n,i=0){const r=this.getIndexAngle(e)-Pn+i;return{x:Math.cos(r)*n+this.xCenter,y:Math.sin(r)*n+this.yCenter,angle:r}}getPointPositionForValue(e,n){return this.getPointPosition(e,this.getDistanceFromCenterForValue(n))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:n,top:i,right:r,bottom:s}=this._pointLabelItems[e];return{left:n,top:i,right:r,bottom:s}}drawBackground(){const{backgroundColor:e,grid:{circular:n}}=this.options;if(e){const i=this.ctx;i.save(),i.beginPath(),uG(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),i.closePath(),i.fillStyle=e,i.fill(),i.restore()}}drawGrid(){const e=this.ctx,n=this.options,{angleLines:i,grid:r,border:s}=n,o=this._pointLabels.length;let a,l,c;if(n.pointLabels.display&&une(this,o),r.display&&this.ticks.forEach((u,h)=>{if(h!==0||h===0&&this.min<0){l=this.getDistanceFromCenterForValue(u.value);const d=this.getContext(h),f=r.setContext(d),g=s.setContext(d);hne(this,f,l,o,g)}}),i.display){for(e.save(),a=o-1;a>=0;a--){const u=i.setContext(this.getPointLabelContext(a)),{color:h,lineWidth:d}=u;!d||!h||(e.lineWidth=d,e.strokeStyle=h,e.setLineDash(u.borderDash),e.lineDashOffset=u.borderDashOffset,l=this.getDistanceFromCenterForValue(n.reverse?this.min:this.max),c=this.getPointPosition(a,l),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(c.x,c.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,n=this.options,i=n.ticks;if(!i.display)return;const r=this.getIndexAngle(0);let s,o;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&this.min>=0&&!n.reverse)return;const c=i.setContext(this.getContext(l)),u=Zn(c.font);if(s=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){e.font=u.string,o=e.measureText(a.label).width,e.fillStyle=c.backdropColor;const h=Li(c.backdropPadding);e.fillRect(-o/2-h.left,-s-u.size/2-h.top,o+h.width,u.size+h.height)}Rh(e,a.label,0,-s,u,{color:c.color,strokeColor:c.textStrokeColor,strokeWidth:c.textStrokeWidth})}),e.restore()}drawTitle(){}}const bS={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Er=Object.keys(bS);function ZN(t,e){return t-e}function QN(t,e){if(it(e))return null;const n=t._adapter,{parser:i,round:r,isoWeekday:s}=t._parseOpts;let o=e;return typeof i=="function"&&(o=i(o)),Cn(o)||(o=typeof i=="string"?n.parse(o,i):n.parse(o)),o===null?null:(r&&(o=r==="week"&&(Rf(s)||s===!0)?n.startOf(o,"isoWeek",s):n.startOf(o,r)),+o)}function eL(t,e,n,i){const r=Er.length;for(let s=Er.indexOf(t);s<r-1;++s){const o=bS[Er[s]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((n-e)/(a*o.size))<=i)return Er[s]}return Er[r-1]}function gne(t,e,n,i,r){for(let s=Er.length-1;s>=Er.indexOf(n);s--){const o=Er[s];if(bS[o].common&&t._adapter.diff(r,i,o)>=e-1)return o}return Er[n?Er.indexOf(n):0]}function mne(t){for(let e=Er.indexOf(t)+1,n=Er.length;e<n;++e)if(bS[Er[e]].common)return Er[e]}function tL(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:i,hi:r}=UA(n,e),s=n[i]>=e?n[i]:n[r];t[s]=!0}}function pne(t,e,n,i){const r=t._adapter,s=+r.startOf(e[0].value,i),o=e[e.length-1].value;let a,l;for(a=s;a<=o;a=+r.add(a,1,i))l=n[a],l>=0&&(e[l].major=!0);return e}function nL(t,e,n){const i=[],r={},s=e.length;let o,a;for(o=0;o<s;++o)a=e[o],r[a]=o,i.push({value:a,major:!1});return s===0||!n?i:pne(t,i,r,n)}class QM extends kh{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const i=e.time||(e.time={}),r=this._adapter=new wQ._date(e.adapters.date);r.init(n),Bm(i.displayFormats,r.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:QN(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,i=e.time.unit||"day";let{min:r,max:s,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(r=Math.min(r,c.min)),!a&&!isNaN(c.max)&&(s=Math.max(s,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=Cn(r)&&!isNaN(r)?r:+n.startOf(Date.now(),i),s=Cn(s)&&!isNaN(s)?s:+n.endOf(Date.now(),i)+1,this.min=Math.min(r,s-1),this.max=Math.max(r+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],i=e[e.length-1]),{min:n,max:i}}buildTicks(){const e=this.options,n=e.time,i=e.ticks,r=i.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const s=this.min,o=this.max,a=DJ(r,s,o);return this._unit=n.unit||(i.autoSkip?eL(n.minUnit,this.min,this.max,this._getLabelCapacity(s)):gne(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:mne(this._unit),this.initOffsets(r),e.reverse&&a.reverse(),nL(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,i=0,r,s;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?n=1-r:n=(this.getDecimalForValue(e[1])-r)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?i=s:i=(s-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;n=hi(n,0,o),i=hi(i,0,o),this._offsets={start:n,end:i,factor:1/(n+1+i)}}_generate(){const e=this._adapter,n=this.min,i=this.max,r=this.options,s=r.time,o=s.unit||eL(s.minUnit,n,i,this._getLabelCapacity(n)),a=Ne(r.ticks.stepSize,1),l=o==="week"?s.isoWeekday:!1,c=Rf(l)||l===!0,u={};let h=n,d,f;if(c&&(h=+e.startOf(h,"isoWeek",l)),h=+e.startOf(h,c?"day":o),e.diff(i,n,o)>1e5*a)throw new Error(n+" and "+i+" are too far apart with stepSize of "+a+" "+o);const g=r.ticks.source==="data"&&this.getDataTimestamps();for(d=h,f=0;d<i;d=+e.add(d,a,o),f++)tL(u,d,g);return(d===i||r.bounds==="ticks"||f===1)&&tL(u,d,g),Object.keys(u).sort(ZN).map(m=>+m)}getLabelForValue(e){const n=this._adapter,i=this.options.time;return i.tooltipFormat?n.format(e,i.tooltipFormat):n.format(e,i.displayFormats.datetime)}format(e,n){const r=this.options.time.displayFormats,s=this._unit,o=n||r[s];return this._adapter.format(e,o)}_tickFormatFunction(e,n,i,r){const s=this.options,o=s.ticks.callback;if(o)return Dt(o,[e,n,i],this);const a=s.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&a[l],h=c&&a[c],d=i[n],f=c&&h&&d&&d.major;return this._adapter.format(e,r||(f?h:u))}generateTickLabels(e){let n,i,r;for(n=0,i=e.length;n<i;++n)r=e[n],r.label=this._tickFormatFunction(r.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,i=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+i)*n.factor)}getValueForPixel(e){const n=this._offsets,i=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+i*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,i=this.ctx.measureText(e).width,r=no(this.isHorizontal()?n.maxRotation:n.minRotation),s=Math.cos(r),o=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:i*s+a*o,h:i*o+a*s}}_getLabelCapacity(e){const n=this.options.time,i=n.displayFormats,r=i[n.unit]||i.millisecond,s=this._tickFormatFunction(e,0,nL(this,[e],this._majorUnit),r),o=this._getLabelSize(s),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],n,i;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,i=r.length;n<i;++n)e=e.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,i;if(e.length)return e;const r=this.getLabels();for(n=0,i=r.length;n<i;++n)e.push(QN(this,r[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return CY(e.sort(ZN))}}function av(t,e,n){let i=0,r=t.length-1,s,o,a,l;n?(e>=t[i].pos&&e<=t[r].pos&&({lo:i,hi:r}=Ga(t,"pos",e)),{pos:s,time:a}=t[i],{pos:o,time:l}=t[r]):(e>=t[i].time&&e<=t[r].time&&({lo:i,hi:r}=Ga(t,"time",e)),{time:s,pos:a}=t[i],{time:o,pos:l}=t[r]);const c=o-s;return c?a+(l-a)*(e-s)/c:a}class wne extends QM{static id="timeseries";static defaults=QM.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=av(n,this.min),this._tableRange=av(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:i}=this,r=[],s=[];let o,a,l,c,u;for(o=0,a=e.length;o<a;++o)c=e[o],c>=n&&c<=i&&r.push(c);if(r.length<2)return[{time:n,pos:0},{time:i,pos:1}];for(o=0,a=r.length;o<a;++o)u=r[o+1],l=r[o-1],c=r[o],Math.round((u+l)/2)!==c&&s.push({time:c,pos:o/(a-1)});return s}_generate(){const e=this.min,n=this.max;let i=super.getDataTimestamps();return(!i.includes(e)||!i.length)&&i.splice(0,0,e),(!i.includes(n)||i.length===1)&&i.push(n),i.sort((r,s)=>r-s)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),i=this.getLabelTimestamps();return n.length&&i.length?e=this.normalize(n.concat(i)):e=n.length?n:i,e=this._cache.all=e,e}getDecimalForValue(e){return(av(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,i=this.getDecimalForPixel(e)/n.factor-n.end;return av(this._table,i*this._tableRange+this._minPos,!0)}}var vne=Object.freeze({__proto__:null,CategoryScale:qte,LinearScale:Xte,LogarithmicScale:Qte,RadialLinearScale:fne,TimeScale:QM,TimeSeriesScale:wne});const bne=[pQ,Kee,zte,vne];nI.register(...bne);function hG(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}function yne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iL(t,e){return t.get(hG(t,e))}function Cne(t,e,n){yne(t,e),e.set(t,n)}function Sne(t,e,n){return t.set(hG(t,e),n),n}const Rne=100,Se={},_ne=()=>{Se.previousActiveElement instanceof HTMLElement?(Se.previousActiveElement.focus(),Se.previousActiveElement=null):document.body&&document.body.focus()},Ene=t=>new Promise(e=>{if(!t)return e();const n=window.scrollX,i=window.scrollY;Se.restoreFocusTimeout=setTimeout(()=>{_ne(),e()},Rne),window.scrollTo(n,i)}),dG="swal2-",xne=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"],K=xne.reduce((t,e)=>(t[e]=dG+e,t),{}),Tne=["success","warning","info","question","error"],Ny=Tne.reduce((t,e)=>(t[e]=dG+e,t),{}),fG="SweetAlert2:",rI=t=>t.charAt(0).toUpperCase()+t.slice(1),tr=t=>{console.warn(`${fG} ${typeof t=="object"?t.join(" "):t}`)},Dh=t=>{console.error(`${fG} ${t}`)},rL=[],Mne=t=>{rL.includes(t)||(rL.push(t),tr(t))},gG=(t,e=null)=>{Mne(`"${t}" is deprecated and will be removed in the next major release.${e?` Use "${e}" instead.`:""}`)},yS=t=>typeof t=="function"?t():t,sI=t=>t&&typeof t.toPromise=="function",nw=t=>sI(t)?t.toPromise():Promise.resolve(t),oI=t=>t&&Promise.resolve(t)===t,rr=()=>document.body.querySelector(`.${K.container}`),iw=t=>{const e=rr();return e?e.querySelector(t):null},ts=t=>iw(`.${t}`),yt=()=>ts(K.popup),Uf=()=>ts(K.icon),Pne=()=>ts(K["icon-content"]),mG=()=>ts(K.title),aI=()=>ts(K["html-container"]),pG=()=>ts(K.image),lI=()=>ts(K["progress-steps"]),CS=()=>ts(K["validation-message"]),aa=()=>iw(`.${K.actions} .${K.confirm}`),Yf=()=>iw(`.${K.actions} .${K.cancel}`),Nh=()=>iw(`.${K.actions} .${K.deny}`),Ane=()=>ts(K["input-label"]),Gf=()=>iw(`.${K.loader}`),rw=()=>ts(K.actions),wG=()=>ts(K.footer),SS=()=>ts(K["timer-progress-bar"]),cI=()=>ts(K.close),Ine=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,uI=()=>{const t=yt();if(!t)return[];const e=t.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),n=Array.from(e).sort((s,o)=>{const a=parseInt(s.getAttribute("tabindex")||"0"),l=parseInt(o.getAttribute("tabindex")||"0");return a>l?1:a<l?-1:0}),i=t.querySelectorAll(Ine),r=Array.from(i).filter(s=>s.getAttribute("tabindex")!=="-1");return[...new Set(n.concat(r))].filter(s=>Pr(s))},hI=()=>nl(document.body,K.shown)&&!nl(document.body,K["toast-shown"])&&!nl(document.body,K["no-backdrop"]),RS=()=>{const t=yt();return t?nl(t,K.toast):!1},One=()=>{const t=yt();return t?t.hasAttribute("data-loading"):!1},ns=(t,e)=>{if(t.textContent="",e){const i=new DOMParser().parseFromString(e,"text/html"),r=i.querySelector("head");r&&Array.from(r.childNodes).forEach(o=>{t.appendChild(o)});const s=i.querySelector("body");s&&Array.from(s.childNodes).forEach(o=>{o instanceof HTMLVideoElement||o instanceof HTMLAudioElement?t.appendChild(o.cloneNode(!0)):t.appendChild(o)})}},nl=(t,e)=>{if(!e)return!1;const n=e.split(/\s+/);for(let i=0;i<n.length;i++)if(!t.classList.contains(n[i]))return!1;return!0},Hne=(t,e)=>{Array.from(t.classList).forEach(n=>{!Object.values(K).includes(n)&&!Object.values(Ny).includes(n)&&!Object.values(e.showClass||{}).includes(n)&&t.classList.remove(n)})},Qr=(t,e,n)=>{if(Hne(t,e),!e.customClass)return;const i=e.customClass[n];if(i){if(typeof i!="string"&&!i.forEach){tr(`Invalid type of customClass.${n}! Expected string or iterable object, got "${typeof i}"`);return}bt(t,i)}},_S=(t,e)=>{if(!e)return null;switch(e){case"select":case"textarea":case"file":return t.querySelector(`.${K.popup} > .${K[e]}`);case"checkbox":return t.querySelector(`.${K.popup} > .${K.checkbox} input`);case"radio":return t.querySelector(`.${K.popup} > .${K.radio} input:checked`)||t.querySelector(`.${K.popup} > .${K.radio} input:first-child`);case"range":return t.querySelector(`.${K.popup} > .${K.range} input`);default:return t.querySelector(`.${K.popup} > .${K.input}`)}},vG=t=>{if(t.focus(),t.type!=="file"){const e=t.value;t.value="",t.value=e}},bG=(t,e,n)=>{!t||!e||(typeof e=="string"&&(e=e.split(/\s+/).filter(Boolean)),e.forEach(i=>{Array.isArray(t)?t.forEach(r=>{n?r.classList.add(i):r.classList.remove(i)}):n?t.classList.add(i):t.classList.remove(i)}))},bt=(t,e)=>{bG(t,e,!0)},Ms=(t,e)=>{bG(t,e,!1)},sc=(t,e)=>{const n=Array.from(t.children);for(let i=0;i<n.length;i++){const r=n[i];if(r instanceof HTMLElement&&nl(r,e))return r}},dh=(t,e,n)=>{n===`${parseInt(`${n}`)}`&&(n=parseInt(n)),n||parseInt(`${n}`)===0?t.style.setProperty(e,typeof n=="number"?`${n}px`:n):t.style.removeProperty(e)},di=(t,e="flex")=>{t&&(t.style.display=e)},$i=t=>{t&&(t.style.display="none")},dI=(t,e="block")=>{t&&new MutationObserver(()=>{sw(t,t.innerHTML,e)}).observe(t,{childList:!0,subtree:!0})},sL=(t,e,n,i)=>{const r=t.querySelector(e);r&&r.style.setProperty(n,i)},sw=(t,e,n="flex")=>{e?di(t,n):$i(t)},Pr=t=>!!(t&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)),kne=()=>!Pr(aa())&&!Pr(Nh())&&!Pr(Yf()),eP=t=>t.scrollHeight>t.clientHeight,Dne=(t,e)=>{let n=t;for(;n&&n!==e;){if(eP(n))return!0;n=n.parentElement}return!1},yG=t=>{const e=window.getComputedStyle(t),n=parseFloat(e.getPropertyValue("animation-duration")||"0"),i=parseFloat(e.getPropertyValue("transition-duration")||"0");return n>0||i>0},fI=(t,e=!1)=>{const n=SS();n&&Pr(n)&&(e&&(n.style.transition="none",n.style.width="100%"),setTimeout(()=>{n.style.transition=`width ${t/1e3}s linear`,n.style.width="0%"},10))},Nne=()=>{const t=SS();if(!t)return;const e=parseInt(window.getComputedStyle(t).width);t.style.removeProperty("transition"),t.style.width="100%";const n=parseInt(window.getComputedStyle(t).width),i=e/n*100;t.style.width=`${i}%`},Lne=()=>typeof window>"u"||typeof document>"u",$ne=`
 <div aria-labelledby="${K.title}" aria-describedby="${K["html-container"]}" class="${K.popup}" tabindex="-1">
   <button type="button" class="${K.close}"></button>
   <ul class="${K["progress-steps"]}"></ul>
   <div class="${K.icon}"></div>
   <img class="${K.image}" />
   <h2 class="${K.title}" id="${K.title}"></h2>
   <div class="${K["html-container"]}" id="${K["html-container"]}"></div>
   <input class="${K.input}" id="${K.input}" />
   <input type="file" class="${K.file}" />
   <div class="${K.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${K.select}" id="${K.select}"></select>
   <div class="${K.radio}"></div>
   <label class="${K.checkbox}">
     <input type="checkbox" id="${K.checkbox}" />
     <span class="${K.label}"></span>
   </label>
   <textarea class="${K.textarea}" id="${K.textarea}"></textarea>
   <div class="${K["validation-message"]}" id="${K["validation-message"]}"></div>
   <div class="${K.actions}">
     <div class="${K.loader}"></div>
     <button type="button" class="${K.confirm}"></button>
     <button type="button" class="${K.deny}"></button>
     <button type="button" class="${K.cancel}"></button>
   </div>
   <div class="${K.footer}"></div>
   <div class="${K["timer-progress-bar-container"]}">
     <div class="${K["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),Fne=()=>{const t=rr();return t?(t.remove(),Ms([document.documentElement,document.body],[K["no-backdrop"],K["toast-shown"],K["has-column"]]),!0):!1},Yc=()=>{Se.currentInstance&&Se.currentInstance.resetValidationMessage()},Vne=()=>{const t=yt();if(!t)return;const e=sc(t,K.input),n=sc(t,K.file),i=t.querySelector(`.${K.range} input`),r=t.querySelector(`.${K.range} output`),s=sc(t,K.select),o=t.querySelector(`.${K.checkbox} input`),a=sc(t,K.textarea);e&&(e.oninput=Yc),n&&(n.onchange=Yc),s&&(s.onchange=Yc),o&&(o.onchange=Yc),a&&(a.oninput=Yc),i&&r&&(i.oninput=()=>{Yc(),r.value=i.value},i.onchange=()=>{Yc(),r.value=i.value})},Bne=t=>{if(typeof t=="string"){const e=document.querySelector(t);if(!e)throw new Error(`Target element "${t}" not found`);return e}return t},Wne=t=>{const e=yt();e&&(e.setAttribute("role",t.toast?"alert":"dialog"),e.setAttribute("aria-live",t.toast?"polite":"assertive"),t.toast||e.setAttribute("aria-modal","true"))},jne=t=>{window.getComputedStyle(t).direction==="rtl"&&(bt(rr(),K.rtl),Se.isRTL=!0)},zne=t=>{const e=Fne();if(Lne()){Dh("SweetAlert2 requires document to initialize");return}const n=document.createElement("div");n.className=K.container,e&&bt(n,K["no-transition"]),ns(n,$ne),n.dataset.swal2Theme=t.theme;const i=Bne(t.target||"body");i.appendChild(n),t.topLayer&&(n.setAttribute("popover",""),n.showPopover()),Wne(t),jne(i),Vne()},gI=(t,e)=>{t instanceof HTMLElement?e.appendChild(t):typeof t=="object"?Une(t,e):t&&ns(e,t)},Une=(t,e)=>{"jquery"in t?Yne(e,t):ns(e,t.toString())},Yne=(t,e)=>{if(t.textContent="",0 in e)for(let n=0;n in e;n++)t.appendChild(e[n].cloneNode(!0));else t.appendChild(e.cloneNode(!0))},Gne=(t,e)=>{const n=rw(),i=Gf();!n||!i||(!e.showConfirmButton&&!e.showDenyButton&&!e.showCancelButton?$i(n):di(n),Qr(n,e,"actions"),qne(n,i,e),ns(i,e.loaderHtml||""),Qr(i,e,"loader"))};function qne(t,e,n){const i=aa(),r=Nh(),s=Yf();!i||!r||!s||(eR(i,"confirm",n),eR(r,"deny",n),eR(s,"cancel",n),Kne(i,r,s,n),n.reverseButtons&&(n.toast?(t.insertBefore(s,i),t.insertBefore(r,i)):(t.insertBefore(s,e),t.insertBefore(r,e),t.insertBefore(i,e))))}function Kne(t,e,n,i){if(!i.buttonsStyling){Ms([t,e,n],K.styled);return}bt([t,e,n],K.styled),i.confirmButtonColor&&t.style.setProperty("--swal2-confirm-button-background-color",i.confirmButtonColor),i.denyButtonColor&&e.style.setProperty("--swal2-deny-button-background-color",i.denyButtonColor),i.cancelButtonColor&&n.style.setProperty("--swal2-cancel-button-background-color",i.cancelButtonColor),Q0(t),Q0(e),Q0(n)}function Q0(t){const e=window.getComputedStyle(t);if(e.getPropertyValue("--swal2-action-button-focus-box-shadow"))return;const n=e.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");t.style.setProperty("--swal2-action-button-focus-box-shadow",e.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${n}`))}function eR(t,e,n){const i=rI(e);sw(t,n[`show${i}Button`],"inline-block"),ns(t,n[`${e}ButtonText`]||""),t.setAttribute("aria-label",n[`${e}ButtonAriaLabel`]||""),t.className=K[e],Qr(t,n,`${e}Button`)}const Xne=(t,e)=>{const n=cI();n&&(ns(n,e.closeButtonHtml||""),Qr(n,e,"closeButton"),sw(n,e.showCloseButton),n.setAttribute("aria-label",e.closeButtonAriaLabel||""))},Jne=(t,e)=>{const n=rr();n&&(Zne(n,e.backdrop),Qne(n,e.position),eie(n,e.grow),Qr(n,e,"container"))};function Zne(t,e){typeof e=="string"?t.style.background=e:e||bt([document.documentElement,document.body],K["no-backdrop"])}function Qne(t,e){e&&(e in K?bt(t,K[e]):(tr('The "position" parameter is not valid, defaulting to "center"'),bt(t,K.center)))}function eie(t,e){e&&bt(t,K[`grow-${e}`])}var Lt={innerParams:new WeakMap,domCache:new WeakMap};const tie=["input","file","range","select","radio","checkbox","textarea"],nie=(t,e)=>{const n=yt();if(!n)return;const i=Lt.innerParams.get(t),r=!i||e.input!==i.input;tie.forEach(s=>{const o=sc(n,K[s]);o&&(sie(s,e.inputAttributes),o.className=K[s],r&&$i(o))}),e.input&&(r&&iie(e),oie(e))},iie=t=>{if(!t.input)return;if(!xn[t.input]){Dh(`Unexpected type of input! Expected ${Object.keys(xn).join(" | ")}, got "${t.input}"`);return}const e=CG(t.input);if(!e)return;const n=xn[t.input](e,t);di(e),t.inputAutoFocus&&setTimeout(()=>{vG(n)})},rie=t=>{for(let e=0;e<t.attributes.length;e++){const n=t.attributes[e].name;["id","type","value","style"].includes(n)||t.removeAttribute(n)}},sie=(t,e)=>{const n=yt();if(!n)return;const i=_S(n,t);if(i){rie(i);for(const r in e)i.setAttribute(r,e[r])}},oie=t=>{if(!t.input)return;const e=CG(t.input);e&&Qr(e,t,"input")},mI=(t,e)=>{!t.placeholder&&e.inputPlaceholder&&(t.placeholder=e.inputPlaceholder)},ow=(t,e,n)=>{if(n.inputLabel){const i=document.createElement("label"),r=K["input-label"];i.setAttribute("for",t.id),i.className=r,typeof n.customClass=="object"&&bt(i,n.customClass.inputLabel),i.innerText=n.inputLabel,e.insertAdjacentElement("beforebegin",i)}},CG=t=>{const e=yt();if(e)return sc(e,K[t]||K.input)},Ly=(t,e)=>{["string","number"].includes(typeof e)?t.value=`${e}`:oI(e)||tr(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof e}"`)},xn={};xn.text=xn.email=xn.password=xn.number=xn.tel=xn.url=xn.search=xn.date=xn["datetime-local"]=xn.time=xn.week=xn.month=(t,e)=>{const n=t;return Ly(n,e.inputValue),ow(n,n,e),mI(n,e),n.type=e.input,n};xn.file=(t,e)=>{const n=t;return ow(n,n,e),mI(n,e),n};xn.range=(t,e)=>{const n=t,i=n.querySelector("input"),r=n.querySelector("output");return i&&(Ly(i,e.inputValue),i.type=e.input,ow(i,t,e)),r&&Ly(r,e.inputValue),t};xn.select=(t,e)=>{const n=t;if(n.textContent="",e.inputPlaceholder){const i=document.createElement("option");ns(i,e.inputPlaceholder),i.value="",i.disabled=!0,i.selected=!0,n.appendChild(i)}return ow(n,n,e),n};xn.radio=t=>{const e=t;return e.textContent="",t};xn.checkbox=(t,e)=>{const n=yt();if(!n)throw new Error("Popup not found");const i=_S(n,"checkbox");if(!i)throw new Error("Checkbox input not found");i.value="1",i.checked=!!e.inputValue;const s=t.querySelector("span");if(s){const o=e.inputPlaceholder||e.inputLabel;o&&ns(s,o)}return i};xn.textarea=(t,e)=>{const n=t;Ly(n,e.inputValue),mI(n,e),ow(n,n,e);const i=r=>parseInt(window.getComputedStyle(r).marginLeft)+parseInt(window.getComputedStyle(r).marginRight);return setTimeout(()=>{if("MutationObserver"in window){const r=yt();if(!r)return;const s=parseInt(window.getComputedStyle(r).width),o=()=>{if(!document.body.contains(n))return;const a=n.offsetWidth+i(n),l=yt();l&&(a>s?l.style.width=`${a}px`:dh(l,"width",e.width))};new MutationObserver(o).observe(n,{attributes:!0,attributeFilter:["style"]})}}),n};const aie=(t,e)=>{const n=aI();n&&(dI(n),Qr(n,e,"htmlContainer"),e.html?(gI(e.html,n),di(n,"block")):e.text?(n.textContent=e.text,di(n,"block")):$i(n),nie(t,e))},lie=(t,e)=>{const n=wG();n&&(dI(n),sw(n,!!e.footer,"block"),e.footer&&gI(e.footer,n),Qr(n,e,"footer"))},cie=(t,e)=>{const n=Lt.innerParams.get(t),i=Uf();if(!i)return;if(n&&e.icon===n.icon){aL(i,e),oL(i,e);return}if(!e.icon&&!e.iconHtml){$i(i);return}if(e.icon&&Object.keys(Ny).indexOf(e.icon)===-1){Dh(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${e.icon}"`),$i(i);return}di(i),aL(i,e),oL(i,e),bt(i,e.showClass&&e.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",SG)},oL=(t,e)=>{for(const[n,i]of Object.entries(Ny))e.icon!==n&&Ms(t,i);bt(t,e.icon&&Ny[e.icon]),die(t,e),SG(),Qr(t,e,"icon")},SG=()=>{const t=yt();if(!t)return;const e=window.getComputedStyle(t).getPropertyValue("background-color"),n=t.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let i=0;i<n.length;i++)n[i].style.backgroundColor=e},uie=t=>`
  ${t.animation?'<div class="swal2-success-circular-line-left"></div>':""}
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div>
  ${t.animation?'<div class="swal2-success-fix"></div>':""}
  ${t.animation?'<div class="swal2-success-circular-line-right"></div>':""}
`,hie=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,aL=(t,e)=>{if(!e.icon&&!e.iconHtml)return;let n=t.innerHTML,i="";e.iconHtml?i=lL(e.iconHtml):e.icon==="success"?(i=uie(e),n=n.replace(/ style=".*?"/g,"")):e.icon==="error"?i=hie:e.icon&&(i=lL({question:"?",warning:"!",info:"i"}[e.icon])),n.trim()!==i.trim()&&ns(t,i)},die=(t,e)=>{if(e.iconColor){t.style.color=e.iconColor,t.style.borderColor=e.iconColor;for(const n of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])sL(t,n,"background-color",e.iconColor);sL(t,".swal2-success-ring","border-color",e.iconColor)}},lL=t=>`<div class="${K["icon-content"]}">${t}</div>`,fie=(t,e)=>{const n=pG();if(n){if(!e.imageUrl){$i(n);return}di(n,""),n.setAttribute("src",e.imageUrl),n.setAttribute("alt",e.imageAlt||""),dh(n,"width",e.imageWidth),dh(n,"height",e.imageHeight),n.className=K.image,Qr(n,e,"image")}};let pI=!1,RG=0,_G=0,EG=0,xG=0;const gie=t=>{t.addEventListener("mousedown",$y),document.body.addEventListener("mousemove",Fy),t.addEventListener("mouseup",Vy),t.addEventListener("touchstart",$y),document.body.addEventListener("touchmove",Fy),t.addEventListener("touchend",Vy)},mie=t=>{t.removeEventListener("mousedown",$y),document.body.removeEventListener("mousemove",Fy),t.removeEventListener("mouseup",Vy),t.removeEventListener("touchstart",$y),document.body.removeEventListener("touchmove",Fy),t.removeEventListener("touchend",Vy)},$y=t=>{const e=yt();if(!e)return;const n=Uf();if(t.target===e||n&&n.contains(t.target)){pI=!0;const i=TG(t);RG=i.clientX,_G=i.clientY,EG=parseInt(e.style.insetInlineStart)||0,xG=parseInt(e.style.insetBlockStart)||0,bt(e,"swal2-dragging")}},Fy=t=>{const e=yt();if(e&&pI){let{clientX:n,clientY:i}=TG(t);const r=n-RG;e.style.insetInlineStart=`${EG+(Se.isRTL?-r:r)}px`,e.style.insetBlockStart=`${xG+(i-_G)}px`}},Vy=()=>{const t=yt();pI=!1,Ms(t,"swal2-dragging")},TG=t=>{let e=0,n=0;return t.type.startsWith("mouse")?(e=t.clientX,n=t.clientY):t.type.startsWith("touch")&&(e=t.touches[0].clientX,n=t.touches[0].clientY),{clientX:e,clientY:n}},pie=(t,e)=>{const n=rr(),i=yt();if(!(!n||!i)){if(e.toast){dh(n,"width",e.width),i.style.width="100%";const r=Gf();r&&i.insertBefore(r,Uf())}else dh(i,"width",e.width);dh(i,"padding",e.padding),e.color&&(i.style.color=e.color),e.background&&(i.style.background=e.background),$i(CS()),wie(i,e),e.draggable&&!e.toast?(bt(i,K.draggable),gie(i)):(Ms(i,K.draggable),mie(i))}},wie=(t,e)=>{const n=e.showClass||{};t.className=`${K.popup} ${Pr(t)?n.popup:""}`,e.toast?(bt([document.documentElement,document.body],K["toast-shown"]),bt(t,K.toast)):bt(t,K.modal),Qr(t,e,"popup"),typeof e.customClass=="string"&&bt(t,e.customClass),e.icon&&bt(t,K[`icon-${e.icon}`])},vie=(t,e)=>{const n=lI();if(!n)return;const{progressSteps:i,currentProgressStep:r}=e;if(!i||i.length===0||r===void 0){$i(n);return}di(n),n.textContent="",r>=i.length&&tr("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),i.forEach((s,o)=>{const a=bie(s);if(n.appendChild(a),o===r&&bt(a,K["active-progress-step"]),o!==i.length-1){const l=yie(e);n.appendChild(l)}})},bie=t=>{const e=document.createElement("li");return bt(e,K["progress-step"]),ns(e,t),e},yie=t=>{const e=document.createElement("li");return bt(e,K["progress-step-line"]),t.progressStepsDistance&&dh(e,"width",t.progressStepsDistance),e},Cie=(t,e)=>{const n=mG();n&&(dI(n),sw(n,!!(e.title||e.titleText),"block"),e.title&&gI(e.title,n),e.titleText&&(n.innerText=e.titleText),Qr(n,e,"title"))},MG=(t,e)=>{var n;pie(t,e),Jne(t,e),vie(t,e),cie(t,e),fie(t,e),Cie(t,e),Xne(t,e),aie(t,e),Gne(t,e),lie(t,e);const i=yt();typeof e.didRender=="function"&&i&&e.didRender(i),(n=Se.eventEmitter)===null||n===void 0||n.emit("didRender",i)},Sie=()=>Pr(yt()),PG=()=>{var t;return(t=aa())===null||t===void 0?void 0:t.click()},Rie=()=>{var t;return(t=Nh())===null||t===void 0?void 0:t.click()},_ie=()=>{var t;return(t=Yf())===null||t===void 0?void 0:t.click()},qf=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),AG=t=>{if(t.keydownTarget&&t.keydownHandlerAdded&&t.keydownHandler){const e=t.keydownHandler;t.keydownTarget.removeEventListener("keydown",e,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!1}},Eie=(t,e,n)=>{if(AG(t),!e.toast){const i=s=>Tie(e,s,n);t.keydownHandler=i;const r=e.keydownListenerCapture?window:yt();if(r){t.keydownTarget=r,t.keydownListenerCapture=e.keydownListenerCapture;const s=i;t.keydownTarget.addEventListener("keydown",s,{capture:t.keydownListenerCapture}),t.keydownHandlerAdded=!0}}},tP=(t,e)=>{var n;const i=uI();if(i.length){t=t+e,t===-2&&(t=i.length-1),t===i.length?t=0:t===-1&&(t=i.length-1),i[t].focus();return}(n=yt())===null||n===void 0||n.focus()},IG=["ArrowRight","ArrowDown"],xie=["ArrowLeft","ArrowUp"],Tie=(t,e,n)=>{t&&(e.isComposing||e.keyCode===229||(t.stopKeydownPropagation&&e.stopPropagation(),e.key==="Enter"?Mie(e,t):e.key==="Tab"?Pie(e):[...IG,...xie].includes(e.key)?Aie(e.key):e.key==="Escape"&&Iie(e,t,n)))},Mie=(t,e)=>{if(!yS(e.allowEnterKey))return;const n=yt();if(!n||!e.input)return;const i=_S(n,e.input);if(t.target&&i&&t.target instanceof HTMLElement&&t.target.outerHTML===i.outerHTML){if(["textarea","file"].includes(e.input))return;PG(),t.preventDefault()}},Pie=t=>{const e=t.target,n=uI();let i=-1;for(let r=0;r<n.length;r++)if(e===n[r]){i=r;break}t.shiftKey?tP(i,-1):tP(i,1),t.stopPropagation(),t.preventDefault()},Aie=t=>{const e=rw(),n=aa(),i=Nh(),r=Yf();if(!e||!n||!i||!r)return;const s=[n,i,r];if(document.activeElement instanceof HTMLElement&&!s.includes(document.activeElement))return;const o=IG.includes(t)?"nextElementSibling":"previousElementSibling";let a=document.activeElement;if(a){for(let l=0;l<e.children.length;l++){if(a=a[o],!a)return;if(a instanceof HTMLButtonElement&&Pr(a))break}a instanceof HTMLButtonElement&&a.focus()}},Iie=(t,e,n)=>{t.preventDefault(),yS(e.allowEscapeKey)&&n(qf.esc)};var xf={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};const Oie=()=>{const t=rr();Array.from(document.body.children).forEach(n=>{n.contains(t)||(n.hasAttribute("aria-hidden")&&n.setAttribute("data-previous-aria-hidden",n.getAttribute("aria-hidden")||""),n.setAttribute("aria-hidden","true"))})},OG=()=>{Array.from(document.body.children).forEach(e=>{e.hasAttribute("data-previous-aria-hidden")?(e.setAttribute("aria-hidden",e.getAttribute("data-previous-aria-hidden")||""),e.removeAttribute("data-previous-aria-hidden")):e.removeAttribute("aria-hidden")})},HG=typeof window<"u"&&!!window.GestureEvent,Hie=()=>{if(HG&&!nl(document.body,K.iosfix)){const t=document.body.scrollTop;document.body.style.top=`${t*-1}px`,bt(document.body,K.iosfix),kie()}},kie=()=>{const t=rr();if(!t)return;let e;t.ontouchstart=n=>{e=Die(n)},t.ontouchmove=n=>{e&&(n.preventDefault(),n.stopPropagation())}},Die=t=>{const e=t.target,n=rr(),i=aI();return!n||!i||Nie(t)||Lie(t)?!1:e===n||!eP(n)&&e instanceof HTMLElement&&!Dne(e,i)&&e.tagName!=="INPUT"&&e.tagName!=="TEXTAREA"&&!(eP(i)&&i.contains(e))},Nie=t=>!!(t.touches&&t.touches.length&&t.touches[0].touchType==="stylus"),Lie=t=>t.touches&&t.touches.length>1,$ie=()=>{if(nl(document.body,K.iosfix)){const t=parseInt(document.body.style.top,10);Ms(document.body,K.iosfix),document.body.style.top="",document.body.scrollTop=t*-1}},Fie=()=>{const t=document.createElement("div");t.className=K["scrollbar-measure"],document.body.appendChild(t);const e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e};let uf=null;const Vie=t=>{uf===null&&(document.body.scrollHeight>window.innerHeight||t==="scroll")&&(uf=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${uf+Fie()}px`)},Bie=()=>{uf!==null&&(document.body.style.paddingRight=`${uf}px`,uf=null)};function kG(t,e,n,i){RS()?cL(t,i):(Ene(n).then(()=>cL(t,i)),AG(Se)),HG?(e.setAttribute("style","display:none !important"),e.removeAttribute("class"),e.innerHTML=""):e.remove(),hI()&&(Bie(),$ie(),OG()),Wie()}function Wie(){Ms([document.documentElement,document.body],[K.shown,K["height-auto"],K["no-backdrop"],K["toast-shown"]])}function oc(t){t=zie(t);const e=xf.swalPromiseResolve.get(this),n=jie(this);this.isAwaitingPromise?t.isDismissed||(aw(this),e(t)):n&&e(t)}const jie=t=>{const e=yt();if(!e)return!1;const n=Lt.innerParams.get(t);if(!n||nl(e,n.hideClass.popup))return!1;Ms(e,n.showClass.popup),bt(e,n.hideClass.popup);const i=rr();return Ms(i,n.showClass.backdrop),bt(i,n.hideClass.backdrop),Uie(t,e,n),!0};function DG(t){const e=xf.swalPromiseReject.get(this);aw(this),e&&e(t)}const aw=t=>{t.isAwaitingPromise&&(delete t.isAwaitingPromise,Lt.innerParams.get(t)||t._destroy())},zie=t=>typeof t>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},t),Uie=(t,e,n)=>{var i;const r=rr(),s=yG(e);typeof n.willClose=="function"&&n.willClose(e),(i=Se.eventEmitter)===null||i===void 0||i.emit("willClose",e),s&&r?Yie(t,e,r,!!n.returnFocus,n.didClose):r&&kG(t,r,!!n.returnFocus,n.didClose)},Yie=(t,e,n,i,r)=>{Se.swalCloseEventFinishedCallback=kG.bind(null,t,n,i,r);const s=function(o){if(o.target===e){var a;(a=Se.swalCloseEventFinishedCallback)===null||a===void 0||a.call(Se),delete Se.swalCloseEventFinishedCallback,e.removeEventListener("animationend",s),e.removeEventListener("transitionend",s)}};e.addEventListener("animationend",s),e.addEventListener("transitionend",s)},cL=(t,e)=>{setTimeout(()=>{var n;typeof e=="function"&&e.bind(t.params)(),(n=Se.eventEmitter)===null||n===void 0||n.emit("didClose"),t._destroy&&t._destroy()})},Tf=t=>{let e=yt();if(e||new Xi,e=yt(),!e)return;const n=Gf();RS()?$i(Uf()):Gie(e,t),di(n),e.setAttribute("data-loading","true"),e.setAttribute("aria-busy","true"),e.focus()},Gie=(t,e)=>{const n=rw(),i=Gf();!n||!i||(!e&&Pr(aa())&&(e=aa()),di(n),e&&($i(e),i.setAttribute("data-button-to-replace",e.className),n.insertBefore(i,e)),bt([t,n],K.loading))},qie=(t,e)=>{e.input==="select"||e.input==="radio"?Qie(t,e):["text","email","number","tel","textarea"].some(n=>n===e.input)&&(sI(e.inputValue)||oI(e.inputValue))&&(Tf(aa()),ere(t,e))},Kie=(t,e)=>{const n=t.getInput();if(!n)return null;switch(e.input){case"checkbox":return Xie(n);case"radio":return Jie(n);case"file":return Zie(n);default:return e.inputAutoTrim?n.value.trim():n.value}},Xie=t=>t.checked?1:0,Jie=t=>t.checked?t.value:null,Zie=t=>t.files&&t.files.length?t.getAttribute("multiple")!==null?t.files:t.files[0]:null,Qie=(t,e)=>{const n=yt();if(!n)return;const i=r=>{e.input==="select"?tre(n,By(r),e):e.input==="radio"&&nre(n,By(r),e)};sI(e.inputOptions)||oI(e.inputOptions)?(Tf(aa()),nw(e.inputOptions).then(r=>{t.hideLoading(),i(r)})):typeof e.inputOptions=="object"?i(e.inputOptions):Dh(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof e.inputOptions}`)},ere=(t,e)=>{const n=t.getInput();n&&($i(n),nw(e.inputValue).then(i=>{n.value=e.input==="number"?`${parseFloat(i)||0}`:`${i}`,di(n),n.focus(),t.hideLoading()}).catch(i=>{Dh(`Error in inputValue promise: ${i}`),n.value="",di(n),n.focus(),t.hideLoading()}))};function tre(t,e,n){const i=sc(t,K.select);if(!i)return;const r=(s,o,a)=>{const l=document.createElement("option");l.value=a,ns(l,o),l.selected=NG(a,n.inputValue),s.appendChild(l)};e.forEach(s=>{const o=s[0],a=s[1];if(Array.isArray(a)){const l=document.createElement("optgroup");l.label=o,l.disabled=!1,i.appendChild(l),a.forEach(c=>r(l,c[1],c[0]))}else r(i,a,o)}),i.focus()}function nre(t,e,n){const i=sc(t,K.radio);if(!i)return;e.forEach(s=>{const o=s[0],a=s[1],l=document.createElement("input"),c=document.createElement("label");l.type="radio",l.name=K.radio,l.value=o,NG(o,n.inputValue)&&(l.checked=!0);const u=document.createElement("span");ns(u,a),u.className=K.label,c.appendChild(l),c.appendChild(u),i.appendChild(c)});const r=i.querySelectorAll("input");r.length&&r[0].focus()}const By=t=>{const e=[];return t instanceof Map?t.forEach((n,i)=>{let r=n;typeof r=="object"&&(r=By(r)),e.push([i,r])}):Object.keys(t).forEach(n=>{let i=t[n];typeof i=="object"&&(i=By(i)),e.push([n,i])}),e},NG=(t,e)=>!!e&&e!==null&&e!==void 0&&e.toString()===t.toString(),ire=t=>{const e=Lt.innerParams.get(t);t.disableButtons(),e.input?LG(t,"confirm"):vI(t,!0)},rre=t=>{const e=Lt.innerParams.get(t);t.disableButtons(),e.returnInputValueOnDeny?LG(t,"deny"):wI(t,!1)},sre=(t,e)=>{t.disableButtons(),e(qf.cancel)},LG=(t,e)=>{const n=Lt.innerParams.get(t);if(!n.input){Dh(`The "input" parameter is needed to be set when using returnInputValueOn${rI(e)}`);return}const i=t.getInput(),r=Kie(t,n);n.inputValidator?ore(t,r,e):i&&!i.checkValidity()?(t.enableButtons(),t.showValidationMessage(n.validationMessage||i.validationMessage)):e==="deny"?wI(t,r):vI(t,r)},ore=(t,e,n)=>{const i=Lt.innerParams.get(t);t.disableInput(),Promise.resolve().then(()=>nw(i.inputValidator(e,i.validationMessage))).then(s=>{t.enableButtons(),t.enableInput(),s?t.showValidationMessage(s):n==="deny"?wI(t,e):vI(t,e)})},wI=(t,e)=>{const n=Lt.innerParams.get(t);n.showLoaderOnDeny&&Tf(Nh()),n.preDeny?(t.isAwaitingPromise=!0,Promise.resolve().then(()=>nw(n.preDeny(e,n.validationMessage))).then(r=>{r===!1?(t.hideLoading(),aw(t)):t.close({isDenied:!0,value:typeof r>"u"?e:r})}).catch(r=>$G(t,r))):t.close({isDenied:!0,value:e})},uL=(t,e)=>{t.close({isConfirmed:!0,value:e})},$G=(t,e)=>{t.rejectPromise(e)},vI=(t,e)=>{const n=Lt.innerParams.get(t);n.showLoaderOnConfirm&&Tf(),n.preConfirm?(t.resetValidationMessage(),t.isAwaitingPromise=!0,Promise.resolve().then(()=>nw(n.preConfirm(e,n.validationMessage))).then(r=>{Pr(CS())||r===!1?(t.hideLoading(),aw(t)):uL(t,typeof r>"u"?e:r)}).catch(r=>$G(t,r))):uL(t,e)};function Wy(){const t=Lt.innerParams.get(this);if(!t)return;const e=Lt.domCache.get(this);$i(e.loader),RS()?t.icon&&di(Uf()):are(e),Ms([e.popup,e.actions],K.loading),e.popup.removeAttribute("aria-busy"),e.popup.removeAttribute("data-loading"),e.confirmButton.disabled=!1,e.denyButton.disabled=!1,e.cancelButton.disabled=!1}const are=t=>{const e=t.loader.getAttribute("data-button-to-replace"),n=e?t.popup.getElementsByClassName(e):[];n.length?di(n[0],"inline-block"):kne()&&$i(t.actions)};function FG(){const t=Lt.innerParams.get(this),e=Lt.domCache.get(this);return e?_S(e.popup,t.input):null}function VG(t,e,n){const i=Lt.domCache.get(t);e.forEach(r=>{i[r].disabled=n})}function BG(t,e){const n=yt();if(!(!n||!t))if(t.type==="radio"){const i=n.querySelectorAll(`[name="${K.radio}"]`);for(let r=0;r<i.length;r++)i[r].disabled=e}else t.disabled=e}function WG(){VG(this,["confirmButton","denyButton","cancelButton"],!1)}function jG(){VG(this,["confirmButton","denyButton","cancelButton"],!0)}function zG(){BG(this.getInput(),!1)}function UG(){BG(this.getInput(),!0)}function YG(t){const e=Lt.domCache.get(this),n=Lt.innerParams.get(this);ns(e.validationMessage,t),e.validationMessage.className=K["validation-message"],n.customClass&&n.customClass.validationMessage&&bt(e.validationMessage,n.customClass.validationMessage),di(e.validationMessage);const i=this.getInput();i&&(i.setAttribute("aria-invalid","true"),i.setAttribute("aria-describedby",K["validation-message"]),vG(i),bt(i,K.inputerror))}function GG(){const t=Lt.domCache.get(this);t.validationMessage&&$i(t.validationMessage);const e=this.getInput();e&&(e.removeAttribute("aria-invalid"),e.removeAttribute("aria-describedby"),Ms(e,K.inputerror))}const ac={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},lre=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],cre={allowEnterKey:void 0},ure=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],qG=t=>Object.prototype.hasOwnProperty.call(ac,t),KG=t=>lre.indexOf(t)!==-1,XG=t=>cre[t],hre=t=>{qG(t)||tr(`Unknown parameter "${t}"`)},dre=t=>{ure.includes(t)&&tr(`The parameter "${t}" is incompatible with toasts`)},fre=t=>{const e=XG(t);e&&gG(t,e)},JG=t=>{t.backdrop===!1&&t.allowOutsideClick&&tr('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),t.theme&&!["light","dark","auto","minimal","borderless","bootstrap-4","bootstrap-4-light","bootstrap-4-dark","bootstrap-5","bootstrap-5-light","bootstrap-5-dark","material-ui","material-ui-light","material-ui-dark","embed-iframe","bulma","bulma-light","bulma-dark"].includes(t.theme)&&tr(`Invalid theme "${t.theme}"`);for(const e in t)hre(e),t.toast&&dre(e),fre(e)};function ZG(t){const e=rr(),n=yt(),i=Lt.innerParams.get(this);if(!n||nl(n,i.hideClass.popup)){tr("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}const r=gre(t),s=Object.assign({},i,r);JG(s),e&&(e.dataset.swal2Theme=s.theme),MG(this,s),Lt.innerParams.set(this,s),Object.defineProperties(this,{params:{value:Object.assign({},this.params,t),writable:!1,enumerable:!0}})}const gre=t=>{const e={};return Object.keys(t).forEach(n=>{if(KG(n)){const i=t;e[n]=i[n]}else tr(`Invalid parameter to update: ${n}`)}),e};function QG(){var t;const e=Lt.domCache.get(this),n=Lt.innerParams.get(this);if(!n){eq(this);return}e.popup&&Se.swalCloseEventFinishedCallback&&(Se.swalCloseEventFinishedCallback(),delete Se.swalCloseEventFinishedCallback),typeof n.didDestroy=="function"&&n.didDestroy(),(t=Se.eventEmitter)===null||t===void 0||t.emit("didDestroy"),mre(this)}const mre=t=>{eq(t),delete t.params,delete Se.keydownHandler,delete Se.keydownTarget,delete Se.currentInstance},eq=t=>{t.isAwaitingPromise?(tR(Lt,t),t.isAwaitingPromise=!0):(tR(xf,t),tR(Lt,t),delete t.isAwaitingPromise,delete t.disableButtons,delete t.enableButtons,delete t.getInput,delete t.disableInput,delete t.enableInput,delete t.hideLoading,delete t.disableLoading,delete t.showValidationMessage,delete t.resetValidationMessage,delete t.close,delete t.closePopup,delete t.closeModal,delete t.closeToast,delete t.rejectPromise,delete t.update,delete t._destroy)},tR=(t,e)=>{for(const n in t)t[n].delete(e)};var pre=Object.freeze({__proto__:null,_destroy:QG,close:oc,closeModal:oc,closePopup:oc,closeToast:oc,disableButtons:jG,disableInput:UG,disableLoading:Wy,enableButtons:WG,enableInput:zG,getInput:FG,handleAwaitingPromise:aw,hideLoading:Wy,rejectPromise:DG,resetValidationMessage:GG,showValidationMessage:YG,update:ZG});const wre=(t,e,n)=>{t.toast?vre(t,e,n):(yre(e),Cre(e),Sre(t,e,n))},vre=(t,e,n)=>{e.popup.onclick=()=>{t&&(bre(t)||t.timer||t.input)||n(qf.close)}},bre=t=>!!(t.showConfirmButton||t.showDenyButton||t.showCancelButton||t.showCloseButton);let jy=!1;const yre=t=>{t.popup.onmousedown=()=>{t.container.onmouseup=function(e){t.container.onmouseup=()=>{},e.target===t.container&&(jy=!0)}}},Cre=t=>{t.container.onmousedown=e=>{e.target===t.container&&e.preventDefault(),t.popup.onmouseup=function(n){t.popup.onmouseup=()=>{},(n.target===t.popup||n.target instanceof HTMLElement&&t.popup.contains(n.target))&&(jy=!0)}}},Sre=(t,e,n)=>{e.container.onclick=i=>{if(jy){jy=!1;return}i.target===e.container&&yS(t.allowOutsideClick)&&n(qf.backdrop)}},Rre=t=>typeof t=="object"&&t.jquery,hL=t=>t instanceof Element||Rre(t),_re=t=>{const e={};return typeof t[0]=="object"&&!hL(t[0])?Object.assign(e,t[0]):["title","html","icon"].forEach((n,i)=>{const r=t[i];typeof r=="string"||hL(r)?e[n]=r:r!==void 0&&Dh(`Unexpected type of ${n}! Expected "string" or "Element", got ${typeof r}`)}),e};function Ere(...t){return new this(...t)}function xre(t){class e extends this{_main(i,r){return super._main(i,Object.assign({},t,r))}}return e}const Tre=()=>Se.timeout&&Se.timeout.getTimerLeft(),tq=()=>{if(Se.timeout)return Nne(),Se.timeout.stop()},nq=()=>{if(Se.timeout){const t=Se.timeout.start();return fI(t),t}},Mre=()=>{const t=Se.timeout;return t&&(t.running?tq():nq())},Pre=t=>{if(Se.timeout){const e=Se.timeout.increase(t);return fI(e,!0),e}},Are=()=>!!(Se.timeout&&Se.timeout.isRunning());let dL=!1;const nP={};function Ire(t="data-swal-template"){nP[t]=this,dL||(document.body.addEventListener("click",Ore),dL=!0)}const Ore=t=>{for(let e=t.target;e&&e!==document;e=e.parentNode)for(const n in nP){const i=e.getAttribute&&e.getAttribute(n);if(i){nP[n].fire({template:i});return}}};class Hre{constructor(){this.events={}}_getHandlersByEventName(e){return typeof this.events[e]>"u"&&(this.events[e]=[]),this.events[e]}on(e,n){const i=this._getHandlersByEventName(e);i.includes(n)||i.push(n)}once(e,n){const i=(...r)=>{this.removeListener(e,i),n.apply(this,r)};this.on(e,i)}emit(e,...n){this._getHandlersByEventName(e).forEach(i=>{try{i.apply(this,n)}catch(r){console.error(r)}})}removeListener(e,n){const i=this._getHandlersByEventName(e),r=i.indexOf(n);r>-1&&i.splice(r,1)}removeAllListeners(e){this.events[e]!==void 0&&(this.events[e].length=0)}reset(){this.events={}}}Se.eventEmitter=new Hre;const kre=(t,e)=>{Se.eventEmitter&&Se.eventEmitter.on(t,e)},Dre=(t,e)=>{Se.eventEmitter&&Se.eventEmitter.once(t,e)},Nre=(t,e)=>{if(Se.eventEmitter){if(!t){Se.eventEmitter.reset();return}e?Se.eventEmitter.removeListener(t,e):Se.eventEmitter.removeAllListeners(t)}};var Lre=Object.freeze({__proto__:null,argsToParams:_re,bindClickHandler:Ire,clickCancel:_ie,clickConfirm:PG,clickDeny:Rie,enableLoading:Tf,fire:Ere,getActions:rw,getCancelButton:Yf,getCloseButton:cI,getConfirmButton:aa,getContainer:rr,getDenyButton:Nh,getFocusableElements:uI,getFooter:wG,getHtmlContainer:aI,getIcon:Uf,getIconContent:Pne,getImage:pG,getInputLabel:Ane,getLoader:Gf,getPopup:yt,getProgressSteps:lI,getTimerLeft:Tre,getTimerProgressBar:SS,getTitle:mG,getValidationMessage:CS,increaseTimer:Pre,isDeprecatedParameter:XG,isLoading:One,isTimerRunning:Are,isUpdatableParameter:KG,isValidParameter:qG,isVisible:Sie,mixin:xre,off:Nre,on:kre,once:Dre,resumeTimer:nq,showLoading:Tf,stopTimer:tq,toggleTimer:Mre});class $re{constructor(e,n){this.callback=e,this.remaining=n,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(e){const n=this.running;return n&&this.stop(),this.remaining+=e,n&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}const iq=["swal-title","swal-html","swal-footer"],Fre=t=>{const e=typeof t.template=="string"?document.querySelector(t.template):t.template;if(!e)return{};const n=e.content;return Gre(n),Object.assign(Vre(n),Bre(n),Wre(n),jre(n),zre(n),Ure(n),Yre(n,iq))},Vre=t=>{const e={};return Array.from(t.querySelectorAll("swal-param")).forEach(i=>{_h(i,["name","value"]);const r=i.getAttribute("name"),s=i.getAttribute("value");!r||!s||(r in ac&&typeof ac[r]=="boolean"?e[r]=s!=="false":r in ac&&typeof ac[r]=="object"?e[r]=JSON.parse(s):e[r]=s)}),e},Bre=t=>{const e={};return Array.from(t.querySelectorAll("swal-function-param")).forEach(i=>{const r=i.getAttribute("name"),s=i.getAttribute("value");!r||!s||(e[r]=new Function(`return ${s}`)())}),e},Wre=t=>{const e={};return Array.from(t.querySelectorAll("swal-button")).forEach(i=>{_h(i,["type","color","aria-label"]);const r=i.getAttribute("type");if(!(!r||!["confirm","cancel","deny"].includes(r))){if(e[`${r}ButtonText`]=i.innerHTML,e[`show${rI(r)}Button`]=!0,i.hasAttribute("color")){const s=i.getAttribute("color");s!==null&&(e[`${r}ButtonColor`]=s)}if(i.hasAttribute("aria-label")){const s=i.getAttribute("aria-label");s!==null&&(e[`${r}ButtonAriaLabel`]=s)}}}),e},jre=t=>{const e={},n=t.querySelector("swal-image");return n&&(_h(n,["src","width","height","alt"]),n.hasAttribute("src")&&(e.imageUrl=n.getAttribute("src")||void 0),n.hasAttribute("width")&&(e.imageWidth=n.getAttribute("width")||void 0),n.hasAttribute("height")&&(e.imageHeight=n.getAttribute("height")||void 0),n.hasAttribute("alt")&&(e.imageAlt=n.getAttribute("alt")||void 0)),e},zre=t=>{const e={},n=t.querySelector("swal-icon");return n&&(_h(n,["type","color"]),n.hasAttribute("type")&&(e.icon=n.getAttribute("type")),n.hasAttribute("color")&&(e.iconColor=n.getAttribute("color")),e.iconHtml=n.innerHTML),e},Ure=t=>{const e={},n=t.querySelector("swal-input");n&&(_h(n,["type","label","placeholder","value"]),e.input=n.getAttribute("type")||"text",n.hasAttribute("label")&&(e.inputLabel=n.getAttribute("label")),n.hasAttribute("placeholder")&&(e.inputPlaceholder=n.getAttribute("placeholder")),n.hasAttribute("value")&&(e.inputValue=n.getAttribute("value")));const i=Array.from(t.querySelectorAll("swal-input-option"));return i.length&&(e.inputOptions={},i.forEach(r=>{_h(r,["value"]);const s=r.getAttribute("value");if(!s)return;const o=r.innerHTML;e.inputOptions[s]=o})),e},Yre=(t,e)=>{const n={};for(const i in e){const r=e[i],s=t.querySelector(r);s&&(_h(s,[]),n[r.replace(/^swal-/,"")]=s.innerHTML.trim())}return n},Gre=t=>{const e=iq.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(t.children).forEach(n=>{const i=n.tagName.toLowerCase();e.includes(i)||tr(`Unrecognized element <${i}>`)})},_h=(t,e)=>{Array.from(t.attributes).forEach(n=>{e.indexOf(n.name)===-1&&tr([`Unrecognized attribute "${n.name}" on <${t.tagName.toLowerCase()}>.`,`${e.length?`Allowed attributes are: ${e.join(", ")}`:"To set the value, use HTML within the element."}`])})},rq=10,qre=t=>{var e,n;const i=rr(),r=yt();if(!i||!r)return;typeof t.willOpen=="function"&&t.willOpen(r),(e=Se.eventEmitter)===null||e===void 0||e.emit("willOpen",r);const o=window.getComputedStyle(document.body).overflowY;if(Jre(i,r,t),setTimeout(()=>{Kre(i,r)},rq),hI()&&(Xre(i,t.scrollbarPadding!==void 0?t.scrollbarPadding:!1,o),Oie()),!RS()&&!Se.previousActiveElement&&(Se.previousActiveElement=document.activeElement),typeof t.didOpen=="function"){const a=t.didOpen;setTimeout(()=>a(r))}(n=Se.eventEmitter)===null||n===void 0||n.emit("didOpen",r)},zy=t=>{const e=yt();if(!e||t.target!==e)return;const n=rr();n&&(e.removeEventListener("animationend",zy),e.removeEventListener("transitionend",zy),n.style.overflowY="auto",Ms(n,K["no-transition"]))},Kre=(t,e)=>{yG(e)?(t.style.overflowY="hidden",e.addEventListener("animationend",zy),e.addEventListener("transitionend",zy)):t.style.overflowY="auto"},Xre=(t,e,n)=>{Hie(),e&&n!=="hidden"&&Vie(n),setTimeout(()=>{t.scrollTop=0})},Jre=(t,e,n)=>{var i;(i=n.showClass)!==null&&i!==void 0&&i.backdrop&&bt(t,n.showClass.backdrop),n.animation?(e.style.setProperty("opacity","0","important"),di(e,"grid"),setTimeout(()=>{var r;(r=n.showClass)!==null&&r!==void 0&&r.popup&&bt(e,n.showClass.popup),e.style.removeProperty("opacity")},rq)):di(e,"grid"),bt([document.documentElement,document.body],K.shown),n.heightAuto&&n.backdrop&&!n.toast&&bt([document.documentElement,document.body],K["height-auto"])};var fL={email:(t,e)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid email address"),url:(t,e)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(t)?Promise.resolve():Promise.resolve(e||"Invalid URL")};function Zre(t){t.inputValidator||(t.input==="email"&&(t.inputValidator=fL.email),t.input==="url"&&(t.inputValidator=fL.url))}function Qre(t){(!t.target||typeof t.target=="string"&&!document.querySelector(t.target)||typeof t.target!="string"&&!t.target.appendChild)&&(tr('Target parameter is not valid, defaulting to "body"'),t.target="body")}function ese(t){Zre(t),t.showLoaderOnConfirm&&!t.preConfirm&&tr(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),Qre(t),typeof t.title=="string"&&(t.title=t.title.split(`
`).join("<br />")),zne(t)}let qo;var lv=new WeakMap;class Hn{constructor(...e){if(Cne(this,lv,Promise.resolve({isConfirmed:!1,isDenied:!1,isDismissed:!0})),typeof window>"u")return;qo=this;const n=Object.freeze(this.constructor.argsToParams(e));this.params=n,this.isAwaitingPromise=!1,Sne(lv,this,this._main(qo.params))}_main(e,n={}){if(JG(Object.assign({},n,e)),Se.currentInstance){const s=xf.swalPromiseResolve.get(Se.currentInstance),{isAwaitingPromise:o}=Se.currentInstance;Se.currentInstance._destroy(),o||s({isDismissed:!0}),hI()&&OG()}Se.currentInstance=qo;const i=nse(e,n);ese(i),Object.freeze(i),Se.timeout&&(Se.timeout.stop(),delete Se.timeout),clearTimeout(Se.restoreFocusTimeout);const r=ise(qo);return MG(qo,i),Lt.innerParams.set(qo,i),tse(qo,r,i)}then(e){return iL(lv,this).then(e)}finally(e){return iL(lv,this).finally(e)}}const tse=(t,e,n)=>new Promise((i,r)=>{const s=o=>{t.close({isDismissed:!0,dismiss:o,isConfirmed:!1,isDenied:!1})};xf.swalPromiseResolve.set(t,i),xf.swalPromiseReject.set(t,r),e.confirmButton.onclick=()=>{ire(t)},e.denyButton.onclick=()=>{rre(t)},e.cancelButton.onclick=()=>{sre(t,s)},e.closeButton.onclick=()=>{s(qf.close)},wre(n,e,s),Eie(Se,n,s),qie(t,n),qre(n),rse(Se,n,s),sse(e,n),setTimeout(()=>{e.container.scrollTop=0})}),nse=(t,e)=>{const n=Fre(t),i=Object.assign({},ac,e,n,t);return i.showClass=Object.assign({},ac.showClass,i.showClass),i.hideClass=Object.assign({},ac.hideClass,i.hideClass),i.animation===!1&&(i.showClass={backdrop:"swal2-noanimation"},i.hideClass={}),i},ise=t=>{const e={popup:yt(),container:rr(),actions:rw(),confirmButton:aa(),denyButton:Nh(),cancelButton:Yf(),loader:Gf(),closeButton:cI(),validationMessage:CS(),progressSteps:lI()};return Lt.domCache.set(t,e),e},rse=(t,e,n)=>{const i=SS();$i(i),e.timer&&(t.timeout=new $re(()=>{n("timer"),delete t.timeout},e.timer),e.timerProgressBar&&i&&(di(i),Qr(i,e,"timerProgressBar"),setTimeout(()=>{t.timeout&&t.timeout.running&&fI(e.timer)})))},sse=(t,e)=>{if(!e.toast){if(!yS(e.allowEnterKey)){gG("allowEnterKey"),lse();return}ose(t)||ase(t,e)||tP(-1,1)}},ose=t=>{const e=Array.from(t.popup.querySelectorAll("[autofocus]"));for(const n of e)if(n instanceof HTMLElement&&Pr(n))return n.focus(),!0;return!1},ase=(t,e)=>e.focusDeny&&Pr(t.denyButton)?(t.denyButton.focus(),!0):e.focusCancel&&Pr(t.cancelButton)?(t.cancelButton.focus(),!0):e.focusConfirm&&Pr(t.confirmButton)?(t.confirmButton.focus(),!0):!1,lse=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};Hn.prototype.disableButtons=jG;Hn.prototype.enableButtons=WG;Hn.prototype.getInput=FG;Hn.prototype.disableInput=UG;Hn.prototype.enableInput=zG;Hn.prototype.hideLoading=Wy;Hn.prototype.disableLoading=Wy;Hn.prototype.showValidationMessage=YG;Hn.prototype.resetValidationMessage=GG;Hn.prototype.close=oc;Hn.prototype.closePopup=oc;Hn.prototype.closeModal=oc;Hn.prototype.closeToast=oc;Hn.prototype.rejectPromise=DG;Hn.prototype.update=ZG;Hn.prototype._destroy=QG;Object.assign(Hn,Lre);Object.keys(pre).forEach(t=>{Hn[t]=function(...e){if(qo&&qo[t])return qo[t](...e)}});Hn.DismissReason=qf;Hn.version="11.26.17";const Xi=Hn;Xi.default=Xi;typeof document<"u"&&(function(t,e){var n=t.createElement("style");if(t.getElementsByTagName("head")[0].appendChild(n),n.styleSheet)n.styleSheet.disabled||(n.styleSheet.cssText=e);else try{n.innerHTML=e}catch{n.innerText=e}})(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.15s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border: 1px solid #d9d9d9;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.2s, box-shadow 0.2s;--swal2-input-hover-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-focus-border: 1px solid #b4dbed;--swal2-input-focus-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-footer-border-color: #eee;--swal2-footer-background: transparent;--swal2-footer-color: inherit;--swal2-timer-progress-bar-background: rgba(0, 0, 0, 0.3);--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.2s, box-shadow 0.2s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-actions-justify-content: center;--swal2-actions-width: auto;--swal2-actions-margin: 1.25em auto 0;--swal2-actions-padding: 0;--swal2-actions-border-radius: 0;--swal2-actions-background: transparent;--swal2-action-button-transition: background-color 0.2s, box-shadow 0.2s;--swal2-action-button-hover: black 10%;--swal2-action-button-active: black 10%;--swal2-confirm-button-box-shadow: none;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-confirm-button-color: #fff;--swal2-deny-button-box-shadow: none;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-deny-button-color: #fff;--swal2-cancel-button-box-shadow: none;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-cancel-button-color: #fff;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white);--swal2-timer-progress-bar-background: rgba(255, 255, 255, 0.7)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white);--swal2-timer-progress-bar-background: rgba(255, 255, 255, 0.7)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;overflow-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:var(--swal2-actions-justify-content);width:var(--swal2-actions-width);margin:var(--swal2-actions-margin);padding:var(--swal2-actions-padding);border-radius:var(--swal2-actions-border-radius);background:var(--swal2-actions-background)}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-action-button-transition);border:none;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);box-shadow:var(--swal2-confirm-button-box-shadow);color:var(--swal2-confirm-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):hover{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):active{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);box-shadow:var(--swal2-deny-button-box-shadow);color:var(--swal2-deny-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):hover{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):active{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);box-shadow:var(--swal2-cancel-button-box-shadow);color:var(--swal2-cancel-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):hover{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):active{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-styled)[disabled]:not(.swal2-loading){opacity:.4}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);background:var(--swal2-footer-background);color:var(--swal2-footer-color);font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:var(--swal2-timer-progress-bar-background)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;overflow-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:var(--swal2-input-border);border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):hover,div:where(.swal2-container) input:where(.swal2-file):hover,div:where(.swal2-container) textarea:where(.swal2-textarea):hover{box-shadow:var(--swal2-input-hover-box-shadow)}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:var(--swal2-input-focus-border);outline:none;box-shadow:var(--swal2-input-focus-box-shadow)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:translate3d(0, -50px, 0) scale(0.9);opacity:0}100%{transform:translate3d(0, 0, 0) scale(1);opacity:1}}@keyframes swal2-hide{0%{transform:translate3d(0, 0, 0) scale(1);opacity:1}100%{transform:translate3d(0, -50px, 0) scale(0.9);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}');var gL=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},mL={},Cg,pL;function kn(){if(pL)return Cg;pL=1;var t=function(e){return e&&e.Math===Math&&e};return Cg=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof gL=="object"&&gL)||t(typeof Cg=="object"&&Cg)||(function(){return this})()||Function("return this")(),Cg}var nR={},iR,wL;function Dn(){return wL||(wL=1,iR=function(t){try{return!!t()}catch{return!0}}),iR}var rR,vL;function Is(){if(vL)return rR;vL=1;var t=Dn();return rR=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),rR}var sR,bL;function ES(){if(bL)return sR;bL=1;var t=Dn();return sR=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),sR}var oR,yL;function jn(){if(yL)return oR;yL=1;var t=ES(),e=Function.prototype.call;return oR=t?e.bind(e):function(){return e.apply(e,arguments)},oR}var aR={},CL;function cse(){if(CL)return aR;CL=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return aR.f=n?function(r){var s=e(this,r);return!!s&&s.enumerable}:t,aR}var lR,SL;function xS(){return SL||(SL=1,lR=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),lR}var cR,RL;function Nn(){if(RL)return cR;RL=1;var t=ES(),e=Function.prototype,n=e.call,i=t&&e.bind.bind(n,n);return cR=t?i:function(r){return function(){return n.apply(r,arguments)}},cR}var uR,_L;function Lh(){if(_L)return uR;_L=1;var t=Nn(),e=t({}.toString),n=t("".slice);return uR=function(i){return n(e(i),8,-1)},uR}var hR,EL;function use(){if(EL)return hR;EL=1;var t=Nn(),e=Dn(),n=Lh(),i=Object,r=t("".split);return hR=e(function(){return!i("z").propertyIsEnumerable(0)})?function(s){return n(s)==="String"?r(s,""):i(s)}:i,hR}var dR,xL;function bI(){return xL||(xL=1,dR=function(t){return t==null}),dR}var fR,TL;function lw(){if(TL)return fR;TL=1;var t=bI(),e=TypeError;return fR=function(n){if(t(n))throw new e("Can't call method on "+n);return n},fR}var gR,ML;function cw(){if(ML)return gR;ML=1;var t=use(),e=lw();return gR=function(n){return t(e(n))},gR}var mR,PL;function ei(){if(PL)return mR;PL=1;var t=typeof document=="object"&&document.all;return mR=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},mR}var pR,AL;function is(){if(AL)return pR;AL=1;var t=ei();return pR=function(e){return typeof e=="object"?e!==null:t(e)},pR}var wR,IL;function Kf(){if(IL)return wR;IL=1;var t=kn(),e=ei(),n=function(i){return e(i)?i:void 0};return wR=function(i,r){return arguments.length<2?n(t[i]):t[i]&&t[i][r]},wR}var vR,OL;function uw(){if(OL)return vR;OL=1;var t=Nn();return vR=t({}.isPrototypeOf),vR}var bR,HL;function TS(){if(HL)return bR;HL=1;var t=kn(),e=t.navigator,n=e&&e.userAgent;return bR=n?String(n):"",bR}var yR,kL;function hse(){if(kL)return yR;kL=1;var t=kn(),e=TS(),n=t.process,i=t.Deno,r=n&&n.versions||i&&i.version,s=r&&r.v8,o,a;return s&&(o=s.split("."),a=o[0]>0&&o[0]<4?1:+(o[0]+o[1])),!a&&e&&(o=e.match(/Edge\/(\d+)/),(!o||o[1]>=74)&&(o=e.match(/Chrome\/(\d+)/),o&&(a=+o[1]))),yR=a,yR}var CR,DL;function yI(){if(DL)return CR;DL=1;var t=hse(),e=Dn(),n=kn(),i=n.String;return CR=!!Object.getOwnPropertySymbols&&!e(function(){var r=Symbol("symbol detection");return!i(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&t&&t<41}),CR}var SR,NL;function sq(){if(NL)return SR;NL=1;var t=yI();return SR=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",SR}var RR,LL;function CI(){if(LL)return RR;LL=1;var t=Kf(),e=ei(),n=uw(),i=sq(),r=Object;return RR=i?function(s){return typeof s=="symbol"}:function(s){var o=t("Symbol");return e(o)&&n(o.prototype,r(s))},RR}var _R,$L;function MS(){if($L)return _R;$L=1;var t=String;return _R=function(e){try{return t(e)}catch{return"Object"}},_R}var ER,FL;function Ar(){if(FL)return ER;FL=1;var t=ei(),e=MS(),n=TypeError;return ER=function(i){if(t(i))return i;throw new n(e(i)+" is not a function")},ER}var xR,VL;function hw(){if(VL)return xR;VL=1;var t=Ar(),e=bI();return xR=function(n,i){var r=n[i];return e(r)?void 0:t(r)},xR}var TR,BL;function dse(){if(BL)return TR;BL=1;var t=jn(),e=ei(),n=is(),i=TypeError;return TR=function(r,s){var o,a;if(s==="string"&&e(o=r.toString)&&!n(a=t(o,r))||e(o=r.valueOf)&&!n(a=t(o,r))||s!=="string"&&e(o=r.toString)&&!n(a=t(o,r)))return a;throw new i("Can't convert object to primitive value")},TR}var MR={exports:{}},PR,WL;function Dc(){return WL||(WL=1,PR=!1),PR}var AR,jL;function SI(){if(jL)return AR;jL=1;var t=kn(),e=Object.defineProperty;return AR=function(n,i){try{e(t,n,{value:i,configurable:!0,writable:!0})}catch{t[n]=i}return i},AR}var zL;function RI(){if(zL)return MR.exports;zL=1;var t=Dc(),e=kn(),n=SI(),i="__core-js_shared__",r=MR.exports=e[i]||n(i,{});return(r.versions||(r.versions=[])).push({version:"3.47.0",mode:t?"pure":"global",copyright:" 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"}),MR.exports}var IR,UL;function oq(){if(UL)return IR;UL=1;var t=RI();return IR=function(e,n){return t[e]||(t[e]=n||{})},IR}var OR,YL;function Xf(){if(YL)return OR;YL=1;var t=lw(),e=Object;return OR=function(n){return e(t(n))},OR}var HR,GL;function rs(){if(GL)return HR;GL=1;var t=Nn(),e=Xf(),n=t({}.hasOwnProperty);return HR=Object.hasOwn||function(r,s){return n(e(r),s)},HR}var kR,qL;function _I(){if(qL)return kR;qL=1;var t=Nn(),e=0,n=Math.random(),i=t(1.1.toString);return kR=function(r){return"Symbol("+(r===void 0?"":r)+")_"+i(++e+n,36)},kR}var DR,KL;function go(){if(KL)return DR;KL=1;var t=kn(),e=oq(),n=rs(),i=_I(),r=yI(),s=sq(),o=t.Symbol,a=e("wks"),l=s?o.for||o:o&&o.withoutSetter||i;return DR=function(c){return n(a,c)||(a[c]=r&&n(o,c)?o[c]:l("Symbol."+c)),a[c]},DR}var NR,XL;function fse(){if(XL)return NR;XL=1;var t=jn(),e=is(),n=CI(),i=hw(),r=dse(),s=go(),o=TypeError,a=s("toPrimitive");return NR=function(l,c){if(!e(l)||n(l))return l;var u=i(l,a),h;if(u){if(c===void 0&&(c="default"),h=t(u,l,c),!e(h)||n(h))return h;throw new o("Can't convert object to primitive value")}return c===void 0&&(c="number"),r(l,c)},NR}var LR,JL;function aq(){if(JL)return LR;JL=1;var t=fse(),e=CI();return LR=function(n){var i=t(n,"string");return e(i)?i:i+""},LR}var $R,ZL;function EI(){if(ZL)return $R;ZL=1;var t=kn(),e=is(),n=t.document,i=e(n)&&e(n.createElement);return $R=function(r){return i?n.createElement(r):{}},$R}var FR,QL;function lq(){if(QL)return FR;QL=1;var t=Is(),e=Dn(),n=EI();return FR=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),FR}var e$;function cq(){if(e$)return nR;e$=1;var t=Is(),e=jn(),n=cse(),i=xS(),r=cw(),s=aq(),o=rs(),a=lq(),l=Object.getOwnPropertyDescriptor;return nR.f=t?l:function(u,h){if(u=r(u),h=s(h),a)try{return l(u,h)}catch{}if(o(u,h))return i(!e(n.f,u,h),u[h])},nR}var VR={},BR,t$;function uq(){if(t$)return BR;t$=1;var t=Is(),e=Dn();return BR=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),BR}var WR,n$;function zn(){if(n$)return WR;n$=1;var t=is(),e=String,n=TypeError;return WR=function(i){if(t(i))return i;throw new n(e(i)+" is not an object")},WR}var i$;function Nc(){if(i$)return VR;i$=1;var t=Is(),e=lq(),n=uq(),i=zn(),r=aq(),s=TypeError,o=Object.defineProperty,a=Object.getOwnPropertyDescriptor,l="enumerable",c="configurable",u="writable";return VR.f=t?n?function(d,f,g){if(i(d),f=r(f),i(g),typeof d=="function"&&f==="prototype"&&"value"in g&&u in g&&!g[u]){var m=a(d,f);m&&m[u]&&(d[f]=g.value,g={configurable:c in g?g[c]:m[c],enumerable:l in g?g[l]:m[l],writable:!1})}return o(d,f,g)}:o:function(d,f,g){if(i(d),f=r(f),i(g),e)try{return o(d,f,g)}catch{}if("get"in g||"set"in g)throw new s("Accessors not supported");return"value"in g&&(d[f]=g.value),d},VR}var jR,r$;function Jf(){if(r$)return jR;r$=1;var t=Is(),e=Nc(),n=xS();return jR=t?function(i,r,s){return e.f(i,r,n(1,s))}:function(i,r,s){return i[r]=s,i},jR}var zR={exports:{}},UR,s$;function gse(){if(s$)return UR;s$=1;var t=Is(),e=rs(),n=Function.prototype,i=t&&Object.getOwnPropertyDescriptor,r=e(n,"name"),s=r&&(function(){}).name==="something",o=r&&(!t||t&&i(n,"name").configurable);return UR={EXISTS:r,PROPER:s,CONFIGURABLE:o},UR}var YR,o$;function mse(){if(o$)return YR;o$=1;var t=Nn(),e=ei(),n=RI(),i=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(r){return i(r)}),YR=n.inspectSource,YR}var GR,a$;function pse(){if(a$)return GR;a$=1;var t=kn(),e=ei(),n=t.WeakMap;return GR=e(n)&&/native code/.test(String(n)),GR}var qR,l$;function xI(){if(l$)return qR;l$=1;var t=oq(),e=_I(),n=t("keys");return qR=function(i){return n[i]||(n[i]=e(i))},qR}var KR,c$;function TI(){return c$||(c$=1,KR={}),KR}var XR,u$;function MI(){if(u$)return XR;u$=1;var t=pse(),e=kn(),n=is(),i=Jf(),r=rs(),s=RI(),o=xI(),a=TI(),l="Object already initialized",c=e.TypeError,u=e.WeakMap,h,d,f,g=function(b){return f(b)?d(b):h(b,{})},m=function(b){return function(R){var S;if(!n(R)||(S=d(R)).type!==b)throw new c("Incompatible receiver, "+b+" required");return S}};if(t||s.state){var p=s.state||(s.state=new u);p.get=p.get,p.has=p.has,p.set=p.set,h=function(b,R){if(p.has(b))throw new c(l);return R.facade=b,p.set(b,R),R},d=function(b){return p.get(b)||{}},f=function(b){return p.has(b)}}else{var v=o("state");a[v]=!0,h=function(b,R){if(r(b,v))throw new c(l);return R.facade=b,i(b,v,R),R},d=function(b){return r(b,v)?b[v]:{}},f=function(b){return r(b,v)}}return XR={set:h,get:d,has:f,enforce:g,getterFor:m},XR}var h$;function hq(){if(h$)return zR.exports;h$=1;var t=Nn(),e=Dn(),n=ei(),i=rs(),r=Is(),s=gse().CONFIGURABLE,o=mse(),a=MI(),l=a.enforce,c=a.get,u=String,h=Object.defineProperty,d=t("".slice),f=t("".replace),g=t([].join),m=r&&!e(function(){return h(function(){},"length",{value:8}).length!==8}),p=String(String).split("String"),v=zR.exports=function(b,R,S){d(u(R),0,7)==="Symbol("&&(R="["+f(u(R),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),S&&S.getter&&(R="get "+R),S&&S.setter&&(R="set "+R),(!i(b,"name")||s&&b.name!==R)&&(r?h(b,"name",{value:R,configurable:!0}):b.name=R),m&&S&&i(S,"arity")&&b.length!==S.arity&&h(b,"length",{value:S.arity});try{S&&i(S,"constructor")&&S.constructor?r&&h(b,"prototype",{writable:!1}):b.prototype&&(b.prototype=void 0)}catch{}var x=l(b);return i(x,"source")||(x.source=g(p,typeof R=="string"?R:"")),b};return Function.prototype.toString=v(function(){return n(this)&&c(this).source||o(this)},"toString"),zR.exports}var JR,d$;function PI(){if(d$)return JR;d$=1;var t=ei(),e=Nc(),n=hq(),i=SI();return JR=function(r,s,o,a){a||(a={});var l=a.enumerable,c=a.name!==void 0?a.name:s;if(t(o)&&n(o,c,a),a.global)l?r[s]=o:i(s,o);else{try{a.unsafe?r[s]&&(l=!0):delete r[s]}catch{}l?r[s]=o:e.f(r,s,{value:o,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return r},JR}var ZR={},QR,f$;function wse(){if(f$)return QR;f$=1;var t=Math.ceil,e=Math.floor;return QR=Math.trunc||function(i){var r=+i;return(r>0?e:t)(r)},QR}var e_,g$;function dw(){if(g$)return e_;g$=1;var t=wse();return e_=function(e){var n=+e;return n!==n||n===0?0:t(n)},e_}var t_,m$;function vse(){if(m$)return t_;m$=1;var t=dw(),e=Math.max,n=Math.min;return t_=function(i,r){var s=t(i);return s<0?e(s+r,0):n(s,r)},t_}var n_,p$;function bse(){if(p$)return n_;p$=1;var t=dw(),e=Math.min;return n_=function(n){var i=t(n);return i>0?e(i,9007199254740991):0},n_}var i_,w$;function Zf(){if(w$)return i_;w$=1;var t=bse();return i_=function(e){return t(e.length)},i_}var r_,v$;function yse(){if(v$)return r_;v$=1;var t=cw(),e=vse(),n=Zf(),i=function(r){return function(s,o,a){var l=t(s),c=n(l);if(c===0)return!r&&-1;var u=e(a,c),h;if(r&&o!==o){for(;c>u;)if(h=l[u++],h!==h)return!0}else for(;c>u;u++)if((r||u in l)&&l[u]===o)return r||u||0;return!r&&-1}};return r_={includes:i(!0),indexOf:i(!1)},r_}var s_,b$;function dq(){if(b$)return s_;b$=1;var t=Nn(),e=rs(),n=cw(),i=yse().indexOf,r=TI(),s=t([].push);return s_=function(o,a){var l=n(o),c=0,u=[],h;for(h in l)!e(r,h)&&e(l,h)&&s(u,h);for(;a.length>c;)e(l,h=a[c++])&&(~i(u,h)||s(u,h));return u},s_}var o_,y$;function AI(){return y$||(y$=1,o_=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),o_}var C$;function Cse(){if(C$)return ZR;C$=1;var t=dq(),e=AI(),n=e.concat("length","prototype");return ZR.f=Object.getOwnPropertyNames||function(r){return t(r,n)},ZR}var a_={},S$;function Sse(){return S$||(S$=1,a_.f=Object.getOwnPropertySymbols),a_}var l_,R$;function Rse(){if(R$)return l_;R$=1;var t=Kf(),e=Nn(),n=Cse(),i=Sse(),r=zn(),s=e([].concat);return l_=t("Reflect","ownKeys")||function(a){var l=n.f(r(a)),c=i.f;return c?s(l,c(a)):l},l_}var c_,_$;function fq(){if(_$)return c_;_$=1;var t=rs(),e=Rse(),n=cq(),i=Nc();return c_=function(r,s,o){for(var a=e(s),l=i.f,c=n.f,u=0;u<a.length;u++){var h=a[u];!t(r,h)&&!(o&&t(o,h))&&l(r,h,c(s,h))}},c_}var u_,E$;function _se(){if(E$)return u_;E$=1;var t=Dn(),e=ei(),n=/#|\.prototype\./,i=function(l,c){var u=s[r(l)];return u===a?!0:u===o?!1:e(c)?t(c):!!c},r=i.normalize=function(l){return String(l).replace(n,".").toLowerCase()},s=i.data={},o=i.NATIVE="N",a=i.POLYFILL="P";return u_=i,u_}var h_,x$;function Ot(){if(x$)return h_;x$=1;var t=kn(),e=cq().f,n=Jf(),i=PI(),r=SI(),s=fq(),o=_se();return h_=function(a,l){var c=a.target,u=a.global,h=a.stat,d,f,g,m,p,v;if(u?f=t:h?f=t[c]||r(c,{}):f=t[c]&&t[c].prototype,f)for(g in l){if(p=l[g],a.dontCallGetSet?(v=e(f,g),m=v&&v.value):m=f[g],d=o(u?g:c+(h?".":"#")+g,a.forced),!d&&m!==void 0){if(typeof p==typeof m)continue;s(p,m)}(a.sham||m&&m.sham)&&n(p,"sham",!0),i(f,g,p,a)}},h_}var d_,T$;function fw(){if(T$)return d_;T$=1;var t=ES(),e=Function.prototype,n=e.apply,i=e.call;return d_=typeof Reflect=="object"&&Reflect.apply||(t?i.bind(n):function(){return i.apply(n,arguments)}),d_}var f_,M$;function gq(){if(M$)return f_;M$=1;var t=Nn(),e=Ar();return f_=function(n,i,r){try{return t(e(Object.getOwnPropertyDescriptor(n,i)[r]))}catch{}},f_}var g_,P$;function Ese(){if(P$)return g_;P$=1;var t=is();return g_=function(e){return t(e)||e===null},g_}var m_,A$;function xse(){if(A$)return m_;A$=1;var t=Ese(),e=String,n=TypeError;return m_=function(i){if(t(i))return i;throw new n("Can't set "+e(i)+" as a prototype")},m_}var p_,I$;function mq(){if(I$)return p_;I$=1;var t=gq(),e=is(),n=lw(),i=xse();return p_=Object.setPrototypeOf||("__proto__"in{}?(function(){var r=!1,s={},o;try{o=t(Object.prototype,"__proto__","set"),o(s,[]),r=s instanceof Array}catch{}return function(l,c){return n(l),i(c),e(l)&&(r?o(l,c):l.__proto__=c),l}})():void 0),p_}var w_,O$;function Tse(){if(O$)return w_;O$=1;var t=Nc().f;return w_=function(e,n,i){i in e||t(e,i,{configurable:!0,get:function(){return n[i]},set:function(r){n[i]=r}})},w_}var v_,H$;function Mse(){if(H$)return v_;H$=1;var t=ei(),e=is(),n=mq();return v_=function(i,r,s){var o,a;return n&&t(o=r.constructor)&&o!==s&&e(a=o.prototype)&&a!==s.prototype&&n(i,a),i},v_}var b_,k$;function Pse(){if(k$)return b_;k$=1;var t=go(),e=t("toStringTag"),n={};return n[e]="z",b_=String(n)==="[object z]",b_}var y_,D$;function pq(){if(D$)return y_;D$=1;var t=Pse(),e=ei(),n=Lh(),i=go(),r=i("toStringTag"),s=Object,o=n((function(){return arguments})())==="Arguments",a=function(l,c){try{return l[c]}catch{}};return y_=t?n:function(l){var c,u,h;return l===void 0?"Undefined":l===null?"Null":typeof(u=a(c=s(l),r))=="string"?u:o?n(c):(h=n(c))==="Object"&&e(c.callee)?"Arguments":h},y_}var C_,N$;function PS(){if(N$)return C_;N$=1;var t=pq(),e=String;return C_=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},C_}var S_,L$;function Ase(){if(L$)return S_;L$=1;var t=PS();return S_=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},S_}var R_,$$;function Ise(){if($$)return R_;$$=1;var t=is(),e=Jf();return R_=function(n,i){t(i)&&"cause"in i&&e(n,"cause",i.cause)},R_}var __,F$;function Ose(){if(F$)return __;F$=1;var t=Nn(),e=Error,n=t("".replace),i=(function(o){return String(new e(o).stack)})("zxcasd"),r=/\n\s*at [^:]*:[^\n]*/,s=r.test(i);return __=function(o,a){if(s&&typeof o=="string"&&!e.prepareStackTrace)for(;a--;)o=n(o,r,"");return o},__}var E_,V$;function Hse(){if(V$)return E_;V$=1;var t=Dn(),e=xS();return E_=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),E_}var x_,B$;function kse(){if(B$)return x_;B$=1;var t=Jf(),e=Ose(),n=Hse(),i=Error.captureStackTrace;return x_=function(r,s,o,a){n&&(i?i(r,s):t(r,"stack",e(o,a)))},x_}var T_,W$;function Dse(){if(W$)return T_;W$=1;var t=Kf(),e=rs(),n=Jf(),i=uw(),r=mq(),s=fq(),o=Tse(),a=Mse(),l=Ase(),c=Ise(),u=kse(),h=Is(),d=Dc();return T_=function(f,g,m,p){var v="stackTraceLimit",b=p?2:1,R=f.split("."),S=R[R.length-1],x=t.apply(null,R);if(x){var M=x.prototype;if(!d&&e(M,"cause")&&delete M.cause,!m)return x;var T=t("Error"),O=g(function(W,N){var G=l(p?N:W,void 0),j=p?new x(W):new x;return G!==void 0&&n(j,"message",G),u(j,O,j.stack,2),this&&i(M,this)&&a(j,this,O),arguments.length>b&&c(j,arguments[b]),j});if(O.prototype=M,S!=="Error"?r?r(O,T):s(O,T,{name:!0}):h&&v in x&&(o(O,x,v),o(O,x,"prepareStackTrace")),s(O,x),!d)try{M.name!==S&&n(M,"name",S),M.constructor=O}catch{}return O}},T_}var j$;function Nse(){if(j$)return mL;j$=1;var t=Ot(),e=kn(),n=fw(),i=Dse(),r="WebAssembly",s=e[r],o=new Error("e",{cause:7}).cause!==7,a=function(c,u){var h={};h[c]=i(c,u,o),t({global:!0,constructor:!0,arity:1,forced:o},h)},l=function(c,u){if(s&&s[c]){var h={};h[c]=i(r+"."+c,u,o),t({target:r,stat:!0,constructor:!0,arity:1,forced:o},h)}};return a("Error",function(c){return function(h){return n(c,this,arguments)}}),a("EvalError",function(c){return function(h){return n(c,this,arguments)}}),a("RangeError",function(c){return function(h){return n(c,this,arguments)}}),a("ReferenceError",function(c){return function(h){return n(c,this,arguments)}}),a("SyntaxError",function(c){return function(h){return n(c,this,arguments)}}),a("TypeError",function(c){return function(h){return n(c,this,arguments)}}),a("URIError",function(c){return function(h){return n(c,this,arguments)}}),l("CompileError",function(c){return function(h){return n(c,this,arguments)}}),l("LinkError",function(c){return function(h){return n(c,this,arguments)}}),l("RuntimeError",function(c){return function(h){return n(c,this,arguments)}}),mL}Nse();var z$={},M_,U$;function wq(){if(U$)return M_;U$=1;var t=Lh();return M_=Array.isArray||function(n){return t(n)==="Array"},M_}var P_,Y$;function vq(){if(Y$)return P_;Y$=1;var t=Is(),e=wq(),n=TypeError,i=Object.getOwnPropertyDescriptor,r=t&&!(function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(s){return s instanceof TypeError}})();return P_=r?function(s,o){if(e(s)&&!i(s,"length").writable)throw new n("Cannot set read only .length");return s.length=o}:function(s,o){return s.length=o},P_}var A_,G$;function bq(){if(G$)return A_;G$=1;var t=TypeError,e=9007199254740991;return A_=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},A_}var q$;function Lse(){if(q$)return z$;q$=1;var t=Ot(),e=Xf(),n=Zf(),i=vq(),r=bq(),s=Dn(),o=s(function(){return[].push.call({length:4294967296},1)!==4294967297}),a=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(c){return c instanceof TypeError}},l=o||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{push:function(u){var h=e(this),d=n(h),f=arguments.length;r(d+f);for(var g=0;g<f;g++)h[d]=arguments[g],d++;return i(h,d),d}}),z$}Lse();var K$={},I_,X$;function $se(){if(X$)return I_;X$=1;var t=Lh(),e=Nn();return I_=function(n){if(t(n)==="Function")return e(n)},I_}var O_,J$;function yq(){if(J$)return O_;J$=1;var t=$se(),e=Ar(),n=ES(),i=t(t.bind);return O_=function(r,s){return e(r),s===void 0?r:n?i(r,s):function(){return r.apply(s,arguments)}},O_}var H_,Z$;function Cq(){return Z$||(Z$=1,H_={}),H_}var k_,Q$;function Fse(){if(Q$)return k_;Q$=1;var t=go(),e=Cq(),n=t("iterator"),i=Array.prototype;return k_=function(r){return r!==void 0&&(e.Array===r||i[n]===r)},k_}var D_,eF;function II(){if(eF)return D_;eF=1;var t=pq(),e=hw(),n=bI(),i=Cq(),r=go(),s=r("iterator");return D_=function(o){if(!n(o))return e(o,s)||e(o,"@@iterator")||i[t(o)]},D_}var N_,tF;function Vse(){if(tF)return N_;tF=1;var t=jn(),e=Ar(),n=zn(),i=MS(),r=II(),s=TypeError;return N_=function(o,a){var l=arguments.length<2?r(o):a;if(e(l))return n(t(l,o));throw new s(i(o)+" is not iterable")},N_}var L_,nF;function Ir(){if(nF)return L_;nF=1;var t=jn(),e=zn(),n=hw();return L_=function(i,r,s){var o,a;e(i);try{if(o=n(i,"return"),!o){if(r==="throw")throw s;return s}o=t(o,i)}catch(l){a=!0,o=l}if(r==="throw")throw s;if(a)throw o;return e(o),s},L_}var $_,iF;function Qf(){if(iF)return $_;iF=1;var t=yq(),e=jn(),n=zn(),i=MS(),r=Fse(),s=Zf(),o=uw(),a=Vse(),l=II(),c=Ir(),u=TypeError,h=function(f,g){this.stopped=f,this.result=g},d=h.prototype;return $_=function(f,g,m){var p=m&&m.that,v=!!(m&&m.AS_ENTRIES),b=!!(m&&m.IS_RECORD),R=!!(m&&m.IS_ITERATOR),S=!!(m&&m.INTERRUPTED),x=t(g,p),M,T,O,W,N,G,j,ne=function(Q){return M&&c(M,"normal"),new h(!0,Q)},ee=function(Q){return v?(n(Q),S?x(Q[0],Q[1],ne):x(Q[0],Q[1])):S?x(Q,ne):x(Q)};if(b)M=f.iterator;else if(R)M=f;else{if(T=l(f),!T)throw new u(i(f)+" is not iterable");if(r(T)){for(O=0,W=s(f);W>O;O++)if(N=ee(f[O]),N&&o(d,N))return N;return new h(!1)}M=a(f,T)}for(G=b?f.next:M.next;!(j=e(G,M)).done;){try{N=ee(j.value)}catch(Q){c(M,"throw",Q)}if(typeof N=="object"&&N&&o(d,N))return N}return new h(!1)},$_}var F_,rF;function Sq(){if(rF)return F_;rF=1;var t=Is(),e=Nc(),n=xS();return F_=function(i,r,s){t?e.f(i,r,n(0,s)):i[r]=s},F_}var sF;function Bse(){if(sF)return K$;sF=1;var t=Ot(),e=Qf(),n=Sq();return t({target:"Object",stat:!0},{fromEntries:function(r){var s={};return e(r,function(o,a){n(s,o,a)},{AS_ENTRIES:!0}),s}}),K$}Bse();var oF={},V_,aF;function ua(){if(aF)return V_;aF=1;var t=Nn(),e=Set.prototype;return V_={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},V_}var B_,lF;function $h(){if(lF)return B_;lF=1;var t=ua().has;return B_=function(e){return t(e),e},B_}var W_,cF;function Fh(){if(cF)return W_;cF=1;var t=jn();return W_=function(e,n,i){for(var r=i?e:e.iterator,s=e.next,o,a;!(o=t(s,r)).done;)if(a=n(o.value),a!==void 0)return a},W_}var j_,uF;function gw(){if(uF)return j_;uF=1;var t=Nn(),e=Fh(),n=ua(),i=n.Set,r=n.proto,s=t(r.forEach),o=t(r.keys),a=o(new i).next;return j_=function(l,c,u){return u?e({iterator:o(l),next:a},c):s(l,c)},j_}var z_,hF;function OI(){if(hF)return z_;hF=1;var t=ua(),e=gw(),n=t.Set,i=t.add;return z_=function(r){var s=new n;return e(r,function(o){i(s,o)}),s},z_}var U_,dF;function mw(){if(dF)return U_;dF=1;var t=gq(),e=ua();return U_=t(e.proto,"size","get")||function(n){return n.size},U_}var Y_,fF;function ha(){return fF||(fF=1,Y_=function(t){return{iterator:t,next:t.next,done:!1}}),Y_}var G_,gF;function Vh(){if(gF)return G_;gF=1;var t=Ar(),e=zn(),n=jn(),i=dw(),r=ha(),s="Invalid size",o=RangeError,a=TypeError,l=Math.max,c=function(u,h){this.set=u,this.size=l(h,0),this.has=t(u.has),this.keys=t(u.keys)};return c.prototype={getIterator:function(){return r(e(n(this.keys,this.set)))},includes:function(u){return n(this.has,this.set,u)}},G_=function(u){e(u);var h=+u.size;if(h!==h)throw new a(s);var d=i(h);if(d<0)throw new o(s);return new c(u,d)},G_}var q_,mF;function Wse(){if(mF)return q_;mF=1;var t=$h(),e=ua(),n=OI(),i=mw(),r=Vh(),s=gw(),o=Fh(),a=e.has,l=e.remove;return q_=function(u){var h=t(this),d=r(u),f=n(h);return i(h)<=d.size?s(h,function(g){d.includes(g)&&l(f,g)}):o(d.getIterator(),function(g){a(f,g)&&l(f,g)}),f},q_}var K_,pF;function Bh(){if(pF)return K_;pF=1;var t=Kf(),e=function(i){return{size:i,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(i){return{size:i,has:function(){return!0},keys:function(){throw new Error("e")}}};return K_=function(i,r){var s=t("Set");try{new s()[i](e(0));try{return new s()[i](e(-1)),!1}catch{if(!r)return!0;try{return new s()[i](n(-1/0)),!1}catch{var o=new s([1,2]);return r(o[i](n(1/0)))}}}catch{return!1}},K_}var wF;function jse(){if(wF)return oF;wF=1;var t=Ot(),e=Wse(),n=Dn(),i=Bh(),r=!i("difference",function(o){return o.size===0}),s=r||n(function(){var o={size:1,has:function(){return!0},keys:function(){var l=0;return{next:function(){var c=l++>1;return a.has(1)&&a.clear(),{done:c,value:2}}}}},a=new Set([1,2,3,4]);return a.difference(o).size!==3});return t({target:"Set",proto:!0,real:!0,forced:s},{difference:e}),oF}jse();var vF={},X_,bF;function zse(){if(bF)return X_;bF=1;var t=$h(),e=ua(),n=mw(),i=Vh(),r=gw(),s=Fh(),o=e.Set,a=e.add,l=e.has;return X_=function(u){var h=t(this),d=i(u),f=new o;return n(h)>d.size?s(d.getIterator(),function(g){l(h,g)&&a(f,g)}):r(h,function(g){d.includes(g)&&a(f,g)}),f},X_}var yF;function Use(){if(yF)return vF;yF=1;var t=Ot(),e=Dn(),n=zse(),i=Bh(),r=!i("intersection",function(s){return s.size===2&&s.has(1)&&s.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:r},{intersection:n}),vF}Use();var CF={},J_,SF;function Yse(){if(SF)return J_;SF=1;var t=$h(),e=ua().has,n=mw(),i=Vh(),r=gw(),s=Fh(),o=Ir();return J_=function(l){var c=t(this),u=i(l);if(n(c)<=u.size)return r(c,function(d){if(u.includes(d))return!1},!0)!==!1;var h=u.getIterator();return s(h,function(d){if(e(c,d))return o(h,"normal",!1)})!==!1},J_}var RF;function Gse(){if(RF)return CF;RF=1;var t=Ot(),e=Yse(),n=Bh(),i=!n("isDisjointFrom",function(r){return!r});return t({target:"Set",proto:!0,real:!0,forced:i},{isDisjointFrom:e}),CF}Gse();var _F={},Z_,EF;function qse(){if(EF)return Z_;EF=1;var t=$h(),e=mw(),n=gw(),i=Vh();return Z_=function(s){var o=t(this),a=i(s);return e(o)>a.size?!1:n(o,function(l){if(!a.includes(l))return!1},!0)!==!1},Z_}var xF;function Kse(){if(xF)return _F;xF=1;var t=Ot(),e=qse(),n=Bh(),i=!n("isSubsetOf",function(r){return r});return t({target:"Set",proto:!0,real:!0,forced:i},{isSubsetOf:e}),_F}Kse();var TF={},Q_,MF;function Xse(){if(MF)return Q_;MF=1;var t=$h(),e=ua().has,n=mw(),i=Vh(),r=Fh(),s=Ir();return Q_=function(a){var l=t(this),c=i(a);if(n(l)<c.size)return!1;var u=c.getIterator();return r(u,function(h){if(!e(l,h))return s(u,"normal",!1)})!==!1},Q_}var PF;function Jse(){if(PF)return TF;PF=1;var t=Ot(),e=Xse(),n=Bh(),i=!n("isSupersetOf",function(r){return!r});return t({target:"Set",proto:!0,real:!0,forced:i},{isSupersetOf:e}),TF}Jse();var AF={},eE,IF;function Zse(){if(IF)return eE;IF=1;var t=$h(),e=ua(),n=OI(),i=Vh(),r=Fh(),s=e.add,o=e.has,a=e.remove;return eE=function(c){var u=t(this),h=i(c).getIterator(),d=n(u);return r(h,function(f){o(u,f)?a(d,f):s(d,f)}),d},eE}var tE,OF;function Rq(){return OF||(OF=1,tE=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},i=e[t](n);return i.size===1&&i.values().next().value===4}catch{return!1}}),tE}var HF;function Qse(){if(HF)return AF;HF=1;var t=Ot(),e=Zse(),n=Rq(),i=Bh(),r=!i("symmetricDifference")||!n("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:r},{symmetricDifference:e}),AF}Qse();var kF={},nE,DF;function eoe(){if(DF)return nE;DF=1;var t=$h(),e=ua().add,n=OI(),i=Vh(),r=Fh();return nE=function(o){var a=t(this),l=i(o).getIterator(),c=n(a);return r(l,function(u){e(c,u)}),c},nE}var NF;function toe(){if(NF)return kF;NF=1;var t=Ot(),e=eoe(),n=Rq(),i=Bh(),r=!i("union")||!n("union");return t({target:"Set",proto:!0,real:!0,forced:r},{union:e}),kF}toe();var LF={},$F={},iE,FF;function noe(){if(FF)return iE;FF=1;var t=uw(),e=TypeError;return iE=function(n,i){if(t(i,n))return n;throw new e("Incorrect invocation")},iE}var rE,VF;function ioe(){if(VF)return rE;VF=1;var t=Dn();return rE=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),rE}var sE,BF;function _q(){if(BF)return sE;BF=1;var t=rs(),e=ei(),n=Xf(),i=xI(),r=ioe(),s=i("IE_PROTO"),o=Object,a=o.prototype;return sE=r?o.getPrototypeOf:function(l){var c=n(l);if(t(c,s))return c[s];var u=c.constructor;return e(u)&&c instanceof u?u.prototype:c instanceof o?a:null},sE}var oE,WF;function roe(){if(WF)return oE;WF=1;var t=hq(),e=Nc();return oE=function(n,i,r){return r.get&&t(r.get,i,{getter:!0}),r.set&&t(r.set,i,{setter:!0}),e.f(n,i,r)},oE}var aE={},lE,jF;function soe(){if(jF)return lE;jF=1;var t=dq(),e=AI();return lE=Object.keys||function(i){return t(i,e)},lE}var zF;function ooe(){if(zF)return aE;zF=1;var t=Is(),e=uq(),n=Nc(),i=zn(),r=cw(),s=soe();return aE.f=t&&!e?Object.defineProperties:function(a,l){i(a);for(var c=r(l),u=s(l),h=u.length,d=0,f;h>d;)n.f(a,f=u[d++],c[f]);return a},aE}var cE,UF;function Eq(){if(UF)return cE;UF=1;var t=Kf();return cE=t("document","documentElement"),cE}var uE,YF;function HI(){if(YF)return uE;YF=1;var t=zn(),e=ooe(),n=AI(),i=TI(),r=Eq(),s=EI(),o=xI(),a=">",l="<",c="prototype",u="script",h=o("IE_PROTO"),d=function(){},f=function(b){return l+u+a+b+l+"/"+u+a},g=function(b){b.write(f("")),b.close();var R=b.parentWindow.Object;return b=null,R},m=function(){var b=s("iframe"),R="java"+u+":",S;return b.style.display="none",r.appendChild(b),b.src=String(R),S=b.contentWindow.document,S.open(),S.write(f("document.F=Object")),S.close(),S.F},p,v=function(){try{p=new ActiveXObject("htmlfile")}catch{}v=typeof document<"u"?document.domain&&p?g(p):m():g(p);for(var b=n.length;b--;)delete v[c][n[b]];return v()};return i[h]=!0,uE=Object.create||function(R,S){var x;return R!==null?(d[c]=t(R),x=new d,d[c]=null,x[h]=R):x=v(),S===void 0?x:e.f(x,S)},uE}var hE,GF;function xq(){if(GF)return hE;GF=1;var t=Dn(),e=ei(),n=is(),i=HI(),r=_q(),s=PI(),o=go(),a=Dc(),l=o("iterator"),c=!1,u,h,d;[].keys&&(d=[].keys(),"next"in d?(h=r(r(d)),h!==Object.prototype&&(u=h)):c=!0);var f=!n(u)||t(function(){var g={};return u[l].call(g)!==g});return f?u={}:a&&(u=i(u)),e(u[l])||s(u,l,function(){return this}),hE={IteratorPrototype:u,BUGGY_SAFARI_ITERATORS:c},hE}var qF;function aoe(){if(qF)return $F;qF=1;var t=Ot(),e=kn(),n=noe(),i=zn(),r=ei(),s=_q(),o=roe(),a=Sq(),l=Dn(),c=rs(),u=go(),h=xq().IteratorPrototype,d=Is(),f=Dc(),g="constructor",m="Iterator",p=u("toStringTag"),v=TypeError,b=e[m],R=f||!r(b)||b.prototype!==h||!l(function(){b({})}),S=function(){if(n(this,h),s(this)===h)throw new v("Abstract class Iterator not directly constructable")},x=function(M,T){d?o(h,M,{configurable:!0,get:function(){return T},set:function(O){if(i(this),this===h)throw new v("You can't redefine this property");c(this,M)?this[M]=O:a(this,M,O)}}):h[M]=T};return c(h,p)||x(p,m),(R||!c(h,g)||h[g]===Object)&&x(g,S),S.prototype=h,t({global:!0,constructor:!0,forced:R},{Iterator:S}),$F}var KF;function loe(){return KF||(KF=1,aoe()),LF}loe();var XF={},JF={},dE,ZF;function coe(){if(ZF)return dE;ZF=1;var t=PI();return dE=function(e,n,i){for(var r in n)t(e,r,n[r],i);return e},dE}var fE,QF;function uoe(){return QF||(QF=1,fE=function(t,e){return{value:t,done:e}}),fE}var gE,eV;function hoe(){if(eV)return gE;eV=1;var t=Ir();return gE=function(e,n,i){for(var r=e.length-1;r>=0;r--)if(e[r]!==void 0)try{i=t(e[r].iterator,n,i)}catch(s){n="throw",i=s}if(n==="throw")throw i;return i},gE}var mE,tV;function kI(){if(tV)return mE;tV=1;var t=jn(),e=HI(),n=Jf(),i=coe(),r=go(),s=MI(),o=hw(),a=xq().IteratorPrototype,l=uoe(),c=Ir(),u=hoe(),h=r("toStringTag"),d="IteratorHelper",f="WrapForValidIterator",g="normal",m="throw",p=s.set,v=function(S){var x=s.getterFor(S?f:d);return i(e(a),{next:function(){var T=x(this);if(S)return T.nextHandler();if(T.done)return l(void 0,!0);try{var O=T.nextHandler();return T.returnHandlerResult?O:l(O,T.done)}catch(W){throw T.done=!0,W}},return:function(){var M=x(this),T=M.iterator;if(M.done=!0,S){var O=o(T,"return");return O?t(O,T):l(void 0,!0)}if(M.inner)try{c(M.inner.iterator,g)}catch(W){return c(T,m,W)}if(M.openIters)try{u(M.openIters,g)}catch(W){return c(T,m,W)}return T&&c(T,g),l(void 0,!0)}})},b=v(!0),R=v(!1);return n(R,h,"Iterator Helper"),mE=function(S,x,M){var T=function(W,N){N?(N.iterator=W.iterator,N.next=W.next):N=W,N.type=x?f:d,N.returnHandlerResult=!!M,N.nextHandler=S,N.counter=0,N.done=!1,p(this,N)};return T.prototype=x?b:R,T},mE}var pE,nV;function Tq(){if(nV)return pE;nV=1;var t=zn(),e=Ir();return pE=function(n,i,r,s){try{return s?i(t(r)[0],r[1]):i(r)}catch(o){e(n,"throw",o)}},pE}var wE,iV;function DI(){return iV||(iV=1,wE=function(t,e){var n=typeof Iterator=="function"&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch{return!0}}),wE}var vE,rV;function Lc(){if(rV)return vE;rV=1;var t=kn();return vE=function(e,n){var i=t.Iterator,r=i&&i.prototype,s=r&&r[e],o=!1;if(s)try{s.call({next:function(){return{done:!0}},return:function(){o=!0}},-1)}catch(a){a instanceof n||(o=!1)}if(!o)return s},vE}var sV;function doe(){if(sV)return JF;sV=1;var t=Ot(),e=jn(),n=Ar(),i=zn(),r=ha(),s=kI(),o=Tq(),a=Dc(),l=Ir(),c=DI(),u=Lc(),h=!a&&!c("filter",function(){}),d=!a&&!h&&u("filter",TypeError),f=a||h||d,g=s(function(){for(var m=this.iterator,p=this.predicate,v=this.next,b,R,S;;){if(b=i(e(v,m)),R=this.done=!!b.done,R)return;if(S=b.value,o(m,p,[S,this.counter++],!0))return S}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{filter:function(p){i(this);try{n(p)}catch(v){l(this,"throw",v)}return d?e(d,this,p):new g(r(this),{predicate:p})}}),JF}var oV;function foe(){return oV||(oV=1,doe()),XF}foe();var aV={},lV={},cV;function goe(){if(cV)return lV;cV=1;var t=Ot(),e=jn(),n=Qf(),i=Ar(),r=zn(),s=ha(),o=Ir(),a=Lc(),l=a("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{forEach:function(u){r(this);try{i(u)}catch(f){o(this,"throw",f)}if(l)return e(l,this,u);var h=s(this),d=0;n(h,function(f){u(f,d++)},{IS_RECORD:!0})}}),lV}var uV;function moe(){return uV||(uV=1,goe()),aV}moe();var hV={},dV={},fV;function poe(){if(fV)return dV;fV=1;var t=Ot(),e=jn(),n=Ar(),i=zn(),r=ha(),s=kI(),o=Tq(),a=Ir(),l=DI(),c=Lc(),u=Dc(),h=!u&&!l("map",function(){}),d=!u&&!h&&c("map",TypeError),f=u||h||d,g=s(function(){var m=this.iterator,p=i(e(this.next,m)),v=this.done=!!p.done;if(!v)return o(m,this.mapper,[p.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:f},{map:function(p){i(this);try{n(p)}catch(v){a(this,"throw",v)}return d?e(d,this,p):new g(r(this),{mapper:p})}}),dV}var gV;function woe(){return gV||(gV=1,poe()),hV}woe();var mV={},pV={},bE,wV;function NI(){if(wV)return bE;wV=1;var t=Nn();return bE=t([].slice),bE}var yE,vV;function Mq(){if(vV)return yE;vV=1;var t=TypeError;return yE=function(e,n){if(e<n)throw new t("Not enough arguments");return e},yE}var CE,bV;function voe(){if(bV)return CE;bV=1;var t=TS();return CE=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),CE}var SE,yV;function Pq(){if(yV)return SE;yV=1;var t=kn(),e=TS(),n=Lh(),i=function(r){return e.slice(0,r.length)===r};return SE=(function(){return i("Bun/")?"BUN":i("Cloudflare-Workers")?"CLOUDFLARE":i("Deno/")?"DENO":i("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":n(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"})(),SE}var RE,CV;function boe(){if(CV)return RE;CV=1;var t=Pq();return RE=t==="NODE",RE}var _E,SV;function Aq(){if(SV)return _E;SV=1;var t=kn(),e=fw(),n=yq(),i=ei(),r=rs(),s=Dn(),o=Eq(),a=NI(),l=EI(),c=Mq(),u=voe(),h=boe(),d=t.setImmediate,f=t.clearImmediate,g=t.process,m=t.Dispatch,p=t.Function,v=t.MessageChannel,b=t.String,R=0,S={},x="onreadystatechange",M,T,O,W;s(function(){M=t.location});var N=function(ee){if(r(S,ee)){var Q=S[ee];delete S[ee],Q()}},G=function(ee){return function(){N(ee)}},j=function(ee){N(ee.data)},ne=function(ee){t.postMessage(b(ee),M.protocol+"//"+M.host)};return(!d||!f)&&(d=function(Q){c(arguments.length,1);var me=i(Q)?Q:p(Q),fe=a(arguments,1);return S[++R]=function(){e(me,void 0,fe)},T(R),R},f=function(Q){delete S[Q]},h?T=function(ee){g.nextTick(G(ee))}:m&&m.now?T=function(ee){m.now(G(ee))}:v&&!u?(O=new v,W=O.port2,O.port1.onmessage=j,T=n(W.postMessage,W)):t.addEventListener&&i(t.postMessage)&&!t.importScripts&&M&&M.protocol!=="file:"&&!s(ne)?(T=ne,t.addEventListener("message",j,!1)):x in l("script")?T=function(ee){o.appendChild(l("script"))[x]=function(){o.removeChild(this),N(ee)}}:T=function(ee){setTimeout(G(ee),0)}),_E={set:d,clear:f},_E}var RV;function yoe(){if(RV)return pV;RV=1;var t=Ot(),e=kn(),n=Aq().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),pV}var _V={},EE,EV;function Coe(){if(EV)return EE;EV=1;var t=kn(),e=fw(),n=ei(),i=Pq(),r=TS(),s=NI(),o=Mq(),a=t.Function,l=/MSIE .\./.test(r)||i==="BUN"&&(function(){var c=t.Bun.version.split(".");return c.length<3||c[0]==="0"&&(c[1]<3||c[1]==="3"&&c[2]==="0")})();return EE=function(c,u){var h=u?2:1;return l?function(d,f){var g=o(arguments.length,1)>h,m=n(d)?d:a(d),p=g?s(arguments,h):[],v=g?function(){e(m,this,p)}:m;return u?c(v,f):c(v)}:c},EE}var xV;function Soe(){if(xV)return _V;xV=1;var t=Ot(),e=kn(),n=Aq().set,i=Coe(),r=e.setImmediate?i(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==r},{setImmediate:r}),_V}var TV;function Roe(){return TV||(TV=1,yoe(),Soe()),mV}Roe();const{entries:Iq,setPrototypeOf:MV,isFrozen:_oe,getPrototypeOf:Eoe,getOwnPropertyDescriptor:xoe}=Object;let{freeze:nr,seal:Ps,create:iP}=Object,{apply:rP,construct:sP}=typeof Reflect<"u"&&Reflect;nr||(nr=function(e){return e});Ps||(Ps=function(e){return e});rP||(rP=function(e,n){for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];return e.apply(n,r)});sP||(sP=function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return new e(...i)});const cv=ir(Array.prototype.forEach),Toe=ir(Array.prototype.lastIndexOf),PV=ir(Array.prototype.pop),Sg=ir(Array.prototype.push),Moe=ir(Array.prototype.splice),Zb=ir(String.prototype.toLowerCase),xE=ir(String.prototype.toString),TE=ir(String.prototype.match),Rg=ir(String.prototype.replace),Poe=ir(String.prototype.indexOf),Aoe=ir(String.prototype.trim),Ys=ir(Object.prototype.hasOwnProperty),Bi=ir(RegExp.prototype.test),_g=Ioe(TypeError);function ir(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return rP(t,e,i)}}function Ioe(t){return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return sP(t,n)}}function tt(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Zb;MV&&MV(t,null);let i=e.length;for(;i--;){let r=e[i];if(typeof r=="string"){const s=n(r);s!==r&&(_oe(e)||(e[i]=s),r=s)}t[r]=!0}return t}function Ooe(t){for(let e=0;e<t.length;e++)Ys(t,e)||(t[e]=null);return t}function $o(t){const e=iP(null);for(const[n,i]of Iq(t))Ys(t,n)&&(Array.isArray(i)?e[n]=Ooe(i):i&&typeof i=="object"&&i.constructor===Object?e[n]=$o(i):e[n]=i);return e}function Eg(t,e){for(;t!==null;){const i=xoe(t,e);if(i){if(i.get)return ir(i.get);if(typeof i.value=="function")return ir(i.value)}t=Eoe(t)}function n(){return null}return n}const AV=nr(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ME=nr(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),PE=nr(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Hoe=nr(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),AE=nr(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),koe=nr(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),IV=nr(["#text"]),OV=nr(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),IE=nr(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),HV=nr(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),uv=nr(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Doe=Ps(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Noe=Ps(/<%[\w\W]*|[\w\W]*%>/gm),Loe=Ps(/\$\{[\w\W]*/gm),$oe=Ps(/^data-[\-\w.\u00B7-\uFFFF]+$/),Foe=Ps(/^aria-[\-\w]+$/),Oq=Ps(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Voe=Ps(/^(?:\w+script|data):/i),Boe=Ps(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Hq=Ps(/^html$/i),Woe=Ps(/^[a-z][.\w]*(-[.\w]+)+$/i);var kV=Object.freeze({__proto__:null,ARIA_ATTR:Foe,ATTR_WHITESPACE:Boe,CUSTOM_ELEMENT:Woe,DATA_ATTR:$oe,DOCTYPE_NAME:Hq,ERB_EXPR:Noe,IS_ALLOWED_URI:Oq,IS_SCRIPT_OR_DATA:Voe,MUSTACHE_EXPR:Doe,TMPLIT_EXPR:Loe});const xg={element:1,text:3,progressingInstruction:7,comment:8,document:9},joe=function(){return typeof window>"u"?null:window},zoe=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const r="data-tt-policy-suffix";n&&n.hasAttribute(r)&&(i=n.getAttribute(r));const s="dompurify"+(i?"#"+i:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},DV=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function kq(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:joe();const e=_e=>kq(_e);if(e.version="3.3.1",e.removed=[],!t||!t.document||t.document.nodeType!==xg.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const i=n,r=i.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:a,Element:l,NodeFilter:c,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:h,DOMParser:d,trustedTypes:f}=t,g=l.prototype,m=Eg(g,"cloneNode"),p=Eg(g,"remove"),v=Eg(g,"nextSibling"),b=Eg(g,"childNodes"),R=Eg(g,"parentNode");if(typeof o=="function"){const _e=n.createElement("template");_e.content&&_e.content.ownerDocument&&(n=_e.content.ownerDocument)}let S,x="";const{implementation:M,createNodeIterator:T,createDocumentFragment:O,getElementsByTagName:W}=n,{importNode:N}=i;let G=DV();e.isSupported=typeof Iq=="function"&&typeof R=="function"&&M&&M.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:j,ERB_EXPR:ne,TMPLIT_EXPR:ee,DATA_ATTR:Q,ARIA_ATTR:me,IS_SCRIPT_OR_DATA:fe,ATTR_WHITESPACE:ye,CUSTOM_ELEMENT:Oe}=kV;let{IS_ALLOWED_URI:Ce}=kV,Te=null;const $e=tt({},[...AV,...ME,...PE,...AE,...IV]);let Me=null;const X=tt({},[...OV,...IE,...HV,...uv]);let w=Object.seal(iP(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),C=null,E=null;const D=Object.seal(iP(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let B=!0,y=!0,_=!1,P=!0,L=!1,I=!0,A=!1,V=!1,H=!1,$=!1,U=!1,z=!1,J=!0,ce=!1;const re="user-content-";let Pe=!0,Je=!1,at={},Ae=null;const Ze=tt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let dt=null;const fn=tt({},["audio","video","img","source","image","track"]);let fi=null;const os=tt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),gn="http://www.w3.org/1998/Math/MathML",Or="http://www.w3.org/2000/svg",$t="http://www.w3.org/1999/xhtml";let Ht=$t,rt=!1,wl=null;const vl=tt({},[gn,Or,$t],xE);let po=tt({},["mi","mo","mn","ms","mtext"]),bl=tt({},["annotation-xml"]);const as=tt({},["title","style","font","a","script"]);let gi=null;const Bw=["application/xhtml+xml","text/html"],Ww="text/html";let Yn=null,Yh=null;const s6=n.createElement("form"),Yk=function(F){return F instanceof RegExp||F instanceof Function},M0=function(){let F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Yh&&Yh===F)){if((!F||typeof F!="object")&&(F={}),F=$o(F),gi=Bw.indexOf(F.PARSER_MEDIA_TYPE)===-1?Ww:F.PARSER_MEDIA_TYPE,Yn=gi==="application/xhtml+xml"?xE:Zb,Te=Ys(F,"ALLOWED_TAGS")?tt({},F.ALLOWED_TAGS,Yn):$e,Me=Ys(F,"ALLOWED_ATTR")?tt({},F.ALLOWED_ATTR,Yn):X,wl=Ys(F,"ALLOWED_NAMESPACES")?tt({},F.ALLOWED_NAMESPACES,xE):vl,fi=Ys(F,"ADD_URI_SAFE_ATTR")?tt($o(os),F.ADD_URI_SAFE_ATTR,Yn):os,dt=Ys(F,"ADD_DATA_URI_TAGS")?tt($o(fn),F.ADD_DATA_URI_TAGS,Yn):fn,Ae=Ys(F,"FORBID_CONTENTS")?tt({},F.FORBID_CONTENTS,Yn):Ze,C=Ys(F,"FORBID_TAGS")?tt({},F.FORBID_TAGS,Yn):$o({}),E=Ys(F,"FORBID_ATTR")?tt({},F.FORBID_ATTR,Yn):$o({}),at=Ys(F,"USE_PROFILES")?F.USE_PROFILES:!1,B=F.ALLOW_ARIA_ATTR!==!1,y=F.ALLOW_DATA_ATTR!==!1,_=F.ALLOW_UNKNOWN_PROTOCOLS||!1,P=F.ALLOW_SELF_CLOSE_IN_ATTR!==!1,L=F.SAFE_FOR_TEMPLATES||!1,I=F.SAFE_FOR_XML!==!1,A=F.WHOLE_DOCUMENT||!1,$=F.RETURN_DOM||!1,U=F.RETURN_DOM_FRAGMENT||!1,z=F.RETURN_TRUSTED_TYPE||!1,H=F.FORCE_BODY||!1,J=F.SANITIZE_DOM!==!1,ce=F.SANITIZE_NAMED_PROPS||!1,Pe=F.KEEP_CONTENT!==!1,Je=F.IN_PLACE||!1,Ce=F.ALLOWED_URI_REGEXP||Oq,Ht=F.NAMESPACE||$t,po=F.MATHML_TEXT_INTEGRATION_POINTS||po,bl=F.HTML_INTEGRATION_POINTS||bl,w=F.CUSTOM_ELEMENT_HANDLING||{},F.CUSTOM_ELEMENT_HANDLING&&Yk(F.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(w.tagNameCheck=F.CUSTOM_ELEMENT_HANDLING.tagNameCheck),F.CUSTOM_ELEMENT_HANDLING&&Yk(F.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(w.attributeNameCheck=F.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),F.CUSTOM_ELEMENT_HANDLING&&typeof F.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(w.allowCustomizedBuiltInElements=F.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),L&&(y=!1),U&&($=!0),at&&(Te=tt({},IV),Me=[],at.html===!0&&(tt(Te,AV),tt(Me,OV)),at.svg===!0&&(tt(Te,ME),tt(Me,IE),tt(Me,uv)),at.svgFilters===!0&&(tt(Te,PE),tt(Me,IE),tt(Me,uv)),at.mathMl===!0&&(tt(Te,AE),tt(Me,HV),tt(Me,uv))),F.ADD_TAGS&&(typeof F.ADD_TAGS=="function"?D.tagCheck=F.ADD_TAGS:(Te===$e&&(Te=$o(Te)),tt(Te,F.ADD_TAGS,Yn))),F.ADD_ATTR&&(typeof F.ADD_ATTR=="function"?D.attributeCheck=F.ADD_ATTR:(Me===X&&(Me=$o(Me)),tt(Me,F.ADD_ATTR,Yn))),F.ADD_URI_SAFE_ATTR&&tt(fi,F.ADD_URI_SAFE_ATTR,Yn),F.FORBID_CONTENTS&&(Ae===Ze&&(Ae=$o(Ae)),tt(Ae,F.FORBID_CONTENTS,Yn)),F.ADD_FORBID_CONTENTS&&(Ae===Ze&&(Ae=$o(Ae)),tt(Ae,F.ADD_FORBID_CONTENTS,Yn)),Pe&&(Te["#text"]=!0),A&&tt(Te,["html","head","body"]),Te.table&&(tt(Te,["tbody"]),delete C.tbody),F.TRUSTED_TYPES_POLICY){if(typeof F.TRUSTED_TYPES_POLICY.createHTML!="function")throw _g('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof F.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw _g('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');S=F.TRUSTED_TYPES_POLICY,x=S.createHTML("")}else S===void 0&&(S=zoe(f,r)),S!==null&&typeof x=="string"&&(x=S.createHTML(""));nr&&nr(F),Yh=F}},Gk=tt({},[...ME,...PE,...Hoe]),qk=tt({},[...AE,...koe]),o6=function(F){let ie=R(F);(!ie||!ie.tagName)&&(ie={namespaceURI:Ht,tagName:"template"});const we=Zb(F.tagName),Yt=Zb(ie.tagName);return wl[F.namespaceURI]?F.namespaceURI===Or?ie.namespaceURI===$t?we==="svg":ie.namespaceURI===gn?we==="svg"&&(Yt==="annotation-xml"||po[Yt]):!!Gk[we]:F.namespaceURI===gn?ie.namespaceURI===$t?we==="math":ie.namespaceURI===Or?we==="math"&&bl[Yt]:!!qk[we]:F.namespaceURI===$t?ie.namespaceURI===Or&&!bl[Yt]||ie.namespaceURI===gn&&!po[Yt]?!1:!qk[we]&&(as[we]||!Gk[we]):!!(gi==="application/xhtml+xml"&&wl[F.namespaceURI]):!1},wo=function(F){Sg(e.removed,{element:F});try{R(F).removeChild(F)}catch{p(F)}},Bc=function(F,ie){try{Sg(e.removed,{attribute:ie.getAttributeNode(F),from:ie})}catch{Sg(e.removed,{attribute:null,from:ie})}if(ie.removeAttribute(F),F==="is")if($||U)try{wo(ie)}catch{}else try{ie.setAttribute(F,"")}catch{}},Kk=function(F){let ie=null,we=null;if(H)F="<remove></remove>"+F;else{const $n=TE(F,/^[\r\n\t ]+/);we=$n&&$n[0]}gi==="application/xhtml+xml"&&Ht===$t&&(F='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+F+"</body></html>");const Yt=S?S.createHTML(F):F;if(Ht===$t)try{ie=new d().parseFromString(Yt,gi)}catch{}if(!ie||!ie.documentElement){ie=M.createDocument(Ht,"template",null);try{ie.documentElement.innerHTML=rt?x:Yt}catch{}}const Ci=ie.body||ie.documentElement;return F&&we&&Ci.insertBefore(n.createTextNode(we),Ci.childNodes[0]||null),Ht===$t?W.call(ie,A?"html":"body")[0]:A?ie.documentElement:Ci},Xk=function(F){return T.call(F.ownerDocument||F,F,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},P0=function(F){return F instanceof h&&(typeof F.nodeName!="string"||typeof F.textContent!="string"||typeof F.removeChild!="function"||!(F.attributes instanceof u)||typeof F.removeAttribute!="function"||typeof F.setAttribute!="function"||typeof F.namespaceURI!="string"||typeof F.insertBefore!="function"||typeof F.hasChildNodes!="function")},Jk=function(F){return typeof a=="function"&&F instanceof a};function wa(_e,F,ie){cv(_e,we=>{we.call(e,F,ie,Yh)})}const Zk=function(F){let ie=null;if(wa(G.beforeSanitizeElements,F,null),P0(F))return wo(F),!0;const we=Yn(F.nodeName);if(wa(G.uponSanitizeElement,F,{tagName:we,allowedTags:Te}),I&&F.hasChildNodes()&&!Jk(F.firstElementChild)&&Bi(/<[/\w!]/g,F.innerHTML)&&Bi(/<[/\w!]/g,F.textContent)||F.nodeType===xg.progressingInstruction||I&&F.nodeType===xg.comment&&Bi(/<[/\w]/g,F.data))return wo(F),!0;if(!(D.tagCheck instanceof Function&&D.tagCheck(we))&&(!Te[we]||C[we])){if(!C[we]&&eD(we)&&(w.tagNameCheck instanceof RegExp&&Bi(w.tagNameCheck,we)||w.tagNameCheck instanceof Function&&w.tagNameCheck(we)))return!1;if(Pe&&!Ae[we]){const Yt=R(F)||F.parentNode,Ci=b(F)||F.childNodes;if(Ci&&Yt){const $n=Ci.length;for(let or=$n-1;or>=0;--or){const va=m(Ci[or],!0);va.__removalCount=(F.__removalCount||0)+1,Yt.insertBefore(va,v(F))}}}return wo(F),!0}return F instanceof l&&!o6(F)||(we==="noscript"||we==="noembed"||we==="noframes")&&Bi(/<\/no(script|embed|frames)/i,F.innerHTML)?(wo(F),!0):(L&&F.nodeType===xg.text&&(ie=F.textContent,cv([j,ne,ee],Yt=>{ie=Rg(ie,Yt," ")}),F.textContent!==ie&&(Sg(e.removed,{element:F.cloneNode()}),F.textContent=ie)),wa(G.afterSanitizeElements,F,null),!1)},Qk=function(F,ie,we){if(J&&(ie==="id"||ie==="name")&&(we in n||we in s6))return!1;if(!(y&&!E[ie]&&Bi(Q,ie))){if(!(B&&Bi(me,ie))){if(!(D.attributeCheck instanceof Function&&D.attributeCheck(ie,F))){if(!Me[ie]||E[ie]){if(!(eD(F)&&(w.tagNameCheck instanceof RegExp&&Bi(w.tagNameCheck,F)||w.tagNameCheck instanceof Function&&w.tagNameCheck(F))&&(w.attributeNameCheck instanceof RegExp&&Bi(w.attributeNameCheck,ie)||w.attributeNameCheck instanceof Function&&w.attributeNameCheck(ie,F))||ie==="is"&&w.allowCustomizedBuiltInElements&&(w.tagNameCheck instanceof RegExp&&Bi(w.tagNameCheck,we)||w.tagNameCheck instanceof Function&&w.tagNameCheck(we))))return!1}else if(!fi[ie]){if(!Bi(Ce,Rg(we,ye,""))){if(!((ie==="src"||ie==="xlink:href"||ie==="href")&&F!=="script"&&Poe(we,"data:")===0&&dt[F])){if(!(_&&!Bi(fe,Rg(we,ye,"")))){if(we)return!1}}}}}}}return!0},eD=function(F){return F!=="annotation-xml"&&TE(F,Oe)},tD=function(F){wa(G.beforeSanitizeAttributes,F,null);const{attributes:ie}=F;if(!ie||P0(F))return;const we={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Me,forceKeepAttr:void 0};let Yt=ie.length;for(;Yt--;){const Ci=ie[Yt],{name:$n,namespaceURI:or,value:va}=Ci,Gh=Yn($n),A0=va;let mi=$n==="value"?A0:Aoe(A0);if(we.attrName=Gh,we.attrValue=mi,we.keepAttr=!0,we.forceKeepAttr=void 0,wa(G.uponSanitizeAttribute,F,we),mi=we.attrValue,ce&&(Gh==="id"||Gh==="name")&&(Bc($n,F),mi=re+mi),I&&Bi(/((--!?|])>)|<\/(style|title|textarea)/i,mi)){Bc($n,F);continue}if(Gh==="attributename"&&TE(mi,"href")){Bc($n,F);continue}if(we.forceKeepAttr)continue;if(!we.keepAttr){Bc($n,F);continue}if(!P&&Bi(/\/>/i,mi)){Bc($n,F);continue}L&&cv([j,ne,ee],iD=>{mi=Rg(mi,iD," ")});const nD=Yn(F.nodeName);if(!Qk(nD,Gh,mi)){Bc($n,F);continue}if(S&&typeof f=="object"&&typeof f.getAttributeType=="function"&&!or)switch(f.getAttributeType(nD,Gh)){case"TrustedHTML":{mi=S.createHTML(mi);break}case"TrustedScriptURL":{mi=S.createScriptURL(mi);break}}if(mi!==A0)try{or?F.setAttributeNS(or,$n,mi):F.setAttribute($n,mi),P0(F)?wo(F):PV(e.removed)}catch{Bc($n,F)}}wa(G.afterSanitizeAttributes,F,null)},a6=function _e(F){let ie=null;const we=Xk(F);for(wa(G.beforeSanitizeShadowDOM,F,null);ie=we.nextNode();)wa(G.uponSanitizeShadowNode,ie,null),Zk(ie),tD(ie),ie.content instanceof s&&_e(ie.content);wa(G.afterSanitizeShadowDOM,F,null)};return e.sanitize=function(_e){let F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ie=null,we=null,Yt=null,Ci=null;if(rt=!_e,rt&&(_e="<!-->"),typeof _e!="string"&&!Jk(_e))if(typeof _e.toString=="function"){if(_e=_e.toString(),typeof _e!="string")throw _g("dirty is not a string, aborting")}else throw _g("toString is not a function");if(!e.isSupported)return _e;if(V||M0(F),e.removed=[],typeof _e=="string"&&(Je=!1),Je){if(_e.nodeName){const va=Yn(_e.nodeName);if(!Te[va]||C[va])throw _g("root node is forbidden and cannot be sanitized in-place")}}else if(_e instanceof a)ie=Kk("<!---->"),we=ie.ownerDocument.importNode(_e,!0),we.nodeType===xg.element&&we.nodeName==="BODY"||we.nodeName==="HTML"?ie=we:ie.appendChild(we);else{if(!$&&!L&&!A&&_e.indexOf("<")===-1)return S&&z?S.createHTML(_e):_e;if(ie=Kk(_e),!ie)return $?null:z?x:""}ie&&H&&wo(ie.firstChild);const $n=Xk(Je?_e:ie);for(;Yt=$n.nextNode();)Zk(Yt),tD(Yt),Yt.content instanceof s&&a6(Yt.content);if(Je)return _e;if($){if(U)for(Ci=O.call(ie.ownerDocument);ie.firstChild;)Ci.appendChild(ie.firstChild);else Ci=ie;return(Me.shadowroot||Me.shadowrootmode)&&(Ci=N.call(i,Ci,!0)),Ci}let or=A?ie.outerHTML:ie.innerHTML;return A&&Te["!doctype"]&&ie.ownerDocument&&ie.ownerDocument.doctype&&ie.ownerDocument.doctype.name&&Bi(Hq,ie.ownerDocument.doctype.name)&&(or="<!DOCTYPE "+ie.ownerDocument.doctype.name+`>
`+or),L&&cv([j,ne,ee],va=>{or=Rg(or,va," ")}),S&&z?S.createHTML(or):or},e.setConfig=function(){let _e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};M0(_e),V=!0},e.clearConfig=function(){Yh=null,V=!1},e.isValidAttribute=function(_e,F,ie){Yh||M0({});const we=Yn(_e),Yt=Yn(F);return Qk(we,Yt,ie)},e.addHook=function(_e,F){typeof F=="function"&&Sg(G[_e],F)},e.removeHook=function(_e,F){if(F!==void 0){const ie=Toe(G[_e],F);return ie===-1?void 0:Moe(G[_e],ie,1)[0]}return PV(G[_e])},e.removeHooks=function(_e){G[_e]=[]},e.removeAllHooks=function(){G=DV()},e}var Uoe=kq();var Dq;function Z(){return Dq.apply(null,arguments)}function Yoe(t){Dq=t}function ao(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function fh(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function gt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function LI(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(gt(t,e))return!1;return!0}function pr(t){return t===void 0}function ol(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function pw(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function Nq(t,e){var n=[],i,r=t.length;for(i=0;i<r;++i)n.push(e(t[i],i));return n}function lc(t,e){for(var n in e)gt(e,n)&&(t[n]=e[n]);return gt(e,"toString")&&(t.toString=e.toString),gt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function da(t,e,n,i){return sK(t,e,n,i,!0).utc()}function Goe(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function ze(t){return t._pf==null&&(t._pf=Goe()),t._pf}var oP;Array.prototype.some?oP=Array.prototype.some:oP=function(t){var e=Object(this),n=e.length>>>0,i;for(i=0;i<n;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};function $I(t){var e=null,n=!1,i=t._d&&!isNaN(t._d.getTime());if(i&&(e=ze(t),n=oP.call(e.parsedDateParts,function(r){return r!=null}),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(i=i&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=i;else return i;return t._isValid}function AS(t){var e=da(NaN);return t!=null?lc(ze(e),t):ze(e).userInvalidated=!0,e}var NV=Z.momentProperties=[],OE=!1;function FI(t,e){var n,i,r,s=NV.length;if(pr(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),pr(e._i)||(t._i=e._i),pr(e._f)||(t._f=e._f),pr(e._l)||(t._l=e._l),pr(e._strict)||(t._strict=e._strict),pr(e._tzm)||(t._tzm=e._tzm),pr(e._isUTC)||(t._isUTC=e._isUTC),pr(e._offset)||(t._offset=e._offset),pr(e._pf)||(t._pf=ze(e)),pr(e._locale)||(t._locale=e._locale),s>0)for(n=0;n<s;n++)i=NV[n],r=e[i],pr(r)||(t[i]=r);return t}function ww(t){FI(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),OE===!1&&(OE=!0,Z.updateOffset(this),OE=!1)}function lo(t){return t instanceof ww||t!=null&&t._isAMomentObject!=null}function Lq(t){Z.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Os(t,e){var n=!0;return lc(function(){if(Z.deprecationHandler!=null&&Z.deprecationHandler(null,t),n){var i=[],r,s,o,a=arguments.length;for(s=0;s<a;s++){if(r="",typeof arguments[s]=="object"){r+=`
[`+s+"] ";for(o in arguments[0])gt(arguments[0],o)&&(r+=o+": "+arguments[0][o]+", ");r=r.slice(0,-2)}else r=arguments[s];i.push(r)}Lq(t+`
Arguments: `+Array.prototype.slice.call(i).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var LV={};function $q(t,e){Z.deprecationHandler!=null&&Z.deprecationHandler(t,e),LV[t]||(Lq(e),LV[t]=!0)}Z.suppressDeprecationWarnings=!1;Z.deprecationHandler=null;function fa(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function qoe(t){var e,n;for(n in t)gt(t,n)&&(e=t[n],fa(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function aP(t,e){var n=lc({},t),i;for(i in e)gt(e,i)&&(fh(t[i])&&fh(e[i])?(n[i]={},lc(n[i],t[i]),lc(n[i],e[i])):e[i]!=null?n[i]=e[i]:delete n[i]);for(i in t)gt(t,i)&&!gt(e,i)&&fh(t[i])&&(n[i]=lc({},n[i]));return n}function VI(t){t!=null&&this.set(t)}var lP;Object.keys?lP=Object.keys:lP=function(t){var e,n=[];for(e in t)gt(t,e)&&n.push(e);return n};var Koe={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function Xoe(t,e,n){var i=this._calendar[t]||this._calendar.sameElse;return fa(i)?i.call(e,n):i}function la(t,e,n){var i=""+Math.abs(t),r=e-i.length,s=t>=0;return(s?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}var BI=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,hv=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,HE={},hf={};function xe(t,e,n,i){var r=i;typeof i=="string"&&(r=function(){return this[i]()}),t&&(hf[t]=r),e&&(hf[e[0]]=function(){return la(r.apply(this,arguments),e[1],e[2])}),n&&(hf[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function Joe(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function Zoe(t){var e=t.match(BI),n,i;for(n=0,i=e.length;n<i;n++)hf[e[n]]?e[n]=hf[e[n]]:e[n]=Joe(e[n]);return function(r){var s="",o;for(o=0;o<i;o++)s+=fa(e[o])?e[o].call(r,t):e[o];return s}}function Qb(t,e){return t.isValid()?(e=Fq(e,t.localeData()),HE[e]=HE[e]||Zoe(e),HE[e](t)):t.localeData().invalidDate()}function Fq(t,e){var n=5;function i(r){return e.longDateFormat(r)||r}for(hv.lastIndex=0;n>=0&&hv.test(t);)t=t.replace(hv,i),hv.lastIndex=0,n-=1;return t}var Qoe={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function eae(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(BI).map(function(i){return i==="MMMM"||i==="MM"||i==="DD"||i==="dddd"?i.slice(1):i}).join(""),this._longDateFormat[t])}var tae="Invalid date";function nae(){return this._invalidDate}var iae="%d",rae=/\d{1,2}/;function sae(t){return this._ordinal.replace("%d",t)}var oae={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function aae(t,e,n,i){var r=this._relativeTime[n];return fa(r)?r(t,e,n,i):r.replace(/%d/i,t)}function lae(t,e){var n=this._relativeTime[t>0?"future":"past"];return fa(n)?n(e):n.replace(/%s/i,e)}var $V={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Hs(t){return typeof t=="string"?$V[t]||$V[t.toLowerCase()]:void 0}function WI(t){var e={},n,i;for(i in t)gt(t,i)&&(n=Hs(i),n&&(e[n]=t[i]));return e}var cae={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function uae(t){var e=[],n;for(n in t)gt(t,n)&&e.push({unit:n,priority:cae[n]});return e.sort(function(i,r){return i.priority-r.priority}),e}var Vq=/\d/,ss=/\d\d/,Bq=/\d{3}/,jI=/\d{4}/,IS=/[+-]?\d{6}/,Ut=/\d\d?/,Wq=/\d\d\d\d?/,jq=/\d\d\d\d\d\d?/,OS=/\d{1,3}/,zI=/\d{1,4}/,HS=/[+-]?\d{1,6}/,eg=/\d+/,kS=/[+-]?\d+/,hae=/Z|[+-]\d\d:?\d\d/gi,DS=/Z|[+-]\d\d(?::?\d\d)?/gi,dae=/[+-]?\d+(\.\d{1,3})?/,vw=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,tg=/^[1-9]\d?/,UI=/^([1-9]\d|\d)/,Uy;Uy={};function de(t,e,n){Uy[t]=fa(e)?e:function(i,r){return i&&n?n:e}}function fae(t,e){return gt(Uy,t)?Uy[t](e._strict,e._locale):new RegExp(gae(t))}function gae(t){return il(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,i,r,s){return n||i||r||s}))}function il(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Rs(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function ot(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Rs(e)),n}var cP={};function At(t,e){var n,i=e,r;for(typeof t=="string"&&(t=[t]),ol(e)&&(i=function(s,o){o[e]=ot(s)}),r=t.length,n=0;n<r;n++)cP[t[n]]=i}function bw(t,e){At(t,function(n,i,r,s){r._w=r._w||{},e(n,r._w,r,s)})}function mae(t,e,n){e!=null&&gt(cP,t)&&cP[t](e,n._a,n,t)}function NS(t){return t%4===0&&t%100!==0||t%400===0}var Ni=0,Ka=1,Jo=2,Qn=3,io=4,Xa=5,qu=6,pae=7,wae=8;xe("Y",0,0,function(){var t=this.year();return t<=9999?la(t,4):"+"+t});xe(0,["YY",2],0,function(){return this.year()%100});xe(0,["YYYY",4],0,"year");xe(0,["YYYYY",5],0,"year");xe(0,["YYYYYY",6,!0],0,"year");de("Y",kS);de("YY",Ut,ss);de("YYYY",zI,jI);de("YYYYY",HS,IS);de("YYYYYY",HS,IS);At(["YYYYY","YYYYYY"],Ni);At("YYYY",function(t,e){e[Ni]=t.length===2?Z.parseTwoDigitYear(t):ot(t)});At("YY",function(t,e){e[Ni]=Z.parseTwoDigitYear(t)});At("Y",function(t,e){e[Ni]=parseInt(t,10)});function Um(t){return NS(t)?366:365}Z.parseTwoDigitYear=function(t){return ot(t)+(ot(t)>68?1900:2e3)};var zq=ng("FullYear",!0);function vae(){return NS(this.year())}function ng(t,e){return function(n){return n!=null?(Uq(this,t,n),Z.updateOffset(this,e),this):Tp(this,t)}}function Tp(t,e){if(!t.isValid())return NaN;var n=t._d,i=t._isUTC;switch(e){case"Milliseconds":return i?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return i?n.getUTCSeconds():n.getSeconds();case"Minutes":return i?n.getUTCMinutes():n.getMinutes();case"Hours":return i?n.getUTCHours():n.getHours();case"Date":return i?n.getUTCDate():n.getDate();case"Day":return i?n.getUTCDay():n.getDay();case"Month":return i?n.getUTCMonth():n.getMonth();case"FullYear":return i?n.getUTCFullYear():n.getFullYear();default:return NaN}}function Uq(t,e,n){var i,r,s,o,a;if(!(!t.isValid()||isNaN(n))){switch(i=t._d,r=t._isUTC,e){case"Milliseconds":return void(r?i.setUTCMilliseconds(n):i.setMilliseconds(n));case"Seconds":return void(r?i.setUTCSeconds(n):i.setSeconds(n));case"Minutes":return void(r?i.setUTCMinutes(n):i.setMinutes(n));case"Hours":return void(r?i.setUTCHours(n):i.setHours(n));case"Date":return void(r?i.setUTCDate(n):i.setDate(n));case"FullYear":break;default:return}s=n,o=t.month(),a=t.date(),a=a===29&&o===1&&!NS(s)?28:a,r?i.setUTCFullYear(s,o,a):i.setFullYear(s,o,a)}}function bae(t){return t=Hs(t),fa(this[t])?this[t]():this}function yae(t,e){if(typeof t=="object"){t=WI(t);var n=uae(t),i,r=n.length;for(i=0;i<r;i++)this[n[i].unit](t[n[i].unit])}else if(t=Hs(t),fa(this[t]))return this[t](e);return this}function Cae(t,e){return(t%e+e)%e}var Tn;Array.prototype.indexOf?Tn=Array.prototype.indexOf:Tn=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function YI(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=Cae(e,12);return t+=(e-n)/12,n===1?NS(t)?29:28:31-n%7%2}xe("M",["MM",2],"Mo",function(){return this.month()+1});xe("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});xe("MMMM",0,0,function(t){return this.localeData().months(this,t)});de("M",Ut,tg);de("MM",Ut,ss);de("MMM",function(t,e){return e.monthsShortRegex(t)});de("MMMM",function(t,e){return e.monthsRegex(t)});At(["M","MM"],function(t,e){e[Ka]=ot(t)-1});At(["MMM","MMMM"],function(t,e,n,i){var r=n._locale.monthsParse(t,i,n._strict);r!=null?e[Ka]=r:ze(n).invalidMonth=t});var Sae="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),Yq="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Gq=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Rae=vw,_ae=vw;function Eae(t,e){return t?ao(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||Gq).test(e)?"format":"standalone"][t.month()]:ao(this._months)?this._months:this._months.standalone}function xae(t,e){return t?ao(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[Gq.test(e)?"format":"standalone"][t.month()]:ao(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function Tae(t,e,n){var i,r,s,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)s=da([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(s,"").toLocaleLowerCase();return n?e==="MMM"?(r=Tn.call(this._shortMonthsParse,o),r!==-1?r:null):(r=Tn.call(this._longMonthsParse,o),r!==-1?r:null):e==="MMM"?(r=Tn.call(this._shortMonthsParse,o),r!==-1?r:(r=Tn.call(this._longMonthsParse,o),r!==-1?r:null)):(r=Tn.call(this._longMonthsParse,o),r!==-1?r:(r=Tn.call(this._shortMonthsParse,o),r!==-1?r:null))}function Mae(t,e,n){var i,r,s;if(this._monthsParseExact)return Tae.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=da([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),!n&&!this._monthsParse[i]&&(s="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(s.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[i].test(t))return i;if(n&&e==="MMM"&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}}function qq(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=ot(e);else if(e=t.localeData().monthsParse(e),!ol(e))return t}var n=e,i=t.date();return i=i<29?i:Math.min(i,YI(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,i):t._d.setMonth(n,i),t}function Kq(t){return t!=null?(qq(this,t),Z.updateOffset(this,!0),this):Tp(this,"Month")}function Pae(){return YI(this.year(),this.month())}function Aae(t){return this._monthsParseExact?(gt(this,"_monthsRegex")||Xq.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(gt(this,"_monthsShortRegex")||(this._monthsShortRegex=Rae),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function Iae(t){return this._monthsParseExact?(gt(this,"_monthsRegex")||Xq.call(this),t?this._monthsStrictRegex:this._monthsRegex):(gt(this,"_monthsRegex")||(this._monthsRegex=_ae),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function Xq(){function t(l,c){return c.length-l.length}var e=[],n=[],i=[],r,s,o,a;for(r=0;r<12;r++)s=da([2e3,r]),o=il(this.monthsShort(s,"")),a=il(this.months(s,"")),e.push(o),n.push(a),i.push(a),i.push(o);e.sort(t),n.sort(t),i.sort(t),this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Oae(t,e,n,i,r,s,o){var a;return t<100&&t>=0?(a=new Date(t+400,e,n,i,r,s,o),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,n,i,r,s,o),a}function Mp(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function Yy(t,e,n){var i=7+e-n,r=(7+Mp(t,0,i).getUTCDay()-e)%7;return-r+i-1}function Jq(t,e,n,i,r){var s=(7+n-i)%7,o=Yy(t,i,r),a=1+7*(e-1)+s+o,l,c;return a<=0?(l=t-1,c=Um(l)+a):a>Um(t)?(l=t+1,c=a-Um(t)):(l=t,c=a),{year:l,dayOfYear:c}}function Pp(t,e,n){var i=Yy(t.year(),e,n),r=Math.floor((t.dayOfYear()-i-1)/7)+1,s,o;return r<1?(o=t.year()-1,s=r+rl(o,e,n)):r>rl(t.year(),e,n)?(s=r-rl(t.year(),e,n),o=t.year()+1):(o=t.year(),s=r),{week:s,year:o}}function rl(t,e,n){var i=Yy(t,e,n),r=Yy(t+1,e,n);return(Um(t)-i+r)/7}xe("w",["ww",2],"wo","week");xe("W",["WW",2],"Wo","isoWeek");de("w",Ut,tg);de("ww",Ut,ss);de("W",Ut,tg);de("WW",Ut,ss);bw(["w","ww","W","WW"],function(t,e,n,i){e[i.substr(0,1)]=ot(t)});function Hae(t){return Pp(t,this._week.dow,this._week.doy).week}var kae={dow:0,doy:6};function Dae(){return this._week.dow}function Nae(){return this._week.doy}function Lae(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function $ae(t){var e=Pp(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}xe("d",0,"do","day");xe("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});xe("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});xe("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});xe("e",0,0,"weekday");xe("E",0,0,"isoWeekday");de("d",Ut);de("e",Ut);de("E",Ut);de("dd",function(t,e){return e.weekdaysMinRegex(t)});de("ddd",function(t,e){return e.weekdaysShortRegex(t)});de("dddd",function(t,e){return e.weekdaysRegex(t)});bw(["dd","ddd","dddd"],function(t,e,n,i){var r=n._locale.weekdaysParse(t,i,n._strict);r!=null?e.d=r:ze(n).invalidWeekday=t});bw(["d","e","E"],function(t,e,n,i){e[i]=ot(t)});function Fae(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function Vae(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function GI(t,e){return t.slice(e,7).concat(t.slice(0,e))}var Bae="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Zq="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Wae="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),jae=vw,zae=vw,Uae=vw;function Yae(t,e){var n=ao(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?GI(n,this._week.dow):t?n[t.day()]:n}function Gae(t){return t===!0?GI(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function qae(t){return t===!0?GI(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function Kae(t,e,n){var i,r,s,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)s=da([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(s,"").toLocaleLowerCase();return n?e==="dddd"?(r=Tn.call(this._weekdaysParse,o),r!==-1?r:null):e==="ddd"?(r=Tn.call(this._shortWeekdaysParse,o),r!==-1?r:null):(r=Tn.call(this._minWeekdaysParse,o),r!==-1?r:null):e==="dddd"?(r=Tn.call(this._weekdaysParse,o),r!==-1||(r=Tn.call(this._shortWeekdaysParse,o),r!==-1)?r:(r=Tn.call(this._minWeekdaysParse,o),r!==-1?r:null)):e==="ddd"?(r=Tn.call(this._shortWeekdaysParse,o),r!==-1||(r=Tn.call(this._weekdaysParse,o),r!==-1)?r:(r=Tn.call(this._minWeekdaysParse,o),r!==-1?r:null)):(r=Tn.call(this._minWeekdaysParse,o),r!==-1||(r=Tn.call(this._weekdaysParse,o),r!==-1)?r:(r=Tn.call(this._shortWeekdaysParse,o),r!==-1?r:null))}function Xae(t,e,n){var i,r,s;if(this._weekdaysParseExact)return Kae.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=da([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(s="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(s.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[i].test(t))return i;if(n&&e==="ddd"&&this._shortWeekdaysParse[i].test(t))return i;if(n&&e==="dd"&&this._minWeekdaysParse[i].test(t))return i;if(!n&&this._weekdaysParse[i].test(t))return i}}function Jae(t){if(!this.isValid())return t!=null?this:NaN;var e=Tp(this,"Day");return t!=null?(t=Fae(t,this.localeData()),this.add(t-e,"d")):e}function Zae(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function Qae(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=Vae(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function ele(t){return this._weekdaysParseExact?(gt(this,"_weekdaysRegex")||qI.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(gt(this,"_weekdaysRegex")||(this._weekdaysRegex=jae),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function tle(t){return this._weekdaysParseExact?(gt(this,"_weekdaysRegex")||qI.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(gt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=zae),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function nle(t){return this._weekdaysParseExact?(gt(this,"_weekdaysRegex")||qI.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(gt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Uae),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function qI(){function t(u,h){return h.length-u.length}var e=[],n=[],i=[],r=[],s,o,a,l,c;for(s=0;s<7;s++)o=da([2e3,1]).day(s),a=il(this.weekdaysMin(o,"")),l=il(this.weekdaysShort(o,"")),c=il(this.weekdays(o,"")),e.push(a),n.push(l),i.push(c),r.push(a),r.push(l),r.push(c);e.sort(t),n.sort(t),i.sort(t),r.sort(t),this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function KI(){return this.hours()%12||12}function ile(){return this.hours()||24}xe("H",["HH",2],0,"hour");xe("h",["hh",2],0,KI);xe("k",["kk",2],0,ile);xe("hmm",0,0,function(){return""+KI.apply(this)+la(this.minutes(),2)});xe("hmmss",0,0,function(){return""+KI.apply(this)+la(this.minutes(),2)+la(this.seconds(),2)});xe("Hmm",0,0,function(){return""+this.hours()+la(this.minutes(),2)});xe("Hmmss",0,0,function(){return""+this.hours()+la(this.minutes(),2)+la(this.seconds(),2)});function Qq(t,e){xe(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}Qq("a",!0);Qq("A",!1);function eK(t,e){return e._meridiemParse}de("a",eK);de("A",eK);de("H",Ut,UI);de("h",Ut,tg);de("k",Ut,tg);de("HH",Ut,ss);de("hh",Ut,ss);de("kk",Ut,ss);de("hmm",Wq);de("hmmss",jq);de("Hmm",Wq);de("Hmmss",jq);At(["H","HH"],Qn);At(["k","kk"],function(t,e,n){var i=ot(t);e[Qn]=i===24?0:i});At(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});At(["h","hh"],function(t,e,n){e[Qn]=ot(t),ze(n).bigHour=!0});At("hmm",function(t,e,n){var i=t.length-2;e[Qn]=ot(t.substr(0,i)),e[io]=ot(t.substr(i)),ze(n).bigHour=!0});At("hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[Qn]=ot(t.substr(0,i)),e[io]=ot(t.substr(i,2)),e[Xa]=ot(t.substr(r)),ze(n).bigHour=!0});At("Hmm",function(t,e,n){var i=t.length-2;e[Qn]=ot(t.substr(0,i)),e[io]=ot(t.substr(i))});At("Hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[Qn]=ot(t.substr(0,i)),e[io]=ot(t.substr(i,2)),e[Xa]=ot(t.substr(r))});function rle(t){return(t+"").toLowerCase().charAt(0)==="p"}var sle=/[ap]\.?m?\.?/i,ole=ng("Hours",!0);function ale(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var tK={calendar:Koe,longDateFormat:Qoe,invalidDate:tae,ordinal:iae,dayOfMonthOrdinalParse:rae,relativeTime:oae,months:Sae,monthsShort:Yq,week:kae,weekdays:Bae,weekdaysMin:Wae,weekdaysShort:Zq,meridiemParse:sle},Jt={},Tg={},Ap;function lle(t,e){var n,i=Math.min(t.length,e.length);for(n=0;n<i;n+=1)if(t[n]!==e[n])return n;return i}function FV(t){return t&&t.toLowerCase().replace("_","-")}function cle(t){for(var e=0,n,i,r,s;e<t.length;){for(s=FV(t[e]).split("-"),n=s.length,i=FV(t[e+1]),i=i?i.split("-"):null;n>0;){if(r=LS(s.slice(0,n).join("-")),r)return r;if(i&&i.length>=n&&lle(s,i)>=n-1)break;n--}e++}return Ap}function ule(t){return!!(t&&t.match("^[^/\\\\]*$"))}function LS(t){var e=null,n;if(Jt[t]===void 0&&typeof Ry<"u"&&Ry&&Ry.exports&&ule(t))try{e=Ap._abbr,n=require,n("./locale/"+t),pc(e)}catch{Jt[t]=null}return Jt[t]}function pc(t,e){var n;return t&&(pr(e)?n=dl(t):n=XI(t,e),n?Ap=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Ap._abbr}function XI(t,e){if(e!==null){var n,i=tK;if(e.abbr=t,Jt[t]!=null)$q("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=Jt[t]._config;else if(e.parentLocale!=null)if(Jt[e.parentLocale]!=null)i=Jt[e.parentLocale]._config;else if(n=LS(e.parentLocale),n!=null)i=n._config;else return Tg[e.parentLocale]||(Tg[e.parentLocale]=[]),Tg[e.parentLocale].push({name:t,config:e}),null;return Jt[t]=new VI(aP(i,e)),Tg[t]&&Tg[t].forEach(function(r){XI(r.name,r.config)}),pc(t),Jt[t]}else return delete Jt[t],null}function hle(t,e){if(e!=null){var n,i,r=tK;Jt[t]!=null&&Jt[t].parentLocale!=null?Jt[t].set(aP(Jt[t]._config,e)):(i=LS(t),i!=null&&(r=i._config),e=aP(r,e),i==null&&(e.abbr=t),n=new VI(e),n.parentLocale=Jt[t],Jt[t]=n),pc(t)}else Jt[t]!=null&&(Jt[t].parentLocale!=null?(Jt[t]=Jt[t].parentLocale,t===pc()&&pc(t)):Jt[t]!=null&&delete Jt[t]);return Jt[t]}function dl(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Ap;if(!ao(t)){if(e=LS(t),e)return e;t=[t]}return cle(t)}function dle(){return lP(Jt)}function JI(t){var e,n=t._a;return n&&ze(t).overflow===-2&&(e=n[Ka]<0||n[Ka]>11?Ka:n[Jo]<1||n[Jo]>YI(n[Ni],n[Ka])?Jo:n[Qn]<0||n[Qn]>24||n[Qn]===24&&(n[io]!==0||n[Xa]!==0||n[qu]!==0)?Qn:n[io]<0||n[io]>59?io:n[Xa]<0||n[Xa]>59?Xa:n[qu]<0||n[qu]>999?qu:-1,ze(t)._overflowDayOfYear&&(e<Ni||e>Jo)&&(e=Jo),ze(t)._overflowWeeks&&e===-1&&(e=pae),ze(t)._overflowWeekday&&e===-1&&(e=wae),ze(t).overflow=e),t}var fle=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,gle=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,mle=/Z|[+-]\d\d(?::?\d\d)?/,dv=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],kE=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],ple=/^\/?Date\((-?\d+)/i,wle=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,vle={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function nK(t){var e,n,i=t._i,r=fle.exec(i)||gle.exec(i),s,o,a,l,c=dv.length,u=kE.length;if(r){for(ze(t).iso=!0,e=0,n=c;e<n;e++)if(dv[e][1].exec(r[1])){o=dv[e][0],s=dv[e][2]!==!1;break}if(o==null){t._isValid=!1;return}if(r[3]){for(e=0,n=u;e<n;e++)if(kE[e][1].exec(r[3])){a=(r[2]||" ")+kE[e][0];break}if(a==null){t._isValid=!1;return}}if(!s&&a!=null){t._isValid=!1;return}if(r[4])if(mle.exec(r[4]))l="Z";else{t._isValid=!1;return}t._f=o+(a||"")+(l||""),QI(t)}else t._isValid=!1}function ble(t,e,n,i,r,s){var o=[yle(t),Yq.indexOf(e),parseInt(n,10),parseInt(i,10),parseInt(r,10)];return s&&o.push(parseInt(s,10)),o}function yle(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function Cle(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Sle(t,e,n){if(t){var i=Zq.indexOf(t),r=new Date(e[0],e[1],e[2]).getDay();if(i!==r)return ze(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function Rle(t,e,n){if(t)return vle[t];if(e)return 0;var i=parseInt(n,10),r=i%100,s=(i-r)/100;return s*60+r}function iK(t){var e=wle.exec(Cle(t._i)),n;if(e){if(n=ble(e[4],e[3],e[2],e[5],e[6],e[7]),!Sle(e[1],n,t))return;t._a=n,t._tzm=Rle(e[8],e[9],e[10]),t._d=Mp.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),ze(t).rfc2822=!0}else t._isValid=!1}function _le(t){var e=ple.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(nK(t),t._isValid===!1)delete t._isValid;else return;if(iK(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Z.createFromInputFallback(t)}Z.createFromInputFallback=Os("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function Bd(t,e,n){return t??e??n}function Ele(t){var e=new Date(Z.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function ZI(t){var e,n,i=[],r,s,o;if(!t._d){for(r=Ele(t),t._w&&t._a[Jo]==null&&t._a[Ka]==null&&xle(t),t._dayOfYear!=null&&(o=Bd(t._a[Ni],r[Ni]),(t._dayOfYear>Um(o)||t._dayOfYear===0)&&(ze(t)._overflowDayOfYear=!0),n=Mp(o,0,t._dayOfYear),t._a[Ka]=n.getUTCMonth(),t._a[Jo]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=i[e]=r[e];for(;e<7;e++)t._a[e]=i[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Qn]===24&&t._a[io]===0&&t._a[Xa]===0&&t._a[qu]===0&&(t._nextDay=!0,t._a[Qn]=0),t._d=(t._useUTC?Mp:Oae).apply(null,i),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Qn]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==s&&(ze(t).weekdayMismatch=!0)}}function xle(t){var e,n,i,r,s,o,a,l,c;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,n=Bd(e.GG,t._a[Ni],Pp(zt(),1,4).year),i=Bd(e.W,1),r=Bd(e.E,1),(r<1||r>7)&&(l=!0)):(s=t._locale._week.dow,o=t._locale._week.doy,c=Pp(zt(),s,o),n=Bd(e.gg,t._a[Ni],c.year),i=Bd(e.w,c.week),e.d!=null?(r=e.d,(r<0||r>6)&&(l=!0)):e.e!=null?(r=e.e+s,(e.e<0||e.e>6)&&(l=!0)):r=s),i<1||i>rl(n,s,o)?ze(t)._overflowWeeks=!0:l!=null?ze(t)._overflowWeekday=!0:(a=Jq(n,i,r,s,o),t._a[Ni]=a.year,t._dayOfYear=a.dayOfYear)}Z.ISO_8601=function(){};Z.RFC_2822=function(){};function QI(t){if(t._f===Z.ISO_8601){nK(t);return}if(t._f===Z.RFC_2822){iK(t);return}t._a=[],ze(t).empty=!0;var e=""+t._i,n,i,r,s,o,a=e.length,l=0,c,u;for(r=Fq(t._f,t._locale).match(BI)||[],u=r.length,n=0;n<u;n++)s=r[n],i=(e.match(fae(s,t))||[])[0],i&&(o=e.substr(0,e.indexOf(i)),o.length>0&&ze(t).unusedInput.push(o),e=e.slice(e.indexOf(i)+i.length),l+=i.length),hf[s]?(i?ze(t).empty=!1:ze(t).unusedTokens.push(s),mae(s,i,t)):t._strict&&!i&&ze(t).unusedTokens.push(s);ze(t).charsLeftOver=a-l,e.length>0&&ze(t).unusedInput.push(e),t._a[Qn]<=12&&ze(t).bigHour===!0&&t._a[Qn]>0&&(ze(t).bigHour=void 0),ze(t).parsedDateParts=t._a.slice(0),ze(t).meridiem=t._meridiem,t._a[Qn]=Tle(t._locale,t._a[Qn],t._meridiem),c=ze(t).era,c!==null&&(t._a[Ni]=t._locale.erasConvertYear(c,t._a[Ni])),ZI(t),JI(t)}function Tle(t,e,n){var i;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(i=t.isPM(n),i&&e<12&&(e+=12),!i&&e===12&&(e=0)),e)}function Mle(t){var e,n,i,r,s,o,a=!1,l=t._f.length;if(l===0){ze(t).invalidFormat=!0,t._d=new Date(NaN);return}for(r=0;r<l;r++)s=0,o=!1,e=FI({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[r],QI(e),$I(e)&&(o=!0),s+=ze(e).charsLeftOver,s+=ze(e).unusedTokens.length*10,ze(e).score=s,a?s<i&&(i=s,n=e):(i==null||s<i||o)&&(i=s,n=e,o&&(a=!0));lc(t,n||e)}function Ple(t){if(!t._d){var e=WI(t._i),n=e.day===void 0?e.date:e.day;t._a=Nq([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(i){return i&&parseInt(i,10)}),ZI(t)}}function Ale(t){var e=new ww(JI(rK(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function rK(t){var e=t._i,n=t._f;return t._locale=t._locale||dl(t._l),e===null||n===void 0&&e===""?AS({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),lo(e)?new ww(JI(e)):(pw(e)?t._d=e:ao(n)?Mle(t):n?QI(t):Ile(t),$I(t)||(t._d=null),t))}function Ile(t){var e=t._i;pr(e)?t._d=new Date(Z.now()):pw(e)?t._d=new Date(e.valueOf()):typeof e=="string"?_le(t):ao(e)?(t._a=Nq(e.slice(0),function(n){return parseInt(n,10)}),ZI(t)):fh(e)?Ple(t):ol(e)?t._d=new Date(e):Z.createFromInputFallback(t)}function sK(t,e,n,i,r){var s={};return(e===!0||e===!1)&&(i=e,e=void 0),(n===!0||n===!1)&&(i=n,n=void 0),(fh(t)&&LI(t)||ao(t)&&t.length===0)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=r,s._l=n,s._i=t,s._f=e,s._strict=i,Ale(s)}function zt(t,e,n,i){return sK(t,e,n,i,!1)}var Ole=Os("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=zt.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:AS()}),Hle=Os("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=zt.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:AS()});function oK(t,e){var n,i;if(e.length===1&&ao(e[0])&&(e=e[0]),!e.length)return zt();for(n=e[0],i=1;i<e.length;++i)(!e[i].isValid()||e[i][t](n))&&(n=e[i]);return n}function kle(){var t=[].slice.call(arguments,0);return oK("isBefore",t)}function Dle(){var t=[].slice.call(arguments,0);return oK("isAfter",t)}var Nle=function(){return Date.now?Date.now():+new Date},Mg=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Lle(t){var e,n=!1,i,r=Mg.length;for(e in t)if(gt(t,e)&&!(Tn.call(Mg,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(i=0;i<r;++i)if(t[Mg[i]]){if(n)return!1;parseFloat(t[Mg[i]])!==ot(t[Mg[i]])&&(n=!0)}return!0}function $le(){return this._isValid}function Fle(){return mo(NaN)}function $S(t){var e=WI(t),n=e.year||0,i=e.quarter||0,r=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,c=e.second||0,u=e.millisecond||0;this._isValid=Lle(e),this._milliseconds=+u+c*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+r+i*3+n*12,this._data={},this._locale=dl(),this._bubble()}function ey(t){return t instanceof $S}function uP(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function Vle(t,e,n){var i=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),s=0,o;for(o=0;o<i;o++)ot(t[o])!==ot(e[o])&&s++;return s+r}function aK(t,e){xe(t,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+la(~~(n/60),2)+e+la(~~n%60,2)})}aK("Z",":");aK("ZZ","");de("Z",DS);de("ZZ",DS);At(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=eO(DS,t)});var Ble=/([\+\-]|\d\d)/gi;function eO(t,e){var n=(e||"").match(t),i,r,s;return n===null?null:(i=n[n.length-1]||[],r=(i+"").match(Ble)||["-",0,0],s=+(r[1]*60)+ot(r[2]),s===0?0:r[0]==="+"?s:-s)}function tO(t,e){var n,i;return e._isUTC?(n=e.clone(),i=(lo(t)||pw(t)?t.valueOf():zt(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),Z.updateOffset(n,!1),n):zt(t).local()}function hP(t){return-Math.round(t._d.getTimezoneOffset())}Z.updateOffset=function(){};function Wle(t,e,n){var i=this._offset||0,r;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=eO(DS,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(r=hP(this)),this._offset=t,this._isUTC=!0,r!=null&&this.add(r,"m"),i!==t&&(!e||this._changeInProgress?uK(this,mo(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Z.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?i:hP(this)}function jle(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function zle(t){return this.utcOffset(0,t)}function Ule(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(hP(this),"m")),this}function Yle(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=eO(hae,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function Gle(t){return this.isValid()?(t=t?zt(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function qle(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Kle(){if(!pr(this._isDSTShifted))return this._isDSTShifted;var t={},e;return FI(t,this),t=rK(t),t._a?(e=t._isUTC?da(t._a):zt(t._a),this._isDSTShifted=this.isValid()&&Vle(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Xle(){return this.isValid()?!this._isUTC:!1}function Jle(){return this.isValid()?this._isUTC:!1}function lK(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Zle=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Qle=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function mo(t,e){var n=t,i=null,r,s,o;return ey(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:ol(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(i=Zle.exec(t))?(r=i[1]==="-"?-1:1,n={y:0,d:ot(i[Jo])*r,h:ot(i[Qn])*r,m:ot(i[io])*r,s:ot(i[Xa])*r,ms:ot(uP(i[qu]*1e3))*r}):(i=Qle.exec(t))?(r=i[1]==="-"?-1:1,n={y:Gc(i[2],r),M:Gc(i[3],r),w:Gc(i[4],r),d:Gc(i[5],r),h:Gc(i[6],r),m:Gc(i[7],r),s:Gc(i[8],r)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(o=ece(zt(n.from),zt(n.to)),n={},n.ms=o.milliseconds,n.M=o.months),s=new $S(n),ey(t)&&gt(t,"_locale")&&(s._locale=t._locale),ey(t)&&gt(t,"_isValid")&&(s._isValid=t._isValid),s}mo.fn=$S.prototype;mo.invalid=Fle;function Gc(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function VV(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function ece(t,e){var n;return t.isValid()&&e.isValid()?(e=tO(e,t),t.isBefore(e)?n=VV(t,e):(n=VV(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function cK(t,e){return function(n,i){var r,s;return i!==null&&!isNaN(+i)&&($q(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=n,n=i,i=s),r=mo(n,i),uK(this,r,t),this}}function uK(t,e,n,i){var r=e._milliseconds,s=uP(e._days),o=uP(e._months);t.isValid()&&(i=i??!0,o&&qq(t,Tp(t,"Month")+o*n),s&&Uq(t,"Date",Tp(t,"Date")+s*n),r&&t._d.setTime(t._d.valueOf()+r*n),i&&Z.updateOffset(t,s||o))}var tce=cK(1,"add"),nce=cK(-1,"subtract");function hK(t){return typeof t=="string"||t instanceof String}function ice(t){return lo(t)||pw(t)||hK(t)||ol(t)||sce(t)||rce(t)||t===null||t===void 0}function rce(t){var e=fh(t)&&!LI(t),n=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r,s,o=i.length;for(r=0;r<o;r+=1)s=i[r],n=n||gt(t,s);return e&&n}function sce(t){var e=ao(t),n=!1;return e&&(n=t.filter(function(i){return!ol(i)&&hK(t)}).length===0),e&&n}function oce(t){var e=fh(t)&&!LI(t),n=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],r,s;for(r=0;r<i.length;r+=1)s=i[r],n=n||gt(t,s);return e&&n}function ace(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function lce(t,e){arguments.length===1&&(arguments[0]?ice(arguments[0])?(t=arguments[0],e=void 0):oce(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||zt(),i=tO(n,this).startOf("day"),r=Z.calendarFormat(this,i)||"sameElse",s=e&&(fa(e[r])?e[r].call(this,n):e[r]);return this.format(s||this.localeData().calendar(r,this,zt(n)))}function cce(){return new ww(this)}function uce(t,e){var n=lo(t)?t:zt(t);return this.isValid()&&n.isValid()?(e=Hs(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function hce(t,e){var n=lo(t)?t:zt(t);return this.isValid()&&n.isValid()?(e=Hs(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function dce(t,e,n,i){var r=lo(t)?t:zt(t),s=lo(e)?e:zt(e);return this.isValid()&&r.isValid()&&s.isValid()?(i=i||"()",(i[0]==="("?this.isAfter(r,n):!this.isBefore(r,n))&&(i[1]===")"?this.isBefore(s,n):!this.isAfter(s,n))):!1}function fce(t,e){var n=lo(t)?t:zt(t),i;return this.isValid()&&n.isValid()?(e=Hs(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf())):!1}function gce(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function mce(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function pce(t,e,n){var i,r,s;if(!this.isValid())return NaN;if(i=tO(t,this),!i.isValid())return NaN;switch(r=(i.utcOffset()-this.utcOffset())*6e4,e=Hs(e),e){case"year":s=ty(this,i)/12;break;case"month":s=ty(this,i);break;case"quarter":s=ty(this,i)/3;break;case"second":s=(this-i)/1e3;break;case"minute":s=(this-i)/6e4;break;case"hour":s=(this-i)/36e5;break;case"day":s=(this-i-r)/864e5;break;case"week":s=(this-i-r)/6048e5;break;default:s=this-i}return n?s:Rs(s)}function ty(t,e){if(t.date()<e.date())return-ty(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),i=t.clone().add(n,"months"),r,s;return e-i<0?(r=t.clone().add(n-1,"months"),s=(e-i)/(i-r)):(r=t.clone().add(n+1,"months"),s=(e-i)/(r-i)),-(n+s)||0}Z.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Z.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function wce(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function vce(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?Qb(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):fa(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Qb(n,"Z")):Qb(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function bce(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,i,r,s;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(n+i+r+s)}function yce(t){t||(t=this.isUtc()?Z.defaultFormatUtc:Z.defaultFormat);var e=Qb(this,t);return this.localeData().postformat(e)}function Cce(t,e){return this.isValid()&&(lo(t)&&t.isValid()||zt(t).isValid())?mo({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Sce(t){return this.from(zt(),t)}function Rce(t,e){return this.isValid()&&(lo(t)&&t.isValid()||zt(t).isValid())?mo({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function _ce(t){return this.to(zt(),t)}function dK(t){var e;return t===void 0?this._locale._abbr:(e=dl(t),e!=null&&(this._locale=e),this)}var fK=Os("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function gK(){return this._locale}var Gy=1e3,df=60*Gy,qy=60*df,mK=(365*400+97)*24*qy;function ff(t,e){return(t%e+e)%e}function pK(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-mK:new Date(t,e,n).valueOf()}function wK(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-mK:Date.UTC(t,e,n)}function Ece(t){var e,n;if(t=Hs(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?wK:pK,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=ff(e+(this._isUTC?0:this.utcOffset()*df),qy);break;case"minute":e=this._d.valueOf(),e-=ff(e,df);break;case"second":e=this._d.valueOf(),e-=ff(e,Gy);break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function xce(t){var e,n;if(t=Hs(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?wK:pK,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=qy-ff(e+(this._isUTC?0:this.utcOffset()*df),qy)-1;break;case"minute":e=this._d.valueOf(),e+=df-ff(e,df)-1;break;case"second":e=this._d.valueOf(),e+=Gy-ff(e,Gy)-1;break}return this._d.setTime(e),Z.updateOffset(this,!0),this}function Tce(){return this._d.valueOf()-(this._offset||0)*6e4}function Mce(){return Math.floor(this.valueOf()/1e3)}function Pce(){return new Date(this.valueOf())}function Ace(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function Ice(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function Oce(){return this.isValid()?this.toISOString():null}function Hce(){return $I(this)}function kce(){return lc({},ze(this))}function Dce(){return ze(this).overflow}function Nce(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}xe("N",0,0,"eraAbbr");xe("NN",0,0,"eraAbbr");xe("NNN",0,0,"eraAbbr");xe("NNNN",0,0,"eraName");xe("NNNNN",0,0,"eraNarrow");xe("y",["y",1],"yo","eraYear");xe("y",["yy",2],0,"eraYear");xe("y",["yyy",3],0,"eraYear");xe("y",["yyyy",4],0,"eraYear");de("N",nO);de("NN",nO);de("NNN",nO);de("NNNN",Gce);de("NNNNN",qce);At(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,i){var r=n._locale.erasParse(t,i,n._strict);r?ze(n).era=r:ze(n).invalidEra=t});de("y",eg);de("yy",eg);de("yyy",eg);de("yyyy",eg);de("yo",Kce);At(["y","yy","yyy","yyyy"],Ni);At(["yo"],function(t,e,n,i){var r;n._locale._eraYearOrdinalRegex&&(r=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[Ni]=n._locale.eraYearOrdinalParse(t,r):e[Ni]=parseInt(t,10)});function Lce(t,e){var n,i,r,s=this._eras||dl("en")._eras;for(n=0,i=s.length;n<i;++n)switch(typeof s[n].since==="string"&&(r=Z(s[n].since).startOf("day"),s[n].since=r.valueOf()),typeof s[n].until){case"undefined":s[n].until=1/0;break;case"string":r=Z(s[n].until).startOf("day").valueOf(),s[n].until=r.valueOf();break}return s}function $ce(t,e,n){var i,r,s=this.eras(),o,a,l;for(t=t.toUpperCase(),i=0,r=s.length;i<r;++i)if(o=s[i].name.toUpperCase(),a=s[i].abbr.toUpperCase(),l=s[i].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(a===t)return s[i];break;case"NNNN":if(o===t)return s[i];break;case"NNNNN":if(l===t)return s[i];break}else if([o,a,l].indexOf(t)>=0)return s[i]}function Fce(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Z(t.since).year():Z(t.since).year()+(e-t.offset)*n}function Vce(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].name;return""}function Bce(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].narrow;return""}function Wce(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].abbr;return""}function jce(){var t,e,n,i,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=r[t].since<=r[t].until?1:-1,i=this.clone().startOf("day").valueOf(),r[t].since<=i&&i<=r[t].until||r[t].until<=i&&i<=r[t].since)return(this.year()-Z(r[t].since).year())*n+r[t].offset;return this.year()}function zce(t){return gt(this,"_erasNameRegex")||iO.call(this),t?this._erasNameRegex:this._erasRegex}function Uce(t){return gt(this,"_erasAbbrRegex")||iO.call(this),t?this._erasAbbrRegex:this._erasRegex}function Yce(t){return gt(this,"_erasNarrowRegex")||iO.call(this),t?this._erasNarrowRegex:this._erasRegex}function nO(t,e){return e.erasAbbrRegex(t)}function Gce(t,e){return e.erasNameRegex(t)}function qce(t,e){return e.erasNarrowRegex(t)}function Kce(t,e){return e._eraYearOrdinalRegex||eg}function iO(){var t=[],e=[],n=[],i=[],r,s,o,a,l,c=this.eras();for(r=0,s=c.length;r<s;++r)o=il(c[r].name),a=il(c[r].abbr),l=il(c[r].narrow),e.push(o),t.push(a),n.push(l),i.push(o),i.push(a),i.push(l);this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}xe(0,["gg",2],0,function(){return this.weekYear()%100});xe(0,["GG",2],0,function(){return this.isoWeekYear()%100});function FS(t,e){xe(0,[t,t.length],0,e)}FS("gggg","weekYear");FS("ggggg","weekYear");FS("GGGG","isoWeekYear");FS("GGGGG","isoWeekYear");de("G",kS);de("g",kS);de("GG",Ut,ss);de("gg",Ut,ss);de("GGGG",zI,jI);de("gggg",zI,jI);de("GGGGG",HS,IS);de("ggggg",HS,IS);bw(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,i){e[i.substr(0,2)]=ot(t)});bw(["gg","GG"],function(t,e,n,i){e[i]=Z.parseTwoDigitYear(t)});function Xce(t){return vK.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Jce(t){return vK.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Zce(){return rl(this.year(),1,4)}function Qce(){return rl(this.isoWeekYear(),1,4)}function eue(){var t=this.localeData()._week;return rl(this.year(),t.dow,t.doy)}function tue(){var t=this.localeData()._week;return rl(this.weekYear(),t.dow,t.doy)}function vK(t,e,n,i,r){var s;return t==null?Pp(this,i,r).year:(s=rl(t,i,r),e>s&&(e=s),nue.call(this,t,e,n,i,r))}function nue(t,e,n,i,r){var s=Jq(t,e,n,i,r),o=Mp(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}xe("Q",0,"Qo","quarter");de("Q",Vq);At("Q",function(t,e){e[Ka]=(ot(t)-1)*3});function iue(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}xe("D",["DD",2],"Do","date");de("D",Ut,tg);de("DD",Ut,ss);de("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});At(["D","DD"],Jo);At("Do",function(t,e){e[Jo]=ot(t.match(Ut)[0])});var bK=ng("Date",!0);xe("DDD",["DDDD",3],"DDDo","dayOfYear");de("DDD",OS);de("DDDD",Bq);At(["DDD","DDDD"],function(t,e,n){n._dayOfYear=ot(t)});function rue(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}xe("m",["mm",2],0,"minute");de("m",Ut,UI);de("mm",Ut,ss);At(["m","mm"],io);var sue=ng("Minutes",!1);xe("s",["ss",2],0,"second");de("s",Ut,UI);de("ss",Ut,ss);At(["s","ss"],Xa);var oue=ng("Seconds",!1);xe("S",0,0,function(){return~~(this.millisecond()/100)});xe(0,["SS",2],0,function(){return~~(this.millisecond()/10)});xe(0,["SSS",3],0,"millisecond");xe(0,["SSSS",4],0,function(){return this.millisecond()*10});xe(0,["SSSSS",5],0,function(){return this.millisecond()*100});xe(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});xe(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});xe(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});xe(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});de("S",OS,Vq);de("SS",OS,ss);de("SSS",OS,Bq);var cc,yK;for(cc="SSSS";cc.length<=9;cc+="S")de(cc,eg);function aue(t,e){e[qu]=ot(("0."+t)*1e3)}for(cc="S";cc.length<=9;cc+="S")At(cc,aue);yK=ng("Milliseconds",!1);xe("z",0,0,"zoneAbbr");xe("zz",0,0,"zoneName");function lue(){return this._isUTC?"UTC":""}function cue(){return this._isUTC?"Coordinated Universal Time":""}var te=ww.prototype;te.add=tce;te.calendar=lce;te.clone=cce;te.diff=pce;te.endOf=xce;te.format=yce;te.from=Cce;te.fromNow=Sce;te.to=Rce;te.toNow=_ce;te.get=bae;te.invalidAt=Dce;te.isAfter=uce;te.isBefore=hce;te.isBetween=dce;te.isSame=fce;te.isSameOrAfter=gce;te.isSameOrBefore=mce;te.isValid=Hce;te.lang=fK;te.locale=dK;te.localeData=gK;te.max=Hle;te.min=Ole;te.parsingFlags=kce;te.set=yae;te.startOf=Ece;te.subtract=nce;te.toArray=Ace;te.toObject=Ice;te.toDate=Pce;te.toISOString=vce;te.inspect=bce;typeof Symbol<"u"&&Symbol.for!=null&&(te[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});te.toJSON=Oce;te.toString=wce;te.unix=Mce;te.valueOf=Tce;te.creationData=Nce;te.eraName=Vce;te.eraNarrow=Bce;te.eraAbbr=Wce;te.eraYear=jce;te.year=zq;te.isLeapYear=vae;te.weekYear=Xce;te.isoWeekYear=Jce;te.quarter=te.quarters=iue;te.month=Kq;te.daysInMonth=Pae;te.week=te.weeks=Lae;te.isoWeek=te.isoWeeks=$ae;te.weeksInYear=eue;te.weeksInWeekYear=tue;te.isoWeeksInYear=Zce;te.isoWeeksInISOWeekYear=Qce;te.date=bK;te.day=te.days=Jae;te.weekday=Zae;te.isoWeekday=Qae;te.dayOfYear=rue;te.hour=te.hours=ole;te.minute=te.minutes=sue;te.second=te.seconds=oue;te.millisecond=te.milliseconds=yK;te.utcOffset=Wle;te.utc=zle;te.local=Ule;te.parseZone=Yle;te.hasAlignedHourOffset=Gle;te.isDST=qle;te.isLocal=Xle;te.isUtcOffset=Jle;te.isUtc=lK;te.isUTC=lK;te.zoneAbbr=lue;te.zoneName=cue;te.dates=Os("dates accessor is deprecated. Use date instead.",bK);te.months=Os("months accessor is deprecated. Use month instead",Kq);te.years=Os("years accessor is deprecated. Use year instead",zq);te.zone=Os("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",jle);te.isDSTShifted=Os("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Kle);function uue(t){return zt(t*1e3)}function hue(){return zt.apply(null,arguments).parseZone()}function CK(t){return t}var mt=VI.prototype;mt.calendar=Xoe;mt.longDateFormat=eae;mt.invalidDate=nae;mt.ordinal=sae;mt.preparse=CK;mt.postformat=CK;mt.relativeTime=aae;mt.pastFuture=lae;mt.set=qoe;mt.eras=Lce;mt.erasParse=$ce;mt.erasConvertYear=Fce;mt.erasAbbrRegex=Uce;mt.erasNameRegex=zce;mt.erasNarrowRegex=Yce;mt.months=Eae;mt.monthsShort=xae;mt.monthsParse=Mae;mt.monthsRegex=Iae;mt.monthsShortRegex=Aae;mt.week=Hae;mt.firstDayOfYear=Nae;mt.firstDayOfWeek=Dae;mt.weekdays=Yae;mt.weekdaysMin=qae;mt.weekdaysShort=Gae;mt.weekdaysParse=Xae;mt.weekdaysRegex=ele;mt.weekdaysShortRegex=tle;mt.weekdaysMinRegex=nle;mt.isPM=rle;mt.meridiem=ale;function Ky(t,e,n,i){var r=dl(),s=da().set(i,e);return r[n](s,t)}function SK(t,e,n){if(ol(t)&&(e=t,t=void 0),t=t||"",e!=null)return Ky(t,e,n,"month");var i,r=[];for(i=0;i<12;i++)r[i]=Ky(t,i,n,"month");return r}function rO(t,e,n,i){typeof t=="boolean"?(ol(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,ol(e)&&(n=e,e=void 0),e=e||"");var r=dl(),s=t?r._week.dow:0,o,a=[];if(n!=null)return Ky(e,(n+s)%7,i,"day");for(o=0;o<7;o++)a[o]=Ky(e,(o+s)%7,i,"day");return a}function due(t,e){return SK(t,e,"months")}function fue(t,e){return SK(t,e,"monthsShort")}function gue(t,e,n){return rO(t,e,n,"weekdays")}function mue(t,e,n){return rO(t,e,n,"weekdaysShort")}function pue(t,e,n){return rO(t,e,n,"weekdaysMin")}pc("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=ot(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Z.lang=Os("moment.lang is deprecated. Use moment.locale instead.",pc);Z.langData=Os("moment.langData is deprecated. Use moment.localeData instead.",dl);var ya=Math.abs;function wue(){var t=this._data;return this._milliseconds=ya(this._milliseconds),this._days=ya(this._days),this._months=ya(this._months),t.milliseconds=ya(t.milliseconds),t.seconds=ya(t.seconds),t.minutes=ya(t.minutes),t.hours=ya(t.hours),t.months=ya(t.months),t.years=ya(t.years),this}function RK(t,e,n,i){var r=mo(e,n);return t._milliseconds+=i*r._milliseconds,t._days+=i*r._days,t._months+=i*r._months,t._bubble()}function vue(t,e){return RK(this,t,e,1)}function bue(t,e){return RK(this,t,e,-1)}function BV(t){return t<0?Math.floor(t):Math.ceil(t)}function yue(){var t=this._milliseconds,e=this._days,n=this._months,i=this._data,r,s,o,a,l;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=BV(dP(n)+e)*864e5,e=0,n=0),i.milliseconds=t%1e3,r=Rs(t/1e3),i.seconds=r%60,s=Rs(r/60),i.minutes=s%60,o=Rs(s/60),i.hours=o%24,e+=Rs(o/24),l=Rs(_K(e)),n+=l,e-=BV(dP(l)),a=Rs(n/12),n%=12,i.days=e,i.months=n,i.years=a,this}function _K(t){return t*4800/146097}function dP(t){return t*146097/4800}function Cue(t){if(!this.isValid())return NaN;var e,n,i=this._milliseconds;if(t=Hs(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+i/864e5,n=this._months+_K(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(dP(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return e*24+i/36e5;case"minute":return e*1440+i/6e4;case"second":return e*86400+i/1e3;case"millisecond":return Math.floor(e*864e5)+i;default:throw new Error("Unknown unit "+t)}}function fl(t){return function(){return this.as(t)}}var EK=fl("ms"),Sue=fl("s"),Rue=fl("m"),_ue=fl("h"),Eue=fl("d"),xue=fl("w"),Tue=fl("M"),Mue=fl("Q"),Pue=fl("y"),Aue=EK;function Iue(){return mo(this)}function Oue(t){return t=Hs(t),this.isValid()?this[t+"s"]():NaN}function Wh(t){return function(){return this.isValid()?this._data[t]:NaN}}var Hue=Wh("milliseconds"),kue=Wh("seconds"),Due=Wh("minutes"),Nue=Wh("hours"),Lue=Wh("days"),$ue=Wh("months"),Fue=Wh("years");function Vue(){return Rs(this.days()/7)}var Va=Math.round,Jd={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Bue(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function Wue(t,e,n,i){var r=mo(t).abs(),s=Va(r.as("s")),o=Va(r.as("m")),a=Va(r.as("h")),l=Va(r.as("d")),c=Va(r.as("M")),u=Va(r.as("w")),h=Va(r.as("y")),d=s<=n.ss&&["s",s]||s<n.s&&["ss",s]||o<=1&&["m"]||o<n.m&&["mm",o]||a<=1&&["h"]||a<n.h&&["hh",a]||l<=1&&["d"]||l<n.d&&["dd",l];return n.w!=null&&(d=d||u<=1&&["w"]||u<n.w&&["ww",u]),d=d||c<=1&&["M"]||c<n.M&&["MM",c]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=i,Bue.apply(null,d)}function jue(t){return t===void 0?Va:typeof t=="function"?(Va=t,!0):!1}function zue(t,e){return Jd[t]===void 0?!1:e===void 0?Jd[t]:(Jd[t]=e,t==="s"&&(Jd.ss=e-1),!0)}function Uue(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,i=Jd,r,s;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(i=Object.assign({},Jd,e),e.s!=null&&e.ss==null&&(i.ss=e.s-1)),r=this.localeData(),s=Wue(this,!n,i,r),n&&(s=r.pastFuture(+this,s)),r.postformat(s)}var DE=Math.abs;function Xh(t){return(t>0)-(t<0)||+t}function VS(){if(!this.isValid())return this.localeData().invalidDate();var t=DE(this._milliseconds)/1e3,e=DE(this._days),n=DE(this._months),i,r,s,o,a=this.asSeconds(),l,c,u,h;return a?(i=Rs(t/60),r=Rs(i/60),t%=60,i%=60,s=Rs(n/12),n%=12,o=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",c=Xh(this._months)!==Xh(a)?"-":"",u=Xh(this._days)!==Xh(a)?"-":"",h=Xh(this._milliseconds)!==Xh(a)?"-":"",l+"P"+(s?c+s+"Y":"")+(n?c+n+"M":"")+(e?u+e+"D":"")+(r||i||t?"T":"")+(r?h+r+"H":"")+(i?h+i+"M":"")+(t?h+o+"S":"")):"P0D"}var ut=$S.prototype;ut.isValid=$le;ut.abs=wue;ut.add=vue;ut.subtract=bue;ut.as=Cue;ut.asMilliseconds=EK;ut.asSeconds=Sue;ut.asMinutes=Rue;ut.asHours=_ue;ut.asDays=Eue;ut.asWeeks=xue;ut.asMonths=Tue;ut.asQuarters=Mue;ut.asYears=Pue;ut.valueOf=Aue;ut._bubble=yue;ut.clone=Iue;ut.get=Oue;ut.milliseconds=Hue;ut.seconds=kue;ut.minutes=Due;ut.hours=Nue;ut.days=Lue;ut.weeks=Vue;ut.months=$ue;ut.years=Fue;ut.humanize=Uue;ut.toISOString=VS;ut.toString=VS;ut.toJSON=VS;ut.locale=dK;ut.localeData=gK;ut.toIsoString=Os("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",VS);ut.lang=fK;xe("X",0,0,"unix");xe("x",0,0,"valueOf");de("x",kS);de("X",dae);At("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});At("x",function(t,e,n){n._d=new Date(ot(t))});Z.version="2.30.1";Yoe(zt);Z.fn=te;Z.min=kle;Z.max=Dle;Z.now=Nle;Z.utc=da;Z.unix=uue;Z.months=due;Z.isDate=pw;Z.locale=pc;Z.invalid=AS;Z.duration=mo;Z.isMoment=lo;Z.weekdays=gue;Z.parseZone=hue;Z.localeData=dl;Z.isDuration=ey;Z.monthsShort=fue;Z.weekdaysMin=pue;Z.defineLocale=XI;Z.updateLocale=hle;Z.locales=dle;Z.weekdaysShort=mue;Z.normalizeUnits=Hs;Z.relativeTimeRounding=jue;Z.relativeTimeThreshold=zue;Z.calendarFormat=ace;Z.prototype=te;Z.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var WV={},jV={},zV;function Yue(){if(zV)return jV;zV=1;var t=Ot(),e=Qf(),n=Ar(),i=zn(),r=ha(),s=Ir(),o=Lc(),a=fw(),l=Dn(),c=TypeError,u=l(function(){[].keys().reduce(function(){},void 0)}),h=!u&&o("reduce",c);return t({target:"Iterator",proto:!0,real:!0,forced:u||h},{reduce:function(f){i(this);try{n(f)}catch(b){s(this,"throw",b)}var g=arguments.length<2,m=g?void 0:arguments[1];if(h)return a(h,this,g?[f]:[f,m]);var p=r(this),v=0;if(e(p,function(b){g?(g=!1,m=b):m=f(m,b,v),v++},{IS_RECORD:!0}),g)throw new c("Reduce of empty iterator with no initial value");return m}}),jV}var UV;function Gue(){return UV||(UV=1,Yue()),WV}Gue();function xK(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function fP(t,e){const n=e.length;let i=0;for(;i<n;)t.push(e[i]),i+=1}function Ym(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,i=t[0].length;for(let r=0;r<n;r++)for(let s=0;s<i;s++)e[s]||(e[s]=[]),e[s][r]=t[r][s];return e}function Un(t,e,n,i){let r=-1,s=t,o=n;Array.isArray(t)||(s=Array.from(t));const a=s.length;for(i&&a&&(r+=1,o=s[r]),r+=1;r<a;)o=e(o,s[r],r,s),r+=1;return o}function Ec(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,s=[];let o=-1;for(;n<r;){const a=i[n];e(a,n,i)&&(o+=1,s[o]=a),n+=1}return s}function lt(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,s=[];let o=-1;for(;n<r;){const a=i[n];o+=1,s[o]=e(a,n,i),n+=1}return s}function k(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length;for(;n<r&&e(i[n],n,i)!==!1;)n+=1;return t}function TK(t){return Un(t,(e,n)=>e+n,0)}function que(t){return Un(t,(e,n)=>e>n?e:n,Array.isArray(t)?t[0]:void 0)}function Kue(t){return Un(t,(e,n)=>e<n?e:n,Array.isArray(t)?t[0]:void 0)}function Xue(t){return t.length?TK(t)/t.length:0}function MK(t){return Un(t,(e,n)=>e.concat(Array.isArray(n)?MK(n):n),[])}function PK(t){const e=[];return k(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function gP(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e];let s=i;return k(r,o=>{s=s.filter(a=>!o.includes(a))}),s}function Jue(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e];let s=i;return k(r,o=>{s=s.filter(a=>o.includes(a))}),s}function Zue(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e],s=new Set(i);return k(r,o=>{k(o,a=>{s.has(a)||s.add(a)})}),Array.from(s)}function mP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const Que=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:Xue,arrayEach:k,arrayFilter:Ec,arrayFlatten:MK,arrayMap:lt,arrayMax:que,arrayMin:Kue,arrayReduce:Un,arraySum:TK,arrayUnique:PK,extendArray:fP,getDifferenceOfArrays:gP,getIntersectionOfArrays:Jue,getUnionOfArrays:Zue,pivot:Ym,stringToArray:mP,to2dArray:xK},Symbol.toStringTag,{value:"Module"}));function ct(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return Un(t,(s,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),c=n[a]?n[a]:"";return s+l+c},"").trim()}function Mf(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];const r=document.createElement("template");r.innerHTML=t.reduce((a,l,c)=>{var u;return a+l+((u=n[c])!==null&&u!==void 0?u:"")},"");const s=r.content.cloneNode(!0),o={};return s.querySelectorAll("[data-ref]").forEach(a=>{const l=a.getAttribute("data-ref");a.removeAttribute("data-ref"),o[l]=a}),{fragment:s,refs:o}}function Pt(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function se(t){return typeof t<"u"}function Nt(t){return typeof t>"u"}function hn(t){return t===null||t===""||Nt(t)}function AK(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Mm="length",Gm=t=>parseInt(t,16),YV=t=>parseInt(t,10),Xy=(t,e,n)=>t.substr(e,n),qm=t=>t.codePointAt(0)-65,pP=t=>`${t}`.replace(/\-/g,""),ehe=t=>Gm(Xy(pP(t),Gm("12"),qm("F")))/(Gm(Xy(pP(t),qm("B"),~~![][Mm]))||9),the=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let GV=!1;const qV={invalid:()=>ct`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ct`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>ct`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},KV={invalid:()=>ct`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return ct`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>ct`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function IK(t,e){const n=!hn(t),i=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",r="16.2.0";let s,o="invalid",a="invalid";t=pP(t||"");const l=nhe(t);if(n||i||l)if(l){const c=Z("25/11/2025","DD/MM/YYYY"),u=Math.floor(c.toDate().getTime()/864e5),h=ehe(t);s=Z((h+1)*864e5,"x").format("MMMM DD, YYYY"),u>h?(o="expired",a="expired"):(o="valid",a="valid")}else i?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(the()&&(o="valid",a="valid"),!GV&&o!=="valid"&&(qV[o]({keyValidityDate:s,hotVersion:r})&&console[o==="non_commercial"?"info":"warn"](qV[o]({keyValidityDate:s,hotVersion:r})),GV=!0),a!=="valid"&&e&&KV[a]({keyValidityDate:s,hotVersion:r})){const u=document.createElement("div");u.className="handsontable hot-display-license-info",u.innerHTML=KV[a]({keyValidityDate:s,hotVersion:r}),e.appendChild(u)}}function nhe(t){let e=[][Mm],n=e;if(t[Mm]!==qm("Z"))return!1;for(let i="",r="B<H4P+".split(""),s=qm(r.shift());s;s=qm(r.shift()||"A"))--s<""[Mm]?n=n|(YV(`${YV(Gm(i)+(Gm(Xy(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=Xy(t,s,s?r[Mm]===1?9:8:6);return n===e}const ihe=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:IK,isDefined:se,isEmpty:hn,isRegExp:AK,isUndefined:Nt,stringify:Pt},Symbol.toStringTag,{value:"Module"}));function Fi(t){return t[0].toUpperCase()+t.substr(1)}function rhe(){const t=[];for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];let r=n.length;for(;r;){r-=1;const s=Pt(n[r]).toLowerCase();t.indexOf(s)===-1&&t.push(s)}return t.length===1}function sO(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function OK(t){if(typeof t!="string")return!1;try{const e=JSON.parse(t);return typeof e=="object"&&e!==null}catch{return!1}}function oO(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function BS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,i)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[i]===void 0?"":e[i])}function ia(t){return WS(`${t}`,{ALLOWED_TAGS:[]})}function WS(t,e){return Uoe.sanitize(t,e)}const she=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:rhe,isJSON:OK,isPercentValue:oO,randomString:sO,sanitize:WS,stripTags:ia,substitute:BS,toUpperCaseFirst:Fi},Symbol.toStringTag,{value:"Module"})),co=t=>["tabindex",t],ohe=()=>["role","treegrid"],Ja=()=>["role","presentation"],ahe=()=>["role","gridcell"],lhe=()=>["role","gridcell button"],che=()=>["role","rowheader"],HK=()=>["role","rowgroup"],uhe=()=>["role","columnheader"],kK=()=>["role","row"],hhe=()=>["role","menu"],dhe=()=>["role","menuitem"],fhe=()=>["role","menuitemcheckbox"],ghe=()=>["role","combobox"],DK=()=>["role","listbox"],mhe=()=>["role","option"],phe=()=>["role","checkbox"],whe=()=>["role","dialog"],vhe=()=>["role","alertdialog"],bhe=()=>["scope","col"],yhe=()=>["scope","row"],Che=()=>["type","text"],Jr=t=>["aria-label",t],She=t=>["aria-labelledby",t],Rhe=t=>["aria-describedby",t],jh=()=>["aria-hidden","true"],Pm=function(){return["aria-disabled",arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0]},_he=()=>["aria-multiselectable","true"],NK=t=>["aria-haspopup",t],LK=t=>["aria-rowcount",t],jS=t=>["aria-colcount",t],$K=t=>["aria-rowindex",t],aO=t=>["aria-colindex",t],Ts=t=>["aria-expanded",t],Ehe=t=>["aria-sort",t],XV=()=>["aria-readonly","true"],JV=()=>["aria-invalid","true"],FK=t=>["aria-checked",t],lO=()=>["aria-selected","true"],xhe=()=>["aria-autocomplete","list"],The=t=>["aria-controls",t],Mhe=t=>["aria-activedescendant",t],Phe=t=>["aria-live",t],Ahe=t=>["aria-relevant",t],Ihe=t=>["aria-setsize",t],Ohe=t=>["aria-posinset",t],Hhe=()=>["aria-modal","true"];var ZV={},NE,QV;function khe(){if(QV)return NE;QV=1;var t=is(),e=MI().get;return NE=function(i){if(!t(i))return!1;var r=e(i);return!!r&&r.type==="RawJSON"},NE}var LE,eB;function Dhe(){if(eB)return LE;eB=1;var t=Nn(),e=rs(),n=SyntaxError,i=parseInt,r=String.fromCharCode,s=t("".charAt),o=t("".slice),a=t(/./.exec),l={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},c=/^[\da-f]{4}$/i,u=/^[\u0000-\u001F]$/;return LE=function(h,d){for(var f=!0,g="";d<h.length;){var m=s(h,d);if(m==="\\"){var p=o(h,d,d+2);if(e(l,p))g+=l[p],d+=2;else if(p==="\\u"){d+=2;var v=o(h,d,d+4);if(!a(c,v))throw new n("Bad Unicode escape at: "+d);g+=r(i(v,16)),d+=4}else throw new n('Unknown escape sequence: "'+p+'"')}else if(m==='"'){f=!1,d++;break}else{if(a(u,m))throw new n("Bad control character in string literal at: "+d);g+=m,d++}}if(f)throw new n("Unterminated string at: "+d);return{value:g,end:d}},LE}var $E,tB;function Nhe(){if(tB)return $E;tB=1;var t=Dn();return $E=!t(function(){var e="9007199254740993",n=JSON.rawJSON(e);return!JSON.isRawJSON(n)||JSON.stringify(n)!==e}),$E}var nB;function Lhe(){if(nB)return ZV;nB=1;var t=Ot(),e=Kf(),n=fw(),i=jn(),r=Nn(),s=Dn(),o=wq(),a=ei(),l=khe(),c=CI(),u=Lh(),h=PS(),d=NI(),f=Dhe(),g=_I(),m=yI(),p=Nhe(),v=String,b=e("JSON","stringify"),R=r(/./.exec),S=r("".charAt),x=r("".charCodeAt),M=r("".replace),T=r("".slice),O=r([].push),W=r(1.1.toString),N=/[\uD800-\uDFFF]/g,G=/^[\uD800-\uDBFF]$/,j=/^[\uDC00-\uDFFF]$/,ne=g(),ee=ne.length,Q=!m||s(function(){var Ce=e("Symbol")("stringify detection");return b([Ce])!=="[null]"||b({a:Ce})!=="{}"||b(Object(Ce))!=="{}"}),me=s(function(){return b("\uDF06\uD834")!=='"\\udf06\\ud834"'||b("\uDEAD")!=='"\\udead"'}),fe=Q?function(Ce,Te){var $e=d(arguments),Me=Oe(Te);if(!(!a(Me)&&(Ce===void 0||c(Ce))))return $e[1]=function(X,w){if(a(Me)&&(w=i(Me,this,v(X),w)),!c(w))return w},n(b,null,$e)}:b,ye=function(Ce,Te,$e){var Me=S($e,Te-1),X=S($e,Te+1);return R(G,Ce)&&!R(j,X)||R(j,Ce)&&!R(G,Me)?"\\u"+W(x(Ce,0),16):Ce},Oe=function(Ce){if(a(Ce))return Ce;if(o(Ce)){for(var Te=Ce.length,$e=[],Me=0;Me<Te;Me++){var X=Ce[Me];typeof X=="string"?O($e,X):(typeof X=="number"||u(X)==="Number"||u(X)==="String")&&O($e,h(X))}var w=$e.length,C=!0;return function(E,D){if(C)return C=!1,D;if(o(this))return D;for(var B=0;B<w;B++)if($e[B]===E)return D}}};return b&&t({target:"JSON",stat:!0,arity:3,forced:Q||me||!p},{stringify:function(Te,$e,Me){var X=Oe($e),w=[],C=fe(Te,function(L,I){var A=a(X)?i(X,this,v(L),I):I;return!p&&l(A)?ne+(O(w,A.rawJSON)-1):A},Me);if(typeof C!="string"||(me&&(C=M(C,N,ye)),p))return C;for(var E="",D=C.length,B=0;B<D;B++){var y=S(C,B);if(y==='"'){var _=f(C,++B).end-1,P=T(C,B,_);E+=T(P,0,ee)===ne?w[T(P,ee)]:'"'+P+'"',B=_}else E+=y}return E}}),ZV}Lhe();function Pf(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},Ye(t,(n,i)=>{i!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[i]=Pf(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[i]=[Pf(n[0])]:e[i]=[]:e[i]=null)})),e}function VK(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function On(t,e,n){const i=Array.isArray(n);return Ye(e,(r,s)=>{(i===!1||n.includes(s))&&(t[s]=r)}),t}function yw(t,e){Ye(e,(n,i)=>{e[i]&&typeof e[i]=="object"?(t[i]||(Array.isArray(e[i])?t[i]=[]:Object.prototype.toString.call(e[i])==="[object Date]"?t[i]=e[i]:t[i]={}),yw(t[i],e[i])):t[i]=e[i]})}function Vi(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function uo(t){const e={};return Ye(t,(n,i)=>{e[i]=n}),e}function pt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return k(n,r=>{t.MIXINS.push(r.MIXIN_NAME),Ye(r,(s,o)=>{if(t.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")t.prototype[o]=s;else{const a=function(u,h){const d=`_${u}`,f=g=>{let m=g;return(Array.isArray(m)||Re(m))&&(m=Vi(m)),m};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(u){const h=`_${u}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),t}function Cw(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Re(t){return Object.prototype.toString.call(t)==="[object Object]"}function ga(t,e,n,i){i.value=n,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(t,e,i)}function Ye(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function Jy(t,e){const n=e.split(".");let i=t;return Ye(n,r=>{if(i=i[r],i===void 0)return i=void 0,!1}),i}function ny(t,e,n){if(typeof e!="string")return;const i=e.split(".");let r=t;i.forEach((s,o)=>{s==="__proto__"||s==="constructor"||s==="prototype"||(o!==i.length-1?(ln(r,s)||(r[s]={}),r=r[s]):r[s]=n)})}function zS(t){if(!Re(t))return 0;const e=function(n){let i=0;return Re(n)?Ye(n,(r,s)=>{s!=="__children"&&(i+=e(r))}):i+=1,i};return e(t)}function xr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,i={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[n]},set(r){this._touched=!0,this[n]=r},enumerable:!0,configurable:!0}),i}function ln(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Km(t,e){if(typeof t!="object"||t===null)return e;if(typeof e!="object"||e===null)return t;const n={};return Object.keys(e).forEach(i=>{typeof e[i]=="object"&&e[i]!==null&&!Array.isArray(e[i])?n[i]=Km(t[i],e[i]):n[i]=ln(t,i)&&t[i]!==void 0?t[i]:e[i]}),Object.keys(t).forEach(i=>{ln(n,i)||(n[i]=t[i])}),n}const $he=Object.freeze(Object.defineProperty({__proto__:null,assignObjectDefaults:Km,clone:uo,createObjectPropListener:xr,deepClone:Vi,deepExtend:yw,deepObjectSize:zS,defineGetter:ga,duckSchema:Pf,extend:On,getProperty:Jy,hasOwnProperty:ln,inherit:VK,isObject:Re,isObjectEqual:Cw,mixin:pt,objectEach:Ye,setProperty:ny},Symbol.toStringTag,{value:"Module"}));function Ip(t){return window.requestAnimationFrame(t)}function Op(t){window.cancelAnimationFrame(t)}function cO(){return"ontouchstart"in window}function BK(){return typeof window<"u"}let Jh;function WK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Jh||(typeof Intl=="object"?Jh=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Jh=(n,i)=>`${n}`.localeCompare(i):Jh=(n,i)=>n===i?0:n>i?-1:1,Jh)}const Fhe=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Op,getComparisonFunction:WK,isCSR:BK,isTouchSupported:cO,requestAnimationFrame:Ip},Symbol.toStringTag,{value:"Module"})),vs=t=>{const e={value:!1};return e.test=(n,i)=>{e.value=t(n,i)},e},gl={chrome:vs((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:vs(t=>/CriOS/.test(t)),edge:vs(t=>/Edge/.test(t)),edgeWebKit:vs(t=>/EdgiOS/.test(t)),firefox:vs(t=>/Firefox/.test(t)),firefoxWebKit:vs(t=>/FxiOS/.test(t)),mobile:vs(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:vs((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},ig={mac:vs(t=>/^Mac/.test(t)),win:vs(t=>/^Win/.test(t)),linux:vs(t=>/^Linux/.test(t)),ios:vs(t=>/iPhone|iPad|iPod/i.test(t))};function jK(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ye(gl,n=>{let{test:i}=n;i(t,e)})}function zK(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ye(ig,e=>{let{test:n}=e;n(t)})}BK()&&(jK(),zK());function uO(){return gl.chrome.value}function UK(){return gl.chromeWebKit.value}function iy(){return gl.firefox.value}function YK(){return gl.firefoxWebKit.value}function Sw(){return gl.safari.value}function GK(){return gl.edge.value}function Vhe(){return gl.edgeWebKit.value}function ro(){return gl.mobile.value}function hO(){return ig.ios.value}function US(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&ig.mac.value}function Zy(){return ig.win.value}function Qy(){return ig.mac.value}function Bhe(){return ig.linux.value}const Whe=Object.freeze(Object.defineProperty({__proto__:null,isChrome:uO,isChromeWebKit:UK,isEdge:GK,isEdgeWebKit:Vhe,isFirefox:iy,isFirefoxWebKit:YK,isIOS:hO,isIpadOS:US,isLinuxOS:Bhe,isMacOS:Qy,isMobileBrowser:ro,isSafari:Sw,isWindowsOS:Zy,setBrowserMeta:jK,setPlatformMeta:zK},Symbol.toStringTag,{value:"Module"}));function qK(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,i=null,r=t;for(;r!==null;){if(n===e){i=r;break}r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:(n+=1,r=r.parentNode)}return i}function Xm(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function KK(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function al(t){return KK(t)&&t.parent}function jhe(t){return!!Object.getPrototypeOf(t.parent)}function xc(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:r}=Node;let s=t;for(;s!=null&&s!==n;){const{nodeType:o,nodeName:a}=s;if(o===i&&(e.includes(a)||e.includes(s)))return s;const{host:l}=s;l&&o===r?s=l:s=s.parentNode}return null}function Am(t,e,n){const i=[];let r=t;for(;r&&(r=xc(r,e,n),!(!r||n&&!n.contains(r)));)i.push(r),r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:r=r.parentNode;const s=i.length;return s?i[s-1]:null}function XK(t,e){const n={element:void 0,classNames:[]};let i=t;for(;i!==null&&i!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&i.classList.contains(e))n.element=i,n.classNames.push(e);else if(e instanceof RegExp){const r=Array.from(i.classList).filter(s=>e.test(s));r.length&&(n.element=i,n.classNames.push(...r))}i=i.parentElement}return n}function wc(t,e){let n=t.parentNode,i=[];for(typeof e=="string"?t.defaultView?i=Array.prototype.slice.call(t.querySelectorAll(e),0):i=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):i.push(e);n!==null;){if(i.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function JK(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function jl(t,e,n){const i=n.parentElement.querySelector(`.ht_clone_${t}`);return i?i.contains(e):null}function ZK(t){return!t||!t.length?[]:t.filter(e=>!!e)}function QK(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],i=[];return i.push(...t.filter(r=>{const s=r instanceof RegExp;return s&&e&&n.push(r),!s})),{regexFree:i,regexes:n}}function Ee(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function q(t,e){typeof e=="string"&&(e=e.split(" ")),e=ZK(e),e.length>0&&t.classList.add(...e)}function ue(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:i}=QK(e,!0);n=ZK(n),n.length>0&&t.classList.remove(...n),i.forEach(r=>{t.classList.forEach(s=>{r.test(s)&&t.classList.remove(s)})})}function he(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(i=>{Array.isArray(i)&&i[0]!==""&&t.setAttribute(...i)})}function ra(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:i}=QK(e,!0);n.forEach(r=>{r!==""&&t.removeAttribute(r)}),i.forEach(r=>{t.getAttributeNames().forEach(s=>{r.test(s)&&t.removeAttribute(s)})})}function dO(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)dO(e[n])}}function ca(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const e5=/(<(.*)>|&(.*);)/;function $c(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;e5.test(e)?t.innerHTML=n?WS(e):e:Tc(t,e)}function Tc(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(ca(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Mc(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let i=t;for(;i!==e;){if(i===null)return!1;if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(i.host){if(i.host.impl)return Mc(i.host.impl);if(i.host)return Mc(i.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(i).display==="none")return!1;i=i.parentNode}return!0}function t5(t){const n=t.ownerDocument.defaultView;let i=t;for(;i.parentNode;){if(i.style.height==="0px"||i.style.height==="0")return n.getComputedStyle(i).overflow==="hidden";i=i.parentNode}return!1}function yi(t){const e=t.ownerDocument,n=e.defaultView,i=e.documentElement;let r=t,s,o,a;for(s=r.offsetLeft,o=r.offsetTop,a=r;(r=r.offsetParent)&&!(r===e.body||!("offsetLeft"in r));)s+=r.offsetLeft,o+=r.offsetTop,a=r;return a&&a.style.position==="fixed"&&(s+=n.pageXOffset||i.scrollLeft,o+=n.pageYOffset||i.scrollTop),{left:s,top:o}}function fO(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function YS(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function GS(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?fO(e):t.scrollTop}function gO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?YS(e):t.scrollLeft}function Hp(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const i=["auto","scroll"];let r=t.parentNode;for(;r&&r.style&&e.body!==r;){let{overflow:s,overflowX:o,overflowY:a}=r.style;if([s,o,a].includes("scroll"))return r;if({overflow:s,overflowX:o,overflowY:a}=n.getComputedStyle(r),i.includes(s)||i.includes(o)||i.includes(a)||r.clientHeight<=r.scrollHeight+1&&(i.includes(a)||i.includes(s))||r.clientWidth<=r.scrollWidth+1&&(i.includes(o)||i.includes(s)))return r;r=r.parentNode}return n}function n5(t){return t.scrollHeight-t.clientHeight}function i5(t){return t.scrollWidth-t.clientWidth}function Af(t){const e=t.ownerDocument,n=e.defaultView;let i=t.parentNode;for(;i&&i.style&&e.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;const r=n.getComputedStyle(i),s=["scroll","hidden","auto"],o=r.getPropertyValue("overflow"),a=r.getPropertyValue("overflow-y"),l=r.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return i;i=i.parentNode}return n}function kp(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const i=t.style[e];if(i!==""&&i!==void 0)return i;const r=n.getComputedStyle(t);if(r[e]!==""&&r[e]!==void 0)return r[e]}function zhe(t,e){const{selectorText:n}=e;let i=!1;return e.type===CSSRule.STYLE_RULE&&n&&(t.msMatchesSelector?i=t.msMatchesSelector(n):t.matches&&(i=t.matches(n))),i}function yn(t){return t.offsetWidth}function An(t){return t.getBoundingClientRect().height}function gf(t){return t.clientHeight||t.innerHeight}function mO(t){return t.clientWidth||t.innerWidth}function Uhe(t,e,n){t.addEventListener(e,n,!1)}function Yhe(t,e,n){t.removeEventListener(e,n,!1)}function pO(t){return t.selectionStart?t.selectionStart:0}function r5(t){return t.selectionEnd?t.selectionEnd:0}function Ghe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let n="";return t.getSelection?n=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(n=e.selection.createRange().text),n}function wP(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function Rw(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const r=t.parentNode,s=r.style.display;r.style.display="block",t.setSelectionRange(e,n),r.style.display=s}}}let FE;function s5(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return Zy()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function qhe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");Sw()&&!ro()&&!US()&&n.classList.add("htScrollbarSafariTest"),n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const i=e.getBoundingClientRect().width;n.style.overflow="scroll";let r=e.getBoundingClientRect().width;return i===r&&(r=n.clientWidth),(t.body||t.documentElement).removeChild(n),parseFloat((i-r).toFixed(3))}function Sn(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return FE===void 0&&(FE=qhe(t)),FE}function wO(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function vO(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function qS(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function Khe(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function _w(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function Jm(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function KS(t){return Jm(t)&&t.hasAttribute("data-hot-input")===!1}function Xhe(t){const e=t.ownerDocument.activeElement;KS(e)||t.select()}function bO(t){return!t.parentNode}function o5(t,e){new IntersectionObserver((i,r)=>{i.forEach(s=>{s.isIntersecting&&t.offsetParent!==null&&(e(),r.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function yO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=t.ownerDocument,r=i.createRange(),s=i.defaultView.getSelection();he(t,"contenteditable",!0),n&&he(t,...jh()),e&&q(t,"invisibleSelection"),r.selectNodeContents(t),s.removeAllRanges(),s.addRange(r)}function CO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&ue(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function a5(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;yO(t,n),e(),CO(t,n)}function sa(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}const Jhe=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:e5,addClass:q,addEvent:Uhe,clearTextSelection:wP,closest:xc,closestDown:Am,empty:ca,fastInnerHTML:$c,fastInnerText:Tc,findFirstParentWithClass:XK,getCaretPosition:pO,getCssTransform:Khe,getFractionalScalingCompensation:s5,getFrameElement:KK,getMaximumScrollLeft:i5,getMaximumScrollTop:n5,getParent:qK,getParentWindow:al,getScrollLeft:gO,getScrollTop:GS,getScrollableElement:Hp,getScrollbarWidth:Sn,getSelectionEndPosition:r5,getSelectionText:Ghe,getStyle:kp,getTrimmingContainer:Af,getWindowScrollLeft:YS,getWindowScrollTop:fO,hasAccessToParentWindow:jhe,hasClass:Ee,hasHorizontalScrollbar:vO,hasVerticalScrollbar:wO,hasZeroHeight:t5,index:JK,innerHeight:gf,innerWidth:mO,isChildOf:wc,isDetached:bO,isHTMLElement:sa,isInput:Jm,isInternalElement:Xm,isOutsideInput:KS,isVisible:Mc,makeElementContentEditableAndSelectItsContent:yO,matchesCSSRules:zhe,observeVisibilityChangeOnce:o5,offset:yi,outerHeight:An,outerWidth:yn,overlayContainsElement:jl,removeAttribute:ra,removeClass:ue,removeContentEditableFromElementAndDeselect:CO,removeEvent:Yhe,removeTextNodes:dO,resetCssTransform:_w,runWithSelectedContendEditableElement:a5,selectElementIfAllowed:Xhe,setAttribute:he,setCaretPosition:Rw,setOverlayPosition:qS},Symbol.toStringTag,{value:"Module"}));function ht(t){return typeof t=="function"}function l5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=0;const i={lastCallThrottled:!0};let r=null;function s(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];const c=Date.now();let u=!1;i.lastCallThrottled=!0,n||(n=c,u=!0);const h=e-(c-n);return u?(i.lastCallThrottled=!1,t.apply(this,a)):(r&&clearTimeout(r),r=setTimeout(()=>{i.lastCallThrottled=!1,t.apply(this,a),n=0,r=void 0},h)),i}return s}function Zhe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const i=l5(t,e);let r=n;function s(){r=n}function o(){for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];return r?(r-=1,t.apply(this,l)):i.apply(this,l)}return o.clearHits=s,o}function Ew(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,i;function r(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n&&clearTimeout(n),n=setTimeout(()=>{i=t.apply(this,o)},e),i}return r}function Qhe(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=e;return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return Un(r,(c,u)=>u(c),i.apply(this,a))}}function SO(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t.apply(this,n.concat(o))}}function c5(t){const e=t.length;function n(i){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=i.concat(o);let c;return l.length>=e?c=t.apply(this,l):c=n(l),c}}return n([])}function ede(t){const e=t.length;function n(i){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=i.concat(o.reverse());let c;return l.length>=e?c=t.apply(this,l):c=n(l),c}}return n([])}function eC(t,e,n,i,r,s,o,a){return se(a)?t.call(e,n,i,r,s,o,a):se(o)?t.call(e,n,i,r,s,o):se(s)?t.call(e,n,i,r,s):se(r)?t.call(e,n,i,r):se(i)?t.call(e,n,i):se(n)?t.call(e,n):t.call(e)}const tde=Object.freeze(Object.defineProperty({__proto__:null,curry:c5,curryRight:ede,debounce:Ew,fastCall:eC,isFunction:ht,partial:SO,pipe:Qhe,throttle:l5,throttleAfterHits:Zhe},Symbol.toStringTag,{value:"Module"})),be={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:iy()?182:174,AUDIO_MUTE:iy()?181:173,AUDIO_UP:iy()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},nde=[be.ALT,be.ARROW_DOWN,be.ARROW_LEFT,be.ARROW_RIGHT,be.ARROW_UP,be.AUDIO_DOWN,be.AUDIO_MUTE,be.AUDIO_UP,be.BACKSPACE,be.CAPS_LOCK,be.DELETE,be.END,be.ENTER,be.ESCAPE,be.F1,be.F2,be.F3,be.F4,be.F5,be.F6,be.F7,be.F8,be.F9,be.F10,be.F11,be.F12,be.F13,be.F14,be.F15,be.F16,be.F17,be.F18,be.F19,be.HOME,be.INSERT,be.MEDIA_NEXT,be.MEDIA_PLAY_PAUSE,be.MEDIA_PREV,be.MEDIA_STOP,be.NULL,be.NUM_LOCK,be.PAGE_DOWN,be.PAGE_UP,be.PAUSE,be.SCROLL_LOCK,be.SHIFT,be.TAB];function u5(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function RO(t){return nde.includes(t)}function ide(t){const e=[];return Qy()?e.push(be.COMMAND_LEFT,be.COMMAND_RIGHT,be.COMMAND_FIREFOX):e.push(be.CONTROL),e.includes(t)}function h5(t){return[be.CONTROL,be.COMMAND_LEFT,be.COMMAND_RIGHT,be.COMMAND_FIREFOX].includes(t)}function Eh(t,e){const n=e.split("|");let i=!1;return k(n,r=>{if(t===be[r])return i=!0,!1}),i}const rde=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:be,isCtrlKey:ide,isCtrlMetaKey:h5,isFunctionKey:RO,isKey:Eh,isPrintableChar:u5},Symbol.toStringTag,{value:"Module"}));function es(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Jl(t){return t.isImmediatePropagationEnabled===!1}function Pc(t){return t.button===2}function XS(t){return t.button===0}function d5(t){return typeof TouchEvent<"u"&&t instanceof TouchEvent}function f5(t,e){const n={x:t.offsetX,y:t.offsetY};let i=t.target;if(!sa(e)||i!==e&&i.contains(e))return n;for(;i!==e;)n.x+=i.offsetLeft,n.y+=i.offsetTop,i=i.offsetParent;return n}const sde=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Jl,isLeftClick:XS,isRightClick:Pc,isTouchEvent:d5,offsetRelativeTo:f5,stopImmediatePropagation:es},Symbol.toStringTag,{value:"Module"}));function Ue(){se(console)&&console.warn(...arguments)}function g5(t){se(console)&&console.warn(`Deprecated: ${t}`)}function _O(){se(console)&&console.error(...arguments)}const Fu=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceCacheUpdate","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceCacheUpdate","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","beforeSelectAll","afterSelectAll","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeHeightChange","beforeWidthChange","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","beforePageChange","afterPageChange","beforePageSizeChange","afterPageSizeChange","afterPageSizeVisibilityChange","afterPageCounterVisibilityChange","afterPageNavigationVisibilityChange","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterDialogHide","afterDialogShow","beforeDialogHide","beforeDialogShow","dialogFocusPreviousElement","dialogFocusNextElement","afterDialogFocus","beforeLoadingShow","afterLoadingShow","beforeLoadingHide","afterLoadingHide","beforeEmptyDataStateShow","afterEmptyDataStateShow","beforeEmptyDataStateHide","afterEmptyDataStateHide","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],VE=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),BE=new Map([[]]);var iB={},WE,rB;function ode(){if(rB)return WE;rB=1;var t=Zf();return WE=function(e,n,i){for(var r=0,s=arguments.length>2?i:t(n),o=new e(s);s>r;)o[r]=n[r++];return o},WE}var jE,sB;function ade(){if(sB)return jE;sB=1;var t=kn();return jE=function(e,n){var i=t[e],r=i&&i.prototype;return r&&r[n]},jE}var zE,oB;function JS(){if(oB)return zE;oB=1;var t=go(),e=HI(),n=Nc().f,i=t("unscopables"),r=Array.prototype;return r[i]===void 0&&n(r,i,{configurable:!0,value:e(null)}),zE=function(s){r[i][s]=!0},zE}var aB;function lde(){if(aB)return iB;aB=1;var t=Ot(),e=Nn(),n=Ar(),i=cw(),r=ode(),s=ade(),o=JS(),a=Array,l=e(s("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(u){u!==void 0&&n(u);var h=i(this),d=r(a,h);return l(d,u)}}),o("toSorted"),iB}lde();var lB={},cB={},uB;function cde(){if(uB)return cB;uB=1;var t=Ot(),e=jn(),n=Qf(),i=Ar(),r=zn(),s=ha(),o=Ir(),a=Lc(),l=a("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{find:function(u){r(this);try{i(u)}catch(f){o(this,"throw",f)}if(l)return e(l,this,u);var h=s(this),d=0;return n(h,function(f,g){if(u(f,d++))return g(f)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),cB}var hB;function ude(){return hB||(hB=1,cde()),lB}ude();function hde(t,e){m5(t,e),e.add(t)}function UE(t,e,n){m5(t,e),e.set(t,n)}function m5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dB(t,e,n){return t.set(tC(t,e),n),n}function wi(t,e){return t.get(tC(t,e))}function tC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const dde=100;var Fr=new WeakMap,Wd=new WeakMap,YE=new WeakMap,GE=new WeakSet;class fB{constructor(){hde(this,GE),UE(this,Fr,new Map),UE(this,Wd,new Map),UE(this,YE,new Set),Fu.forEach(e=>tC(GE,this,gB).call(this,e))}getHooks(e){var n;return(n=wi(Fr,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};wi(Fr,this).has(e)||(tC(GE,this,gB).call(this,e),Fu.push(e));const r=wi(Fr,this).get(e),s=r.find(u=>u.callback===n);if(s){s.skip===!0&&(s.skip=!1);return}const o=Number.isInteger(i.orderIndex)?i.orderIndex:0,a=!!i.runOnce,l=!!i.initialHook;let c=!1;if(l){const u=r.find(h=>h.initialHook);u&&(u.callback=n,c=!0)}if(!c){r.push({callback:n,orderIndex:o,runOnce:a,initialHook:l,skip:!1});let u=wi(YE,this).has(e);!u&&o!==0&&(u=!0,wi(YE,this).add(e)),u&&r.length>1&&wi(Fr,this).set(e,r.toSorted((h,d)=>h.orderIndex-d.orderIndex))}}has(e){return wi(Fr,this).has(e)&&wi(Fr,this).get(e).length>0}remove(e,n){if(!wi(Fr,this).has(e))return!1;const i=wi(Fr,this).get(e),r=i.find(s=>s.callback===n);if(r){let s=wi(Wd,this).get(e);return r.skip=!0,s+=1,s>dde&&(wi(Fr,this).set(e,i.filter(o=>!o.skip)),s=0),wi(Wd,this).set(e,s),!0}return!1}destroy(){wi(Fr,this).clear(),wi(Wd,this).clear(),dB(Fr,this,null),dB(Wd,this,null)}}function gB(t){wi(Fr,this).set(t,[]),wi(Wd,this).set(t,0)}function fde(t,e,n){return(e=gde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gde(t){var e=mde(t,"string");return typeof e=="symbol"?e:e+""}function mde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const pde=ct`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class le{constructor(){fde(this,"globalBucket",new fB)}static getSingleton(){return vde()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new fB),e.pluginHookBucket):this.globalBucket}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?k(n,s=>this.add(e,s,i)):(VE.has(e)&&Ue(BS(pde,{hookName:e,removedInVersion:VE.get(e)})),BE.has(e)&&Ue(BE.get(e)),this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!1})),this}once(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?k(n,s=>this.once(e,s,i)):this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!0}),this}addAsFixed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?k(n,r=>this.addAsFixed(e,r,i)):this.getBucket(i).add(e,n,{initialHook:!0}),this}remove(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(i).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,i,r,s,o,a,l){{const c=this.getBucket().getHooks(n),u=c?c.length:0;let h=0;if(u)for(;h<u;){if(!c[h]||c[h].skip){h+=1;continue}const d=eC(c[h].callback,e,i,r,s,o,a,l);d!==void 0&&(i=d),c[h]&&c[h].runOnce&&this.remove(n,c[h].callback),h+=1}}{const c=this.getBucket(e).getHooks(n),u=c?c.length:0;let h=0;if(u)for(;h<u;){if(!c[h]||c[h].skip){h+=1;continue}const d=eC(c[h].callback,e,i,r,s,o,a,l);d!==void 0&&(i=d),c[h]&&c[h].runOnce&&this.remove(n,c[h].callback,e),h+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||Fu.push(e)}deregister(e){this.isRegistered(e)&&Fu.splice(Fu.indexOf(e),1)}isDeprecated(e){return BE.has(e)||VE.has(e)}isRegistered(e){return Fu.indexOf(e)>=0}getRegistered(){return Fu}}const wde=new le;function vde(){return wde}const Ku=new Map;function ks(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";Ku.has(t)||Ku.set(t,new Map);const e=Ku.get(t);function n(l,c){e.set(l,c)}function i(l){return e.get(l)}function r(l){return e.has(l)}function s(){return[...e.keys()]}function o(){return[...e.values()]}function a(){Ku.delete(t),e.clear()}return{register:n,getItem:i,hasItem:r,getNames:s,getValues:o,clear:a}}function bde(t,e){var n;return Ku==null||(n=Ku.get(t.guid))===null||n===void 0?void 0:n.get(e)}const vP=new WeakMap,{register:yde,getItem:p5,hasItem:w5,getNames:Cde,getValues:qNe}=ks("editors");function Sde(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new n(i)),e[i.guid]},le.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function v5(t,e){let n;if(typeof t=="function")vP.get(t)||wr(null,t),n=vP.get(t);else if(typeof t=="string")n=p5(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function nC(t){if(typeof t=="function")return t;if(!w5(t))throw Error(`No registered editor found under "${t}" name`);return p5(t).getConstructor()}function wr(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new Sde(e);typeof t=="string"&&yde(t,n),vP.set(e,n)}function Rde(t,e,n){return(e=_de(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _de(t){var e=Ede(t,"string");return typeof e=="symbol"?e:e+""}function Ede(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let ry=0;class As{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;Rde(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){i.call(this,xde(o))}return this.context.eventListeners.push({element:e,event:n,callback:i,callbackProxy:s,options:r,eventManager:this}),e.addEventListener(n,s,r),ry+=1,()=>{this.removeEventListener(e,n,i)}}removeEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===n&&o.element===e){if(i&&i!==o.callback||r&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),ry-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const i=this.context.eventListeners[n];e&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),ry-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let i=e.document,r=e;i||(i=e.ownerDocument?e.ownerDocument:e,r=i.defaultView);const s={bubbles:!0,cancelable:n!=="mousemove",view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let o;i.createEvent?(o=i.createEvent("MouseEvents"),o.initMouseEvent(n,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,i.body.parentNode)):o=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${n}`,o)}}function xde(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),es(this)},t}function Tde(){return ry}function Mde(t,e){Pde(t,e),e.add(t)}function Pde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qc(t,e,n){return(e=Ade(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ade(t){var e=Ide(t,"string");return typeof e=="symbol"?e:e+""}function Ide(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qE(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var fv=new WeakSet;class bP{constructor(e,n,i){Mde(this,fv),qc(this,"hot",void 0),qc(this,"tableMeta",void 0),qc(this,"selection",void 0),qc(this,"eventManager",void 0),qc(this,"destroyed",!1),qc(this,"activeEditor",void 0),qc(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=i,this.eventManager=new As(e),this.hot.addHook("afterDocumentKeyDown",r=>qE(fv,this,mB).call(this,r)),this.hot.addHook("beforeCompositionStart",r=>qE(fv,this,mB).call(this,r)),this.hot.view._wt.update("onCellDblClick",(r,s,o)=>qE(fv,this,Ode).call(this,r,s,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,c=>{c&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:i,col:r}=n,s=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");let o=i,a=r;if(Array.isArray(s)&&([o,a]=s),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(i,r,!0);if(l){const c=this.hot.getCellEditor(this.cellProperties),u=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=v5(c,this.hot),this.activeEditor.prepare(i,r,u,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const r=this.hot.getSelectedRangeActive();let s=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,e,n,i);if(n instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&r.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,i){this.activeEditor?this.activeEditor.finishEditing(e,n,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeActive();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:i,col:r}=e.highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.hot,a=s.isHidden(this.hot.toPhysicalRow(i))||o.isHidden(this.hot.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!n||a)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function mB(t){const e=this.hot.getSelectedRangeActive();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Jl(t))return;const{keyCode:n}=t,i=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!RO(n)&&!h5(n)&&!i&&!this.isEditorOpened()&&this.openEditor("",t)}function Ode(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const pB=new WeakMap;bP.getInstance=function(t,e,n){let i=pB.get(t);return i||(i=new bP(t,e,n),pB.set(t,i)),i};var wB={},KE,vB;function Hde(){if(vB)return KE;vB=1;var t=is(),e=Lh(),n=go(),i=n("match");return KE=function(r){var s;return t(r)&&((s=r[i])!==void 0?!!s:e(r)==="RegExp")},KE}var XE,bB;function kde(){if(bB)return XE;bB=1;var t=kn(),e=Dn(),n=t.RegExp,i=!e(function(){var r=!0;try{n(".","d")}catch{r=!1}var s={},o="",a=r?"dgimsy":"gimsy",l=function(d,f){Object.defineProperty(s,d,{get:function(){return o+=f,!0}})},c={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};r&&(c.hasIndices="d");for(var u in c)l(u,c[u]);var h=Object.getOwnPropertyDescriptor(n.prototype,"flags").get.call(s);return h!==a||o!==a});return XE={correct:i},XE}var JE,yB;function Dde(){if(yB)return JE;yB=1;var t=zn();return JE=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},JE}var ZE,CB;function Nde(){if(CB)return ZE;CB=1;var t=jn(),e=rs(),n=uw(),i=kde(),r=Dde(),s=RegExp.prototype;return ZE=i.correct?function(o){return o.flags}:function(o){return!i.correct&&n(s,o)&&!e(o,"flags")?t(r,o):o.flags},ZE}var QE,SB;function Lde(){if(SB)return QE;SB=1;var t=Nn(),e=Xf(),n=Math.floor,i=t("".charAt),r=t("".replace),s=t("".slice),o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,a=/\$([$&'`]|\d{1,2})/g;return QE=function(l,c,u,h,d,f){var g=u+l.length,m=h.length,p=a;return d!==void 0&&(d=e(d),p=o),r(f,p,function(v,b){var R;switch(i(b,0)){case"$":return"$";case"&":return l;case"`":return s(c,0,u);case"'":return s(c,g);case"<":R=d[s(b,1,-1)];break;default:var S=+b;if(S===0)return v;if(S>m){var x=n(S/10);return x===0?v:x<=m?h[x-1]===void 0?i(b,1):h[x-1]+i(b,1):v}R=h[S-1]}return R===void 0?"":R})},QE}var RB;function $de(){if(RB)return wB;RB=1;var t=Ot(),e=jn(),n=Nn(),i=lw(),r=ei(),s=is(),o=Hde(),a=PS(),l=hw(),c=Nde(),u=Lde(),h=go(),d=Dc(),f=h("replace"),g=TypeError,m=n("".indexOf),p=n("".replace),v=n("".slice),b=Math.max;return t({target:"String",proto:!0},{replaceAll:function(S,x){var M=i(this),T,O,W,N,G,j,ne,ee,Q,me,fe=0,ye="";if(s(S)){if(T=o(S),T&&(O=a(i(c(S))),!~m(O,"g")))throw new g("`.replaceAll` does not allow non-global regexes");if(W=l(S,f),W)return e(W,S,M,x);if(d&&T)return p(a(M),S,x)}for(N=a(M),G=a(S),j=r(x),j||(x=a(x)),ne=G.length,ee=b(1,ne),Q=m(N,G);Q!==-1;)me=j?a(x(G,Q,N)):u(G,N,Q,[],void 0,x),ye+=v(N,fe,Q)+me,fe=Q+ne,Q=Q+ee>N.length?-1:m(N,G,Q+ee);return fe<N.length&&(ye+=v(N,fe)),ye}}),wB}$de();const b5={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Fde=new RegExp(Object.keys(b5).map(t=>`(${t})`).join("|"),"gi");function Vde(t){return(t&&t.nodeName||"")==="TABLE"}function yP(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),i=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],r=t.getData(...i),s=r.length,o=s>0?r[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],c=["<tbody>","</tbody>"],u=n?1:0,h=e?1:0;for(let d=0;d<s;d+=1){const f=e&&d===0,g=[];for(let p=0;p<o;p+=1){const v=!f&&n&&p===0;let b="";if(f)b=`<th>${t.getColHeader(p-u)}</th>`;else if(v)b=`<th>${t.getRowHeader(d-h)}</th>`;else{const R=r[d][p],{hidden:S,rowspan:x,colspan:M}=t.getCellMeta(d-h,p-u);if(!S){const T=[];if(x&&T.push(`rowspan="${x}"`),M&&T.push(`colspan="${M}"`),hn(R))b=`<td ${T.join(" ")}></td>`;else{const O=R.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");b=`<td ${T.join(" ")}>${O}</td>`}}}g.push(b)}const m=["<tr>",...g,"</tr>"].join("");f?l.splice(1,0,m):c.splice(-1,0,m)}return a.splice(1,0,l.join(""),c.join("")),a.join("")}function CP(t){const e=t.length,n=["<table>"];for(let i=0;i<e;i+=1){const r=t[i],s=r.length,o=[];i===0&&n.push("<tbody>");for(let a=0;a<s;a+=1){const l=r[a],c=hn(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,u=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(u.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${c}</td>`)}n.push("<tr>",...o,"</tr>"),i+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function SP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},i=e.createDocumentFragment(),r=e.createElement("div");i.appendChild(r);let s=t;if(typeof s=="string"){const R=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,S=>{const x=S.match(/<td\b[^>]*?>/g)[0],M=/<p.*?>/g,T=S.substring(x.length,S.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(M,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${x}${T}</td>`});r.insertAdjacentHTML("afterbegin",`${R}`),s=r.querySelector("table")}if(!s||!Vde(s))return;const o=r.querySelector('meta[name$="enerator"]'),a=s.querySelector("tbody th")!==null,l=s.querySelector("tr"),c=l?Array.from(l.cells).reduce((R,S)=>R+S.colSpan,0)-(a?1:0):0,u=s.tFoot&&Array.from(s.tFoot.rows)||[],h=[];let d=!1,f=0,g=0;if(s.tHead){const R=Array.from(s.tHead.rows).filter(S=>{const x=S.querySelector("td")!==null;return x&&h.push(S),!x});f=R.length,d=f>0,f>1?n.nestedHeaders=Array.from(R).reduce((S,x)=>{const M=Array.from(x.cells).reduce((T,O,W)=>{if(a&&W===0)return T;const{colSpan:N,innerHTML:G}=O,j=N>1?{label:G,colspan:N}:G;return T.push(j),T},[]);return S.push(M),S},[]):d&&(n.colHeaders=Array.from(R[0].children).reduce((S,x,M)=>(a&&M===0||S.push(x.innerHTML),S),[]))}h.length&&(n.fixedRowsTop=h.length),u.length&&(n.fixedRowsBottom=u.length);const m=[...h,...Array.from(s.tBodies).reduce((R,S)=>(R.push(...Array.from(S.rows)),R),[]),...u];g=m.length;const p=new Array(g);for(let R=0;R<g;R++)p[R]=new Array(c);const v=[],b=[];for(let R=0;R<g;R++){const S=m[R],x=Array.from(S.cells),M=x.length;for(let T=0;T<M;T++){const O=x[T],{nodeName:W,innerHTML:N,rowSpan:G,colSpan:j}=O,ne=p[R].findIndex(ee=>ee===void 0);if(W==="TD"){if(G>1||j>1){for(let fe=R;fe<R+G;fe++)if(fe<g)for(let ye=ne;ye<ne+j;ye++)p[fe][ye]=null;const Q=O.getAttribute("style");Q&&Q.includes("mso-ignore:colspan")||v.push({col:ne,row:R,rowspan:G,colspan:j})}let ee="";o&&/excel/gi.test(o.content)?ee=N.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):ee=N.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),p[R][ne]=ee.replace(Fde,Q=>b5[Q])}else b.push(N)}}return v.length&&(n.mergeCells=v),b.length&&(n.rowHeaders=b),p.length&&(n.data=p),n}const Bde=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:CP,htmlToGridSettings:SP,instanceToHTML:yP},Symbol.toStringTag,{value:"Module"}));function Oi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const i=Array.from(new Set([".",...e])).map(r=>`\\${r}`).join("|");return new RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function y5(t){return Oi(t,[","])}function pe(t,e,n){let i=-1;for(typeof e=="function"?(n=e,e=t):i=t-1;++i<=e&&n(i)!==!1;);}function RP(t,e,n){let i=t+1;for(typeof e=="function"&&(n=e,e=0);--i>=e&&n(i)!==!1;);}function EO(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ke(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}function C5(t){const e=t.replace(",",".");return isNaN(parseFloat(e))===!1?parseFloat(e):null}function gh(t){return Number.isInteger(t)&&t>=0}const Wde=Object.freeze(Object.defineProperty({__proto__:null,clamp:Ke,getParsedNumber:C5,isNumeric:Oi,isNumericLike:y5,isUnsignedNumber:gh,rangeEach:pe,rangeEachReverse:RP,valueAccordingPercent:EO},Symbol.toStringTag,{value:"Module"})),_P="asc",jde="desc",_B=new Map([[_P,[-1,1]],[jde,[1,-1]]]),zde=t=>`The priority '${t}' is already declared in a map.`,Ude=t=>`The priority '${t}' is not a number.`;function Yde(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=ht(t)?t:zde,e=ht(e)?e:Ude;function i(s,o){if(!Oi(s))throw new Error(e(s));if(n.has(s))throw new Error(t(s));n.set(s,o)}function r(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_P;const[o,a]=_B.get(s)||_B.get(_P);return[...n].sort((l,c)=>l[0]<c[0]?o:a).map(l=>l[1])}return{addItem:i,getItems:r}}const Gde=t=>`The id '${t}' is already declared in a map.`;function xw(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=ht(t)?t:Gde;function n(u,h){if(c(u))throw new Error(t(u));e.set(u,h)}function i(u){return e.delete(u)}function r(){e.clear()}function s(u){const[h]=a().find(d=>{let[f,g]=d;return u===g?f:!1})||[null];return h}function o(u){return e.get(u)}function a(){return[...e]}function l(){return[...e.values()]}function c(u){return e.has(u)}return{addItem:n,clear:r,getId:s,getItem:o,getItems:a,getValues:l,hasItem:c,removeItem:i}}const qde=t=>`'${t}' value is already declared in a unique set.`;function Kde(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=ht(t)?t:qde;function n(s){if(e.has(s))throw new Error(t(s));e.add(s)}function i(){return[...e]}function r(){e.clear()}return{addItem:n,clear:r,getItems:i}}const xO=t=>`There is already registered "${t}" plugin.`,Xde=t=>`There is already registered plugin on priority "${t}".`,Jde=t=>`The priority "${t}" is not a number.`,S5=Yde({errorPriorityExists:Xde,errorPriorityNaN:Jde}),R5=Kde({errorItemExists:xO}),EP=xw({errorIdExists:xO});function TO(){return[...S5.getItems(),...R5.getItems()]}function Tw(t){const e=Fi(t);return EP.getItem(e)}function Zde(t){return!!Tw(t)}function Qe(t,e,n){[t,e,n]=efe(t,e,n),Tw(t)===void 0&&Qde(t,e,n)}function Qde(t,e,n){const i=Fi(t);if(EP.hasItem(i))throw new Error(xO(i));n===void 0?R5.addItem(i):S5.addItem(n,i),EP.addItem(i,e)}function efe(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:tfe,getItem:nfe,hasItem:_5,getNames:ife,getValues:KNe}=ks("renderers");function iC(t){if(typeof t=="function")return t;if(!_5(t))throw Error(`No registered renderer found under "${t}" name`);return nfe(t)}function Wr(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),tfe(t,e)}const{register:rfe,getItem:sfe,hasItem:E5,getNames:ofe,getValues:XNe}=ks("validators");function MO(t){if(typeof t=="function")return t;if(!E5(t))throw Error(`No registered validator found under "${t}" name`);return sfe(t)}function Vu(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),rfe(t,e)}var EB={},xB;function afe(){if(xB)return EB;xB=1;var t=Ot(),e=Xf(),n=Zf(),i=dw(),r=JS();return t({target:"Array",proto:!0},{at:function(o){var a=e(this),l=n(a),c=i(o),u=c>=0?c:l+c;return u<0||u>=l?void 0:a[u]}}),r("at"),EB}afe();var TB={},MB;function lfe(){if(MB)return TB;MB=1;var t=Ot(),e=Nn(),n=lw(),i=dw(),r=PS(),s=Dn(),o=e("".charAt),a=s(function(){return"".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:a},{at:function(c){var u=r(n(this)),h=u.length,d=i(c),f=d>=0?d:h+d;return f<0||f>=h?void 0:o(u,f)}}),TB}lfe();function Pg(t,e,n){return(e=cfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cfe(t){var e=ufe(t,"string");return typeof e=="symbol"?e:e+""}function ufe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class hfe{constructor(){Pg(this,"count",0),Pg(this,"startColumn",null),Pg(this,"endColumn",null),Pg(this,"startPosition",null),Pg(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:s,columnWidth:o}=n,a=r>0?s+1:s;i>=r&&i+o<=r+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:c,columnWidth:u}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const g=c[this.endColumn]+u-c[this.startColumn-1];if(g<=r&&(this.startColumn-=1),g>=r)break}this.startPosition=(n=c[this.startColumn])!==null&&n!==void 0?n:null;const h=o>0?r+1:r,d=i+r-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*s||i>c.at(-1)||-1*i-r>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Ag(t,e,n){return(e=dfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dfe(t){var e=ffe(t,"string");return typeof e=="symbol"?e:e+""}function ffe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gfe{constructor(){Ag(this,"count",0),Ag(this,"startRow",null),Ag(this,"endRow",null),Ag(this,"startPosition",null),Ag(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:s,rowHeight:o}=n;i>=r&&i+o<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:c}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+c-l[this.startRow-1];if(d<=r-s&&(this.startRow-=1),d>=r-s)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null;const u=i+r-s,h=this.startRow===null?0:e.getRowHeight(this.startRow);u<h||i>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Ig(t,e,n){return(e=mfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mfe(t){var e=pfe(t,"string");return typeof e=="symbol"?e:e+""}function pfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x5{constructor(){Ig(this,"count",0),Ig(this,"startColumn",null),Ig(this,"endColumn",null),Ig(this,"startPosition",null),Ig(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:s}=n;i<=r&&(this.startColumn=e);const o=r>0?s+1:s;i>=r&&i<=r+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:c,columnWidth:u}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=c[this.endColumn]+u-c[this.startColumn-1];if(this.startColumn-=1,f>r)break}this.startPosition=(n=c[this.startColumn])!==null&&n!==void 0?n:null;const h=o>0?r+1:r;i+r-h<-1*s||i>c.at(-1)+u||-1*i-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Og(t,e,n){return(e=wfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wfe(t){var e=vfe(t,"string");return typeof e=="symbol"?e:e+""}function vfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T5{constructor(){Og(this,"count",0),Og(this,"startRow",null),Og(this,"endRow",null),Og(this,"startPosition",null),Og(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:s}=n;i<=r&&(this.startRow=e),i>=r&&i<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:c}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+c-l[this.startRow-1];if(this.startRow-=1,h>=r-s)break}this.startPosition=(n=l[this.startRow])!==null&&n!==void 0?n:null,i+r-s<0||i>l.at(-1)+c?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Hg(t,e,n){return(e=bfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bfe(t){var e=yfe(t,"string");return typeof e=="symbol"?e:e+""}function yfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cfe{constructor(){Hg(this,"count",0),Hg(this,"startColumn",0),Hg(this,"endColumn",0),Hg(this,"startPosition",0),Hg(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function kg(t,e,n){return(e=Sfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sfe(t){var e=Rfe(t,"string");return typeof e=="symbol"?e:e+""}function Rfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _fe{constructor(){kg(this,"count",0),kg(this,"startRow",0),kg(this,"endRow",0),kg(this,"startPosition",0),kg(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function PB(t,e,n){return(e=Efe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Efe(t){var e=xfe(t,"string");return typeof e=="symbol"?e:e+""}function xfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Tfe extends x5{constructor(){super(...arguments),PB(this,"columnStartOffset",0),PB(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalColumns:r,startPositions:s}=e;if(this.startColumn!==null&&typeof i=="function"){const o=this.startColumn,a=this.endColumn;i(this),this.columnStartOffset=o-this.startColumn,this.columnEndOffset=this.endColumn-a}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=s[this.startColumn])!==null&&n!==void 0?n:null,r<this.endColumn&&(this.endColumn=r-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function AB(t,e,n){return(e=Mfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mfe(t){var e=Pfe(t,"string");return typeof e=="symbol"?e:e+""}function Pfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Afe extends T5{constructor(){super(...arguments),AB(this,"rowStartOffset",0),AB(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalRows:r,startPositions:s}=e;if(this.startRow!==null&&typeof i=="function"){const o=this.startRow,a=this.endRow;i(this),this.rowStartOffset=o-this.startRow,this.rowEndOffset=this.endRow-a}this.startRow<0&&(this.startRow=0),this.startPosition=(n=s[this.startRow])!==null&&n!==void 0?n:null,r<this.endRow&&(this.endRow=r-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function IB(t,e,n){return(e=Ife(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ife(t){var e=Ofe(t,"string");return typeof e=="symbol"?e:e+""}function Ofe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class M5{constructor(e){IB(this,"calculationTypes",[]),IB(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[i,r]=n;this.calculationResults.set(i,r),r.initialize(e)})}_process(e,n){this.calculationTypes.forEach(i=>{let[,r]=i;return r.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,i]=n;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Ns(t,e,n){return(e=Hfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hfe(t){var e=kfe(t,"string");return typeof e=="symbol"?e:e+""}function kfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const If=50;class Dfe extends M5{constructor(e){let{calculationTypes:n,viewportWidth:i,scrollOffset:r,totalColumns:s,columnWidthFn:o,overrideFn:a,inlineStartOffset:l}=e;super(n),Ns(this,"viewportWidth",0),Ns(this,"scrollOffset",0),Ns(this,"zeroBasedScrollOffset",0),Ns(this,"totalColumns",0),Ns(this,"columnWidthFn",null),Ns(this,"columnWidth",0),Ns(this,"overrideFn",null),Ns(this,"inlineStartOffset",0),Ns(this,"totalCalculatedWidth",0),Ns(this,"startPositions",[]),Ns(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=s,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?If:n}}function cs(t,e,n){return(e=Nfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nfe(t){var e=Lfe(t,"string");return typeof e=="symbol"?e:e+""}function Lfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $fe extends M5{constructor(e){let{calculationTypes:n,viewportHeight:i,scrollOffset:r,totalRows:s,defaultRowHeight:o,rowHeightFn:a,overrideFn:l,horizontalScrollbarHeight:c}=e;super(n),cs(this,"viewportHeight",0),cs(this,"scrollOffset",0),cs(this,"zeroBasedScrollOffset",0),cs(this,"totalRows",0),cs(this,"rowHeightFn",null),cs(this,"rowHeight",0),cs(this,"overrideFn",null),cs(this,"horizontalScrollbarHeight",0),cs(this,"innerViewportHeight",0),cs(this,"totalCalculatedHeight",0),cs(this,"startPositions",[]),cs(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=s,this.rowHeightFn=a,this.overrideFn=l,this.horizontalScrollbarHeight=c??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function Ffe(t,e,n){Vfe(t,e),e.set(t,n)}function Vfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function OB(t,e,n){return(e=Bfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bfe(t){var e=Wfe(t,"string");return typeof e=="symbol"?e:e+""}function Wfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zh(t,e){return t.get(P5(t,e))}function HB(t,e,n){return t.set(P5(t,e),n),n}function P5(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ca=new WeakMap;class xh{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;OB(this,"row",null),OB(this,"col",null),Ffe(this,Ca,!1),HB(Ca,this,i),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:i,countRowHeaders:r,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-r||this.row>=n||this.col>=i)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Zh(Ca,this)}isSouthEastOf(e){return this.row>=e.row&&(Zh(Ca,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Zh(Ca,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Zh(Ca,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Zh(Ca,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof xh&&HB(Ca,this,e.isRtl()),this}clone(){return new xh(this.row,this.col,Zh(Ca,this))}toObject(){return{row:this.row,col:this.col}}}function jfe(t,e,n){zfe(t,e),e.set(t,n)}function zfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ex(t,e,n){return(e=Ufe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ufe(t){var e=Yfe(t,"string");return typeof e=="symbol"?e:e+""}function Yfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function us(t,e){return t.get(A5(t,e))}function Gfe(t,e,n){return t.set(A5(t,e),n),n}function A5(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var lr=new WeakMap;class rg{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;ex(this,"highlight",null),ex(this,"from",null),ex(this,"to",null),jfe(this,lr,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=i.clone(),Gfe(lr,this,r)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:i}=e,r=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return r.row<=n&&s.row>=n&&r.col<=i&&s.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>i.row||e.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(i.row,o.row),c=Math.min(i.col,o.col),u=Math.max(r.row,a.row),h=Math.max(r.col,a.col),d=this._createCellCoords(l,c),f=this._createCellCoords(u,h);return this.from=d,this.to=f,this.setDirection(s),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return us(lr,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return us(lr,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return us(lr,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return us(lr,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return us(lr,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return us(lr,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return us(lr,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return us(lr,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof xh))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];return n.top===i.top&&r.push("top"),n.right===i.right&&r.push(us(lr,this)?"left":"right"),n.bottom===i.bottom&&r.push("bottom"),n.left===i.left&&r.push(us(lr,this)?"right":"left"),r}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let s=e.col;s<=n.col;s++)!(this.from.row===r&&this.from.col===s)&&!(this.to.row===r&&this.to.col===s)&&i.push(this._createCellCoords(r,s));return i}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let s=e.col;s<=n.col;s++)e.row===r&&e.col===s?i.push(e):n.row===r&&n.col===s?i.push(n):i.push(this._createCellCoords(r,s));return i}forAll(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let r=n.row;r<=i.row;r++)for(let s=n.col;s<=i.col;s++)if(e(r,s)===!1)return}clone(){return new rg(this.highlight,this.from,this.to,us(lr,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new xh(e,n,us(lr,this))}}function bo(t,e,n){qfe(t,e),e.set(t,n)}function qfe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ve(t,e){return t.get(I5(t,e))}function Cl(t,e,n){return t.set(I5(t,e),n),n}function I5(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hs=new WeakMap,tx=new WeakMap,ni=new WeakMap,Qh=new WeakMap,gv=new WeakMap,Ls=new WeakMap,nx=new WeakMap,Dg=new WeakMap,Kc=new WeakMap,yo=new WeakMap;let O5=class{constructor(e,n,i,r,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;bo(this,hs,void 0),bo(this,tx,void 0),bo(this,ni,void 0),bo(this,Qh,void 0),bo(this,gv,void 0),bo(this,Ls,void 0),bo(this,nx,void 0),bo(this,Dg,void 0),bo(this,Kc,[null,null]),bo(this,yo,[null,null]),Cl(hs,this,i),Cl(tx,this,n),Cl(ni,this,s),Cl(Qh,this,o),Cl(gv,this,a),Cl(Ls,this,r),Cl(nx,this,e),this.registerEvents()}registerEvents(){ve(Ls,this).addEventListener(ve(ni,this).holder,"contextmenu",i=>this.onContextMenu(i)),ve(Ls,this).addEventListener(ve(ni,this).TABLE,"mouseover",i=>this.onMouseOver(i)),ve(Ls,this).addEventListener(ve(ni,this).TABLE,"mouseout",i=>this.onMouseOut(i));const e=()=>{ve(Ls,this).addEventListener(ve(ni,this).holder,"touchstart",i=>this.onTouchStart(i)),ve(Ls,this).addEventListener(ve(ni,this).holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),ve(Ls,this).addEventListener(ve(ni,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||ve(hs,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,ve(hs,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{ve(Ls,this).addEventListener(ve(ni,this).holder,"mouseup",i=>this.onMouseUp(i)),ve(Ls,this).addEventListener(ve(ni,this).holder,"mousedown",i=>this.onMouseDown(i))};ro()?e():(cO()&&e(),n())}selectedCellWasTouched(e){const i=this.parentCell(e).coords;if(ve(Dg,this)&&i){const[r,s]=[i.row,ve(Dg,this).from.row],[o,a]=[i.col,ve(Dg,this).from.col];return r===s&&o===a}return!1}parentCell(e){const n={},i=ve(ni,this).TABLE,r=Am(e,["TD","TH"],i);return r?(n.coords=ve(ni,this).getCoords(r),n.TD=r):Ee(e,"wtBorder")&&Ee(e,"current")?(n.coords=ve(Qh,this).getFocusSelection().cellRange.highlight,n.TD=ve(ni,this).getCell(n.coords)):Ee(e,"wtBorder")&&Ee(e,"area")&&ve(Qh,this).getAreaSelection().cellRange&&(n.coords=ve(Qh,this).getAreaSelection().cellRange.to,n.TD=ve(ni,this).getCell(n.coords)),n}onMouseDown(e){const n=ve(tx,this).rootDocument.activeElement,i=SO(qK,e.target),r=e.target;if(!["TD","TH"].includes(n.nodeName)&&(r===n||i(0)===n||i(1)===n))return;const s=this.parentCell(r);Ee(r,"corner")?ve(hs,this).getSetting("onCellCornerMouseDown",e,r):s.TD&&ve(hs,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(ve(yo,this)[0]=s.TD,clearTimeout(ve(Kc,this)[0]),ve(Kc,this)[0]=setTimeout(()=>{ve(yo,this)[0]=null},1e3))}onContextMenu(e){if(ve(hs,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!ve(hs,this).has("onCellMouseOver"))return;const n=ve(ni,this).TABLE,i=Am(e.target,["TD","TH"],n),r=ve(gv,this)||this;i&&i!==r.lastMouseOver&&wc(i,n)&&(r.lastMouseOver=i,this.callListener("onCellMouseOver",e,ve(ni,this).getCoords(i),i))}onMouseOut(e){if(!ve(hs,this).has("onCellMouseOut"))return;const n=ve(ni,this).TABLE,i=Am(e.target,["TD","TH"],n),r=Am(e.relatedTarget,["TD","TH"],n),s=ve(gv,this)||this;i&&i!==r&&wc(i,n)&&(this.callListener("onCellMouseOut",e,ve(ni,this).getCoords(i),i),r===null&&(s.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&ve(hs,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===ve(yo,this)[0]&&n.TD===ve(yo,this)[1]?(Ee(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),ve(yo,this)[0]=null,ve(yo,this)[1]=null):n.TD===ve(yo,this)[0]&&(ve(yo,this)[1]=n.TD,clearTimeout(ve(Kc,this)[1]),ve(Kc,this)[1]=setTimeout(()=>{ve(yo,this)[1]=null},500)))}onTouchStart(e){Cl(Dg,this,ve(Qh,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const i=e.target,r=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,s=se(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&s&&ve(hs,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];hO()&&(UK()||YK())&&this.selectedCellWasTouched(i)&&!a.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,i,r){const s=ve(hs,this).getSettingPure(e);s&&s(n,i,r,ve(nx,this).call(this))}destroy(){clearTimeout(ve(Kc,this)[0]),clearTimeout(ve(Kc,this)[1]),ve(Ls,this).destroy()}};function ix(t,e,n){return(e=Kfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kfe(t){var e=Xfe(t,"string");return typeof e=="symbol"?e:e+""}function Xfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jfe{constructor(e,n,i){ix(this,"offset",void 0),ix(this,"total",void 0),ix(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function rx(t,e,n){return(e=Zfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zfe(t){var e=Qfe(t,"string");return typeof e=="symbol"?e:e+""}function Qfe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ege{constructor(e,n,i){rx(this,"offset",void 0),rx(this,"total",void 0),rx(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function mv(t,e,n){return(e=tge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tge(t){var e=nge(t,"string");return typeof e=="symbol"?e:e+""}function nge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ige{constructor(){mv(this,"currentSize",0),mv(this,"nextSize",0),mv(this,"currentOffset",0),mv(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const rge=0,kB=1,xP=2;function sx(t,e,n){return(e=sge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sge(t){var e=oge(t,"string");return typeof e=="symbol"?e:e+""}function oge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class age{constructor(){sx(this,"size",new ige),sx(this,"workingSpace",rge),sx(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=kB,e.workingSpace=xP,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=xP,e.workingSpace=kB,this.sharedSize=e.getViewSize()}}var DB={},ox,NB;function lge(){if(NB)return ox;NB=1;var t=MS(),e=TypeError;return ox=function(n,i){if(!delete n[i])throw new e("Cannot delete property "+t(i)+" of "+t(n))},ox}var LB;function cge(){if(LB)return DB;LB=1;var t=Ot(),e=Xf(),n=Zf(),i=vq(),r=lge(),s=bq(),o=[].unshift(0)!==1,a=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(c){return c instanceof TypeError}},l=o||!a();return t({target:"Array",proto:!0,arity:1,forced:l},{unshift:function(u){var h=e(this),d=n(h),f=arguments.length;if(f){s(d+f);for(var g=d;g--;){var m=g+f;g in h?h[m]=h[g]:r(h,m)}for(var p=0;p<f;p++)h[p]=arguments[p]}return i(h,d+f)}}),DB}cge();function uge(t,e,n){return(e=hge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hge(t){var e=dge(t,"string");return typeof e=="symbol"?e:e+""}function dge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $B{constructor(e,n){uge(this,"order",[]),this.order=[...Array(n).keys()].map(i=>e+i)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function fge(t,e,n){return(e=gge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gge(t){var e=mge(t,"string");return typeof e=="symbol"?e:e+""}function mge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pge{constructor(e){fge(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:i}=e.getViewSize();let r=Math.max(i,n);if(r===0)return[];const{currentOffset:s,nextOffset:o}=e.getViewSize(),a=new $B(s,n),l=new $B(o,i),c=[];for(let u=0;u<r;u++){const h=a.get(u),d=l.get(u);if(d===-1)c.push(["remove",h]);else if(h===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(xP)?c.push(["append",d]):c.push(["prepend",d]);else if(d>h)a.has(d)&&(a.remove(d),i<=a.length&&(r-=1)),c.push(["replace",d,h]);else if(d<h){const f=a.prepend(d);c.push(["insert_before",d,h,f])}else c.push(["none",d])}return c}}function ed(t,e,n){return(e=wge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wge(t){var e=vge(t,"string");return typeof e=="symbol"?e:e+""}function vge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class H5{constructor(e,n){ed(this,"rootNode",void 0),ed(this,"nodesPool",void 0),ed(this,"sizeSet",new age),ed(this,"collectedNodes",[]),ed(this,"viewDiffer",new pge(this.sizeSet)),ed(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[i,r,s,o]=e,a=this.nodesPool(r);switch(this.collectedNodes.push(a),i){case"prepend":n.insertBefore(a,n.firstChild);break;case"append":n.appendChild(a);break;case"insert_before":n.insertBefore(a,this.nodesPool(s)),n.removeChild(this.nodesPool(o));break;case"replace":n.replaceChild(a,this.nodesPool(s));break;case"remove":n.removeChild(a);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class k5 extends H5{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function FB(t,e,n){return(e=bge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bge(t){var e=yge(t,"string");return typeof e=="symbol"?e:e+""}function yge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cge{constructor(e){FB(this,"nodeType",void 0),FB(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const r=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(r))return this.pool.get(r);const s=this.rootDocument.createElement(this.nodeType);return this.pool.set(r,s),s}}function Ng(t,e,n){return(e=Sge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sge(t){var e=Rge(t,"string");return typeof e=="symbol"?e:e+""}function Rge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mw{constructor(e,n){Ng(this,"nodesPool",null),Ng(this,"nodeType",void 0),Ng(this,"rootNode",void 0),Ng(this,"table",null),Ng(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new Cge(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function VB(t,e,n){return(e=_ge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ge(t){var e=Ege(t,"string");return typeof e=="symbol"?e:e+""}function Ege(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xge extends Mw{constructor(){super("TH"),VB(this,"orderViews",new WeakMap),VB(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new k5(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:i,rows:r,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=r.getRenderedNode(o);this.sourceRowIndex=a;const c=this.obtainOrderView(l),u=s.obtainOrderView(l);c.appendView(u).setSize(i).setOffset(0).start();for(let h=i-1;h>=0;h--){c.render();const d=c.getCurrentNode();d.className="",d.removeAttribute("style"),ra(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&he(d,[che(),yhe(),aO(h+1),co(-1)]),n[h](a,d,h)}c.end()}}}class Tge extends Mw{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let i=this.rootNode.firstChild;if(e){const{columnsToRender:r}=this.table,s=r+n;for(let a=0,l=e;a<l;a++){for(i=this.rootNode.childNodes[a],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<s;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)i.removeChild(i.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&ca(i)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&he(this.rootNode,[HK()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:i,columnsToRender:r,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&he(o,[kK(),$K(n+1)]);for(let a=-1*s;a<r;a+=1){const l=this.table.renderedColumnToSource(a),c=o.childNodes[a+s];c.className="",c.removeAttribute("style"),ra(c,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&he(c,[aO(a+1+this.table.rowHeadersCount),co(-1),uhe(),...a>=0?[bhe()]:[lhe(),Jr("Select whole grid")]]),i[n](l,c,n)}}}}let BB=!1;class Mge extends Mw{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,i=e+n;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!BB&&e>1e3&&(BB=!0,Ue(ct`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let r=0;r<n;r++){const s=this.table.renderedColumnToSource(r),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[r].style.width=`${o}px`}for(let r=0;r<e;r++){const s=this.table.renderedColumnToSource(r),o=this.table.columnUtils.getWidth(s);this.rootNode.childNodes[r+n].style.width=`${o}px`}const i=this.rootNode.firstChild;i&&q(i,"rowHeader")}}function Pge(t,e,n){return(e=Age(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Age(t){var e=Ige(t,"string");return typeof e=="symbol"?e:e+""}function Ige(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const td={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let WB=!1;class Oge extends Mw{constructor(e){super("TR",e),Pge(this,"orderView",void 0),this.orderView=new H5(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!WB&&e>1e3&&(WB=!0,Ue(ct`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&he(this.rootNode,[HK()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++){this.orderView.render();const s=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(r);if(this.table.isAriaEnabled()){var n,i;he(s,[kK(),$K(o+((n=(i=this.table.rowUtils)===null||i===void 0||(i=i.dataAccessObject)===null||i===void 0?void 0:i.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(o+1)%2===0?Ee(s,td.rowEven)||(ue(s,td.rowOdd),q(s,td.rowEven)):Ee(s,td.rowOdd)||(ue(s,td.rowEven),q(s,td.rowOdd))}this.orderView.end()}}function jB(t,e,n){return(e=Hge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hge(t){var e=kge(t,"string");return typeof e=="symbol"?e:e+""}function kge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dge extends Mw{constructor(){super("TD"),jB(this,"orderViews",new WeakMap),jB(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new k5(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:i,rowHeaders:r}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),c=i.getRenderedNode(a);this.sourceRowIndex=l;const u=this.obtainOrderView(c),h=r.obtainOrderView(c);u.prependView(h).setSize(n).setOffset(0).start();for(let d=0;d<n;d++){u.render();const f=this.table.renderedColumnToSource(d),g=u.getCurrentNode();if(Ee(g,"hide")||(g.className=""),g.removeAttribute("style"),g.removeAttribute("dir"),ra(g,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,f,g),this.table.isAriaEnabled()){var s,o;he(g,[...g.hasAttribute("role")?[]:[ahe()],co(-1),aO(f+((s=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}u.end()}}}function Fn(t,e,n){return(e=Nge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nge(t){var e=Lge(t,"string");return typeof e=="symbol"?e:e+""}function Lge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $ge{constructor(e){let{cellRenderer:n,stylesHandler:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Fn(this,"rootNode",void 0),Fn(this,"rootDocument",void 0),Fn(this,"rowHeaders",null),Fn(this,"columnHeaders",null),Fn(this,"colGroup",null),Fn(this,"rows",null),Fn(this,"cells",null),Fn(this,"rowFilter",null),Fn(this,"columnFilter",null),Fn(this,"rowUtils",null),Fn(this,"columnUtils",null),Fn(this,"rowsToRender",0),Fn(this,"columnsToRender",0),Fn(this,"rowHeaderFunctions",[]),Fn(this,"rowHeadersCount",0),Fn(this,"columnHeaderFunctions",[]),Fn(this,"columnHeadersCount",0),Fn(this,"cellRenderer",void 0),Fn(this,"activeOverlayName",void 0),Fn(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=i}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:i,rows:r,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),i.setTable(this),r.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=i,this.rows=r,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let i=0;i<e;i++){const r=n.getRenderedNode(i),s=this.rowUtils;if(r.firstChild){const o=this.renderedRowToSource(i),a=s.getHeightByOverlayName(o,this.activeOverlayName),c=this.stylesHandler.areCellsBorderBox()?0:1;a?r.firstChild.style.height=`${a-c}px`:r.firstChild.style.height=""}}}}class Fge{constructor(){let{TABLE:e,THEAD:n,COLGROUP:i,TBODY:r,rowUtils:s,columnUtils:o,cellRenderer:a,stylesHandler:l}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new $ge(e,{cellRenderer:a,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new xge,columnHeaders:new Tge(n),colGroup:new Mge(i),rows:new Oge(r),cells:new Dge}),this.renderer.setAxisUtils(s,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function ax(t,e,n){return(e=Vge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vge(t){var e=Bge(t,"string");return typeof e=="symbol"?e:e+""}function Bge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wge{constructor(e,n){ax(this,"dataAccessObject",void 0),ax(this,"wtSettings",void 0),ax(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(n=n?Math.max(n,i):i),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const i=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth");for(let s=0;s<i;s++){let o=Array.isArray(n)?n[s]:n;o=o??r,this.headerWidths.set(s,o)}}}}function zB(t,e,n){return(e=jge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jge(t){var e=zge(t,"string");return typeof e=="symbol"?e:e+""}function zge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Uge{constructor(e,n){zB(this,"dataAccessObject",void 0),zB(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}getHeightByOverlayName(e,n){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(i=i===void 0?r:Math.max(i,r)),i}}function Co(t,e,n){return(e=Yge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yge(t){var e=Gge(t,"string");return typeof e=="symbol"?e:e+""}function Gge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class sg{constructor(e,n,i,r,s){Co(this,"wtSettings",null),Co(this,"domBindings",void 0),Co(this,"TBODY",null),Co(this,"THEAD",null),Co(this,"COLGROUP",null),Co(this,"hasTableHeight",!0),Co(this,"hasTableWidth",!0),Co(this,"isTableVisible",!1),Co(this,"tableOffset",0),Co(this,"holderOffset",0),this.domBindings=i,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,dO(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new Uge(this.dataAccessObject,this.wtSettings),this.columnUtils=new Wge(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Fge({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ee(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",this.wtSettings.getSetting("ariaTags")&&he(i,[Ja()]),i}createHider(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ee(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,e),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&he(i,[Ja()]),i}createHolder(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Ee(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",this.isMaster&&he(i,[co(-1)]),n&&n.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&he(i.parentNode,[Ja()])),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&he(i,[Ja()]),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:i,wtViewport:r}=this.dataAccessObject,s=n.getSetting("totalRows"),o=n.getSetting("totalColumns"),a=n.getSetting("rowHeaders"),l=a.length,c=n.getSetting("columnHeaders"),u=c.length;let h=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=yi(this.holder),h=r.createCalculators(h),l&&!n.getSetting("fixedColumnsStart"))){const f=i.inlineStartOverlay.getScrollPosition(),g=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,g!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=yi(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=Math.max(this.getFirstRenderedRow(),0),g=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new ege(f,s,u),this.columnFilter=new Jfe(g,o,l);let m=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const p={};this.wtSettings.getSetting("beforeDraw",!0,p),m=p.skipRender!==!0}m&&(this.tableRenderer.setHeaderContentRenderers(a,c),(this.is(Zo)||this.is(vc))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Zo))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||r.createVisibleCalculators(),i.refresh(!1),i.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Zo)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(d=i.bottomOverlay.resetFixedPosition()||d),d=i.inlineStartOverlay.resetFixedPosition()||d,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let i=this.wtSettings.getSetting("columnHeaders").length;const r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let s,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,s=this.getColumnHeaderHeight(i),o=this.getColumnHeader(n,i),o&&(a=gf(o),(!s&&r<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=a),Array.isArray(l)?l[i]!==null&&l[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(l[i]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=l[i]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=e.getSetting("columnHeaders");for(let s=0,o=r.length;s<o;s++)if(i[s]){if(!n[s]||n[s].childNodes.length===0)return;n[s].childNodes[0].style.height=`${i[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Zo))&&!e.getSetting("externalRowCalculator")){const i=this.getRenderedRowsCount();for(let r=0;r<i;r++){const s=this.rowFilter.renderedToSource(r);n.oversizedRows&&n.oversizedRows[s]&&(n.oversizedRows[s]=void 0)}}}getCell(e){let n=e.row,i=e.col;const r=this.wtSettings.getSetting("onModifyGetCellCoords",n,i,!this.isMaster,"render");if(r&&Array.isArray(r)&&([n,i]=r),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;const s=this.getRow(n);if(!s&&n>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!o&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let n=null,i=null;if(e<0){var r;n=(r=this.rowFilter)===null||r===void 0?void 0:r.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var s;n=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.THEAD.childNodes[n];return i?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(r=>{const s=r.childNodes[i];s&&n.push(s)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.wtSettings.getSetting("rowHeaders").length;if(n>=i)return;const r=this.rowFilter.sourceToRendered(e),s=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):r,a=(r<0?this.THEAD:this.TBODY).childNodes[s];return a?.childNodes[n]}getRowHeaders(e){const n=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<i;r++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s?.childNodes[r];o&&n.push(o)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=xc(n,["TD","TH"])),n===null)return null;const i=n.parentNode;if(!i)return null;const r=i.parentNode;let s=JK(i),o=n.cellIndex;jl(Ph,n,this.wtRootElement)||jl(Th,n,this.wtRootElement)?r.nodeName==="THEAD"&&(s-=r.childNodes.length):jl(vc,n,this.wtRootElement)||jl(Zo,n,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-r.childNodes.length+s:r===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):this.rowFilter&&(s=this.rowFilter.renderedToSource(s)),jl(Ph,n,this.wtRootElement)||jl(Mh,n,this.wtRootElement)||jl(vc,n,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):this.columnFilter&&(o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o));const a=this.wtSettings.getSetting("onModifyGetCoordsElement",s,o);return a&&Array.isArray(a)&&([s,o]=a),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=this.wtSettings.getSetting("stylesHandler"),i=e*n.getDefaultRowHeight(),r=gf(this.TBODY)-1,s=n.areCellsBorderBox(),o=s?An:gf,a=s?0:1,l=s?1:0;let c,u,h,d,f;if(!(i===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,h=this.rowFilter.renderedToSource(e),c=this.getRowHeight(h),d=this.getTrForRow(h),f=d.querySelector("th");const g=h===0?l:0;f?u=o(f):u=o(d)-a,(!c&&n.getDefaultRowHeight()<u-g||c<u)&&(s||(u+=1),this.dataAccessObject.wtViewport.oversizedRows[h]=u)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return yn(this.TABLE)}getHeight(){return An(this.TABLE)}getTotalWidth(){const e=yn(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=An(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Mc(this.TABLE)}_modifyRowHeaderWidth(e){let n=ht(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const qge="stickyRowsBottom",PO={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};ga(PO,"MIXIN_NAME",qge,{writable:!1,enumerable:!1});const Kge="stickyColumnsStart",ZS={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ga(ZS,"MIXIN_NAME",Kge,{writable:!1,enumerable:!1});class AO extends sg{constructor(e,n,i,r){super(e,n,i,r,vc)}}pt(AO,PO);pt(AO,ZS);const Th="top",Zo="bottom",Mh="inline_start",Ph="top_inline_start_corner",vc="bottom_inline_start_corner",D5=[Th,Zo,Mh,Ph,vc],Xge=new Map([[Th,`ht_clone_${Th}`],[Zo,`ht_clone_${Zo}`],[Mh,`ht_clone_${Mh} ht_clone_left`],[Ph,`ht_clone_${Ph} ht_clone_top_left_corner`],[vc,`ht_clone_${vc} ht_clone_bottom_left_corner`]]);function Jge(t,e){Zge(t,e),e.add(t)}function Zge(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qge(t,e,n){return(e=eme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eme(t){var e=tme(t,"string");return typeof e=="symbol"?e:e+""}function tme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Lg=new WeakSet;class nme{constructor(e){Jge(this,Lg),Qge(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,i){if(e.col<0||e.row<0)return!1;const r=this.scrollViewportHorizontally(e.col,n),s=this.scrollViewportVertically(e.row,i);return r||s}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalColumns:r}=this.dataAccessObject;if(!i)return!1;const s=xr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,s),!Number.isInteger(e)||e<0||e>r)return!1;n=s.value;const{fixedColumnsStart:o,inlineStartOverlay:a}=this.dataAccessObject,l=n==="auto";if(l&&e<o)return!1;const c=this.getFirstVisibleColumn(),u=this.getLastVisibleColumn();let h=!1;return(l&&(e<c||e>u)||!l)&&(h=a.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():n==="end")),h}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalRows:r}=this.dataAccessObject;if(!i)return!1;const s=xr(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,s),!Number.isInteger(e)||e<0||e>r)return!1;n=s.value;const{fixedRowsBottom:o,fixedRowsTop:a,topOverlay:l}=this.dataAccessObject,c=n==="auto";if(c&&(e<a||e>r-o-1))return!1;const u=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(c&&(e<u||e>h)||!c)&&(d=l.scrollTo(e,c?e>=this.getLastPartiallyVisibleRow():n==="bottom")),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return pv(Lg,this,YB).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return pv(Lg,this,YB).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return pv(Lg,this,UB).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return pv(Lg,this,UB).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function UB(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:i,wtViewport:r,totalColumns:s,rootWindow:o}=this.dataAccessObject;if(n.mainTableScrollableElement===o){const a=e.getSetting("rtlMode");let l=null;if(a){const u=i.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(u.right-d)}else l=yi(i.wtRootElement).left;const c=Math.abs(gO(o,o));if(l>c){const u=mO(o);let h=r.getRowHeaderWidth();for(let d=1;d<=s;d++)if(h+=n.sumCellSizes(d-1,d),l+h-c>=u){t=d-2;break}}}return t}function YB(t){const{topOverlay:e,wtTable:n,wtViewport:i,totalRows:r,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const o=yi(n.wtRootElement),a=GS(s,s);if(o.top>a){const l=gf(s);let c=i.getColumnHeaderHeight();for(let u=1;u<=r;u++)if(c+=e.sumCellSizes(u-1,u),o.top+c-a>=l){t=u-2;break}}}return t}function ds(t,e,n){return(e=ime(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ime(t){var e=rme(t,"string");return typeof e=="symbol"?e:e+""}function rme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IO{get eventManager(){return new As(this)}constructor(e,n){ds(this,"wtTable",void 0),ds(this,"wtScroll",void 0),ds(this,"wtViewport",void 0),ds(this,"wtOverlays",void 0),ds(this,"selectionManager",void 0),ds(this,"wtEvent",void 0),ds(this,"guid",`wt_${sO()}`),ds(this,"drawInterrupted",!1),ds(this,"drawn",!1),ds(this,"activeOverlayName","master"),ds(this,"domBindings",void 0),ds(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new nme(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,i){Tc(i,e[n])}])}}createCellCoords(e,n){return new xh(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,i){return new rg(e,n,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||t5(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=i-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,i){return this.wtScroll.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function GB(t,e,n){return(e=sme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sme(t){var e=ome(t,"string");return typeof e=="symbol"?e:e+""}function ome(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ame extends IO{constructor(e,n,i){super(e,n),GB(this,"cloneSource",void 0),GB(this,"cloneOverlay",void 0);const r=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new O5(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}function lme(t,e,n){return(e=cme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cme(t){var e=ume(t,"string");return typeof e=="symbol"?e:e+""}function ume(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Pw{constructor(e,n,i,r,s){lme(this,"wtSettings",null),ga(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=n,this.wtSettings=r;const{TABLE:o,hider:a,spreader:l,holder:c,wtRootElement:u}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=c,this.wtRootElement=u,this.trimmingContainer=Af(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Af(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=Hp(e.TABLE)}getRelativeCellPosition(e,n,i){if(this.clone.wtTable.holder.contains(e)===!1){Ue(`The provided element is not a child of the ${this.type} overlay`);return}const r=this.mainTableScrollableElement===this.domBindings.rootWindow,s=i<this.wtSettings.getSetting("fixedColumnsStart"),o=n<this.wtSettings.getSetting("fixedRowsTop"),a=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,c={start:this.getRelativeStartPosition(l),top:l.offsetTop},u={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return r?h=this.getRelativeCellPositionWithinWindow(o,s,u,c):h=this.getRelativeCellPositionWithinHolder(o,a,s,u,c),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,i,r){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!n)o=r.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+Sn())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=r.top,{start:i.start+o,top:i.top+a}}getRelativeCellPositionWithinHolder(e,n,i,r,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(i||(a=o.horizontal-s.start),n){const c=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+c.top}else e||(l=o.vertical-s.top);return{start:r.start-a,top:r.top-l}}makeClone(){if(D5.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,s=i.createElement("div"),o=i.createElement("table"),a=e.wtRootElement.parentNode;s.className=`${Xge.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,n.getSetting("ariaTags")&&he(s,[Ja()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(o),a.appendChild(s);const c=this.wtSettings.getSetting("preventOverflow");return c===!0||c==="horizontal"&&this.type===Th||c==="vertical"&&this.type===Mh?this.mainTableScrollableElement=r:r.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=Hp(e.TABLE),new ame(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=e.style,r=n.style,s=e.parentNode.style;[i,r,s].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class hme extends Pw{constructor(e,n,i,r,s,o){super(e,n,vc,i,r),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new AO(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${s}px`,n.style.bottom=`${o}px`}else _w(n),this.repositionOverlay();let i=An(this.clone.wtTable.TABLE);const r=yn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),n.style.height=`${i}px`,n.style.width=`${r}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let s=0;n.hasVerticalScroll()||(s+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(s+=Sn(i)),r.style.bottom=`${s}px`}}const dme="calculatedColumns",QS={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};ga(QS,"MIXIN_NAME",dme,{writable:!1,enumerable:!1});class OO extends sg{constructor(e,n,i,r){super(e,n,i,r,Zo)}}pt(OO,PO);pt(OO,QS);function fme(t,e,n){return(e=gme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gme(t){var e=mme(t,"string");return typeof e=="symbol"?e:e+""}function mme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pme extends Pw{constructor(e,n,i,r){super(e,n,Zo,i,r),fme(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new OO(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let i=0;const r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!r||r!=="vertical")?(i=this.getOverlayOffset(),n.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let s=0;n.hasVerticalScroll()||(s+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(s+=Sn(i)),r.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,i=this.mainTableScrollableElement;let r=!1;if(i===n&&e!==n.scrollY){const s=n.scrollY;n.scrollTo(YS(n),top),r=s!==n.scrollY}else if(e!==i.scrollTop){const s=i.scrollTop;i.scrollTop=e,r=s!==i.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:i,wtSettings:r}=this.wot,s=r.getSetting("stylesHandler").getDefaultRowHeight();let o=e,a=0;for(;o<n;){const l=i.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let c=n.getWorkspaceWidth();n.hasVerticalScroll()&&(c-=Sn(i)),c=Math.min(c,e.wtRootElement.scrollWidth),o.width=`${c}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=An(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let i=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;n&&s.offsetHeight!==s.clientHeight&&(o=Sn(this.domBindings.rootDocument)),n?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=o,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return GS(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=r-s,a=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+r,0),i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==n,r=this.wtSettings.getSetting("columnHeaders");let s=!1;if((i||n===0)&&r.length>0){const o=this.wot.wtTable.holder.parentNode,a=Ee(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(q(o,"innerBorderBottom"),s=!a):(ue(o,"innerBorderBottom"),s=a)}return s}}const wme="calculatedRows",HO={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ga(HO,"MIXIN_NAME",wme,{writable:!1,enumerable:!1});class kO extends sg{constructor(e,n,i,r){super(e,n,i,r,Mh)}}pt(kO,HO);pt(kO,ZS);const vme="localHooks",ti={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},removeLocalHook(t,e){if(this._localHooks[t]){const n=this._localHooks[t].indexOf(e);n>-1&&this._localHooks[t].splice(n,1)}return this},runLocalHooks(t,e,n,i,r,s,o){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)eC(this._localHooks[t][l],this,e,n,i,r,s,o)}},clearLocalHooks(){return this._localHooks={},this}};ga(ti,"MIXIN_NAME",vme,{writable:!1,enumerable:!1});let N5=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};pt(N5,ti);const L5="active-header",DO="header",NO="area",rC="focus",bme="fill",yme="row",Cme="column",Sme="custom-selection",LO=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),i=e.getCSSVariableValue("cell-autofill-border-width"),r=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:i,borderStyle:"solid",borderColor:r})};var qB={},KB;function Rme(){if(KB)return qB;KB=1;var t=JS();return t("flat"),qB}Rme();function _me(t,e){$5(t,e),e.add(t)}function XB(t,e,n){$5(t,e),e.set(t,n)}function $5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nn(t,e){return t.get(Zm(t,e))}function JB(t,e,n){return t.set(Zm(t,e),n),n}function Zm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var js=new WeakMap,Ti=new WeakMap,wv=new WeakSet;class Eme{constructor(){_me(this,wv),XB(this,js,void 0),XB(this,Ti,void 0)}setActiveOverlay(e){return JB(Ti,this,e),this}setActiveSelection(e){return JB(js,this,e),this}scan(){const e=nn(js,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="area"?this.scanCellsRange(i=>n.add(i)):e==="focus"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i)),this.scanCellsRange(i=>n.add(i))):e==="fill"?this.scanCellsRange(i=>n.add(i)):e==="header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="row"?(this.scanRowsInHeadersRange(i=>n.add(i)),this.scanRowsInCellsRange(i=>n.add(i))):e==="column"&&(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanColumnsInCellsRange(i=>n.add(i))),n}scanColumnsInHeadersRange(e){const[n,i,r,s]=nn(js,this).getCorners(),{wtTable:o}=nn(Ti,this),a=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount();let c=0;for(let u=-o.getRowHeadersCount();u<a;u++){const h=o.columnFilter.renderedToSource(u);if(!(h<i||h>s)){for(let d=-l;d<0;d++){if(d<n||d>r)continue;const f=d+l;let g=o.getColumnHeader(h,f);const m=nn(Ti,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:nn(js,this).settings.selectionType,columnCursor:c,selectionWidth:s-i+1});m!==null&&(m!==h&&(g=o.getColumnHeader(m,f)),e(g))}c+=1}}}scanRowsInHeadersRange(e){const[n,i,r,s]=nn(js,this).getCorners(),{wtTable:o}=nn(Ti,this),a=o.getRenderedRowsCount(),l=o.getRowHeadersCount();let c=0;for(let u=-o.getColumnHeadersCount();u<a;u++){const h=o.rowFilter.renderedToSource(u);if(!(h<n||h>r)){for(let d=-l;d<0;d++){if(d<i||d>s)continue;const f=d+l;let g=o.getRowHeader(h,f);const m=nn(Ti,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:nn(js,this).settings.selectionType,rowCursor:c,selectionHeight:r-n+1});m!==null&&(m!==h&&(g=o.getRowHeader(m,f)),e(g))}c+=1}}}scanCellsRange(e){const{wtTable:n}=nn(Ti,this);Zm(wv,this,xme).call(this,(i,r)=>{const s=n.getCell(nn(Ti,this).createCellCoords(i,r)),o=nn(Ti,this).getSetting("onAfterDrawSelection",i,r,nn(js,this).settings.layerLevel);typeof o=="string"&&q(s,o),e(s)})}scanRowsInCellsRange(e){const[n,,i]=nn(js,this).getCorners(),{wtTable:r}=nn(Ti,this);Zm(wv,this,ZB).call(this,(s,o)=>{if(s>=n&&s<=i){const a=r.getCell(nn(Ti,this).createCellCoords(s,o));e(a)}})}scanColumnsInCellsRange(e){const[,n,,i]=nn(js,this).getCorners(),{wtTable:r}=nn(Ti,this);Zm(wv,this,ZB).call(this,(s,o)=>{if(o>=n&&o<=i){const a=r.getCell(nn(Ti,this).createCellCoords(s,o));e(a)}})}}function xme(t){let[e,n,i,r]=nn(js,this).getCorners();if(e<0&&i<0||n<0&&r<0)return;const{wtTable:s}=nn(Ti,this),o=e!==i||n!==r;if(n=Math.max(n,0),r=Math.max(r,0),e=Math.max(e,0),i=Math.max(i,0),o){if(n=Math.max(n,s.getFirstRenderedColumn()),r=Math.min(r,s.getLastRenderedColumn()),e=Math.max(e,s.getFirstRenderedRow()),i=Math.min(i,s.getLastRenderedRow()),r<n||i<e)return}else{const a=s.getCell(nn(Ti,this).createCellCoords(e,n));if(!sa(a))return}for(let a=e;a<=i;a+=1)for(let l=n;l<=r;l+=1)t(a,l)}function ZB(t){const{wtTable:e}=nn(Ti,this),n=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let r=0;r<n;r+=1){const s=e.rowFilter.renderedToSource(r);for(let o=0;o<i;o+=1)t(s,e.columnFilter.renderedToSource(o))}}const QB="ht-border-style-",Tme="-vertical",Mme="-horizontal";class e2{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=LO(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,i=this.main.childNodes.length;n<i;n++){const r=this.main.childNodes[n];this.eventManager.addEventListener(r,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),es(e);const i=this,r=this.wot.rootDocument.body,s=n.getBoundingClientRect();n.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(i.eventManager.removeEventListener(r,"mousemove",a),n.style.display="block")}this.eventManager.addEventListener(r,"mousemove",a)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const i=["top","start","bottom","end","corner"];let r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let a=0;a<5;a++){const l=i[a],c=n.createElement("div"),u=d=>this.settings[l]&&this.settings[l][d]?this.settings[l][d]:e.border[d];c.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(c.className+=" hidden"),r=c.style;const h=u("style");h?(["start","end"].includes(l)?c.className+=` ${QB}${h}${Tme}`:c.className+=` ${QB}${h}${Mme}`,r.setProperty("--ht-custom-border-size",`${u("width")}px`),r.setProperty("--ht-custom-border-color",u("color"))):r.backgroundColor=u("color"),r.height=`${u("width")}px`,r.width=`${u("width")}px`,this.main.appendChild(c)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),ro()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=n.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:n}=this.wot,i=n.getSetting("stylesHandler"),r=i.getCSSVariableValue("cell-mobile-handle-size"),s=i.getCSSVariableValue("cell-mobile-handle-border-radius"),o=i.getCSSVariableValue("cell-mobile-handle-background-color"),a=i.getCSSVariableValue("cell-mobile-handle-border-width"),l=i.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const c=10,u=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const h={position:"absolute",height:`${u}px`,width:`${u}px`,"border-radius":`${parseInt(u/1.5,10)}px`};Ye(h,(f,g)=>{this.selectionHandles.styles.bottomHitArea[g]=f,this.selectionHandles.styles.topHitArea[g]=f});const d=i.isClassicTheme()?{position:"absolute",height:`${c}px`,width:`${c}px`,"border-radius":`${parseInt(c/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${s}px`,background:`${o}`,border:`${a}px solid ${l}`};Ye(d,(f,g)=>{this.selectionHandles.styles.bottom[g]=f,this.selectionHandles.styles.top[g]=f}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const i=this.wot.selectionManager.getAreaSelection();return!!(i.cellRange&&(e!==i.cellRange.to.row||n!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,i,r,s,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:c,topHitArea:u,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(c.borderWidth,10),g=parseInt(c.width,10),m=parseInt(u.width,10),p=this.wot.wtTable.getWidth(),v=this.wot.wtTable.getHeight();c.top=`${parseInt(i-g-1,10)}px`,c[l]=`${parseInt(r-g-1,10)}px`,u.top=`${parseInt(i-m/4*3,10)}px`,u[l]=`${parseInt(r-m/4*3,10)}px`;const b=Math.min(parseInt(r+s,10),p-g-f*2),R=Math.min(parseInt(r+s-m/4,10),p-m-f*2);h[l]=`${b}px`,d[l]=`${R}px`;const S=Math.min(parseInt(i+o,10),v-g-f*2),x=Math.min(parseInt(i+o-m/4,10),v-m-f*2);h.top=`${S}px`,d.top=`${x}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(c.display="block",u.display="block",this.isPartRange(e,n)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(c.display="none",h.display="none",u.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(c.zIndex="9999",u.zIndex="9999"):(c.zIndex="",u.zIndex="")}appear(e){if(this.disabled)return;let[n,i,r,s]=e;if(n<0&&r<0||i<0&&s<0){this.disappear();return}const{wtTable:o,rootDocument:a,rootWindow:l}=this.wot,c=n!==r||i!==s,u=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),h=o.getFirstRenderedRow(),d=o.getLastRenderedRow(),f=o.getFirstRenderedColumn(),g=o.getLastRenderedColumn();if(f<0&&g<0||h<0&&d<0){this.disappear();return}let m;if(c){if(i=Math.max(i,f),s=Math.min(s,g),n=Math.max(n,h),r=Math.min(r,d),s<i||r<n){this.disappear();return}m=o.getCell(this.wot.createCellCoords(n,i))}else if(m=o.getCell(this.wot.createCellCoords(n,i)),!sa(m)){this.disappear();return}const p=c?o.getCell(this.wot.createCellCoords(r,s)):m,v=yi(m),b=c?yi(p):v,R=yi(o.TABLE),S=v.top,x=v.left,M=this.wot.wtSettings.getSetting("rtlMode");let T=0,O=0;if(M){const ye=yn(o.TABLE),Oe=yn(m),Ce=l.innerWidth-R.left-ye;O=x+Oe-b.left,T=l.innerWidth-x-Oe-Ce-1}else O=b.left+yn(p)-x,T=x-R.left-1;if(this.isEntireColumnSelected(n,r)){const ye=n,Oe=this.getDimensionsFromHeader("columns",i,s,ye,R);let Ce=null;Oe&&([Ce,T,O]=Oe),Ce&&(m=Ce)}let W=S-R.top-1,N=b.top+An(p)-S;if(this.isEntireRowSelected(i,s)){const ye=i,Oe=this.getDimensionsFromHeader("rows",n,r,ye,R);let Ce=null;Oe&&([Ce,W,N]=Oe),Ce&&(m=Ce)}const G=l.getComputedStyle(m);parseInt(G.borderTopWidth,10)>0&&(W+=1,N=N>0?N-1:0),parseInt(G[M?"borderRightWidth":"borderLeftWidth"],10)>0&&(T+=1,O=O>0?O-1:0);const j=M?"right":"left",ne=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${W}px`,this.topStyle[j]=`${T}px`,this.topStyle.width=`${O+ne}px`,this.topStyle.display="block",this.startStyle.top=`${W}px`,this.startStyle[j]=`${T}px`,this.startStyle.height=`${N+ne}px`,this.startStyle.display="block",this.bottomStyle.top=`${W+N-parseInt(this.bottomStyle.height,10)+ne}px`,this.bottomStyle[j]=`${T}px`,this.bottomStyle.width=`${O+ne}px`,this.bottomStyle.display="block",this.endStyle.top=`${W}px`,this.endStyle[j]=`${T+O-parseInt(this.endStyle.width,10)+ne}px`,this.endStyle.height=`${N+ne}px`,this.endStyle.display="block";let ee=this.settings.border.cornerVisible;ee=typeof ee=="function"?ee(this.settings.layerLevel):ee;const Q=this.wot.getSetting("onModifyGetCellCoords",r,s,!1,"render");let[me,fe]=[r,s];if(Q&&Array.isArray(Q)&&([,,me,fe]=Q),ro()||!ee||this.isPartRange(me,fe))this.cornerStyle.display="none";else{this.cornerStyle.top=`${W+N+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[j]=`${T+O+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let ye=Af(o.TABLE);const Oe=ye===l;Oe&&(ye=a.documentElement);const Ce=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Te=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),$e=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(s===this.wot.getSetting("totalColumns")-1){const Me=Oe?p.getBoundingClientRect().left:p.offsetLeft;let X=!1,w=0;if(M?(w=Me-parseInt(this.cornerDefaultStyle.width,10)/2,X=w<0):(w=Me+yn(p)+parseInt(this.cornerDefaultStyle.width,10)/2,X=w>=mO(ye)),X){const C=Math.floor(T+O+this.cornerCenterPointOffset-Te-Ce);u?(this.cornerStyle[j]=`${C}px`,this.cornerStyle[M?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[j]=`${C-1}px`}}if(r===this.wot.getSetting("totalRows")-1&&(Oe?p.getBoundingClientRect().top:p.offsetTop)+An(p)+parseInt(this.cornerDefaultStyle.height,10)/2>=gf(ye)){const C=Math.floor(W+N+this.cornerCenterPointOffset-$e-Ce);u?(this.cornerStyle.top=`${C}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${C-1}px`}this.cornerStyle.display="block"}ro()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(r,s,W,T,O,N)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,i,r,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,c=null,u=null,h=null,d=null,f=null,g=null,m=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},c=function(){return An(...arguments)},u="ht__selection--rows",f="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},c=function(){return yn(...arguments)},u="ht__selection--columns",f="left";break}if(a.classList.contains(u)){const p=this.wot.getSetting("columnHeaders").length;if(g=l(n,p-r),m=l(i,p-r),!g||!m)return!1;const v=yi(g),b=yi(m);return g&&m&&(h=v[f]-s[f]-1,d=b[f]+c(m)-v[f]),[g,h,d]}return!1}changeBorderStyle(e,n){const i=this[e].style,r=n[e];!r||r.hide?q(this[e],"hidden"):(Ee(this[e],"hidden")&&ue(this[e],"hidden"),i.backgroundColor=r.color,(e==="top"||e==="bottom")&&(i.height=`${r.width}px`),(e==="start"||e==="end")&&(i.width=`${r.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},i=this[e].style;i.backgroundColor=n.color,i.width=`${n.width}px`,i.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?q(this[e],"hidden"):ue(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",ro()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function Pme(t,e){F5(t,e),e.add(t)}function nd(t,e,n){F5(t,e),e.set(t,n)}function F5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qe(t,e){return t.get($O(t,e))}function t2(t,e,n){return t.set($O(t,e),n),n}function $O(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Mi=new WeakMap,vr=new WeakMap,lx=new WeakMap,Im=new WeakMap,cx=new WeakMap,Xc=new WeakMap,n2=new WeakSet;class Ame{constructor(e){Pme(this,n2),nd(this,Mi,void 0),nd(this,vr,void 0),nd(this,lx,new Eme),nd(this,Im,new WeakMap),nd(this,cx,new WeakSet),nd(this,Xc,new Map),t2(vr,this,e)}setActiveOverlay(e){return t2(Mi,this,e),qe(lx,this).setActiveOverlay(qe(Mi,this)),qe(Im,this).has(qe(Mi,this))||qe(Im,this).set(qe(Mi,this),new Set),this}getFocusSelection(){return qe(vr,this)!==null?qe(vr,this).getFocus():null}getAreaSelection(){return qe(vr,this)!==null?qe(vr,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(qe(Xc,this).has(e)){const i=qe(Xc,this).get(e);if(i.has(qe(Mi,this)))return i.get(qe(Mi,this));const r=new e2(qe(Mi,this),e.settings);return i.set(qe(Mi,this),r),r}const n=new e2(qe(Mi,this),e.settings);return qe(Xc,this).set(e,new Map([[qe(Mi,this),n]])),n}getBorderInstances(e){var n,i;return Array.from((n=(i=qe(Xc,this).get(e))===null||i===void 0?void 0:i.values())!==null&&n!==void 0?n:[])}destroyBorders(e){qe(Xc,this).get(e).forEach(n=>n.destroy()),qe(Xc,this).delete(e)}render(e){if(qe(vr,this)===null)return;e&&$O(n2,this,Ime).call(this);const n=Array.from(qe(vr,this)),i=new Map,r=new Map;for(let s=0;s<n.length;s++){const o=n[s],{className:a,headerAttributes:l,createLayers:c,selectionType:u}=o.settings;qe(cx,this).has(o)||(qe(cx,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const h=this.getBorderInstance(o);if(o.isEmpty()){h?.disappear();continue}a&&qe(lx,this).setActiveSelection(o).scan().forEach(g=>{if(i.has(g)){const m=i.get(g);m.has(a)&&c===!0?m.set(a,m.get(a)+1):m.set(a,1)}else i.set(g,new Map([[a,1]]));l&&(r.has(g)||r.set(g,[]),g.nodeName==="TH"&&r.get(g).push(...l))});const d=o.getCorners();qe(Mi,this).getSetting("onBeforeDrawBorders",d,u),h?.appear(d)}i.forEach((s,o)=>{var a;const l=Array.from(s).map(c=>{let[u,h]=c;return h===1?u:[u,...Array.from({length:h-1},(d,f)=>`${u}-${f+1}`)]}).flat();l.forEach(c=>qe(Im,this).get(qe(Mi,this)).add(c)),q(o,l),o.nodeName==="TD"&&Array.isArray((a=qe(vr,this).options)===null||a===void 0?void 0:a.cellAttributes)&&he(o,qe(vr,this).options.cellAttributes)}),Array.from(r.keys()).forEach(s=>{he(s,[...r.get(s)])})}}function Ime(){const t=qe(Im,this).get(qe(Mi,this)),e=qe(Mi,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var i,r;const s=qe(Mi,this).wtTable.TABLE.querySelectorAll(`.${n}`);let o=[];Array.isArray((i=qe(vr,this).options)===null||i===void 0?void 0:i.cellAttributes)&&(o=qe(vr,this).options.cellAttributes.map(a=>a[0])),Array.isArray((r=qe(vr,this).options)===null||r===void 0?void 0:r.headerAttributes)&&(o=[...o,...qe(vr,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=s.length;a<l;a++)ue(s[a],n),ra(s[a],o)}),t.clear()}class Ome extends Pw{constructor(e,n,i,r){super(e,n,Mh,i,r)}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new kO(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===n&&(!r||r!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),qS(i,`${s}px`,"0px")):(s=this.getScrollPosition(),_w(i));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let i=!1;this.isRtl()&&(e=-e);const r=this.mainTableScrollableElement;if(r===n&&e!==n.scrollX){const s=n.scrollX;n.scrollTo(e,fO(n)),i=s!==n.scrollX}else if(e!==r.scrollLeft){const s=r.scrollLeft;r.scrollLeft=e,i=s!==r.scrollLeft}return i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("defaultColumnWidth");let r=e,s=0;for(;r<n;)s+=this.wot.wtTable.getColumnWidth(r)||i,r+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="vertical"){let c=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(c-=Sn(i)),c=Math.min(c,e.wtRootElement.scrollHeight),o.height=`${c}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=yn(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=LO(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:i}=this,r=i.getSetting("rowHeaders"),s=i.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=s===0&&r.length>0&&!Ee(a.parentNode,"innerBorderInlineStart")?1:0;let c=this.getTableParentOffset(),u=0;if(n){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(n=!1)}return n&&a.offsetWidth!==a.clientWidth&&(u=Sn(this.domBindings.rootDocument)),n?(c+=this.sumCellSizes(0,e+1),c-=this.wot.wtViewport.getViewportWidth(),c+=l):c+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),c+=u,i5(this.mainTableScrollableElement)===c-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(c)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(gO(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const r=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=r-s;i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,r=n.getSetting("rowHeaders"),s=n.getSetting("fixedColumnsStart"),o=n.getSetting("totalRows"),a=n.getSetting("preventOverflow")==="vertical";o?ue(i,"emptyRows"):q(i,"emptyRows");let l=!1;if(!a){if(s&&!r.length)q(i,"innerBorderLeft innerBorderInlineStart");else if(!s&&r.length){const c=Ee(i,"innerBorderInlineStart");e?(q(i,"innerBorderLeft innerBorderInlineStart"),l=!c):(ue(i,"innerBorderLeft innerBorderInlineStart"),l=c)}}return l}}const Hme="stickyRowsTop",FO={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};ga(FO,"MIXIN_NAME",Hme,{writable:!1,enumerable:!1});class VO extends sg{constructor(e,n,i,r){super(e,n,i,r,Ph)}}pt(VO,FO);pt(VO,ZS);function i2(t,e,n){return(e=kme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kme(t){var e=Dme(t,"string");return typeof e=="symbol"?e:e+""}function Dme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nme extends Pw{constructor(e,n,i,r,s,o){super(e,n,Ph,i,r),i2(this,"topOverlay",void 0),i2(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new VO(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const r=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();qS(e,`${r}px`,`${s}px`)}else _w(e);let n=An(this.clone.wtTable.TABLE);const i=yn(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${i}px`,!1}}class BO extends sg{constructor(e,n,i,r){super(e,n,i,r,Th)}}pt(BO,FO);pt(BO,QS);function Lme(t,e,n){return(e=$me(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $me(t){var e=Fme(t,"string");return typeof e=="symbol"?e:e+""}function Fme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vme extends Pw{constructor(e,n,i,r){super(e,n,Th,i,r),Lme(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new BO(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow");let r=0,s=!1;if(this.trimmingContainer===n&&(!i||i!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),c=Math.ceil(l.bottom),u=e.offsetHeight;s=c===u,r=this.getOverlayOffset(),qS(e,"0px",`${r}px`)}else r=this.getScrollPosition(),_w(e);const o=this.adjustHeaderBordersPosition(r,s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:n}=this.domBindings,i=this.mainTableScrollableElement;let r=!1;if(i===n&&e!==n.scrollY){const s=n.scrollY;n.scrollTo(YS(n),e),r=s!==n.scrollY}else if(e!==i.scrollTop){const s=i.scrollTop;i.scrollTop=e,r=s!==i.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let r=e,s=0;for(;r<n;){const o=this.wot.wtTable.getRowHeight(r);s+=o===void 0?i:o,r+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||a==="horizontal"){let c=n.getWorkspaceWidth();n.hasVerticalScroll()&&(c-=Sn(i)),c=Math.min(c,e.wtRootElement.scrollWidth),o.width=`${c}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=An(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=LO(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:i,wtSettings:r}=this,o=(i.cloneSource?i.cloneSource:i).wtTable.holder,a=r.getSetting("columnHeaders"),c=r.getSetting("fixedRowsTop")===0&&a.length>0&&!Ee(o.parentNode,"innerBorderTop")?1:0;let u=this.getTableParentOffset(),h=0;if(n){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(n=!1)}if(n&&o.offsetHeight!==o.clientHeight&&(h=Sn(this.domBindings.rootDocument)),n){const d=r.getSetting("fixedRowsBottom"),f=r.getSetting("totalRows");u+=this.sumCellSizes(0,e+1),u-=i.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),u+=1,u+=c}else u+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return u+=h,n5(this.mainTableScrollableElement)===u-c&&c>0&&this.wot.wtOverlays.expandHiderVerticallyBy(c),this.setScrollPosition(u)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return GS(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=r-s;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>o&&(i=0)}return i}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:i}=this,r=this.wot.wtTable.holder.parentNode,s=i.getSetting("totalColumns"),o=i.getSetting("preventOverflow")==="horizontal";s?ue(r,"emptyColumns"):q(r,"emptyColumns");let a=!1;if(!n&&!o){const l=i.getSetting("fixedRowsTop"),c=this.cachedFixedRowsTop!==l,u=i.getSetting("columnHeaders");if((c||l===0)&&u.length>0){const h=Ee(r,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||i.getSetting("totalRows")===0?(q(r,"innerBorderTop"),a=!h):(ue(r,"innerBorderTop"),a=h)}}return a}}function vv(t,e,n){Bme(t,e),e.set(t,n)}function Bme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sa(t,e,n){return(e=Wme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Wme(t){var e=jme(t,"string");return typeof e=="symbol"?e:e+""}function jme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jc(t,e,n){return t.set(V5(t,e),n),n}function Ra(t,e){return t.get(V5(t,e))}function V5(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var id=new WeakMap,bv=new WeakMap,rd=new WeakMap,yv=new WeakMap;class zme{constructor(e,n,i,r,s,o){Sa(this,"wot",null),vv(this,id,[]),Sa(this,"topOverlay",null),Sa(this,"bottomOverlay",null),Sa(this,"inlineStartOverlay",null),Sa(this,"topInlineStartCornerOverlay",null),Sa(this,"bottomInlineStartCornerOverlay",null),Sa(this,"browserLineHeight",void 0),Sa(this,"wtSettings",null),vv(this,bv,!1),vv(this,rd,0),vv(this,yv,null),Sa(this,"resizeObserver",new ResizeObserver(u=>{Ip(()=>{!Array.isArray(u)||!u.length||(Jc(rd,this,Ra(rd,this)+1),Ra(rd,this)===300&&(Ue("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Ra(yv,this)!==null&&clearTimeout(Ra(yv,this)),Jc(yv,this,setTimeout(()=>{Jc(rd,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=r,this.domBindings=i,this.facadeGetter=n,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=Sn(a);const c=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=c?o.holder:Hp(o.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...Ra(id,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,i=e.getComputedStyle(n.body),r=parseInt(i.lineHeight,10),s=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=r||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Vme(...e),this.bottomOverlay=new pme(...e),this.inlineStartOverlay=new Ome(...e),this.topInlineStartCornerOverlay=new Nme(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new hme(...e,this.bottomOverlay,this.inlineStartOverlay),Jc(id,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Jc(bv,this,Ra(id,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),Ra(id,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Ra(id,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:r}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0}),i!==r&&this.eventManager.addEventListener(r,"scroll",h=>this.onTableScroll(h),{passive:!0});const s=n.devicePixelRatio&&n.devicePixelRatio>1,o=this.scrollableElement===n,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!uO())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{this.eventManager.addEventListener(h.clone.wtTable.holder,"wheel",d=>this.onCloneWheel(d,a),l)});let u;this.eventManager.addEventListener(n,"resize",()=>{Ip(()=>{clearTimeout(u),this.wtSettings.getSetting("onWindowResize"),u=setTimeout(()=>{Jc(rd,this,0)},200)})}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(r!==n&&s!==n&&!e.target.contains(r)||i!==n&&s!==n&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,n){if(e.ctrlKey)return;const{rootWindow:i}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==i&&o!==i&&!o.contains(s),l=r!==i&&o!==i&&!o.contains(r);if(this.keyPressed&&(a||l)||this.scrollableElement===i)return;const c=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==i&&c)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Eh(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);const r=this.scrollVertically(n),s=this.scrollHorizontally(i);return r||s}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let i=this.scrollableElement.scrollLeft,r=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(i=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(r=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==i,this.verticalScrolling=this.lastScrollY!==r,this.lastScrollX=i,this.lastScrollY=r,this.horizontalScrolling){e.scrollLeft=i;const s=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;s&&(s.scrollLeft=i)}this.verticalScrolling&&(n.scrollTop=r),this.refreshAll()}syncScrollWithMaster(){if(!Ra(bv,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i),Jc(bv,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=Hp(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,i=e.clientHeight,r=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),r}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:i}=this.domBindings,r=this.scrollableElement===i,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),l=e.getColumnHeaderHeight(),c=this.wtSettings.getSetting("externalRowCalculator")?0:1,u=l+this.topOverlay.sumCellSizes(0,o)+c,h=a+this.inlineStartOverlay.sumCellSizes(0,s),f=n.hider.style,g=()=>r?!1:this.scrollableElement.scrollTop>Math.max(0,u-n.holder.clientHeight),m=()=>r?!1:this.scrollableElement.scrollLeft>Math.max(0,h-n.holder.clientWidth),p=g()?1:0,v=m()?1:0;f.width=`${h+v}px`,f.height=`${u+p}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let i=null;return k(n,r=>{r&&r.clone&&r.clone.wtTable.TABLE.contains(e)&&(i=r.clone)}),i}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];k(n,i=>{i&&(i.clone.wtTable.TABLE.className=e.className)})}}function r2(t,e,n){return(e=Ume(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ume(t){var e=Yme(t,"string");return typeof e=="symbol"?e:e+""}function Yme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gme{constructor(e){r2(this,"settings",{}),r2(this,"defaults",Object.freeze(this.getDefaults())),Ye(this.defaults,(n,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(n===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,i)=>{const r=this.getSetting("data",e,n);Tc(i,r??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,n){return n===void 0?Ye(e,(i,r)=>{this.settings[r]=i}):this.settings[e]=n,this}getSetting(e,n,i,r,s){return typeof this.settings[e]=="function"?this.settings[e](n,i,r,s):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class WO extends sg{constructor(e,n,i,r){super(e,n,i,r,"master")}alignOverlaysWithTrimmingContainer(){const e=Af(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const i=e.parentElement,r=kp(e,"height",n),s=kp(e,"overflow",n),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let c=e.offsetWidth,u=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(s)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?i.insertBefore(d,e.nextElementSibling):i.appendChild(d);const f=parseInt(n.getComputedStyle(d).height,10);i.removeChild(d),f===0&&(u=0)}u=Math.min(u,l),o.height=r==="auto"?"auto":`${u}px`,c=Math.min(c,a),o.width=`${c}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:u>0,this.hasTableWidth=c>0}this.isTableVisible=Mc(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,i="master",s=e.getSetting("columnHeaders").length;if(s&&!n.hasOversizedColumnHeadersMarked[i]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let c=0;c<s;c++)for(let u=-1*a;u<l;u++)this.markIfOversizedColumnHeader(u);n.hasOversizedColumnHeadersMarked[i]=!0}}}pt(WO,HO);pt(WO,QS);class qme{constructor(e,n,i,r,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=i,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new _fe:new Afe],["fullyVisible",()=>new gfe],["partiallyVisible",()=>new T5]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new Cfe:new Tfe],["fullyVisible",()=>new hfe],["partiallyVisible",()=>new x5]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let i=0;return n===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=An(n)>0&&n.clientHeight>0?n.clientHeight:1/0,i}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let r;if(i===n){const s=this.wtSettings.getSetting("totalColumns");r=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,s)>r&&(r=e.documentElement.clientWidth)}else r=i.clientWidth;return r}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const s=this.domBindings.rootDocument.documentElement;return s.scrollHeight>s.clientHeight}const{holder:e,hider:n}=this.wtTable,i=e.clientHeight,r=n.offsetHeight;return i<r?!0:r>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const r=this.domBindings.rootDocument.documentElement;return r.scrollWidth>r.clientWidth}const{hider:e}=this.wtTable,n=e.offsetWidth,i=this.hasVerticalScroll()?Sn():0;return n>this.getWorkspaceWidth()-i}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let i=0,r=e;for(;r<n;)i+=this.wtTable.getColumnWidth(r),r+=1;return i}getWorkspaceOffset(){return yi(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=An(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,r=n.length;i<r;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let r=0,s=n.length;r<s;r++)i?(this.rowHeaderWidth+=yn(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportHeight(),s,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=n.getSetting("fixedRowsTop"),c=n.getSetting("fixedRowsBottom"),u=n.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,r-=o),c&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(u-c,u),r-=o),i.holder.clientHeight===i.holder.offsetHeight?s=0:s=Sn(this.domBindings.rootDocument),new $fe({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:r,scrollOffset:a,totalRows:n.getSetting("totalRows"),defaultRowHeight:n.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:h=>i.getRowHeight(h),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=n.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,r-=a}return i.holder.clientWidth!==i.holder.offsetWidth&&(r-=Sn(this.domBindings.rootDocument)),new Dfe({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:r,scrollOffset:s,totalColumns:n.getSetting("totalColumns"),columnWidthFn:a=>i.getColumnWidth(a),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,i=this.createRowsCalculator(),r=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const s=i.getResultsFor("fullyVisible"),o=i.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s,o)}if(e&&!n.getSetting("renderAllColumns")){const s=r.getResultsFor("fullyVisible"),o=r.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s,o)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e,n){if(!this.rowsVisibleCalculator)return!1;let{startRow:i,endRow:r}=e;const{startRow:s,endRow:o}=n;if(i===null&&r===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isRowBeforeRenderedRows(s)&&!this.wtTable.isRowAfterRenderedRows(o))return!0;i=s,r=o}const{startRow:a,endRow:l,rowStartOffset:c,rowEndOffset:u}=this.rowsRenderCalculator,h=this.wtSettings.getSetting("totalRows")-1,d=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(d)&&d>0?(i=Math.max(0,i-Math.min(c,d)),r=Math.min(h,r+Math.min(u,d))):d==="auto"&&(i=Math.max(0,i-Math.ceil(c/2)),r=Math.min(h,r+Math.ceil(u/2))),i<a||i===a&&i>0?!1:!(r>l||r===l&&r<h)}areAllProposedVisibleColumnsAlreadyRendered(e,n){if(!this.columnsVisibleCalculator)return!1;let{startColumn:i,endColumn:r}=e;const{startColumn:s,endColumn:o}=n;if(i===null&&r===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isColumnBeforeRenderedColumns(s)&&!this.wtTable.isColumnAfterRenderedColumns(o))return!0;i=s,r=o}const{startColumn:a,endColumn:l,columnStartOffset:c,columnEndOffset:u}=this.columnsRenderCalculator,h=this.wtSettings.getSetting("totalColumns")-1,d=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(d)&&d>0?(i=Math.max(0,i-Math.min(c,d)),r=Math.min(h,r+Math.min(u,d))):d==="auto"&&(i=Math.max(0,i-Math.ceil(c/2)),r=Math.min(h,r+Math.ceil(u/2))),i<a||i===a&&i>0?!1:!(r>l||r===l&&r<h)}resetHasOversizedColumnHeadersMarked(){Ye(this.hasOversizedColumnHeadersMarked,(e,n,i)=>{i[n]=void 0})}}class Kme extends IO{constructor(e,n){super(e,new Gme(n));const i=this.wtSettings.getSetting("facade",this);this.wtTable=new WO(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new qme(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Ame(this.wtSettings.getSetting("selections")),this.wtEvent=new O5(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new zme(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],i=[];Ye(e,(r,s)=>{this.wtSettings.getSetting(s).length&&i.push(r),n.push(r)}),ue(this.wtTable.wtRootElement.parentNode,n),q(this.wtTable.wtRootElement.parentNode,i)}getOverlayByName(e){var n;if(!D5.includes(e))return null;const i=e.replace(/_([a-z])/g,r=>r[1].toUpperCase());return(n=this.wtOverlays[`${i}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class jO{constructor(e){e instanceof IO?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const i=new jO(n);return()=>i},this._wot=new Kme(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,i){return this._wot.createCellRange(e,n,i)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,i){return this._wot.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,i,r,s){return this._wot.wtSettings.getSetting(e,n,i,r,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function s2(t){let{isShiftKey:e,isLeftClick:n,isRightClick:i,coords:r,selection:s,controller:o,cellCoordsFactory:a}=t;const l=s.isSelected()?s.getSelectedRange().current():null,c=s.isSelectedByCorner(),u=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&l)r.row>=0&&r.col>=0&&!o.cell?s.setRangeEnd(r):(c||u)&&r.row>=0&&r.col>=0&&!o.cell?s.setRangeEnd(a(r.row,r.col)):c&&r.row<0&&!o.column?s.setRangeEnd(a(l.to.row,r.col)):u&&r.col<0&&!o.row?s.setRangeEnd(a(r.row,l.to.col)):(!c&&!u&&r.col<0||c&&r.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),r.row,r.col):(!c&&!u&&r.row<0||u&&r.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),r.col,r.row);else{const h=!s.inInSelection(r),d=n||i&&h;r.row<0&&r.col>=0&&!o.column?d&&s.selectColumns(r.col,r.col,r.row):r.col<0&&r.row>=0&&!o.row?d&&s.selectRows(r.row,r.row,r.col):r.col>=0&&r.row>=0&&!o.cell?d&&s.setRangeStart(r):r.col<0&&r.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function Xme(t){let{isLeftClick:e,coords:n,selection:i,controller:r,cellCoordsFactory:s}=t;if(!e)return;const o=i.isSelectedByRowHeader(),a=i.isSelectedByColumnHeader(),l=i.tableProps.countCols(),c=i.tableProps.countRows();i.markSource("mouse"),a&&!r.column?i.setRangeEnd(s(c-1,n.col)):o&&!r.row?i.setRangeEnd(s(n.row,l-1)):r.cell||i.setRangeEnd(n),i.markEndSource()}function o2(t){let{isLeftClick:e,selection:n,cellRangeMapper:i}=t;if(!e||n.settings.selectionMode!=="multiple")return;const r=n.getSelectedRange(),s=r.clone().map(a=>i.toRenderable(a)),o=s.current();if(s.size()>1&&!o.isHeader()&&!n.isMultiple(o)){const a=s.findAll(o);a.length===s.size()?(r.pop(),n.refresh()):a.length>1&&(r.removeLayers(a.map(l=>{let{layer:c}=l;return c})),n.refresh())}}const Jme=new Map([["touchstart",s2],["touchend",o2],["mousedown",s2],["mouseover",Xme],["mouseup",o2]]);function ux(t,e){Jme.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:XS(t)||t.type==="touchstart",isRightClick:Pc(t),...e})}const B5=new WeakMap,zO=Symbol("rootInstance");function Zme(t){B5.set(t,!0)}function Qme(t){return t===zO}function Fo(t){return B5.has(t)}function epe(t,e){W5(t,e),e.add(t)}function Sl(t,e,n){W5(t,e),e.set(t,n)}function W5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rl(t,e,n){return(e=tpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tpe(t){var e=npe(t,"string");return typeof e=="symbol"?e:e+""}function npe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _n(t,e){return t.get(mf(t,e))}function cr(t,e,n){return t.set(mf(t,e),n),n}function mf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hx=new WeakMap,Cv=new WeakMap,Sv=new WeakMap,_a=new WeakMap,$s=new WeakMap,dx=new WeakMap,fx=new WeakMap,sd=new WeakMap,Om=new WeakSet;class ipe{constructor(e){epe(this,Om),Rl(this,"hot",void 0),Rl(this,"eventManager",void 0),Rl(this,"settings",void 0),Rl(this,"THEAD",void 0),Rl(this,"TBODY",void 0),Rl(this,"_wt",void 0),Rl(this,"activeWt",void 0),Sl(this,hx,0),Sl(this,Cv,0),Rl(this,"postponedAdjustElementsSize",!1),Sl(this,Sv,!1),Sl(this,_a,void 0),Sl(this,$s,void 0),Sl(this,dx,0),Sl(this,fx,0),Sl(this,sd,null),this.hot=e,this.eventManager=new As(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this._wt.draw(!e),mf(Om,this,spe).call(this),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?this._wt.wtOverlays.adjustElementsSize():this.postponedAdjustElementsSize=!0}getCellAtCoords(e,n){const i=this._wt.getCell(e,n);return i<0?null:i}scrollViewport(e,n,i){return this._wt.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),q(e,"handsontable"),cr($s,this,n.createElement("TABLE")),q(_n($s,this),"htCore"),this.hot.getSettings().tableClassName&&q(_n($s,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(he(_n($s,this),[Ja()]),he(e,[ohe(),LK(-1),jS(this.hot.countCols()),_he()])),this.THEAD=n.createElement("THEAD"),_n($s,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),_n($s,this).appendChild(this.TBODY),this.hot.table=_n($s,this),this.hot.container.insertBefore(_n($s,this),this.hot.container.firstChild)}registerEvents(){const{rootWrapperElement:e,rootElement:n,rootDocument:i,selection:r,rootWindow:s}=this.hot,o=i.documentElement;this.eventManager.addEventListener(n,"mousedown",l=>{cr(Sv,this,!0),this.isTextSelectionAllowed(l.target)||(wP(s),l.preventDefault(),s.focus())}),this.eventManager.addEventListener(n,"mouseup",()=>{cr(Sv,this,!1)}),this.eventManager.addEventListener(n,"mousemove",l=>{_n(Sv,this)&&!this.isTextSelectionAllowed(l.target)&&(this.settings.fragmentSelection&&wP(s),l.preventDefault())}),this.eventManager.addEventListener(o,"keyup",l=>{r.isInProgress()&&!l.shiftKey&&r.finish()}),this.eventManager.addEventListener(o,"mouseup",l=>{r.isInProgress()&&XS(l)&&r.finish(),cr(_a,this,!1);const c=KS(i.activeElement);Jm(i.activeElement)&&!c||(c||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!(e??n).contains(l.target)&&!Pc(l))&&this.hot.unlisten()}),this.eventManager.addEventListener(o,"contextmenu",l=>{r.isInProgress()&&Pc(l)&&(r.finish(),cr(_a,this,!1))}),this.eventManager.addEventListener(o,"touchend",()=>{r.isInProgress()&&r.finish(),cr(_a,this,!1)}),this.eventManager.addEventListener(o,"mousedown",l=>{const c=l.target,u=l.x||l.clientX,h=l.y||l.clientY;let d=l.target;if(_n(_a,this)||!n||!this.hot.view)return;const{holder:f}=this._wt.wtTable;if(d===f){const m=Sn(i);if(i.elementFromPoint(u+m,h)!==f||i.elementFromPoint(u,h+m)!==f)return}else for(;d!==o;){if(d===null){if(l.isTargetWebComponent)break;return}if(d===n)return;d=d.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(c):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let a=al(s);for(;a!==null;)this.eventManager.addEventListener(a.document.documentElement,"click",()=>{this.hot.unlisten()}),a=al(a);this.eventManager.addEventListener(_n($s,this),"selectstart",l=>{this.settings.fragmentSelection||Jm(l.target)||l.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,i))}translateFromRenderableToVisualIndex(e,n){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=e),r===null&&(r=n),[i,r]}countRenderableIndexes(e,n){const i=Math.min(e.getNotTrimmedIndexesLength(),n),r=e.getNearestNotHiddenIndex(i-1,-1);return r===null?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,i,r){if(isNaN(e)||e<0)return 0;const s=i.getNearestNotHiddenIndex(e,n),o=i.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return n<0?a=o+1:n>0&&(a=r-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}countRenderableRowsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}addClassNameToLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&q(i,e)}removeClassNameFromLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&ue(i,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:_n($s,this),isDataViewInstance:()=>Fo(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(s,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),cr(Cv,this,s.length),this.hot.getSettings().ariaTags&&mf(Om,this,j5).call(this)===this.hot.countCols()&&mf(Om,this,rpe).call(this,_n(Cv,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),cr(hx,this,s.length),s},columnWidth:s=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(o===null?s:o)},rowHeight:s=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(o===null?s:o)},rowHeightByOverlayName:(s,o)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),l=a===null?s:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,o)},cellRenderer:(s,o,a)=>{const[l,c]=this.translateFromRenderableToVisualIndex(s,o),u=this.hot.runHooks("modifyGetCellCoords",l,c,!1,"meta");let h=l,d=c;Array.isArray(u)&&([h,d]=u);const f=this.hot.getCellMeta(h,d),g=this.hot.colToProp(d);let m=this.hot.getDataAtRowProp(h,g);this.hot.hasHook("beforeValueRender")&&(m=this.hot.runHooks("beforeValueRender",m,f)),this.hot.runHooks("beforeRenderer",a,l,c,g,m,f),this.hot.getCellRenderer(f)(this.hot,a,l,c,g,m,f),this.hot.runHooks("afterRenderer",a,l,c,g,m,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Mc(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o),u={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,cr(_a,this,!0),cr(sd,this,{x:s.clientX,y:s.clientY}),this.hot.runHooks("beforeOnCellMouseDown",s,c,a,u),!Jl(s)&&(ux(s,{coords:c,selection:this.hot.selection,controller:u,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",s,c,a),this.activeWt=this._wt)},onCellContextMenu:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,cr(_a,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,c,a),!Jl(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,c,a),this.activeWt=this._wt)},onCellMouseOut:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",s,c,a),!Jl(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,c,a),this.activeWt=this._wt)},onCellMouseOver:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o),u={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",s,c,a,u),!Jl(s)&&(_n(_a,this)&&(!_n(sd,this)||_n(sd,this).x!==s.clientX||_n(sd,this).y!==s.clientY)&&ux(s,{coords:c,selection:this.hot.selection,controller:u,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",s,c,a),this.activeWt=this._wt,cr(sd,this,null))},onCellMouseUp:(s,o,a,l)=>{const c=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",s,c,a),!(Jl(s)||this.hot.isDestroyed)&&(ux(s,{coords:c,selection:this.hot.selection,cellRangeMapper:bde(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",s,c,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,o)=>this.beforeRender(s,o),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:(s,o)=>{const a=this.hot.rowIndexMapper,l=s<0;let c=s;return!l&&(c=a.getVisualFromRenderableIndex(s),c===null)?s:(c=this.hot.runHooks("beforeViewportScrollVertically",c,o),this.hot.runHooks("beforeViewportScroll"),l?c:a.getRenderableFromVisualIndex(c))},onBeforeViewportScrollHorizontally:(s,o)=>{const a=this.hot.columnIndexMapper,l=s<0;let c=s;return!l&&(c=a.getVisualFromRenderableIndex(s),c===null)?s:(c=this.hot.runHooks("beforeViewportScrollHorizontally",c,o),this.hot.runHooks("beforeViewportScroll"),l?c:a.getRenderableFromVisualIndex(c))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,o,a)=>{const l=this.hot.rowIndexMapper,c=s<0;let u=s;c||(u=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingRowHeader",u,o,a);return c?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(s,o,a)=>{const l=this.hot.columnIndexMapper,c=s<0;let u=s;c||(u=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingColumnHeader",u,o,a);return c?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(s,o,a)=>{let l;const[c,u]=this.translateFromRenderableToVisualIndex(s,o),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",c,u,l,a)},onBeforeDrawBorders:(s,o)=>{const[a,l,c,u]=s,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(c),this.hot.columnIndexMapper.getVisualFromRenderableIndex(u)];return this.hot.runHooks("beforeDrawBorders",h,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,o,a,l)=>{const c=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,h=o>=0?u.getVisualFromRenderableIndex(o):o,d=s>=0?c.getVisualFromRenderableIndex(s):s,f=this.hot.runHooks("modifyGetCellCoords",d,h,a,l);if(Array.isArray(f)){const[g,m,p,v]=f;return[g>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(g,1)):g,m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,p>=0?c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(p,-1)):p,v>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(v,-1)):v]}},onModifyGetCoordsElement:(s,o)=>{const a=this.hot.rowIndexMapper,l=this.hot.columnIndexMapper,c=o>=0?l.getVisualFromRenderableIndex(o):o,u=s>=0?a.getVisualFromRenderableIndex(s):s,h=this.hot.runHooks("modifyGetCoordsElement",u,c);if(Array.isArray(h)){const[d,f]=h;return[d>=0?a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(d,1)):d,f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f]}},viewportRowCalculatorOverride:s=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const a=this.countRenderableRows(),l=s.startRow,c=s.endRow;if(typeof o=="number")s.startRow=Math.max(l-o,0),s.endRow=Math.min(c+o,a-1);else if(o==="auto"){const u=Math.max(1,Math.ceil(c/a*12));s.startRow=Math.max(l-u,0),s.endRow=Math.min(c+u,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const a=this.countRenderableColumns(),l=s.startColumn,c=s.endColumn;if(typeof o=="number"&&(s.startColumn=Math.max(l-o,0),s.endColumn=Math.min(c+o,a-1)),o==="auto"){const u=Math.max(1,Math.ceil(c/a*6));s.startColumn=Math.max(l-u,0),s.endColumn=Math.min(c+u,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new jO(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:i,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,r),this.eventManager.addEventListener(n,"mousedown",s=>{s.target===n&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",s=>{s.target===n&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){var n,i;if(Jm(e))return!0;const r=wc(e,this._wt.wtTable.spreader);if(this.settings.fragmentSelection===!0&&r)return!0;const s=(n=(i=this.hot.getSelectedRangeActive())===null||i===void 0?void 0:i.isSingleCell())!==null&&n!==void 0?n:!1;return!!(this.settings.fragmentSelection==="cell"&&s&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&s)}isMouseDown(){return _n(_a,this)}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const i=n.firstChild;if(!Ee(i,"relative")){ca(n),this.appendRowHeader(e,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:i,getRowHeader:r}=this.hot,s=i.createElement("div"),o=i.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,r),s.appendChild(o),n.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(n.firstChild){const o=n.firstChild;Ee(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,i,r),o.className="",q(o,["relative",...s()])):(ca(n),this.appendColHeader(e,n,i,r))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),l=o.createElement("span"),c=s();a.classList.add("relative",...c),l.className="colHeader",this.settings.ariaTags&&(he(a,...Ja()),he(l,...Ja())),this.updateCellHeader(l,e,i,r),a.appendChild(l),n.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,n,r)}updateCellHeader(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=n;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Ee(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(n):Ee(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(n))),s>-1?$c(e,i(n,r)):(Tc(e,""),q(e,"cornerHeader"))}maximumVisibleElementWidth(e){const i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){const i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,n){cr(dx,this,e),cr(fx,this,n)}getLastSize(){return{width:_n(dx,this),height:_n(fx,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return _n(hx,this)}getRowHeadersCount(){return _n(Cv,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTotalTableWidth(){return this._wt.wtTable.getTotalWidth()}getTotalTableHeight(){return this._wt.wtTable.getTotalHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getTableScrollPosition(){return{left:this._wt.wtTable.holder.scrollLeft,top:this._wt.wtTable.holder.scrollTop}}setTableScrollPosition(e){this._wt.wtTable.holder.scrollLeft=e.left,this._wt.wtTable.holder.scrollTop=e.top}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function j5(){return parseInt(this.hot.rootElement.getAttribute(jS()[0]),10)}function rpe(t){const e=mf(Om,this,j5).call(this)+t;he(this.hot.rootElement,...jS(e))}function spe(){const t=this.hot.rootElement;this.hasVerticalScroll()?q(t,"htHasScrollY"):ue(t,"htHasScrollY"),this.isVerticallyScrollableByWindow()?q(t,"htVerticallyScrollableByWindow"):ue(t,"htVerticallyScrollableByWindow"),this.hasHorizontalScroll()?q(t,"htHasScrollX"):ue(t,"htHasScrollX"),this.isHorizontallyScrollableByWindow()?q(t,"htHorizontallyScrollableByWindow"):ue(t,"htHorizontallyScrollableByWindow")}var a2={},l2={},c2;function ope(){if(c2)return l2;c2=1;var t=Ot(),e=jn(),n=Qf(),i=Ar(),r=zn(),s=ha(),o=Ir(),a=Lc(),l=a("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{every:function(u){r(this);try{i(u)}catch(f){o(this,"throw",f)}if(l)return e(l,this,u);var h=s(this),d=0;return!n(h,function(f,g){if(!u(f,d++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),l2}var u2;function ape(){return u2||(u2=1,ope()),a2}ape();const z5="ABCDEFGHIJKLMNOPQRSTUVWXYZ",TP=z5.length;function e0(t){let e=t+1,n="",i;for(;e>0;)i=(e-1)%TP,n=String.fromCharCode(65+i)+n,e=parseInt((e-i)/TP,10);return n}function lpe(t){let e=0;if(t)for(let n=0,i=t.length-1;n<t.length;n+=1,i-=1)e+=TP**i*(z5.indexOf(t[n])+1);return e-=1,e}function cpe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let i,r;for(i=0;i<t;i++){const s=[];for(r=0;r<e;r++)s.push(e0(r)+(i+1));n.push(s)}return n}function upe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const n=[];let i,r;for(i=0;i<t;i++){const s={};for(r=0;r<e;r++)s[`prop${r}`]=e0(r)+(i+1);n.push(s)}return n}function hpe(t,e){const n=[];let i;for(let r=0;r<t;r++){i=[];for(let s=0;s<e;s++)i.push("");n.push(i)}return n}function UO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const i=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((r,s)=>{Array.isArray(r)?r.forEach((o,a)=>{i.push([s+e,a,o])}):Object.keys(r).forEach(o=>{i.push([s+e,o,r[o]])})}),i}function YO(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Re(t[0])&&(e=zS(t[0]))),e}function U5(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function Y5(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const dpe=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:YO,createEmptySpreadsheetData:hpe,createSpreadsheetData:cpe,createSpreadsheetObjectData:upe,dataRowToChangesArray:UO,isArrayOfArrays:U5,isArrayOfObjects:Y5,spreadsheetColumnIndex:lpe,spreadsheetColumnLabel:e0},Symbol.toStringTag,{value:"Module"}));function $g(t,e,n){return(e=fpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fpe(t){var e=gpe(t,"string");return typeof e=="symbol"?e:e+""}function gpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mpe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];$g(this,"hot",void 0),$g(this,"data",void 0),$g(this,"dataType","array"),$g(this,"colToProp",()=>{}),$g(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return k(this.data,(i,r)=>{const s=this.getAtCell(r,e);n.push(s)}),n}getAtRow(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=n===void 0&&i===void 0,{dataDotNotation:o}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],s?a.forEach((c,u)=>{l[u]=this.getAtPhysicalCell(e,u,a)}):pe(n,i,c=>{l[c-n]=this.getAtPhysicalCell(e,c,a)});else if(Re(a)||ht(a))if(r?l=[]:l={},!s||r){const u=this.countFirstRowKeys()-1;pe(0,u,h=>{const d=this.colToProp(h);if(h>=(n||0)&&h<=(i||u)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);r?l.push(f):o?ny(l,d,f):l[d]=f}})}else Ye(a,(c,u)=>{const h=this.getAtPhysicalCell(e,u,a);o?ny(l,u,h):l[u]=h});return l}setAtCell(e,n,i){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const r=xr(i);this.hot.runHooks("modifySourceData",e,n,r,"set"),r.isTouched()&&(i=r.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=i:ny(this.data[e],n,i))}}getAtPhysicalCell(e,n,i){let r=null;if(i)if(typeof n=="string"){const{dataDotNotation:s}=this.hot.getSettings();r=s?Jy(i,n):i[n]}else typeof n=="function"?r=n(i):r=i[n];if(this.hot.hasHook("modifySourceData")){const s=xr(r);this.hot.runHooks("modifySourceData",e,n,s,"get"),s.isTouched()&&(r=s.value)}return r}getAtCell(e,n){const i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=!1,s=null,o=null,a=null,l=null;e===null||n===null?(r=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,n.row),o=Math.min(e.col,n.col),a=Math.max(e.row,n.row),l=Math.max(e.col,n.col));const c=[];return pe(s,a,u=>{c.push(r?this.getAtRow(u,void 0,void 0,i):this.getAtRow(u,o,l,i))}),c}getCopyable(e,n){const i=this.propToCol(n);return this.hot.getCellMeta(e,i).copyable?this.getAtCell(this.hot.toPhysicalRow(e),i):""}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return YO(this.data)}destroy(){this.data=null,this.hot=null}}var h2={},d2={},f2;function ppe(){if(f2)return d2;f2=1;var t=Ot(),e=jn(),n=Qf(),i=Ar(),r=zn(),s=ha(),o=Ir(),a=Lc(),l=a("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:l},{some:function(u){r(this);try{i(u)}catch(f){o(this,"throw",f)}if(l)return e(l,this,u);var h=s(this),d=0;return n(h,function(f,g){if(u(f,d++))return g()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),d2}var g2;function wpe(){return g2||(g2=1,ppe()),h2}wpe();function m2(t,e,n){return(e=vpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vpe(t){var e=bpe(t,"string");return typeof e=="symbol"?e:e+""}function bpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zh{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;m2(this,"indexedValues",[]),m2(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,ht(this.initValueOrFn)?pe(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):pe(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}pt(zh,ti);function GO(t,e,n,i){const r=n.length?n[0]:void 0;return[...t.slice(0,r),...n.map((s,o)=>ht(i)?i(s,o):i),...r===void 0?[]:t.slice(r)]}function qO(t,e){return Ec(t,(n,i)=>e.includes(i)===!1)}class Fc extends zh{insert(e,n){this.indexedValues=GO(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=qO(this.indexedValues,e),super.remove(e)}}class t0 extends Fc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Un(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}function KO(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function Dp(t,e){return Ec(t,n=>e.includes(n)===!1)}function XO(t,e){return lt(t,n=>n-e.filter(i=>i<n).length)}function JO(t,e){const n=e[0],i=e.length;return lt(t,r=>r>=n?r+i:r)}function ype(t,e,n){return(e=Cpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cpe(t){var e=Spe(t,"string");return typeof e=="symbol"?e:e+""}function Spe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class n0 extends zh{constructor(){super(...arguments),ype(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Dp(this.orderOfIndexes,[e]),ht(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=GO(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=JO(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=qO(this.indexedValues,e),this.orderOfIndexes=Dp(this.orderOfIndexes,e),this.orderOfIndexes=XO(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Aw extends Fc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Un(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}const p2=new Map([["indexesSequence",{getListWithInsertedItems:KO,getListWithRemovedItems:Dp}],["physicallyIndexed",{getListWithInsertedItems:GO,getListWithRemovedItems:qO}]]),G5=t=>{if(p2.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return p2.get(t)};class q5 extends zh{constructor(){super(e=>e)}insert(e,n){const i=JO(this.indexedValues,n);this.indexedValues=KO(i,e,n),super.insert(e,n)}remove(e){const n=Dp(this.indexedValues,e);this.indexedValues=XO(n,e),super.remove(e)}}const w2=new Map([["hiding",t0],["index",zh],["linkedPhysicalIndexToValue",n0],["physicalIndexToValue",Fc],["trimming",Aw]]);function Rpe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!w2.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(w2.get(t))(e)}function _pe(t,e,n){return(e=Epe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Epe(t){var e=xpe(t,"string");return typeof e=="symbol"?e:e+""}function xpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let MP=0;class ZO{constructor(){_pe(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)),MP+=1)}unregister(e){const n=this.collection.get(e);se(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n),MP-=1)}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return Nt(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(i=>{i.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}pt(ZO,ti);function Tpe(){return MP}function gx(t,e,n){return(e=Mpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mpe(t){var e=Ppe(t,"string");return typeof e=="symbol"?e:e+""}function Ppe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class v2 extends ZO{constructor(e,n){super(),gx(this,"mergedValuesCache",[]),gx(this,"aggregationFunction",void 0),gx(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=lt(this.get(),s=>s.getValues()),i=[],r=se(n[0])&&n[0].length||0;for(let s=0;s<r;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(n[a][s]);i.push(o)}return lt(i,this.aggregationFunction)}getMergedValueAtIndex(e,n){const i=this.getMergedValues(n)[e];return se(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function Ape(t,e,n){Ipe(t,e),e.set(t,n)}function Ipe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ope(t,e,n){return t.set(K5(t,e),n),n}function Hpe(t,e){return t.get(K5(t,e))}function K5(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var mx=new WeakMap;class X5{constructor(){Ape(this,mx,[])}subscribe(e){return this.addLocalHook("change",e),this._write(Hpe(mx,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Ope(mx,this,e)}}pt(X5,ti);function b2(t,e){const n=[];let i=0,r=0;for(;i<t.length&&r<e.length;i++,r++)t[i]!==e[r]&&n.push({op:"replace",index:r,oldValue:t[i],newValue:e[r]});for(;i<e.length;i++)n.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;r<t.length;r++)n.push({op:"remove",index:r,oldValue:t[r],newValue:void 0});return n}function Fg(t,e,n){kpe(t,e),e.set(t,n)}function kpe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fs(t,e){return t.get(J5(t,e))}function Rv(t,e,n){return t.set(J5(t,e),n),n}function J5(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _v=new WeakMap,Vg=new WeakMap,Ev=new WeakMap,xv=new WeakMap,Tv=new WeakMap;class Dpe{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Fg(this,_v,new Set),Fg(this,Vg,[]),Fg(this,Ev,[]),Fg(this,xv,!1),Fg(this,Tv,!1),Rv(Tv,this,e??!1)}createObserver(){const e=new X5;return fs(_v,this).add(e),e.addLocalHook("unsubscribe",()=>{fs(_v,this).delete(e)}),e._writeInitialChanges(b2(fs(Vg,this),fs(Ev,this))),e}emit(e){let n=fs(Ev,this);(!fs(xv,this)||fs(Vg,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(fs(Tv,this)):Rv(Vg,this,new Array(e.length).fill(fs(Tv,this))),fs(xv,this)||(Rv(xv,this,!0),n=fs(Vg,this)));const i=b2(n,e);fs(_v,this).forEach(r=>r._write(i)),Rv(Ev,this,e)}}function Wi(t,e,n){return(e=Npe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Npe(t){var e=Lpe(t,"string");return typeof e=="symbol"?e:e+""}function Lpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PP{constructor(){Wi(this,"indexesSequence",new q5),Wi(this,"trimmingMapsCollection",new v2(e=>e.some(n=>n===!0),!1)),Wi(this,"hidingMapsCollection",new v2(e=>e.some(n=>n===!0),!1)),Wi(this,"variousMapsCollection",new ZO),Wi(this,"hidingChangesObservable",new Dpe({initialIndexValue:!1})),Wi(this,"notTrimmedIndexesCache",[]),Wi(this,"notHiddenIndexesCache",[]),Wi(this,"isBatched",!1),Wi(this,"indexesSequenceChanged",!1),Wi(this,"indexesChangeSource",void 0),Wi(this,"trimmedIndexesChanged",!1),Wi(this,"hiddenIndexesChanged",!1),Wi(this,"renderablePhysicalIndexesCache",[]),Wi(this,"fromPhysicalToVisualIndexesCache",new Map),Wi(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,i){return this.registerMap(e,Rpe(n,i))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Aw?this.trimmingMapsCollection.register(e,n):n instanceof t0?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const i=this.getNumberOfIndexes();return i>0&&n.init(i),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return se(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return se(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return se(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return se(n)?n:null}getNearestNotHiddenIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return n>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?i?this.getNearestNotHiddenIndex(e,-n,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const i=[...Array(this.getNumberOfIndexes()-e).keys()].map(r=>r+e);this.removeIndexes(i)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const i=lt(e,c=>this.getPhysicalFromVisualIndex(c)),r=this.getNotTrimmedIndexesLength(),s=e.length,o=Dp(this.getIndexesSequence(),i),a=o.filter(c=>this.isTrimmed(c)===!1);let l=o.indexOf(a[a.length-1])+1;if(n+s<r){const c=a[n];l=o.indexOf(c)}this.indexesChangeSource="move",this.setIndexesSequence(KO(o,l,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const r=this.getNotTrimmedIndexes()[e],s=se(r)?r:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),a=lt(new Array(n).fill(s),(c,u)=>c+u);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,a),this.indexesChangeSource=void 0;const l=i==="end"?a.map(c=>c+1):a;this.trimmingMapsCollection.insertToEvery(o,l),this.hidingMapsCollection.insertToEvery(o,l),this.variousMapsCollection.insertToEvery(o,l),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromRenderableIndex(n),r=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(r,n)}}}pt(PP,ti);function $pe(t,e){return Ye(e,(n,i)=>{Nt(t[i])&&(t[i]=n)}),t}function Z5(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function Q5(t){se(t)&&_O(ct`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Fpe(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}function e3(t,e){return Array.isArray(t)?t.map(n=>e3(n,e)):BS(t,e)}const{register:Vpe,getValues:Bpe}=ks("phraseFormatters");function t3(t,e){Vpe(t,e)}function Wpe(){return Bpe()}t3("pluralize",Fpe);t3("substitute",e3);const QO="Common:",sC=`${QO}ok`,e1=`${QO}cancel`,n3="ContextMenu:items",Le=n3,t1=`${Le}.noItems`,n1=`${Le}.insertRowAbove`,i1=`${Le}.insertRowBelow`,r1=`${Le}.insertColumnOnTheLeft`,s1=`${Le}.insertColumnOnTheRight`,o1=`${Le}.removeRow`,a1=`${Le}.removeColumn`,l1=`${Le}.undo`,c1=`${Le}.redo`,oC=`${Le}.readOnly`,u1=`${Le}.clearColumn`,h1=`${Le}.copy`,d1=`${Le}.copyWithHeaders`,f1=`${Le}.copyWithGroupHeaders`,g1=`${Le}.copyHeadersOnly`,m1=`${Le}.cut`,p1=`${Le}.freezeColumn`,w1=`${Le}.unfreezeColumn`,v1=`${Le}.mergeCells`,b1=`${Le}.unmergeCells`,y1=`${Le}.addComment`,C1=`${Le}.editComment`,S1=`${Le}.removeComment`,R1=`${Le}.readOnlyComment`,_1=`${Le}.align`,E1=`${Le}.align.left`,x1=`${Le}.align.center`,T1=`${Le}.align.right`,M1=`${Le}.align.justify`,P1=`${Le}.align.top`,A1=`${Le}.align.middle`,I1=`${Le}.align.bottom`,O1=`${Le}.borders`,H1=`${Le}.borders.top`,k1=`${Le}.borders.right`,D1=`${Le}.borders.bottom`,N1=`${Le}.borders.left`,L1=`${Le}.borders.remove`,$1=`${Le}.nestedHeaders.insertChildRow`,F1=`${Le}.nestedHeaders.detachFromParent`,V1=`${Le}.hideColumn`,B1=`${Le}.showColumn`,W1=`${Le}.hideRow`,j1=`${Le}.showRow`,sr="Filters:",dn=`${sr}conditions`,i0=`${dn}.none`,z1=`${dn}.isEmpty`,U1=`${dn}.isNotEmpty`,Y1=`${dn}.isEqualTo`,G1=`${dn}.isNotEqualTo`,q1=`${dn}.beginsWith`,K1=`${dn}.endsWith`,X1=`${dn}.contains`,J1=`${dn}.doesNotContain`,jpe=`${dn}.byValue`,Z1=`${dn}.greaterThan`,Q1=`${dn}.greaterThanOrEqualTo`,eH=`${dn}.lessThan`,tH=`${dn}.lessThanOrEqualTo`,nH=`${dn}.isBetween`,iH=`${dn}.isNotBetween`,rH=`${dn}.after`,sH=`${dn}.before`,oH=`${dn}.today`,aH=`${dn}.tomorrow`,lH=`${dn}.yesterday`,cH=`${sr}labels.filterByCondition`,uH=`${sr}labels.filterByValue`,hH=`${sr}labels.conjunction`,r0=`${sr}labels.disjunction`,aC=`${sr}values.blankCells`,dH=`${sr}buttons.selectAll`,fH=`${sr}buttons.clear`,gH=`${sr}buttons.ok`,mH=`${sr}buttons.cancel`,pH=`${sr}buttons.placeholder.search`,wH=`${sr}buttons.placeholder.value`,vH=`${sr}buttons.placeholder.secondValue`,ma="Pagination:",bH=`${ma}section.pagination`,yH=`${ma}.pageSize.auto`,lC=`${ma}section.pageSize`,CH=`${ma}section.counter`,SH=`${ma}section.navigation`,RH=`${ma}firstPage`,_H=`${ma}prevPage`,EH=`${ma}nextPage`,xH=`${ma}lastPage`,TH="CheckboxRenderer:",MH=`${TH}checked`,PH=`${TH}unchecked`,i3="Loading:",AH=`${i3}title`,og="EmptyDataState:",IH=`${og}title`,OH=`${og}description`,HH=`${og}title.filters`,kH=`${og}description.filters`,DH=`${og}buttons.filters.reset`,zpe=Object.freeze(Object.defineProperty({__proto__:null,CANCEL:e1,CHECKBOX_CHECKED:MH,CHECKBOX_RENDERER_NAMESPACE:TH,CHECKBOX_UNCHECKED:PH,COMMON_NAMESPACE:QO,CONTEXTMENU_ITEMS_ADD_COMMENT:y1,CONTEXTMENU_ITEMS_ALIGNMENT:_1,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:I1,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:x1,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:M1,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:E1,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:A1,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:T1,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:P1,CONTEXTMENU_ITEMS_BORDERS:O1,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:D1,CONTEXTMENU_ITEMS_BORDERS_LEFT:N1,CONTEXTMENU_ITEMS_BORDERS_RIGHT:k1,CONTEXTMENU_ITEMS_BORDERS_TOP:H1,CONTEXTMENU_ITEMS_CLEAR_COLUMN:u1,CONTEXTMENU_ITEMS_COPY:h1,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:g1,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:f1,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:d1,CONTEXTMENU_ITEMS_CUT:m1,CONTEXTMENU_ITEMS_EDIT_COMMENT:C1,CONTEXTMENU_ITEMS_FREEZE_COLUMN:p1,CONTEXTMENU_ITEMS_HIDE_COLUMN:V1,CONTEXTMENU_ITEMS_HIDE_ROW:W1,CONTEXTMENU_ITEMS_INSERT_LEFT:r1,CONTEXTMENU_ITEMS_INSERT_RIGHT:s1,CONTEXTMENU_ITEMS_MERGE_CELLS:v1,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:F1,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:$1,CONTEXTMENU_ITEMS_NO_ITEMS:t1,CONTEXTMENU_ITEMS_READ_ONLY:oC,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:R1,CONTEXTMENU_ITEMS_REDO:c1,CONTEXTMENU_ITEMS_REMOVE_BORDERS:L1,CONTEXTMENU_ITEMS_REMOVE_COLUMN:a1,CONTEXTMENU_ITEMS_REMOVE_COMMENT:S1,CONTEXTMENU_ITEMS_REMOVE_ROW:o1,CONTEXTMENU_ITEMS_ROW_ABOVE:n1,CONTEXTMENU_ITEMS_ROW_BELOW:i1,CONTEXTMENU_ITEMS_SHOW_COLUMN:B1,CONTEXTMENU_ITEMS_SHOW_ROW:j1,CONTEXTMENU_ITEMS_UNDO:l1,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:w1,CONTEXTMENU_ITEMS_UNMERGE_CELLS:b1,CONTEXT_MENU_ITEMS_NAMESPACE:n3,EMPTY_DATA_STATE_BUTTONS_FILTERS_RESET:DH,EMPTY_DATA_STATE_DESCRIPTION:OH,EMPTY_DATA_STATE_DESCRIPTION_FILTERS:kH,EMPTY_DATA_STATE_NAMESPACE:og,EMPTY_DATA_STATE_TITLE:IH,EMPTY_DATA_STATE_TITLE_FILTERS:HH,FILTERS_BUTTONS_CANCEL:mH,FILTERS_BUTTONS_CLEAR:fH,FILTERS_BUTTONS_OK:gH,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:pH,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:vH,FILTERS_BUTTONS_PLACEHOLDER_VALUE:wH,FILTERS_BUTTONS_SELECT_ALL:dH,FILTERS_CONDITIONS_AFTER:rH,FILTERS_CONDITIONS_BEFORE:sH,FILTERS_CONDITIONS_BEGINS_WITH:q1,FILTERS_CONDITIONS_BETWEEN:nH,FILTERS_CONDITIONS_BY_VALUE:jpe,FILTERS_CONDITIONS_CONTAINS:X1,FILTERS_CONDITIONS_EMPTY:z1,FILTERS_CONDITIONS_ENDS_WITH:K1,FILTERS_CONDITIONS_EQUAL:Y1,FILTERS_CONDITIONS_GREATER_THAN:Z1,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:Q1,FILTERS_CONDITIONS_LESS_THAN:eH,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:tH,FILTERS_CONDITIONS_NAMESPACE:dn,FILTERS_CONDITIONS_NONE:i0,FILTERS_CONDITIONS_NOT_BETWEEN:iH,FILTERS_CONDITIONS_NOT_CONTAIN:J1,FILTERS_CONDITIONS_NOT_EMPTY:U1,FILTERS_CONDITIONS_NOT_EQUAL:G1,FILTERS_CONDITIONS_TODAY:oH,FILTERS_CONDITIONS_TOMORROW:aH,FILTERS_CONDITIONS_YESTERDAY:lH,FILTERS_DIVS_FILTER_BY_CONDITION:cH,FILTERS_DIVS_FILTER_BY_VALUE:uH,FILTERS_LABELS_CONJUNCTION:hH,FILTERS_LABELS_DISJUNCTION:r0,FILTERS_NAMESPACE:sr,FILTERS_VALUES_BLANK_CELLS:aC,LOADING_NAMESPACE:i3,LOADING_TITLE:AH,OK:sC,PAGINATION_COUNTER_SECTION:CH,PAGINATION_FIRST_PAGE:RH,PAGINATION_LAST_PAGE:xH,PAGINATION_NAMESPACE:ma,PAGINATION_NAV_SECTION:SH,PAGINATION_NEXT_PAGE:EH,PAGINATION_PAGE_SIZE_AUTO:yH,PAGINATION_PAGE_SIZE_SECTION:lC,PAGINATION_PREV_PAGE:_H,PAGINATION_SECTION:bH},Symbol.toStringTag,{value:"Module"}));const r3={languageCode:"en-US",[sC]:"OK",[e1]:"Cancel",[t1]:"No available options",[n1]:"Insert row above",[i1]:"Insert row below",[r1]:"Insert column left",[s1]:"Insert column right",[o1]:["Remove row","Remove rows"],[a1]:["Remove column","Remove columns"],[l1]:"Undo",[c1]:"Redo",[oC]:"Read only",[u1]:"Clear column",[_1]:"Alignment",[E1]:"Left",[x1]:"Center",[T1]:"Right",[M1]:"Justify",[P1]:"Top",[A1]:"Middle",[I1]:"Bottom",[p1]:"Freeze column",[w1]:"Unfreeze column",[O1]:"Borders",[H1]:"Top",[k1]:"Right",[D1]:"Bottom",[N1]:"Left",[L1]:"Remove border(s)",[y1]:"Add comment",[C1]:"Edit comment",[S1]:"Delete comment",[R1]:"Read-only comment",[v1]:"Merge cells",[b1]:"Unmerge cells",[h1]:"Copy",[d1]:["Copy with header","Copy with headers"],[f1]:["Copy with group header","Copy with group headers"],[g1]:["Copy header only","Copy headers only"],[m1]:"Cut",[$1]:"Insert child row",[F1]:"Detach from parent",[V1]:["Hide column","Hide columns"],[B1]:["Show column","Show columns"],[W1]:["Hide row","Hide rows"],[j1]:["Show row","Show rows"],[i0]:"None",[z1]:"Is empty",[U1]:"Is not empty",[Y1]:"Is equal to",[G1]:"Is not equal to",[q1]:"Begins with",[K1]:"Ends with",[X1]:"Contains",[J1]:"Does not contain",[Z1]:"Greater than",[Q1]:"Greater than or equal to",[eH]:"Less than",[tH]:"Less than or equal to",[nH]:"Is between",[iH]:"Is not between",[rH]:"After",[sH]:"Before",[oH]:"Today",[aH]:"Tomorrow",[lH]:"Yesterday",[aC]:"Blank cells",[cH]:"Filter by condition",[uH]:"Filter by value",[hH]:"And",[r0]:"Or",[dH]:"Select all",[fH]:"Clear",[gH]:"OK",[mH]:"Cancel",[pH]:"Search",[wH]:"Value",[vH]:"Second value",[bH]:"Pagination",[lC]:"Page size",[yH]:"Auto",[CH]:"[start] - [end] of [total]",[SH]:"Page [currentPage] of [totalPages]",[RH]:"Go to first page",[_H]:"Go to previous page",[EH]:"Go to next page",[xH]:"Go to last page",[MH]:"Checked",[PH]:"Unchecked",[AH]:"Loading...",[IH]:"No data available",[OH]:"Theres nothing to display yet.",[HH]:"No results found",[kH]:"It looks like your current filters are hiding all results.",[DH]:"Reset filters"},Upe=zpe,AP=r3.languageCode,{register:Ype,getItem:s3,hasItem:Gpe,getValues:qpe}=ks("languagesDictionaries");o3(r3);function o3(t,e){let n=t,i=e;return Re(t)&&(i=t,n=i.languageCode),Kpe(n,i),Ype(n,Vi(i)),Vi(i)}function Kpe(t,e){t!==AP&&$pe(e,s3(AP))}function a3(t){return NH(t)?Vi(s3(t)):null}function NH(t){return Gpe(t)}function Xpe(){return qpe()}function l3(t,e,n){const i=a3(t);if(i===null)return null;const r=i[e];if(Nt(r))return null;const s=Jpe(r,n);return Array.isArray(s)?s[0]:s}function Jpe(t,e){return Wpe().reduce((n,i)=>i(n,e),t)}function Zpe(t){let e=Z5(t);return NH(e)||(e=AP,Q5(t)),e}function Qpe(t,e,n){return(e=ewe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ewe(t){var e=twe(t,"string");return typeof e=="symbol"?e:e+""}function twe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ml extends N5{constructor(e,n){super(e,null),Qpe(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:i}=e,r=this.getNearestNotHiddenCoords(n,1),s=this.getNearestNotHiddenCoords(i,-1);return r===null||s===null?null:((r.row>s.row||r.col>s.col)&&(r=n,s=i),this.settings.createCellRange(r,r,s))}getNearestNotHiddenCoords(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(r===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return s===null?null:this.settings.createCellCoords(r,s)}getNearestNotHiddenIndex(e,n,i){return n<0?n:e.getNearestNotHiddenIndex(n,i)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),i=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((s===null||s.col===null||s.row===null)&&(o=this.getNearestNotHiddenCoords(n,i,r)),o!==null&&e.overlaps(o)){const a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&s!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const i=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(n);return i.row===null||i.col===null||r.row===null||r.col===null?null:this.settings.createCellRange(i,i,r)}}function px(t){let{activeHeaderClassName:e,...n}=t;return new ml({className:e,...n,selectionType:L5})}function nwe(t){let{areaCornerVisible:e,...n}=t;return new ml({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:NO})}function iwe(t){let{...e}=t;return new ml({className:"highlight",...e,selectionType:NO})}function rwe(t){let{columnClassName:e,...n}=t;return new ml({className:e,...n,selectionType:Cme})}function swe(t){let{cellCornerVisible:e,...n}=t;return new ml({className:"current",headerAttributes:[lO()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:rC})}function owe(t){let{border:e,visualCellRange:n,...i}=t;return new ml({...e,...i,selectionType:Sme},n)}function awe(t){let{...e}=t;return new ml({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:bme})}function y2(t){let{headerClassName:e,...n}=t;return new ml({className:e,...n,selectionType:DO})}function lwe(t){let{rowClassName:e,...n}=t;return new ml({className:e,...n,selectionType:yme})}function cwe(t,e){uwe(t,e),e.add(t)}function uwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ur(t,e,n){return(e=hwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hwe(t){var e=dwe(t,"string");return typeof e=="symbol"?e:e+""}function dwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ea(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var So=new WeakSet;class fwe{constructor(e){cwe(this,So),ur(this,"options",void 0),ur(this,"layerLevel",0),ur(this,"focus",void 0),ur(this,"fill",void 0),ur(this,"layeredAreas",new Map),ur(this,"areas",new Map),ur(this,"rowHeaders",new Map),ur(this,"columnHeaders",new Map),ur(this,"activeRowHeaders",new Map),ur(this,"activeColumnHeaders",new Map),ur(this,"activeCornerHeaders",new Map),ur(this,"rowHighlights",new Map),ur(this,"columnHighlights",new Map),ur(this,"customSelections",[]),this.options=e,this.focus=swe(e),this.fill=awe(e)}isEnabledFor(e,n){let i=e;e===rC&&(i="current");let r=this.options.disabledCellSelection(n.row,n.col);return typeof r=="string"&&(r=[r]),r===!1||Array.isArray(r)&&!r.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Ea(So,this,xa).call(this,this.layeredAreas,nwe)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Ea(So,this,xa).call(this,this.areas,iwe)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Ea(So,this,xa).call(this,this.rowHeaders,y2)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Ea(So,this,xa).call(this,this.columnHeaders,y2)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Ea(So,this,xa).call(this,this.activeRowHeaders,px)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Ea(So,this,xa).call(this,this.activeColumnHeaders,px)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Ea(So,this,xa).call(this,this.activeCornerHeaders,px)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Ea(So,this,xa).call(this,this.rowHighlights,lwe)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Ea(So,this,xa).call(this,this.columnHighlights,rwe)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(owe({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),k(this.areas.values(),e=>{e.clear()}),k(this.layeredAreas.values(),e=>{e.clear()}),k(this.rowHeaders.values(),e=>{e.clear()}),k(this.columnHeaders.values(),e=>{e.clear()}),k(this.activeRowHeaders.values(),e=>{e.clear()}),k(this.activeColumnHeaders.values(),e=>{e.clear()}),k(this.activeCornerHeaders.values(),e=>{e.clear()}),k(this.rowHighlights.values(),e=>{e.clear()}),k(this.columnHighlights.values(),e=>{e.clear()})}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function xa(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const i=e({layerLevel:n,...this.options});return t.set(n,i),i}function C2(t,e,n){return(e=gwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gwe(t){var e=mwe(t,"string");return typeof e=="symbol"?e:e+""}function mwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LH{constructor(e){C2(this,"ranges",[]),C2(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}push(e){return this.ranges.push(e),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((i,r)=>i.includes(e)&&n(i,r))}findAll(e){const n=[];return this.ranges.forEach((i,r)=>{i.isEqual(e)&&n.push({range:i,layer:r})}),n}remove(e){return this.ranges=this.ranges.filter(n=>!e.some(i=>i.isEqual(n))),this}removeLayers(e){return this.ranges=this.ranges.filter((n,i)=>!e.includes(i)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new LH(this.createCellRange);return e.ranges=this.ranges.map(n=>n.clone()),e}map(e){return this.ranges=this.ranges.map((n,i)=>e(n,i)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function pwe(t,e){c3(t,e),e.add(t)}function wwe(t,e,n){return(e=vwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vwe(t){var e=bwe(t,"string");return typeof e=="symbol"?e:e+""}function bwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wx(t,e,n){c3(t,e),e.set(t,n)}function c3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bn(t,e){return t.get(vt(t,e))}function Zd(t,e,n){return t.set(vt(t,e),n),n}function vt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ba=new WeakMap,Bu=new WeakMap,Zr=new WeakMap,St=new WeakSet;class $H{constructor(e,n){pwe(this,St),wx(this,Ba,void 0),wx(this,Bu,0),wx(this,Zr,{x:0,y:0}),wwe(this,"tableApi",void 0),Zd(Ba,this,e),this.tableApi=n}setActiveLayerIndex(e){Zd(Bu,this,e)}getCurrentSelection(){return Bn(Ba,this).peekByIndex(Bn(Bu,this))}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Zd(Zr,this,this.calculateOffset());const r=this.tableApi.createCellCoords(e,n);let s=this.getCurrentSelection().highlight;const o=this.tableApi.visualToRenderableCoords(s);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",r),o.row!==null&&o.col!==null){let{width:c,height:u}=vt(St,this,IP).call(this);const{row:h,col:d}=vt(St,this,E2).call(this,s),f=this.tableApi.fixedRowsBottom(),g=this.tableApi.minSpareRows(),m=this.tableApi.minSpareCols(),p=this.tableApi.autoWrapRow(),v=this.tableApi.autoWrapCol(),b=this.tableApi.createCellCoords(h+r.row,d+r.col);if(b.row>=u){const x=xr(i&&g>0&&f===0),M=b.col+1,T=M>=c,O=this.tableApi.createCellCoords(b.row-u,T?M-c:M);if(this.runLocalHooks("beforeColumnWrap",x,vt(St,this,od).call(this,O),T),x.value)this.runLocalHooks("insertRowRequire",this.countRenderableRows());else if(v){if(this.shouldSwitchSelectionLayer()&&T&&Bn(Ba,this).size()>1){vt(St,this,S2).call(this);const W=vt(St,this,Mv).call(this,"forward");W!==null&&O.assign(W)}b.assign(O)}}else if(b.row<0){const x=xr(v),M=b.col-1,T=M<0,O=this.tableApi.createCellCoords(u+b.row,T?c+M:M);if(this.runLocalHooks("beforeColumnWrap",x,vt(St,this,od).call(this,O),T),v){if(this.shouldSwitchSelectionLayer()&&T&&Bn(Ba,this).size()>1){vt(St,this,R2).call(this);const W=vt(St,this,Mv).call(this,"backward");W!==null&&O.assign(W)}b.assign(O)}}if({width:c,height:u}=vt(St,this,IP).call(this),b.col>=c){const x=xr(i&&m>0),M=b.row+1,T=M>=u,O=this.tableApi.createCellCoords(T?M-u:M,b.col-c);if(this.runLocalHooks("beforeRowWrap",x,vt(St,this,od).call(this,O),T),x.value)this.runLocalHooks("insertColRequire",this.countRenderableColumns());else if(p){if(this.shouldSwitchSelectionLayer()&&T&&Bn(Ba,this).size()>1){vt(St,this,S2).call(this);const W=vt(St,this,Mv).call(this,"forward");W!==null&&O.assign(W)}b.assign(O)}}else if(b.col<0){const x=xr(p),M=b.row-1,T=M<0,O=this.tableApi.createCellCoords(T?u+M:M,c+b.col);if(this.runLocalHooks("beforeRowWrap",x,vt(St,this,od).call(this,O),T),p){if(this.shouldSwitchSelectionLayer()&&T&&Bn(Ba,this).size()>1){vt(St,this,R2).call(this);const W=vt(St,this,Mv).call(this,"backward");W!==null&&O.assign(W)}b.assign(O)}}const{rowDir:R,colDir:S}=vt(St,this,_2).call(this,b);a=R,l=S,s=vt(St,this,od).call(this,b)}return this.runLocalHooks("afterTransformStart",s,a,l),{selectionLayer:Bn(Bu,this),visualCoords:s}}transformEnd(e,n){Zd(Zr,this,this.calculateOffset());const i=this.tableApi.createCellCoords(e,n),r=this.getCurrentSelection(),s=this.tableApi.visualToRenderableCoords(r.highlight),o=vt(St,this,sy).call(this,r.to.row,r.from.row),a=vt(St,this,oy).call(this,r.to.col,r.from.col),l=r.to.clone();let c=0,u=0;if(this.runLocalHooks("beforeTransformEnd",i),s.row!==null&&s.col!==null&&o!==null&&a!==null){const{row:h,col:d}=vt(St,this,E2).call(this,r.highlight),f=this.tableApi.createCellCoords(o+i.row,a+i.col),g=r.getTopStartCorner(),m=r.getTopEndCorner(),p=r.getBottomEndCorner();if(i.col<0&&a>=d&&f.col<d){const S=f.col-d;f.col=vt(St,this,oy).call(this,g.col,m.col)+S}else if(i.col>0&&a<=d&&f.col>d){const S=vt(St,this,oy).call(this,m.col,g.col),x=Math.max(f.col-S,1);f.col=S+x}if(i.row<0&&o>=h&&f.row<h){const S=f.row-h;f.row=vt(St,this,sy).call(this,g.row,p.row)+S}else if(i.row>0&&o<=h&&f.row>h){const S=vt(St,this,sy).call(this,p.row,g.row),x=Math.max(f.row-S,1);f.row=S+x}const{rowDir:v,colDir:b}=vt(St,this,_2).call(this,f);c=v,u=b;const R=vt(St,this,od).call(this,f);i.row===0&&i.col!==0?l.col=R.col:i.row!==0&&i.col===0?l.row=R.row:(l.row=R.row,l.col=R.col)}return this.runLocalHooks("afterTransformEnd",l,c,u),{selectionLayer:Bn(Bu,this),visualCoords:l}}calculateOffset(){throw new Error("`calculateOffset` is not implemented")}countRenderableRows(){throw new Error("`countRenderableRows` is not implemented")}countRenderableColumns(){throw new Error("`countRenderableColumns` is not implemented")}shouldSwitchSelectionLayer(){throw new Error("`shouldSwitchSelectionLayer` is not implemented")}}function S2(){const t=Bn(Bu,this)+1;this.setActiveLayerIndex(t>=Bn(Ba,this).size()?0:t),Zd(Zr,this,this.calculateOffset())}function R2(){const t=Bn(Bu,this)-1;this.setActiveLayerIndex(t<0?Bn(Ba,this).size()-1:t),Zd(Zr,this,this.calculateOffset())}function _2(t){const{width:e,height:n}=vt(St,this,IP).call(this);let i=0,r=0;return t.row<0?(i=-1,t.row=0):t.row>0&&t.row>=n&&(i=1,t.row=n-1),t.col<0?(r=-1,t.col=0):t.col>0&&t.col>=e&&(r=1,t.col=e-1),{rowDir:i,colDir:r}}function IP(){return{width:Bn(Zr,this).x+this.countRenderableColumns(),height:Bn(Zr,this).y+this.countRenderableRows()}}function Mv(t){if(!["forward","backward"].includes(t))return null;const e=this.getCurrentSelection().getTopStartCorner(),n=this.getCurrentSelection().getBottomEndCorner(),[i,r,s,o]=t==="forward"?[e.row,n.row,e.col,n.col]:[n.row,e.row,n.col,e.col],a=vt(St,this,sy).call(this,i,r),l=vt(St,this,oy).call(this,s,o);return a===null||l===null?null:this.tableApi.createCellCoords(a,l)}function sy(t,e){const n=this.tableApi.findFirstNonHiddenRenderableRow(t,e);return n===null?null:Bn(Zr,this).y+n}function oy(t,e){const n=this.tableApi.findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Bn(Zr,this).x+n}function E2(t){const{row:e,col:n}=this.tableApi.visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return this.tableApi.createCellCoords(Bn(Zr,this).y+e,Bn(Zr,this).x+n)}function od(t){const e=t.clone();return e.col=t.col-Bn(Zr,this).x,e.row=t.row-Bn(Zr,this).y,this.tableApi.renderableToVisualCoords(e)}pt($H,ti);class ywe extends $H{calculateOffset(){return{x:this.tableApi.navigableHeaders()?this.tableApi.countRowHeaders():0,y:this.tableApi.navigableHeaders()?this.tableApi.countColHeaders():0}}countRenderableRows(){return this.tableApi.countRenderableRows()}countRenderableColumns(){return this.tableApi.countRenderableColumns()}shouldSwitchSelectionLayer(){return!1}}class Cwe extends $H{calculateOffset(){const e=this.getCurrentSelection(),{row:n,col:i}=e.getOuterTopStartCorner(),r=this.tableApi.countRenderableColumnsInRange(0,i-1),s=this.tableApi.countRenderableRowsInRange(0,n-1),o=e.highlight.isHeader(),a=o?Math.abs(i):0,l=o?Math.abs(n):0;return{x:i<0?a:-r,y:n<0?l:-s}}countRenderableRows(){const e=this.getCurrentSelection();return this.tableApi.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)}countRenderableColumns(){const e=this.getCurrentSelection();return this.tableApi.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)}transformEnd(){throw new Error("`transformEnd` is not valid for focus selection use `transformStart` instead")}shouldSwitchSelectionLayer(){return!0}}const s0=0,o0=1,u3=2,FH=3,Swe=[FH,u3],Rwe=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],vx=Symbol("root"),x2=Symbol("child");function Of(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vx;if(e!==vx&&e!==x2)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),i=e===vx;let r=s0;if(n){const s=t[0];t.length===0?r=o0:i&&s instanceof rg?r=FH:i&&Array.isArray(s)?r=Of(s,x2):t.length>=2&&t.length<=4&&!t.some((a,l)=>!Rwe[l].includes(typeof a))&&(r=u3)}return r}function Np(t){let{createCellCoords:e,createCellRange:n,keepDirection:i=!1,propToCol:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Swe.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=t===FH;let a=o?s.from.row:s[0],l=o?s.from.col:s[1],c=o?s.to.row:s[2],u=o?s.to.col:s[3];if(typeof r=="function"&&(typeof l=="string"&&(l=r(l)),typeof u=="string"&&(u=r(u))),Nt(c)&&(c=a),Nt(u)&&(u=l),!i){const g=a,m=l,p=c,v=u;a=Math.min(g,p),l=Math.min(m,v),c=Math.max(g,p),u=Math.max(m,v)}const h=o?s.highlight.clone():e(a,l),d=e(a,l),f=e(c,u);return n(h,d,f)}}function _we(t){const e=Of(t.getSelected());if(e===s0||e===o0)return[];const n=Np(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;k(t.getSelected(),o=>{const{from:a,to:l}=n(o),c=Math.max(a.col,0),u=l.col-c+1;k(Array.from(new Array(u),(h,d)=>c+d),h=>{i.has(h)||i.add(h)})});const r=Array.from(i).sort((o,a)=>o-a);return Un(r,(o,a,l,c)=>(l!==0&&a===c[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function Ewe(t){const e=Of(t.getSelected());if(e===s0||e===o0)return[];const n=Np(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;k(t.getSelected(),o=>{const{from:a,to:l}=n(o),c=Math.max(a.row,0),u=l.row-c+1;k(Array.from(new Array(u),(h,d)=>c+d),h=>{i.has(h)||i.add(h)})});const r=Array.from(i).sort((o,a)=>o-a);return Un(r,(o,a,l,c)=>(l!==0&&a===c[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function Zc(t,e,n){xwe(t,e),e.set(t,n)}function xwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qc(t,e,n){return(e=Twe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Twe(t){var e=Mwe(t,"string");return typeof e=="symbol"?e:e+""}function Mwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gt(t,e){return t.get(h3(t,e))}function Hr(t,e,n){return t.set(h3(t,e),n),n}function h3(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var kr=new WeakMap,ad=new WeakMap,Pv=new WeakMap,_l=new WeakMap,Av=new WeakMap,Bg=new WeakMap,Iv=new WeakMap;class d3{constructor(e,n){var i=this;Qc(this,"settings",void 0),Qc(this,"tableProps",void 0),Qc(this,"inProgress",!1),Qc(this,"selectedRange",new LH((r,s,o)=>this.tableProps.createCellRange(r,s,o))),Qc(this,"highlight",void 0),Zc(this,kr,void 0),Zc(this,ad,void 0),Qc(this,"selectedByRowHeader",new Set),Qc(this,"selectedByColumnHeader",new Set),Zc(this,Pv,!1),Zc(this,_l,!1),Zc(this,Av,"unknown"),Zc(this,Bg,-1),Zc(this,Iv,0),this.settings=e,this.tableProps=n,this.highlight=new fwe({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[lO()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(r,s)=>this.tableProps.isDisabledCellSelection(r,s),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),createCellCoords:(r,s)=>this.tableProps.createCellCoords(r,s),createCellRange:(r,s,o)=>this.tableProps.createCellRange(r,s,o)}),Hr(kr,this,new ywe(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Hr(ad,this,new Cwe(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Gt(kr,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformStart",...s)}),Gt(kr,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("afterModifyTransformStart",...s)}),Gt(kr,this).addLocalHook("beforeTransformEnd",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformEnd",...s)}),Gt(kr,this).addLocalHook("afterTransformEnd",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("afterModifyTransformEnd",...s)}),Gt(kr,this).addLocalHook("insertRowRequire",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("insertRowRequire",...s)}),Gt(kr,this).addLocalHook("insertColRequire",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("insertColRequire",...s)}),Gt(kr,this).addLocalHook("beforeRowWrap",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("beforeRowWrap",...s)}),Gt(kr,this).addLocalHook("beforeColumnWrap",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("beforeColumnWrap",...s)}),Gt(ad,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("beforeModifyTransformFocus",...s)}),Gt(ad,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}getActiveSelectedRange(){return this.selectedRange.peekByIndex(Gt(Iv,this))}getActiveSelectionLayerIndex(){return Gt(Iv,this)}setActiveSelectionLayerIndex(e){Hr(Iv,this,e)}markSource(e){Hr(Av,this,e)}markEndSource(){Hr(Av,this,"unknown")}getSelectionSource(){return Gt(Av,this)}setExpectedLayers(e){Hr(Bg,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Hr(Bg,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",o=Nt(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,a=e.clone();Hr(_l,this,!1),Hr(Pv,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,a),(!s||s&&!o&&Nt(n))&&(this.selectedRange.clear(),k(this.highlight.getAreas(),l=>{l.clear()}),k(this.highlight.getLayeredAreas(),l=>{l.clear()}),k(this.highlight.getRowHeaders(),l=>{l.clear()}),k(this.highlight.getColumnHeaders(),l=>{l.clear()}),k(this.highlight.getActiveRowHeaders(),l=>{l.clear()}),k(this.highlight.getActiveColumnHeaders(),l=>{l.clear()}),k(this.highlight.getActiveCornerHeaders(),l=>{l.clear()}),k(this.highlight.getRowHighlights(),l=>{l.clear()}),k(this.highlight.getColumnHighlights(),l=>{l.clear()})),this.selectedRange.add(a).current().setHighlight(r.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,i)}setRangeEnd(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(n);const i=e.clone(),r=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.getActiveSelectedRange().clone().setTo(e).isSingleHeader();if((r>0||s>0)&&(r===0&&i.col<0&&!o||s===0&&i.row<0&&!o))return;this.runLocalHooks("beforeSetRangeEnd",i),this.begin();const a=this.getActiveSelectedRange();if(this.settings.navigableHeaders||a.highlight.normalize(),this.settings.selectionMode==="single")a.setFrom(a.highlight),a.setTo(a.highlight);else{const c=a.getHorizontalDirection(),u=a.getVerticalDirection(),h=this.isMultiple();a.setTo(i),h&&(c!==a.getHorizontalDirection()||a.getWidth()===1&&!a.includes(a.highlight))&&a.from.assign({col:a.highlight.col}),h&&(u!==a.getVerticalDirection()||a.getHeight()===1&&!a.includes(a.highlight))&&a.from.assign({row:a.highlight.row})}r>0&&s>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!a.isSingleHeader())&&a.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.getActiveSelectedRange().highlight,n),this.applyAndCommit(this.getActiveSelectedRange(),n);const l=Gt(Bg,this)===-1||this.selectedRange.size()===Gt(Bg,this);this.runLocalHooks("afterSetRangeEnd",e,l)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const i=this.tableProps.countRows(),r=this.tableProps.countCols();this.highlight.useLayerLevel(n);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(s.clear(),o.clear(),a.clear(),l.clear(),c.clear(),u.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(NO,e.highlight)&&(this.isMultiple()||n>=1)&&(s.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),n===1)){const g=this.selectedRange.peekByIndex(n-1);this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(g.from).commit().syncWith(g),this.highlight.createLayeredArea().add(g.from).commit().syncWith(g),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(DO,e.highlight)){if(!e.isSingleHeader()){const p=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),v=this.tableProps.createCellCoords(e.to.row,-1),b=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),R=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(p).commit(),l.add(b).commit(),d.add(p).commit(),f.add(b).commit()):(a.add(p).add(v).commit(),l.add(b).add(R).commit(),d.add(p).add(v).commit(),f.add(b).add(R).commit())}const g=!Gt(_l,this)&&this.isEntireRowSelected()&&(r>0&&r===e.getWidth()||r===0&&this.isSelectedByRowHeader()),m=!Gt(_l,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||i===0&&this.isSelectedByColumnHeader());g&&c.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),m&&u.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),g&&m&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(n),Gt(kr,this).setActiveLayerIndex(n),Gt(ad,this).setActiveLayerIndex(n);const i=this.getActiveSelectedRange();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),i.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(rC,i.highlight)&&r.add(i.highlight).commit().syncWith(i),this.inProgress||(Hr(Pv,this,!0),this.runLocalHooks("afterSetFocus",i.highlight))}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{visualCoords:r}=Gt(kr,this).transformStart(e,n,i);this.setRangeStart(r)}transformEnd(e,n){const{visualCoords:i,selectionLayer:r}=Gt(kr,this).transformEnd(e,n);this.setRangeEnd(i,r)}transformFocus(e,n){const{selectionLayer:i,visualCoords:r}=Gt(ad,this).transformStart(e,n);this.setRangeFocus(r.normalize(),i)}shiftRows(e,n){if(!this.isSelected())return;const i=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){const{from:r,to:s,highlight:o}=i,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),u=c?-1:0,h=c?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Ke(r.row+h,u,a-1),r.col),f=this.tableProps.createCellCoords(Ke(s.row+n,u,a-1),s.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Ke(o.row+n,0,a-1),o.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const i=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){const{from:r,to:s,highlight:o}=i,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),c=this.isSelectedByColumnHeader(),u=l?-1:0,h=l?0:n;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(r.row,Ke(r.col+h,u,a-1)),f=this.tableProps.createCellCoords(s.row,Ke(s.col+n,u,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(o.row,Ke(o.col+n,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),c&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange();if(!this.isSelected())return!1;const n=xr(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",n),n.value}isFocusSelectionChanged(){return this.isSelected()&&Gt(Pv,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{col:s}=r.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&s<0||o===0)&&r.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{row:s}=r.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&s<0||o===0)&&r.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),c=i?-l:0,u=n?-a:0;if(c===0&&u===0&&(s===0||o===0))return;let h=(e=this.getActiveSelectedRange())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=r;d&&Number.isInteger(d?.row)&&Number.isInteger(d?.col)&&(h=this.tableProps.createCellCoords(Ke(d.row,c,s-1),Ke(d.col,u,o-1)));const g=this.tableProps.createCellCoords(c,u),m=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.runLocalHooks("beforeSelectAll",g,m,h),this.setRangeStartOnly(g,void 0,h),Hr(_l,this,f),u<0&&this.selectedByRowHeader.add(this.getLayerLevel()),c<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(m),this.runLocalHooks("afterSelectAll",g,m,h),this.finish()}selectCells(e){var n=this;const i=Of(e);if(i===o0)return!1;if(i===s0)throw new Error(ct`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=Np(i,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),s=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},a=!e.some(l=>{const c=r(l),u=c.isValid(o);return!(u&&!c.containsHeaders()||u&&c.containsHeaders()&&c.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),k(e,l=>{const{from:c,to:u}=r(l);this.setRangeStartOnly(c.clone(),!1),this.setRangeEnd(u.clone())}),this.finish()),a}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof n=="string"?this.tableProps.propToCol(n):n,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),c=l===0?0:-l,u=this.tableProps.createCellCoords(c,r),h=this.tableProps.createCellCoords(o-1,s),d=this.tableProps.createCellRange(u,u,h).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,g=0;Number.isInteger(i?.row)&&Number.isInteger(i?.col)?(f=Ke(i.row,c,o-1),g=Ke(i.col,Math.min(r,s),Math.max(r,s))):(f=Ke(i,c,o-1),g=r);const m=this.tableProps.createCellCoords(f,g),p=l===0?0:Ke(m.row,c,-1),v=o-1,b=this.tableProps.createCellCoords(p,r),R=this.tableProps.createCellCoords(v,s);this.runLocalHooks("beforeSelectColumns",b,R,m),this.setRangeStartOnly(b,void 0,m),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(R),this.runLocalHooks("afterSelectColumns",b,R,m),this.finish()}return d}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,l=this.tableProps.createCellCoords(e,a),c=this.tableProps.createCellCoords(n,s-1),u=this.tableProps.createCellRange(l,l,c).isValid({countRows:r,countCols:s,countRowHeaders:o,countColHeaders:0});if(u){let h=0,d=0;Number.isInteger(i?.row)&&Number.isInteger(i?.col)?(h=Ke(i.row,Math.min(e,n),Math.max(e,n)),d=Ke(i.col,a,s-1)):(h=e,d=Ke(i,a,s-1));const f=this.tableProps.createCellCoords(h,d),g=o===0?0:Ke(f.col,a,-1),m=s-1,p=this.tableProps.createCellCoords(e,g),v=this.tableProps.createCellCoords(n,m);this.runLocalHooks("beforeSelectRows",p,v,f),this.setRangeStartOnly(p,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(v),this.runLocalHooks("afterSelectRows",p,v,f),this.finish()}return u}importSelection(e){let{ranges:n,activeRange:i,activeSelectionLayer:r,selectedByRowHeader:s,selectedByColumnHeader:o,disableHeadersHighlight:a}=e;n.length!==0&&(this.selectedRange.clear(),this.highlight.clear(),this.inProgress=!1,Hr(_l,this,a),this.selectedByRowHeader=new Set(s),this.selectedByColumnHeader=new Set(o),this.setActiveSelectionLayerIndex(0),n.forEach((l,c)=>{this.selectedRange.push(l),this.applyAndCommit(l,c)}),this.setRangeFocus(i.highlight,r),Hr(_l,this,!1),this.inProgress=!1)}exportSelection(){return{ranges:Array.from(this.selectedRange).map(e=>e.clone()),activeRange:this.getActiveSelectedRange(),activeSelectionLayer:this.getActiveSelectionLayerIndex(),selectedByRowHeader:Array.from(this.selectedByRowHeader),selectedByColumnHeader:Array.from(this.selectedByColumnHeader),disableHeadersHighlight:Gt(_l,this)}}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const i=this.selectedRange.ranges.map(o=>o.clone());this.markSource("refresh");const r=new Set(this.selectedByRowHeader),s=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(i.length),i.forEach(o=>{const{from:a,to:l,highlight:c}=o,u=e-1,h=n-1;c.assign({row:Ke(c.row,this.settings.navigableHeaders?-1/0:0,u),col:Ke(c.col,this.settings.navigableHeaders?-1/0:0,h)}),a.assign({row:Ke(a.row,-1/0,u),col:Ke(a.col,-1/0,h)}),l.assign({row:Ke(l.row,-1/0,u),col:Ke(l.col,-1/0,h)}),this.setRangeStartOnly(a,!0,c),this.setRangeEnd(l)}),this.selectedByRowHeader=r,this.selectedByColumnHeader=s,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(r=>{r.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),i=this.getActiveSelectedRange();this.highlight.isEnabledFor(rC,i.highlight)&&this.highlight.getFocus().commit().syncWith(i);for(let r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),c=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();s.commit(),o.commit(),a.commit(),l.commit(),c.commit(),u.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}pt(d3,ti);const T2=/^(\r\n|\n\r|\r|\n)/,Pwe=/^[^\t\r\n]+/,M2=/^\t/;function Awe(t){const e=[[""]];if(t.length===0)return e;let n=0,i=0,r;for(;t.length>0&&r!==t.length;)if(r=t.length,t.match(M2))t=t.replace(M2,""),n+=1,e[i][n]="";else if(t.match(T2))t=t.replace(T2,""),n=0,i+=1,e[i]=[""];else{let s="";if(t.startsWith('"')){let o=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(o+=1),s+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&o%2===0)&&(a=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const o=t.match(Pwe);s=o?o[0]:"",t=t.slice(s.length)}e[i][n]=s}return e}function cC(t){let e,n,i,r,s="",o;for(e=0,n=t.length;e<n;e+=1){for(r=t[e].length,i=0;i<r;i+=1)i>0&&(s+="	"),o=t[e][i],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==n-1&&(s+=`
`)}return s}function bx(t,e){const{instance:n,visualRow:i,visualCol:r,valueSetter:s}=e;return ht(s)?s.call(n,t,i,r,e):t}function Iwe(t,e){const{instance:n,visualRow:i,visualCol:r,valueGetter:s}=e;return ht(s)?s.call(n,t,i,r,e):t}function eu(t,e,n){return(e=Owe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Owe(t){var e=Hwe(t,"string");return typeof e=="symbol"?e:e+""}function Hwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Qd{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,i){eu(this,"hot",void 0),eu(this,"metaManager",void 0),eu(this,"tableMeta",void 0),eu(this,"dataSource",void 0),eu(this,"duckSchema",void 0),eu(this,"colToPropCache",void 0),eu(this,"propToColCache",void 0),this.hot=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,n){let r=0,s=0,o=!1;if(typeof n=="function"){const a=zS(e);r=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;r=Math.min(a,n.length)}for(i=0;i<r;i++){const a=o?n(i):n[i];if(Re(a)){if(typeof a.data<"u"){const l=o?s:i;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return YO(this.dataSource)}recursiveDuckColumns(e,n,i){let r=n,s=i,o;return typeof r>"u"&&(r=0,s=""),typeof e=="object"&&!Array.isArray(e)&&Ye(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,r),r+=1):r=this.recursiveDuckColumns(a,r,`${l}.`)}),r}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&se(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(se(n))return this.hot.toVisualColumn(n);const i=this.hot.toVisualColumn(e);return i===null?e:i}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?Pf(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.hot.countRows()&&(o=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,n,i)===!1||o===null)return{delta:0};const u=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<n&&s+a<u;){let g=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?g=Vi(this.getSchema()):(g=[],pe(h-1,()=>g.push(null))):this.hot.dataType==="function"?g=this.tableMeta.dataSchema(l+a):(g={},yw(g,this.getSchema())),d.push(g),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),r==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,d);const f=this.hot.toVisualRow(o);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):i!=="auto"&&this.metaManager.createRow(o,n)),this.hot.runHooks("afterCreateRow",f,a,i),{delta:a,startPhysicalIndex:o}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols(),l=this.hot.countCols(),c=this.hot.countSourceRows(),u=typeof e=="number"&&e<=a?e:l;if(this.hot.runHooks("beforeCreateCol",u,n,i)===!1)return{delta:0};const h=u<l?this.hot.toPhysicalColumn(u):a,d=r==="end"?Math.min(h+1,a):h;let f=0;for(let g=d;f<n&&l+f<o;g++){if(typeof u!="number"||u>=l+f)if(c>0)for(let m=0;m<c;m+=1)typeof s[m]>"u"&&(s[m]=[]),s[m].push(null);else s.push([null]);else for(let m=0;m<c;m++)s[m].splice(g,0,null);f+=1}return f>0&&(e==null?this.metaManager.createColumn(null,f):i!=="auto"&&this.metaManager.createColumn(d,n)),this.hot.columnIndexMapper.insertIndexes(u,f,r),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(d),f,i),this.refreshDuckSchema(),{delta:f,startPhysicalIndex:d}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-n;const s=this.visualRowsToPhysical(r,n),o=this.hot.countSourceRows();if(r=(o+r)%o,this.hot.runHooks("beforeRemoveRow",r,s.length,s,i)===!1)return!1;const l=s.length;if(this.filterData(r,l,s),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const u=se(this.tableMeta.columns)||se(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!u&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((u,h)=>h-u).forEach(u=>{this.metaManager.removeRow(u,1)}),this.hot.runHooks("afterRemoveRow",r,l,s,i),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let r=typeof e!="number"?-n:e;r=(this.hot.countCols()+r)%this.hot.countCols();const s=this.visualColumnsToPhysical(r,n),o=s.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",r,n,s,i)===!1)return!1;let l=!0;const c=o.length,u=this.dataSource;for(let h=0;h<c;h++)l&&s[0]!==s[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)u[h].splice(s[0],n),h===0&&this.metaManager.removeColumn(s[0],n);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<c;f++)u[h].splice(o[f],1),h===0&&this.metaManager.removeColumn(o[f],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,n,s,i),this.refreshDuckSchema(),!0}spliceCol(e,n,i){const r=this.hot.getDataAtCol(e),s=r.slice(n,n+i),o=r.slice(n+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),c=3;c<a;c++)l[c-3]=arguments[c];fP(l,o);let u=0;for(;u<i;)l.push(null),u+=1;return xK(l),this.hot.populateFromArray(n,e,l,null,null,"spliceCol"),s}spliceRow(e,n,i){const r=this.hot.getSourceDataAtRow(e),s=r.slice(n,n+i),o=r.slice(n+i);for(var a=arguments.length,l=new Array(a>3?a-3:0),c=3;c<a;c++)l[c-3]=arguments[c];fP(l,o);let u=0;for(;u<i;)l.push(null),u+=1;return this.hot.populateFromArray(e,n,[l],null,null,"spliceRow"),s}spliceData(e,n,i){if(this.hot.runHooks("beforeDataSplice",e,n,i)!==!1){const s=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,n,i){let r=this.hot.runHooks("filterData",e,n,i);Array.isArray(r)===!1&&(r=this.dataSource.filter((s,o)=>i.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,n){const i=this.hot.toPhysicalRow(e);let r=this.dataSource[i];const s=this.hot.runHooks("modifyRowData",i);r=isNaN(s)?s:r;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(r&&r.hasOwnProperty&&ln(r,n))a=r[n];else if(o&&typeof n=="string"&&n.indexOf(".")>-1){let u=r;if(!u)return null;const h=n.split(".");for(let d=0,f=h.length;d<f;d++)if(u=u[h[d]],typeof u>"u")return null;a=u}else typeof n=="function"&&(a=n(this.dataSource.slice(i,i+1)[0]));const l=this.propToCol(n),c=this.hot.toPhysicalColumn(l);if(gh(i)&&gh(c)&&(a=Iwe(a,this.metaManager.getCellMeta(i,c,{visualRow:e,visualColumn:l,skipMetaExtension:!0}))),this.hot.hasHook("modifyData")){const u=xr(a);this.hot.runHooks("modifyData",e,l,u,"get"),u.isTouched()&&(a=u.value)}return a}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,i){const r=this.hot.toPhysicalRow(e);let s=i,o=this.dataSource[r];const a=this.hot.runHooks("modifyRowData",r);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const c=xr(s);this.hot.runHooks("modifyData",e,this.propToCol(n),c,"set"),c.isTouched()&&(s=c.value)}const{dataDotNotation:l}=this.hot.getSettings();if(o&&o.hasOwnProperty&&ln(o,n))o[n]=s;else if(l&&typeof n=="string"&&n.indexOf(".")>-1){let c=o,u=0,h;const d=n.split(".");for(u=0,h=d.length-1;u<h;u++){if(d[u]==="__proto__"||d[u]==="constructor"||d[u]==="prototype")return;typeof c[d[u]]>"u"&&(c[d[u]]={}),c=c[d[u]]}c[d[u]]=s}else if(typeof n=="function")n(this.dataSource.slice(r,r+1)[0],s);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;o[n]=s}}visualRowsToPhysical(e,n){const i=this.hot.countSourceRows(),r=[];let s=(i+e)%i,o=n,a;for(;s<i&&o;)a=this.hot.toPhysicalRow(s),r.push(a),o-=1,s+=1;return r}visualColumnsToPhysical(e,n){const i=this.hot.countCols(),r=[];let s=(i+e)%i,o=n;for(;s<i&&o;){const a=this.hot.toPhysicalColumn(s);r.push(a),o-=1,s+=1}return r}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Qd.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,i){const r=[];let s,o,a;const l=this.tableMeta.maxRows,c=this.tableMeta.maxCols;if(l===0||c===0)return[];const u=i===Qd.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,n.row)),d=Math.min(Math.max(c-1,0),Math.max(e.col,n.col));for(s=Math.min(e.row,n.row);s<=h;s++){a=[];const f=s>=0?this.hot.toPhysicalRow(s):s;for(o=Math.min(e.col,n.col);o<=d&&f!==null;o++)a.push(u.call(this,s,this.colToProp(o)));f!==null&&r.push(a)}return r}getText(e,n){return cC(this.getRange(e,n,Qd.DESTINATION_RENDERER))}getCopyableText(e,n){return cC(this.getRange(e,n,Qd.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:kwe,getItem:Dwe,hasItem:f3,getNames:Nwe,getValues:QNe}=ks("cellTypes");function VH(t){if(!f3(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Dwe(t)}function ms(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:i,validator:r}=e;n&&wr(t,n),i&&Wr(t,i),r&&Vu(t,r),kwe(t,e)}function Lwe(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!ln(e,t)}function a0(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=typeof e.type=="string"?VH(e.type):e.type;if(t._automaticallyAssignedMetaProps&&Ye(e,(s,o)=>{t._automaticallyAssignedMetaProps.delete(o)}),!Re(i))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const r={};Ye(i,(s,o)=>{if(Lwe(o,n)){var a;r[o]=s,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),On(t,r)}function $we(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}VK(n,t);for(let i=0;i<e.length;i++)n.prototype[e[i]]=void 0;return n}function ay(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Hm(t){return t==null}const g3=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dialog:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,emptyDataState:!1,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,initialState:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,i;for(e=0,n=this.countRows();e<n;e++)if(i=this.getDataAtCell(e,t),hn(i)===!1)return!1;return!0},isEmptyRow(t){let e,n,i,r;for(e=0,n=this.countCols();e<n;e++)if(i=this.getDataAtCell(t,e),hn(i)===!1)return typeof i=="object"?(r=this.getCellMeta(t,e),Cw(this.getSchema()[r.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",loading:!1,manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRowHeights:void 0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,pagination:void 0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,valueGetter:void 0,valueSetter:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function P2(t,e,n){return(e=Fwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Fwe(t){var e=Vwe(t,"string");return typeof e=="symbol"?e:e+""}function Vwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bwe(){return class{}}class Wwe{constructor(e){P2(this,"metaCtor",Bwe()),P2(this,"meta",void 0),this.meta=this.metaCtor.prototype,On(this.meta,g3()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;On(this.meta,e),a0(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function jwe(t,e,n){return(e=zwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zwe(t){var e=Uwe(t,"string");return typeof e=="symbol"?e:e+""}function Uwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ywe{constructor(e){jwe(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){On(this.meta,e),a0(this.meta,e,e)}}function Ov(t,e,n){return(e=Gwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gwe(t){var e=qwe(t,"string");return typeof e=="symbol"?e:e+""}function qwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class uC{constructor(e){Ov(this,"valueFactory",void 0),Ov(this,"data",[]),Ov(this,"index",[]),Ov(this,"holes",new Set),this.valueFactory=e}obtain(e){ay(()=>gh(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let i;if(n>=0)i=this.data[n],i===void 0&&(i=this.valueFactory(e),this.data[n]=i);else if(i=this.valueFactory(e),this.holes.size>0){const r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=i,this.index[e]=r}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;ay(()=>gh(e)||Hm(e),"Expecting an unsigned number or null/undefined argument.");const i=[],r=this.data.length;for(let o=0;o<n;o++)i.push(r+o),this.data.push(void 0);const s=Hm(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...i,...this.index.slice(s)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;ay(()=>gh(e)||Hm(e),"Expecting an unsigned number or null/undefined argument.");const i=this.index.splice(Hm(e)?this.index.length-n:e,n);for(let r=0;r<i.length;r++){const s=i[r];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let i=0;i<this.data.length;i++){const r=this._getKeyByStorageIndex(i);r!==-1&&this.data[i]!==void 0&&e.push([r,this.data[i]])}let n=0;return{next:()=>{if(n<e.length){const i=e[n];return n+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function A2(t,e,n){return(e=Kwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kwe(t){var e=Xwe(t,"string");return typeof e=="symbol"?e:e+""}function Xwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Jwe=["data","width"];class Zwe{constructor(e){A2(this,"globalMeta",void 0),A2(this,"metas",new uC(()=>this._createMeta())),this.globalMeta=e,this.metas=new uC(()=>this._createMeta())}updateMeta(e,n){const i=this.getMeta(e);On(i,n),a0(i,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return $we(this.globalMeta.getMetaConstructor(),Jwe).prototype}}function I2(t,e,n){return(e=Qwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qwe(t){var e=eve(t,"string");return typeof e=="symbol"?e:e+""}function eve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tve{constructor(e){I2(this,"columnMeta",void 0),I2(this,"metas",new uC(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,i){const r=this.getMeta(e,n);On(r,i),a0(r,i)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,n)}getMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);return i===void 0?r:r[i]}setMeta(e,n,i,r){var s;const o=this.metas.obtain(e).obtain(n);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(i),o[i]=r}removeMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);delete r[i]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let i=0;i<n.length;i++)se(n[i])&&e.push(...n[i].values());return e}getMetasAtRow(e){ay(()=>gh(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new uC(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class m3{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new Wwe(e),this.tableMeta=new Ywe(this.globalMeta),this.columnMeta=new Zwe(this.globalMeta),this.cellMeta=new tve(this.columnMeta),i.forEach(r=>new r(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,i){const r=this.cellMeta.getMeta(e,n);return r.visualRow=i.visualRow,r.visualCol=i.visualColumn,r.row=e,r.col=n,i.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(e,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,i)}setCellMeta(e,n,i,r){this.cellMeta.setMeta(e,n,i,r)}updateCellMeta(e,n,i){this.cellMeta.updateMeta(e,n,i)}removeCellMeta(e,n,i){this.cellMeta.removeMeta(e,n,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}pt(m3,ti);function O2(t,e,n,i){const{hotInstance:r,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:c,firstRun:u}=i,h=Fi(a),d=r.getSettings();Array.isArray(d.dataSchema)?r.dataType="array":ht(d.dataSchema)?r.dataType="function":r.dataType="object",s&&s.destroy(),t=r.runHooks(`before${h}`,t,u,l);const f=new Qd(r,t,c);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const g=f.getSchema();t=[];let m,p=0,v=0;for(p=0,v=d.startRows;p<v;p++)if((r.dataType==="object"||r.dataType==="function")&&d.dataSchema)m=Vi(g),t.push(m);else if(r.dataType==="array")m=Vi(g[0]),t.push(m);else{m=[];for(let b=0,R=d.startCols;b<R;b++)m.push(null);t.push(m)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(r.dataType="array"),d.data=t,f.dataSource=t,o.data=t,o.dataType=r.dataType,o.colToProp=f.colToProp.bind(f),o.propToCol=f.propToCol.bind(f),o.countCachedColumns=f.countCachedColumns.bind(f),n(f),r.runHooks(`after${h}`,t,u,l),u||(r.runHooks("afterChange",null,a),r.view.adjustElementsSize(),r.render()),r.getSettings().ariaTags&&he(r.rootElement,[LK(-1),jS(r.countCols()+(r.view?r.countRowHeaders():0))])}function H2(t,e,n){return(e=nve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nve(t){var e=ive(t,"string");return typeof e=="symbol"?e:e+""}function ive(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rve{constructor(e){var n=this;H2(this,"metaManager",void 0),H2(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),le.getSingleton().add("beforeRender",i=>{i&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:i,col:r}=e;if((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(r))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);const c=ln(e,"type")?e.type:null;let u=ht(e.cells)?e.cells(i,r,l):null;if(c)if(u){var h;u.type=(h=u.type)!==null&&h!==void 0?h:c}else u={type:c};u&&this.metaManager.updateCellMeta(i,r,u),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(r)}}function sve(t,e,n){ove(t,e),e.set(t,n)}function ove(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yx(t,e,n){return(e=ave(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ave(t){var e=lve(t,"string");return typeof e=="symbol"?e:e+""}function lve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cve(t,e){return t.get(uve(t,e))}function uve(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var k2=new WeakMap;class hve{constructor(e){yx(this,"metaManager",void 0),yx(this,"usageTracker",new Set),yx(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),sve(this,k2,(n,i,r)=>{if(!r)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:i,target:r,onChange:s}=e,o=typeof r=="string",a=o?r:n,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],s?(this.installPropWatcher(n,l,s),o&&this.installPropWatcher(r,l,s)):i&&(this.installPropWatcher(n,l,cve(k2,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,i){const r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(s){const o=!r.usageTracker.has(e);r.usageTracker.add(e),i.call(r,e,s,o),this[n]=s},enumerable:!0,configurable:!0})}}function dve(t,e){p3(t,e),e.add(t)}function D2(t,e,n){p3(t,e),e.set(t,n)}function p3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function N2(t,e){return t.get(Hf(t,e))}function L2(t,e,n){return t.set(Hf(t,e),n),n}function Hf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var OP=new WeakMap,HP=new WeakMap,Qm=new WeakSet;class fve{constructor(e){let{rowIndexMapper:n,columnIndexMapper:i}=e;dve(this,Qm),D2(this,OP,void 0),D2(this,HP,void 0),L2(OP,this,n),L2(HP,this,i)}toRenderable(e){const n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,r=Hf(Qm,this,$2).call(this,e.from,n,i);if(r===null)return null;const s=Hf(Qm,this,$2).call(this,e.to,-n,-i);if(s===null)return null;const o=e.clone();return o.from=r,o.to=s,o.includes(e.highlight)||(o.highlight=r),o}}function $2(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const i=Hf(Qm,this,F2).call(this,N2(OP,this),t.row,e);if(i===null)return null;const r=Hf(Qm,this,F2).call(this,N2(HP,this),t.col,n);return r===null?null:t.clone().assign({row:i,col:r})}function F2(t,e,n){return e<0?e:t.getNearestNotHiddenIndex(e,n)}function ag(t){sa(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function l0(t){const{selection:e,view:n}=t,i=t.getSelectedRangeActive(),r=e.getSelectionSource(),s=n.getFirstFullyVisibleColumn(),o=n.getLastFullyVisibleColumn(),a=i.getTopStartCorner().col,l=i.getBottomEndCorner().col,c=a<=s,u=l>=o,h=n.getFirstFullyVisibleRow(),d=n.getLastFullyVisibleRow(),f=i.getTopStartCorner().row,g=i.getBottomEndCorner().row,m=f<=h,p=g>=d;return{getComputedColumnTarget(v){return r==="mouse"||r==="keyboard"?v.col:c&&u?i.highlight.col:c?a:u?l:v.col},getComputedRowTarget(v){return r==="mouse"||r==="keyboard"?v.row:m&&p?i.highlight.row:m?f:p?g:v.row}}}function gve(t){return e=>{const n=l0(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const i=!!t.getSettings().colHeaders;ag(t.getCell(i?-1:0,n,!0))})}}function mve(){return()=>{}}function pve(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const n=t.getSelectedRangeActive();if(!n)return;const{row:i,col:r}=n.highlight;ag(t.getCell(i,r,!0))})}}function wve(t){return e=>{const n=l0(t),i={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(i,()=>{const{row:r,col:s}=i;ag(t.getCell(r,s,!0))})}}function vve(t){return e=>{const n=l0(t),i={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(i,()=>{const{row:r,col:s}=i;ag(t.getCell(r,s,!0))})}}function bve(t){return e=>{const n=l0(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const i=!!t.getSettings().rowHeaders;ag(t.getCell(n,i?-1:0,!0))})}}function yve(t){return e=>{const n=t.selection.getSelectionSource(),{row:i,col:r}=e,s=()=>{ag(t.getCell(i,r,!0))};if(i<0&&r>=0)t.scrollViewportTo({col:r},s);else if(r<0&&i>=0)t.scrollViewportTo({row:i},s);else{if(n==="mouse"&&(r===t.view.getLastPartiallyVisibleColumn()||i===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:i,col:r},s)}}}function Cve(t){const{selection:e}=t;let n=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){n=!0},scrollTo(r){var s;if(n||i){n=!1;return}let o;e.isFocusSelectionChanged()?o=pve(t):e.isSelectedByCorner()?o=mve():e.isSelectedByRowHeader()?o=bve(t):e.isSelectedByColumnHeader()?o=gve(t):e.getSelectedRange().size()===1&&e.isMultiple()?o=wve(t):e.getSelectedRange().size()===1&&!e.isMultiple()?o=yve(t):e.getSelectedRange().size()>1&&(o=vve(t)),(s=o)===null||s===void 0||s(r)}}}const Sve=Object.freeze({INLINE:"inline",MODAL:"modal"}),Xu=Object.freeze({UNKNOWN:"unknown",CLICK:"click",TAB_FROM_ABOVE:"tab_from_above",TAB_FROM_BELOW:"tab_from_below"}),Rve="grid";function _ve(t,e){const n=V2(t,Xu.TAB_FROM_ABOVE),i=V2(t,Xu.TAB_FROM_BELOW);return e.prepend(n),e.append(i),{activate(){n.tabIndex=0,i.tabIndex=0},deactivate(){n.tabIndex=-1,i.tabIndex=-1},destroy(){n.remove(),i.remove()}}}function V2(t,e){const i=t.rootDocument.createElement("input");return i.type="text",i.name="htFocusCatcher",i.classList.add("htFocusCatcher"),i.dataset.htFocusSource=e,t.getSettings().ariaTags&&he(i,[Jr("Focus catcher")]),i}function Eve(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i={shortcutsContextName:Rve,type:Sve.INLINE,contains:f=>f===e||e.contains(f),runOnlyIf:()=>!0,...n},r=_ve(t,e);return{getType:()=>i.type,hasContainerDetached:()=>!t.rootWrapperElement.contains(e),getShortcutsContextName:()=>i.shortcutsContextName,runOnlyIf:()=>i.runOnlyIf(),contains:f=>i.contains(f),activate:function(){var f;let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Xu.UNKNOWN;(f=i.onActivate)===null||f===void 0||f.call(i,g)},deactivate:()=>{var f;(f=i.onDeactivate)===null||f===void 0||f.call(i)},activateFocusCatchers:()=>{r?.activate()},deactivateFocusCatchers:()=>{r?.deactivate()},enable:()=>{e.removeAttribute("inert")},disable:()=>{e.setAttribute("inert","true")},destroy:()=>{r?.destroy()}}}function xve(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=!1;function i(u){if(!n){var h;(h=e.onFocus)===null||h===void 0||h.call(e,u)}}function r(u){var h;(h=e.onClick)===null||h===void 0||h.call(e,u)}function s(u){if(u.key==="Tab"){var h;(h=e.onTabKeyDown)===null||h===void 0||h.call(e,u)}}function o(){n=!0}function a(){n=!1}return{mount:()=>{let u=t;for(;u;){const{documentElement:h}=u.document;h.addEventListener("focusin",i),h.addEventListener("click",r),h.addEventListener("keydown",s),h.addEventListener("mousedown",o),h.addEventListener("mouseup",a),u=al(u)}},unmount:()=>{let u=t;for(;u;){const{documentElement:h}=u.document;h.removeEventListener("focusin",i),h.removeEventListener("click",r),h.removeEventListener("keydown",s),h.removeEventListener("mousedown",o),h.removeEventListener("mouseup",a),u=al(u)}}}}function Tve(t){const e=xw({errorIdExists:g=>`The "${g}" focus scope is already registered.`}),n=t.getShortcutManager();let i=null;function r(){return i?e.getId(i):null}function s(g,m){let p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(e.hasItem(g))throw new Error(`Scope with id "${g}" already registered`);const v=Eve(t,m,p);e.addItem(g,v),n.getOrCreateContext(v.getShortcutsContextName())}function o(g){if(!e.hasItem(g))throw new Error(`Scope with id "${g}" not found`);e.getItem(g).destroy(),e.removeItem(g)}function a(g){if(!e.hasItem(g))throw new Error(`Scope with id "${g}" not found`);c(e.getItem(g))}function l(g){if(!e.hasItem(g))throw new Error(`Scope with id "${g}" not found`);u(e.getItem(g))}function c(g){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xu.UNKNOWN;i!==g&&(i!==null&&u(i),i=g,i.activate(m),n.setActiveContextName(g.getShortcutsContextName()))}function u(g){h(),i===g&&(i=null,g.deactivate())}function h(){const g=e.getValues(),m=g.filter(p=>p.runOnlyIf()&&p.getType()==="modal");g.forEach(p=>{m.length>0&&m.includes(p)||m.length===0||p.hasContainerDetached()?p.enable():p.disable(),p===i?p.contains(t.rootDocument.activeElement)?p.deactivateFocusCatchers():p.activateFocusCatchers():p.runOnlyIf()?p.activateFocusCatchers():p.deactivateFocusCatchers()})}function d(g,m){if(!g.isConnected||!Mc(g))return;const p=e.getValues().filter(b=>b.runOnlyIf());let v=!1;p.forEach(b=>{!v&&b.contains(g)&&(v=!0,m!==Xu.UNKNOWN&&t.listen(),c(b,m))}),!v&&i&&(u(i),t.unlisten())}const f=xve(t.rootWindow,{onFocus:g=>{var m;d(g.target,(m=g.target.dataset.htFocusSource)!==null&&m!==void 0?m:Xu.UNKNOWN)},onClick:g=>{d(g.target,Xu.CLICK)},onTabKeyDown:()=>{h()}});return f.mount(),{getActiveScopeId:r,registerScope:s,unregisterScope:o,activateScope:g=>a(g),deactivateScope:g=>l(g),destroy:()=>f.unmount()}}function Mve(t,e){w3(t,e),e.add(t)}function ld(t,e,n){w3(t,e),e.set(t,n)}function w3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tt(t,e){return t.get(to(t,e))}function Wu(t,e,n){return t.set(to(t,e),n),n}function to(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pf=Object.freeze({CELL:"cell",MIXED:"mixed"});var pn=new WeakMap,Hv=new WeakMap,kv=new WeakMap,Dv=new WeakMap,Nv=new WeakMap,hC=new WeakMap,Ko=new WeakSet;class Pve{constructor(e){Mve(this,Ko),ld(this,pn,void 0),ld(this,Hv,void 0),ld(this,kv,1),ld(this,Dv,null),ld(this,Nv,new Map),ld(this,hC,!1),Wu(pn,this,e)}init(){var e=this;const n=Tt(pn,this).getSettings();Wu(Hv,this,n.imeFastEdit?pf.MIXED:pf.CELL),Tt(pn,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return to(Ko,e,Hve).call(e,...r)}),Tt(pn,this).addHook("afterSelection",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return to(Ko,e,B2).call(e,...r)}),Tt(pn,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return to(Ko,e,B2).call(e,...r)}),Tt(pn,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return to(Ko,e,Ive).call(e,...r)}),Tt(pn,this).addHook("afterRender",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return to(Ko,e,Ove).call(e,...r)})}getFocusMode(){return Tt(Hv,this)}setFocusMode(e){Object.values(pf).includes(e)?Wu(Hv,this,e):Ue(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return Tt(kv,this)}setRefocusDelay(e){Wu(kv,this,e)}setRefocusElementGetter(e){Wu(Dv,this,e)}getRefocusElement(){var e;return typeof Tt(Dv,this)=="function"?Tt(Dv,this).call(this):(e=Tt(pn,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=i=>{var r,s;const o=(r=Tt(pn,this).getSelectedRangeActive())===null||r===void 0?void 0:r.highlight;if(!o)return;let a=Tt(pn,this).runHooks("modifyFocusedElement",o.row,o.col,i);sa(a)||(a=i),a&&!((s=Tt(pn,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&a.focus({preventScroll:!0})};e?n(e):to(Ko,this,BH).call(this,i=>n(i))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Tt(kv,this);if(Tt(pn,this).getSettings().imeFastEdit&&!((e=Tt(pn,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var i,r;(i=Tt(pn,this).getActiveEditor())===null||i===void 0||(r=i.refreshValue)===null||r===void 0||r.call(i),Tt(Nv,this).has(n)||Tt(Nv,this).set(n,Ew(()=>{if(!Tt(pn,this).isDestroyed){var s;(s=this.getRefocusElement())===null||s===void 0||s.select()}},n)),Tt(Nv,this).get(n)()}}}function BH(t){var e;const n=(e=Tt(pn,this).getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!n||!Tt(pn,this).selection.isCellVisible(n)){t(null);return}const i=Tt(pn,this).getCell(n.row,n.col,!0);i===null?Tt(pn,this).addHookOnce("afterScroll",()=>{t(Tt(pn,this).getCell(n.row,n.col,!0))}):t(i)}function Ave(){to(Ko,this,BH).call(this,t=>{const{activeElement:e}=Tt(pn,this).rootDocument;e&&KS(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function Ive(){to(Ko,this,BH).call(this,t=>{this.getFocusMode()===pf.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function B2(){Wu(hC,this,!0)}function Ove(){Tt(hC,this)&&(Wu(hC,this,!1),to(Ko,this,Ave).call(this))}function Hve(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?pf.MIXED:pf.CELL)}function kve(t){return e=>{if(!e)return null;const{rowIndexMapper:n,columnIndexMapper:i}=t;if(n.isHidden(e.row)||i.isHidden(e.col))return null;const r=kP(t),s=DP(t);return r===null||s===null?null:(e.row=Ke(e.row,r.row,s.row),e.col=Ke(e.col,r.col,s.col),e)}}function kP(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:i}=t.getSettings();let r=i&&t.countColHeaders()>0?-t.countColHeaders():0,s=i&&t.countRowHeaders()>0?-t.countRowHeaders():0;return r===0&&(r=e.getVisualFromRenderableIndex(r)),s===0&&(s=n.getVisualFromRenderableIndex(s)),r===null||s===null?null:t._createCellCoords(r,s)}function DP(t){var e,n;const{rowIndexMapper:i,columnIndexMapper:r}=t,{navigableHeaders:s}=t.getSettings();let o=i.getRenderableIndexesLength()-1,a=r.getRenderableIndexesLength()-1;if(o<0){if(!s||t.countColHeaders()===0)return null;o=-1}if(a<0){if(!s||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=i.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(n=r.getVisualFromRenderableIndex(a))!==null&&n!==void 0?n:a)}const ep="gridDefault",WH="grid",dC="grid.tabNavigation",Vc="editorManager.handlingEditor",Dve="editor",Nve={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},Lve="hooksRefRegisterer",v3={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){k(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){Ye(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};ga(v3,"MIXIN_NAME",Lve,{writable:!1,enumerable:!1});function Fs(t,e,n){return(e=$ve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ve(t){var e=Fve(t,"string");return typeof e=="symbol"?e:e+""}function Fve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Vve="base",wn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class lg{static get EDITOR_TYPE(){return Vve}constructor(e){Fs(this,"hot",void 0),Fs(this,"state",wn.VIRGIN),Fs(this,"_opened",!1),Fs(this,"_fullEditMode",!1),Fs(this,"_closeCallback",null),Fs(this,"TD",null),Fs(this,"row",null),Fs(this,"col",null),Fs(this,"prop",null),Fs(this,"originalValue",null),Fs(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,i,r,s,o){this.TD=r,this.row=e,this.col=n,this.prop=i,this.originalValue=s,this.cellProperties=o,this.state=this.isOpened()?this.state:wn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let i,r,s,o;if(n){const l=this.hot.getSelectedRangeActive(),c=l.getTopStartCorner(),u=l.getBottomEndCorner();i=c.row,r=c.col,s=u.row,o=u.col}else[i,r,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");Array.isArray(a)&&([i,r]=a),this.hot.populateFromArray(i,r,e,s,o,"edit")}beginEditing(e,n){if(this.state!==wn.VIRGIN)return;const i=this.hot,r=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=i.columnIndexMapper.getRenderableFromVisualIndex(this.col),o=()=>{if(this.state=wn.EDITING,this.isInFullEditMode()){const l=this.cellProperties.valueGetter?this.cellProperties.valueGetter(this.originalValue):this.originalValue,c=typeof e=="string"?e:Pt(l);this.setValue(c)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",o),i.view.scrollViewport(i._createCellCoords(r,s))||(this.hot.removeHook("afterScroll",o),o()),this.addHook("beforeDialogShow",()=>this.cancelChanges())}finishEditing(e,n,i){let r;if(i){const s=this._closeCallback;this._closeCallback=o=>{s&&s(o),i(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===wn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===wn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?r=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:r=[[s]],this.state=wn.WAITING,this.saveValue(r,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=wn.FINISHED,this.discardEditor(o)}):(this.state=wn.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=wn.FINISHED,this.discardEditor()}discardEditor(e){this.state===wn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=wn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=wn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===wn.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:i,wtViewport:r}=this.hot.view._wt,s=this.hot.rootWindow,o=yi(n),a=yn(n),l=yi(this.hot.rootElement),c=yn(this.hot.rootElement),u=i.topOverlay.holder,h=i.inlineStartOverlay.holder,d=u!==s?u.scrollTop:0,f=h!==s?h.scrollLeft:0,g=s.innerWidth-l.left-c,{wtTable:m}=(e=i.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,p=m.name,v=["master","inline_start"].includes(p)?d:0,b=["master","top","bottom"].includes(p)?f:0,R=o.top===l.top?0:1;let S=o.top-l.top-R-v,x=0;this.hot.isRtl()?x=s.innerWidth-o.left-a-g-1+b:x=o.left-l.left-1-b,["top","top_inline_start_corner"].includes(p)&&(S+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(p)&&(x+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));const M=this.hot.hasColHeaders(),T=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),O=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),N=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(M&&T<=0||T===N)&&(S+=1),O<=0&&(x+=1);const G=r.rowsRenderCalculator.startPosition,j=r.columnsRenderCalculator.startPosition,ne=Math.abs(i.inlineStartOverlay.getScrollPosition()),ee=i.topOverlay.getScrollPosition(),Q=Sn(this.hot.rootDocument);let me=n.offsetTop;if(["inline_start","master"].includes(p)&&(me+=G-ee),["bottom","bottom_inline_start_corner"].includes(p)){const{wtViewport:D,wtTable:B}=i.bottomOverlay.clone;me+=D.getWorkspaceHeight()-B.getHeight()-Q}let fe=n.offsetLeft;this.hot.isRtl()?(fe>=0?fe=m.getWidth()-n.offsetLeft:fe=Math.abs(fe),fe+=j-ne-a):["top","master","bottom"].includes(p)&&(fe+=j-ne);const ye=s.getComputedStyle(this.TD),Oe=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Ce=parseInt(ye[Oe],10)>0?0:1,Te=parseInt(ye.borderTopWidth,10)>0?0:1,$e=yn(n)+Ce,Me=An(n)+Te,X=wO(u)?Q:0,w=vO(h)?Q:0,C=this.hot.view.maximumVisibleElementWidth(fe)-X+Ce,E=Math.max(this.hot.view.maximumVisibleElementHeight(me)-w+Te,this.hot.stylesHandler.getDefaultRowHeight());return{top:S,start:x,height:Me,maxHeight:E,width:$e,maxWidth:C}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}pt(lg,v3);const Bve={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const i=t._getEditorManager(),r=i.getActiveEditor();r.isInFullEditMode()&&r.state===wn.EDITING||(i.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},Wve={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},jve={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},zve={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeActive();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},Uve={name:"editorOpen",callback(t,e,n){const{selection:i}=t,r=t._getEditorManager(),s=t.getSelectedRange(),o=t.getSelectedRangeActive(),{highlight:a}=o;if((s.some(l=>i.isMultiple(l))||s.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const l=t.getSettings(),c=typeof l.enterMoves=="function"?l.enterMoves(e):l.enterMoves;n.includes("shift")?i.transformFocus(-c.row,-c.col):i.transformFocus(c.row,c.col);return}a.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),es(e))}};function Yve(){return[Nve,Bve,Wve,jve,zve,Uve]}const Gve={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},qve={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:i}=t.getSelectedRangeActive(),r=Math.min(i.row+t.countVisibleRows(),t.countRows()-1),s=n.getNearestNotHiddenIndex(r,-1);if(s!==null){const o=t._createCellCoords(s,i.col),a=i.row-t.getFirstFullyVisibleRow(),l=Math.min(o.row-a,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(o,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}},Kve={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},Xve={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},Jve={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(i.col,r.col,n),e.markEndSource()}},Zve={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeActive(),o=i.isHeader()&&e.isSelectedByRowHeader();if(i.isCell()||o){const a=n.getNearestNotHiddenIndex(t.countRows()-1,-1),l=r.clone();l.row=i.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col)),e.markEndSource()}}},Qve={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&i.isCell()){const o=n.getNearestNotHiddenIndex(t.countCols()-1,-1),a=r.clone();a.col=i.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(s.row,o)),e.markEndSource()}}},ebe={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&i.isCell()){const o=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(o,1),l=r.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},tbe={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeActive(),o=i.isHeader()&&e.isSelectedByColumnHeader();if(i.isCell()||o){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=r.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},nbe={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeActive(),o=i.isHeader()&&e.isSelectedByColumnHeader();if(i.isCell()||o){const a=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=r.clone();l.col=i.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a)),e.markEndSource()}}},ibe={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:s}=t.getSelectedRangeActive(),o=i.isHeader()&&e.isSelectedByRowHeader();if(i.isCell()||o){const a=n.getNearestNotHiddenIndex(0,1),l=r.clone();l.row=i.row,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,i.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col)),e.markEndSource()}}},rbe={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(i.row,r.row,n),e.markEndSource()}},sbe={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},obe={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:i}=t.getSelectedRangeActive(),r=Math.max(i.row-t.countVisibleRows(),0),s=n.getNearestNotHiddenIndex(r,1);if(s!==null){const o=t._createCellCoords(s,i.col),a=i.row-t.getFirstFullyVisibleRow(),l=Math.max(o.row-a,0);e.markSource("keyboard"),e.setRangeEnd(o,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:l,verticalSnap:"top",horizontalSnap:"start"})}}};function abe(){return[Gve,qve,Kve,Xve,Jve,Zve,Qve,ebe,tbe,nbe,ibe,rbe,sbe,obe]}const lbe={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},cbe={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),i=n?t.countColHeaders():0,{row:r}=t.getSelectedRangeActive().highlight;let s=t.countVisibleRows()+i;s=s===0?1:s,r===t.countRows()-1?s=1:r+s>t.countRows()&&(s=t.countRows()-r-1),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}},ube={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,i=t.getSettings(),r=t.getSelectedRange(),s=t.getSelectedRangeActive(),o=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;n.markSource("keyboard"),(r.some(a=>n.isMultiple(a))||r.length>1)&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-o.row,-o.col):n.transformStart(-o.row,-o.col),n.markEndSource()}},hbe={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,i=t.getSettings(),r=t.getSelectedRange(),s=t.getSelectedRangeActive(),o=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;n.markSource("keyboard"),(r.some(a=>n.isMultiple(a))||r.length>1)&&!s.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(o.row,o.col):n.transformStart(o.row,o.col),n.markEndSource()}},dbe={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},fbe={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},gbe={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeActive().highlight;let i=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);i===null&&(i=-1),e.setRangeStart(t._createCellCoords(i,n))}},mbe={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsBottom,10),s=n.getNearestNotHiddenIndex(t.countRows()-r-1,-1),o=i.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,o)),e.markEndSource()}},pbe={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeActive().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},wbe={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedColumnsStart,10),r=t.getSelectedRangeActive().highlight.row,s=n.getNearestNotHiddenIndex(i,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,s)),e.markEndSource()}},vbe={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,i=t.getSelectedRangeActive().highlight.row;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);r===null&&(r=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,r)),e.markEndSource()}},bbe={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:i}=t.getSelectedRangeActive().highlight;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);r===null&&(r=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,r)),e.markEndSource()}},ybe={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeActive().highlight;let i=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);i===null&&(i=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,n)),e.markEndSource()}},Cbe={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),o=n.getNearestNotHiddenIndex(r,1),a=i.getNearestNotHiddenIndex(s,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,a)),e.markEndSource()}},Sbe={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},Rbe={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),i=n?t.countColHeaders():0,{row:r}=t.getSelectedRangeActive().highlight;let s=t.countVisibleRows()+i;s=s===0?-1:-s,r===-i?s=-1:r+s<i&&(s=-(r+i)),e.markSource("keyboard"),e.transformStart(s,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}};function _be(){return[lbe,cbe,ube,hbe,dbe,fbe,gbe,mbe,pbe,wbe,vbe,bbe,ybe,Cbe,Sbe,Rbe]}const Ebe={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},xbe={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeActive(),n=t.getFirstFullyVisibleRow()-1,i=t.getFirstFullyVisibleColumn()-1,r=t.getLastFullyVisibleRow()+1,s=t.getLastFullyVisibleColumn()+1,o=t._createCellCoords(n,i),a=t._createCellCoords(r,s);if(!t._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){const c={};if(e.col>=0){const u=Math.floor(t.countVisibleCols()/2);c.col=Math.max(e.col-u,0)}if(e.row>=0){const u=Math.floor(t.countVisibleRows()/2);c.row=Math.max(e.row-u,0)}t.scrollViewportTo({...c,verticalSnap:"top",horizontalSnap:"start"})}}},Tbe={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},Mbe={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},Pbe={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:i}=e[e.length-1].highlight.normalize(),r=t.getDataAtCell(n,i),s=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==n||l!==i)){const{readOnly:c}=t.getCellMeta(a,l);c||s.set(`${a}x${l}`,[a,l,r])}});t.setDataAtCell(Array.from(s.values()))}},Abe={name:"tabNavigation",callback(t){const e={wrapped:!1,flipped:!1};let n=!1,i=!1;return t.addHook("afterSelection",(r,s,o,a,l)=>{n&&(e.wrapped&&e.flipped||i)&&(i=!1,l.value=!0)}),t.addHook("beforeRowWrap",(r,s,o)=>{e.wrapped=!0,e.flipped=o}),{before(){const{tabNavigation:r}=t.getSettings();n=!0,r||(i=!0)},after(r){const{tabNavigation:s,autoWrapRow:o}=t.getSettings();if(n=!1,!s||!t.selection.isSelected()||o&&e.wrapped&&e.flipped||!o&&e.wrapped)return e.wrapped=!1,e.flipped=!1,t.deselectCell(),!1;r.preventDefault()}}}},Ibe=[...Yve(),...abe(),..._be(),Ebe,xbe,Tbe,Mbe,Pbe,Abe];function b3(t){const e={};return Ibe.forEach(n=>{let{name:i,callback:r}=n;e[i]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return r(t,...o)}}),e}function Obe(t){const e=t.getShortcutManager().addContext(Dve),n=b3(t),i={group:Vc};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(r,s)=>n.editorCloseAndSaveByEnter(r,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(r,s)=>n.editorCloseAndSaveByEnter(r,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext(WH),callback:(r,s)=>n.editorCloseAndSave(r,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(r,s)=>n.editorCloseAndSaveByArrowKeys(r,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],i)}function Hbe(t){const e=t.getShortcutManager().addContext(WH),n=b3(t),i={runOnlyIf:()=>{const{navigableHeaders:s}=t.getSettings();return se(t.getSelected())&&(s||!s&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:ep};e.addShortcuts([{keys:[["F2"]],callback:s=>n.editorFastOpen(s)},{keys:[["Enter"],["Enter","Shift"]],callback:(s,o)=>n.editorOpen(s,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Vc,runOnlyIf:()=>se(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var s;return!((s=t.getSelectedRangeActive())!==null&&s!==void 0&&s.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var s;return(s=t.getSelectedRangeActive())===null||s===void 0?void 0:s.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var s,o;return!((s=t.getSelectedRangeActive())!==null&&s!==void 0&&s.highlight.isHeader())&&((o=t.getSelectedRangeActive())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:s=>n.moveCellSelectionInlineStart(s)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:s=>n.moveCellSelectionInlineEnd(s)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],i);const r=n.tabNavigation();e.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:ep,group:dC,position:"before",callback:s=>r.before(s)},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:ep,group:dC,callback:s=>r.after(s),position:"after"}])}function kbe(t){[Hbe,Obe].forEach(e=>e(t))}function Dbe(t){var e;const n=kve(t),i={wrapped:!1,flipped:!1};let r,s=!0,o=!1;t.addHook("afterSelection",()=>{if(s){var c;r=(c=t.getSelectedRangeActive())===null||c===void 0?void 0:c.highlight}}),t.addHook("beforeRowWrap",(c,u,h)=>{i.wrapped=!0,i.flipped=h}),t.addHook("beforeEmptyDataStateShow",()=>{o=!0}),t.addHook("beforeEmptyDataStateHide",()=>{o=!1}),t.getShortcutManager().getContext(WH).addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:ep,group:dC,position:"before",callback(){const{tabNavigation:c}=t.getSettings();t.getSelectedRangeActive()&&!c&&(s=!1)}},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:ep,group:dC,callback(c){const{tabNavigation:u,autoWrapRow:h}=t.getSettings();s=!0,(!u||!t.selection.isSelected()||h&&i.wrapped&&i.flipped||!h&&i.wrapped)&&(h&&i.wrapped&&i.flipped&&(r=c.shiftKey?kP(t):DP(t)),i.wrapped=!1,i.flipped=!1)},position:"after"}]);const l=(e=t.rootGridElement)!==null&&e!==void 0?e:t.rootElement;t.getFocusScopeManager().registerScope("grid",l,{contains:c=>l===c||l.contains(c)?!0:c.closest(".htMenu")!==null?!1:t.rootPortalElement.contains(c),runOnlyIf:()=>{const{navigableHeaders:c}=t.getSettings();return(o||!c)&&t.countRenderedRows()===0&&t.countRenderedCols()===0&&t.countRowHeaders()>0&&t.countColHeaders()>0?!1:!c&&t.countRenderedRows()>0&&t.countRenderedCols()>0||c&&(t.countRowHeaders()>0||t.countColHeaders()>0)},onActivate:c=>{if(c==="tab_from_above"){var u;const d=(u=n(r))!==null&&u!==void 0?u:kP(t);d&&t.runHooks("modifyFocusOnTabNavigation","from_above",d)!==!1&&t.selectCell(d.row,d.col)}else if(c==="tab_from_below"){var h;const d=(h=n(r))!==null&&h!==void 0?h:DP(t);d&&t.runHooks("modifyFocusOnTabNavigation","from_below",d)!==!1&&t.selectCell(d.row,d.col)}}})}function Nbe(t){[Dbe].forEach(e=>e(t))}const W2=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Lv=t=>t.map(e=>{const n=e.toLowerCase();return W2.has(n)?W2.get(n):n}).sort().join("+"),Lbe=t=>t.split("+"),j2=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),Cx=t=>{let{which:e,key:n}=t;if(j2.has(e))return j2.get(e);const i=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(i)?i:n.toLowerCase()},y3=Symbol("shortcut-context");function NP(t){return Re(t)&&t.__kindOf===y3}const $be=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const n=xw({errorIdExists:c=>`The "${c}" shortcut is already registered in the "${t}" context.`}),i=function(){let{keys:c,callback:u,group:h,runOnlyIf:d=()=>!0,captureCtrl:f=!1,preventDefault:g=!0,stopPropagation:m=!1,relativeToGroup:p,position:v,forwardToContext:b}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Nt(h))throw new Error("You need to define the shortcut's group.");if(ht(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(c)===!1)throw new Error(ct`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const R={callback:u,group:h,runOnlyIf:d,captureCtrl:f,preventDefault:g,stopPropagation:m};se(p)&&(R.relativeToGroup=p,R.position=v),NP(b)&&(R.forwardToContext=b),c.forEach(S=>{const x=Lv(S);if(n.hasItem(x)){const T=n.getItem(x);let O=T.findIndex(W=>W.group===p);O!==-1?v==="before"?O-=1:O+=1:O=T.length,T.splice(O,0,R)}else n.addItem(x,[R])})},r=function(c){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};c.forEach(h=>{Ye(u,(d,f)=>{Object.prototype.hasOwnProperty.call(h,f)===!1&&(h[f]=u[f])}),i(h)})},s=c=>{const u=Lv(c);n.removeItem(u)};return{__kindOf:y3,scope:e,addShortcut:i,addShortcuts:r,getShortcuts:c=>{const u=Lv(c),h=n.getItem(u);return se(h)?h.slice():[]},hasShortcut:c=>{const u=Lv(c);return n.hasItem(u)},removeShortcutsByKeys:s,removeShortcutsByGroup:c=>{n.getItems().forEach(h=>{let[d,f]=h;const g=f.filter(m=>m.group!==c);g.length===0?s(Lbe(d)):(f.length=0,f.push(...g))})}}};function Fbe(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const Vbe=["meta","alt","shift","control"],Wg=Fbe(),jg=[];let $v=0;function Bbe(t,e,n,i,r){const s=f=>Vbe.includes(f),o=function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const m=[];return f.altKey&&m.push("alt"),g&&(f.ctrlKey||f.metaKey)?m.push("control/meta"):(f.ctrlKey&&m.push("control"),f.metaKey&&m.push("meta")),f.shiftKey&&m.push("shift"),m},a=f=>{if(e(f)===!1||n(f)===!1||f.keyCode===229||typeof f.key!="string"||Jl(f))return;const m=Cx(f);let p=[];s(m)||(p=o(f));const v=[m].concat(p);!r(f,v)&&(Qy()&&p.includes("meta")||!Qy()&&p.includes("control"))&&r(f,[m].concat(o(f,!0))),i(f)},l=f=>{if(typeof f.key=="string"){const g=Cx(f);s(g)&&Wg.press(g)}},c=f=>{if(typeof f.key=="string"){const g=Cx(f);s(g)&&Wg.release(g)}},u=()=>{Wg.releaseAll()};return{mount:()=>{let f=t;for($v+=1;f;)$v===1&&(f.document.documentElement.addEventListener("keydown",l),jg.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",c),jg.push({event:"keyup",listener:c})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",u),f=al(f)},unmount:()=>{let f=t;for($v-=1;f;){if($v===0){for(let g=0;g<jg.length;g++){const{event:m,listener:p}=jg[g];f.document.documentElement.removeEventListener(m,p)}jg.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",u),f=al(f)}},isPressed:f=>Wg.isPressed(f),releasePressedKeys:()=>Wg.releaseAll()}}const Wbe=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:i,afterKeyDown:r}=t;const s=xw({errorIdExists:p=>`The "${p}" context name is already registered.`});let o="grid";const a=function(p){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const b=$be(p,v);return s.addItem(p,b),b},l=()=>o,c=p=>s.getItem(p),u=function(p){var v;let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";return(v=c(p))!==null&&v!==void 0?v:a(p,b)},h=p=>{if(!s.hasItem(p))throw new Error(ct`You've tried to activate the "${p}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=p};let d=!1;const f=function(p,v){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const R=NP(b)?b:c(b);let S=!1;if(!R.hasShortcut(v))return S;const x=R.getShortcuts(v);for(let M=0;M<x.length;M++){const{callback:T,runOnlyIf:O,preventDefault:W,stopPropagation:N,captureCtrl:G,forwardToContext:j}=x[M];if(O(p)===!0){if(d=G,S=T(p,v)===!1,d=!1,W&&p.preventDefault(),N&&(es(p),p.stopPropagation()),S)break;j&&f(p,v,j)}}return S},m=Bbe(e,p=>{const v=l(),b=NP(v)?v:c(v);return n(p,b.scope)},i,r,f);return m.mount(),{addContext:a,getActiveContextName:l,getContext:c,getOrCreateContext:u,setActiveContextName:h,isCtrlPressed:()=>!d&&(m.isPressed("control")||m.isPressed("meta")),releasePressedKeys:()=>m.releasePressedKeys(),destroy:()=>m.unmount()}};function z2(t){const{classNames:e}=XK(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function jbe(t,e){C3(t,e),e.add(t)}function Ta(t,e,n){C3(t,e),e.set(t,n)}function C3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rn(t,e){return t.get(Qs(t,e))}function br(t,e,n){return t.set(Qs(t,e),n),n}function Qs(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const U2=23;var Sx=new WeakMap,Ro=new WeakMap,fC=new WeakMap,jH=new WeakMap,LP=new WeakMap,zl=new WeakMap,km=new WeakMap,Lp=new WeakMap,zg=new WeakMap,jo=new WeakSet;class zbe{constructor(e){let{hot:n,rootElement:i,rootDocument:r,onThemeChange:s=()=>{}}=e;jbe(this,jo),Ta(this,Sx,void 0),Ta(this,Ro,void 0),Ta(this,fC,void 0),Ta(this,jH,void 0),Ta(this,LP,void 0),Ta(this,zl,!0),Ta(this,km,{}),Ta(this,Lp,{}),Ta(this,zg,void 0),br(Sx,this,n),br(fC,this,i),br(LP,this,r),br(zg,this,s)}isClassicTheme(){return rn(zl,this)}getCSSVariableValue(e){var n;if(rn(zl,this))return null;if(rn(km,this)[`--ht-${e}`])return rn(km,this)[`--ht-${e}`];const i=(n=Qs(jo,this,Gbe).call(this,`--ht-${e}`))!==null&&n!==void 0?n:Qs(jo,this,S3).call(this,`--ht-${e}`);if(i!==null)return rn(km,this)[`--ht-${e}`]=i,i}getStyleForTD(e){var n;return(n=rn(Lp,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(e){if(rn(zl,this))return U2;const n=Qs(jo,this,Ube).call(this);return n?e!==void 0&&e===rn(Sx,this).view.getFirstRenderedVisibleRow()?n+1:n:U2}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){br(Ro,this,void 0),br(zl,this,!0),rn(zg,this).call(this,rn(Ro,this)),Qs(jo,this,Rx).call(this);return}if(e&&e!==rn(Ro,this)){if(!/ht-theme-.*/.test(e)){Ue(`Invalid theme name: ${e}. Please provide a valid theme name.`),br(Ro,this,void 0),br(zl,this,!1),rn(zg,this).call(this,rn(Ro,this)),Qs(jo,this,Rx).call(this);return}rn(Ro,this)&&Qs(jo,this,qbe).call(this),br(Ro,this,e),br(zl,this,!1),rn(zg,this).call(this,rn(Ro,this)),Qs(jo,this,Rx).call(this)}}getThemeName(){return rn(Ro,this)}}function Ube(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function Rx(){this.isClassicTheme()||br(jH,this,getComputedStyle(rn(fC,this)));const t=Qs(jo,this,Ybe).call(this,["box-sizing","border-bottom-width"]);rn(Lp,this).td={...rn(Lp,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function Ybe(t){const e=rn(LP,this),n=rn(fC,this),i=e.createElement("table"),r=e.createElement("tbody"),s=e.createElement("tr"),o=e.createElement("tr"),a=e.createElement("td");o.appendChild(a),r.appendChild(s),r.appendChild(o),i.appendChild(r),n.appendChild(i);const l=getComputedStyle(a),c={};return t.forEach(u=>{c[u]=l.getPropertyValue(u)}),n.removeChild(i),c}function Gbe(t){const e=Math.ceil(parseFloat(Qs(jo,this,S3).call(this,t)));return Number.isNaN(e)?null:e}function S3(t){const e=rn(jH,this).getPropertyValue(t);return e===""?null:e}function qbe(){br(Lp,this,{}),br(km,this,{}),br(zl,this,!0)}let Xr=null,ly=0;function Kbe(t){const e=t.ownerDocument;if(!Xr){Xr=e.createElement("div"),Xr.setAttribute("role","status"),Xr.setAttribute("aria-live","assertive"),Xr.setAttribute("aria-atomic","true");const n=Xr.style;n.position="absolute",n.width="1px",n.height="1px",n.margin="-1px",n.overflow="hidden",n.clipPath="rect(0 0 0 0)",n.whiteSpace="nowrap",t.appendChild(Xr)}ly+=1}function Xbe(){ly!==0&&(ly===1&&(Xr.remove(),Xr=null),ly-=1)}function Jbe(t){Xr&&(Xr.textContent="",setTimeout(()=>{Xr&&(Xr.textContent=t)},100))}let _x=null;const Fv=new WeakSet,Ex=new Map;function R3(t,e){var n,i,r=this;let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=this;const a=new As(o);let l,c,u,h,d,f,g=!0;const m={...e.initialState,...e};Qme(s)&&Zme(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootGridElement=void 0,this.rootPortalElement=void 0,this.rootElement=Fo(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Fo(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootGridElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),q(this.rootElement,["ht-wrapper","handsontable"]),q(this.rootWrapperElement,"ht-root-wrapper"),q(this.rootGridElement,"ht-grid"),this.rootGridElement.appendChild(this.rootElement),this.rootWrapperElement.appendChild(this.rootGridElement),this.rootContainer.appendChild(this.rootWrapperElement),q(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const p=(n=m?.layoutDirection)!==null&&n!==void 0?n:"inherit",v=["rtl","ltr"].includes(p)?p:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",v),(i=this.rootWrapperElement)===null||i===void 0||i.setAttribute("dir",v),this.isRtl=function(){return v==="rtl"},this.isLtr=function(){return!o.isRtl()},this.getDirectionFactor=function(){return o.isLtr()?1:-1},this.stylesHandler=new zbe({hot:o,rootElement:o.rootElement,rootDocument:o.rootDocument,onThemeChange:w=>{Fo(this)&&(ue(this.rootWrapperElement,/ht-theme-.*/g),ue(this.rootPortalElement,/ht-theme-.*/g),w&&(q(this.rootWrapperElement,w),q(this.rootPortalElement,w),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||Ue(`The "${w}" theme is enabled, but its stylesheets are missing or not imported correctly.               Import the correct CSS files in order to use that theme.`)))}}),m.language=Zpe(m.language);const b=Object.fromEntries(Object.entries(m).filter(w=>{let[C]=w;return!(le.getSingleton().isRegistered(C)||le.getSingleton().isDeprecated(C))})),R=new m3(o,b,[rve,hve]),S=R.getTableMeta(),x=R.getGlobalMeta(),M=xw();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),this.guid=`ht_${sO()}`,Ex.set(this.guid,this),this.columnIndexMapper=new PP,this.rowIndexMapper=new PP,this.columnIndexMapper.addLocalHook("indexesSequenceChange",w=>{o.runHooks("afterColumnSequenceChange",w)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",w=>{o.runHooks("afterRowSequenceChange",w)}),a.addEventListener(this.rootDocument.documentElement,"compositionstart",w=>{o.runHooks("beforeCompositionStart",w)}),c=new mpe(o);const T=ks(this.guid);T.register("cellRangeMapper",new fve({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const O=w=>{const{row:C,col:E}=w;return o._createCellCoords(C>=0?o.rowIndexMapper.getRenderableFromVisualIndex(C):C,E>=0?o.columnIndexMapper.getRenderableFromVisualIndex(E):E)},W=w=>{const{row:C,col:E}=w;return o._createCellCoords(C>=0?o.rowIndexMapper.getVisualFromRenderableIndex(C):C,E>=0?o.columnIndexMapper.getVisualFromRenderableIndex(E):E)},N=(w,C)=>{const E=C>w?1:-1,D=Math.min(w,C),B=Math.max(w,C),y=o.rowIndexMapper.getNearestNotHiddenIndex(w,E);return y===null||E===1&&y>B||E===-1&&y<D?null:y>=0?o.rowIndexMapper.getRenderableFromVisualIndex(y):y},G=(w,C)=>{const E=C>w?1:-1,D=Math.min(w,C),B=Math.max(w,C),y=o.columnIndexMapper.getNearestNotHiddenIndex(w,E);return y===null||E===1&&y>B||E===-1&&y<D?null:y>=0?o.columnIndexMapper.getRenderableFromVisualIndex(y):y};let j=new d3(S,{rowIndexMapper:o.rowIndexMapper,columnIndexMapper:o.columnIndexMapper,countCols:()=>o.countCols(),countRows:()=>o.countRows(),propToCol:w=>l.propToCol(w),isEditorOpened:()=>o.getActiveEditor()?o.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>o.getShortcutManager(),createCellCoords:(w,C)=>o._createCellCoords(w,C),createCellRange:(w,C,E)=>o._createCellRange(w,C,E),visualToRenderableCoords:O,renderableToVisualCoords:W,findFirstNonHiddenRenderableRow:N,findFirstNonHiddenRenderableColumn:G,isDisabledCellSelection:(w,C)=>w<0||C<0?o.getSettings().disableVisualSelection:o.getCellMeta(w,C).disableVisualSelection});this.selection=j;const ne=w=>{let{hiddenIndexesChanged:C}=w;this.forceFullRender=!0,C&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",w=>{ne(w),this.runHooks("afterColumnSequenceCacheUpdate",w)}),this.rowIndexMapper.addLocalHook("cacheUpdated",w=>{ne(w),this.runHooks("afterRowSequenceCacheUpdate",w)}),this.selection.addLocalHook("afterSetRangeEnd",(w,C)=>{const E=xr(!1),D=this.selection.getSelectedRange(),{from:B,to:y}=D.current(),_=D.size()-1;this.runHooks("afterSelection",B.row,B.col,y.row,y.col,E,_),this.runHooks("afterSelectionByProp",B.row,o.colToProp(B.col),y.row,o.colToProp(y.col),E,_),C&&(!E.isTouched()||E.isTouched()&&!E.value)&&f.scrollTo(w);const P=j.isSelectedByRowHeader(),L=j.isSelectedByColumnHeader();P&&L?q(this.rootElement,["ht__selection--rows","ht__selection--columns"]):P?(ue(this.rootElement,"ht__selection--columns"),q(this.rootElement,"ht__selection--rows")):L?(ue(this.rootElement,"ht__selection--rows"),q(this.rootElement,"ht__selection--columns")):ue(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(j.getSelectionSource())||h.closeEditor(null),j.getSelectionSource()!=="refresh"&&(o.view.render(),h.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",w=>{this.runHooks("beforeSelectionFocusSet",w.row,w.col)}),this.selection.addLocalHook("afterSetFocus",w=>{const C=xr(!1);this.runHooks("afterSelectionFocusSet",w.row,w.col,C),(!C.isTouched()||C.isTouched()&&!C.value)&&f.scrollTo(w),h.closeEditor(),o.view.render(),h.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",w=>{const C=w.length-1,{from:E,to:D}=w[C];this.runHooks("afterSelectionEnd",E.row,E.col,D.row,D.col,C),this.runHooks("afterSelectionEndByProp",E.row,o.colToProp(E.col),D.row,o.colToProp(D.col),C),j.getSelectionSource()==="refresh"&&(o.view.render(),h.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",w=>{const C=this.runHooks("afterIsMultipleSelection",w.value);w.value&&(w.value=C)}),this.selection.addLocalHook("afterDeselect",()=>{h.closeEditor(),o.view.render(),ue(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var w=arguments.length,C=new Array(w),E=0;E<w;E++)C[E]=arguments[E];return r.runHooks("beforeSetRangeStart",...C)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var w=arguments.length,C=new Array(w),E=0;E<w;E++)C[E]=arguments[E];return r.runHooks("beforeSetRangeStartOnly",...C)}).addLocalHook("beforeSetRangeEnd",function(){for(var w=arguments.length,C=new Array(w),E=0;E<w;E++)C[E]=arguments[E];return r.runHooks("beforeSetRangeEnd",...C)}).addLocalHook("beforeSelectColumns",function(){for(var w=arguments.length,C=new Array(w),E=0;E<w;E++)C[E]=arguments[E];return r.runHooks("beforeSelectColumns",...C)}).addLocalHook("afterSelectColumns",function(){for(var w=arguments.length,C=new Array(w),E=0;E<w;E++)C[E]=arguments[E];return r.runHooks("afterSelectColumns",...C)}).addLocalHook("beforeSelectRows",function(){for(var w=arguments.length,C=new Array(w),E=0;E<w;E++)C[E]=arguments[E];return r.runHooks("beforeSelectRows",...C)}).addLocalHook("afterSelectRows",function(){for(var w=arguments.length,C=new Array(w),E=0;E<w;E++)C[E]=arguments[E];return r.runHooks("afterSelectRows",...C)}).addLocalHook("beforeSelectAll",function(){for(var w=arguments.length,C=new Array(w),E=0;E<w;E++)C[E]=arguments[E];return r.runHooks("beforeSelectAll",...C)}).addLocalHook("afterSelectAll",function(){for(var w=arguments.length,C=new Array(w),E=0;E<w;E++)C[E]=arguments[E];return r.runHooks("afterSelectAll",...C)}).addLocalHook("beforeModifyTransformStart",function(){for(var w=arguments.length,C=new Array(w),E=0;E<w;E++)C[E]=arguments[E];return r.runHooks("modifyTransformStart",...C)}).addLocalHook("afterModifyTransformStart",function(){for(var w=arguments.length,C=new Array(w),E=0;E<w;E++)C[E]=arguments[E];return r.runHooks("afterModifyTransformStart",...C)}).addLocalHook("beforeModifyTransformFocus",function(){for(var w=arguments.length,C=new Array(w),E=0;E<w;E++)C[E]=arguments[E];return r.runHooks("modifyTransformFocus",...C)}).addLocalHook("afterModifyTransformFocus",function(){for(var w=arguments.length,C=new Array(w),E=0;E<w;E++)C[E]=arguments[E];return r.runHooks("afterModifyTransformFocus",...C)}).addLocalHook("beforeModifyTransformEnd",function(){for(var w=arguments.length,C=new Array(w),E=0;E<w;E++)C[E]=arguments[E];return r.runHooks("modifyTransformEnd",...C)}).addLocalHook("afterModifyTransformEnd",function(){for(var w=arguments.length,C=new Array(w),E=0;E<w;E++)C[E]=arguments[E];return r.runHooks("afterModifyTransformEnd",...C)}).addLocalHook("beforeRowWrap",function(){for(var w=arguments.length,C=new Array(w),E=0;E<w;E++)C[E]=arguments[E];return r.runHooks("beforeRowWrap",...C)}).addLocalHook("beforeColumnWrap",function(){for(var w=arguments.length,C=new Array(w),E=0;E<w;E++)C[E]=arguments[E];return r.runHooks("beforeColumnWrap",...C)}).addLocalHook("insertRowRequire",w=>this.alter("insert_row_above",w,1,"auto")).addLocalHook("insertColRequire",w=>this.alter("insert_col_start",w,1,"auto")),u={alter(w,C){let E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,D=arguments.length>3?arguments[3]:void 0,B=arguments.length>4?arguments[4]:void 0;const y=_=>{if(_.length===0)return[];const P=[..._];return P.sort((I,A)=>{let[V]=I,[H]=A;return V===H?0:V>H?1:-1}),Un(P,(I,A)=>{let[V,H]=A;const $=I[I.length-1],[U,z]=$,J=U+z;if(V<=J){const ce=Math.max(H-(J-V),0);$[1]+=ce}else I.push([V,H]);return I},[P[0]])};switch(w){case"insert_row_below":case"insert_row_above":const _=o.countSourceRows();if(S.maxRows===_)return;const P=w==="insert_row_below"?"below":"above";C=C??(P==="below"?_:0);const{delta:L,startPhysicalIndex:I}=l.createRow(C,E,{source:D,mode:P});j.shiftRows(o.toVisualRow(I),L);break;case"insert_col_start":case"insert_col_end":const A=w==="insert_col_end"?"end":"start";C=C??(A==="end"?o.countSourceCols():0);const{delta:V,startPhysicalIndex:H}=l.createCol(C,E,{source:D,mode:A});if(V){if(Array.isArray(S.colHeaders)){const z=[o.toVisualColumn(H),0];z.length+=V,Array.prototype.splice.apply(S.colHeaders,z)}j.shiftColumns(o.toVisualColumn(H),V)}break;case"remove_row":const $=z=>{let J=0;k(z,ce=>{let[re,Pe]=ce;const Je=hn(re)?o.countRows()-1:Math.max(re-J,0);if(Number.isInteger(re)&&(re=Math.max(re-J,0)),!l.removeRow(re,Pe,D))return;if(j.isSelected()){const{row:fn}=o.getSelectedRangeActive().highlight;fn>=re&&fn<=re+Pe-1&&h.closeEditor(!0)}const Ae=o.countRows(),Ze=S.fixedRowsTop;Ze>=Je+1&&(S.fixedRowsTop-=Math.min(Pe,Ze-Je));const dt=S.fixedRowsBottom;if(dt&&Je>=Ae-dt&&(S.fixedRowsBottom-=Math.min(Pe,dt)),Ae===0)j.deselect();else if(D==="ContextMenu.removeRow"){const fn=j.getSelectedRange(),fi=fn.pop();fn.clear().set(fi.from).current().setTo(fi.to),j.refresh()}else j.shiftRows(re,-Pe);J+=Pe})};Array.isArray(C)?$(y(C)):$([[C,E]]);break;case"remove_col":const U=z=>{let J=0;k(z,ce=>{let[re,Pe]=ce;const Je=hn(re)?o.countCols()-1:Math.max(re-J,0);let at=o.toPhysicalColumn(Je);if(Number.isInteger(re)&&(re=Math.max(re-J,0)),!l.removeCol(re,Pe,D))return;if(j.isSelected()){const{col:fn}=o.getSelectedRangeActive().highlight;fn>=re&&fn<=re+Pe-1&&h.closeEditor(!0)}if(o.countCols()===0)j.deselect();else if(D==="ContextMenu.removeColumn"){const fn=j.getSelectedRange(),fi=fn.pop();fn.clear().set(fi.from).current().setTo(fi.to),j.refresh()}else j.shiftColumns(re,-Pe);const dt=S.fixedColumnsStart;dt>=Je+1&&(S.fixedColumnsStart-=Math.min(Pe,dt-Je)),Array.isArray(S.colHeaders)&&(typeof at>"u"&&(at=-1),S.colHeaders.splice(at,Pe)),J+=Pe})};Array.isArray(C)?U(y(C)):U([[C,E]]);break;default:throw new Error(`There is no such action "${w}"`)}B||u.adjustRowsAndCols(),o.view.adjustElementsSize(),o.view.render()},adjustRowsAndCols(){const w=S.minRows,C=S.minSpareRows,E=S.minCols,D=S.minSpareCols;if(w){const B=o.countRows();B<w&&l.createRow(B,w-B,{source:"auto"})}if(C){const B=o.countEmptyRows(!0);if(B<C){const y=C-B,_=Math.min(y,S.maxRows-o.countSourceRows());l.createRow(o.countRows(),_,{source:"auto"})}}{let B;(E||D)&&(B=o.countEmptyCols(!0));let y=o.countCols();if(E&&!S.columns&&y<E){const _=E-y;B+=_,l.createCol(y,_,{source:"auto"})}if(D&&!S.columns&&o.dataType==="array"&&B<D){y=o.countCols();const _=D-B,P=Math.min(_,S.maxCols-y);l.createCol(y,P,{source:"auto"})}}},populateFromArray(w,C,E,D,B){let y,_,P,L;const I=[],A={},V=[],H=w.row,$=w.col;if(_=C.length,_===0)return!1;let U=0,z=0;switch(Re(E)&&(U=E.col-$+1,z=E.row-H+1),B){case"shift_down":const ce=Ym(C),re=ce.length,Pe=Math.max(re,U),Je=o.getData().slice(H),at=Ym(Je).slice($,$+Pe);for(P=0;P<Pe;P+=1)if(P<re){for(y=0,_=ce[P].length;y<z-_;y+=1)ce[P].push(ce[P][y%_]);P<at.length?V.push(ce[P].concat(at[P])):V.push(ce[P].concat(new Array(Je.length).fill(null)))}else V.push(ce[P%re].concat(at[P]));o.populateFromArray(H,$,Ym(V));break;case"shift_right":const Ae=C.length,Ze=Math.max(Ae,z),dt=o.getData().slice(H).map(rt=>rt.slice($));for(y=0;y<Ze;y+=1)if(y<Ae){for(P=0,L=C[y].length;P<U-L;P+=1)C[y].push(C[y][P%L]);if(y<dt.length)for(let rt=0;rt<dt[y].length;rt+=1)C[y].push(dt[y][rt]);else C[y].push(...new Array(dt[0].length).fill(null))}else C.push(C[y%_].slice(0,Ze).concat(dt[y]));o.populateFromArray(H,$,C);break;default:A.row=w.row,A.col=w.col;let fn=0,fi=0,os=!0,gn;const Or=function(wl){let vl=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const po=C[wl%C.length];return vl!==null?po[vl%po.length]:po},$t=C.length,Ht=E?E.row-w.row+1:0;for(E?_=Ht:_=Math.max($t,Ht),y=0;y<_&&!(E&&A.row>E.row&&Ht>$t||!S.allowInsertRow&&A.row>o.countRows()-1||A.row>=S.maxRows);y++){const rt=y-fn,wl=Or(rt).length,vl=E?E.col-w.col+1:0;if(E?L=vl:L=Math.max(wl,vl),A.col=w.col,gn=o.getCellMeta(A.row,A.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&gn.skipRowOnPaste){fn+=1,A.row+=1,_+=1;continue}for(fi=0,P=0;P<L;P++){var J;if(E&&A.col>E.col&&vl>wl||!S.allowInsertColumn&&A.col>o.countCols()-1||A.col>=S.maxCols)break;if(gn=o.getCellMeta(A.row,A.col),(D==="CopyPaste.paste"||D==="Autofill.fill")&&gn.skipColumnOnPaste){fi+=1,A.col+=1,L+=1;continue}if(gn.readOnly&&D!=="UndoRedo.undo"){A.col+=1;continue}const po=P-fi,bl=!!gn.valueSetter;let as=Or(rt,po),gi=(J=o.getSourceDataAtCell(A.row,A.col))!==null&&J!==void 0?J:null;if(as!==null&&typeof as=="object"){if(Array.isArray(as)&&gi===null&&(gi=[]),!bl&&(typeof gi!="object"||gi===null))os=!1;else if(gi!==null){const Bw=Pf(Array.isArray(gi)?gi:gi[0]||gi),Ww=Pf(Array.isArray(as)?as:as[0]||as);bl||Cw(Bw,Ww)||Array.isArray(Bw)&&Array.isArray(Ww)?as=Vi(as):os=!1}}else!bl&&gi!==null&&typeof gi=="object"&&(os=!1);os&&I.push([A.row,A.col,as]),os=!0,A.col+=1}A.row+=1}o.setDataAtCell(I,null,null,D||"populateFromArray");break}}};function ee(w){const C=Z5(w);NH(C)?(o.runHooks("beforeLanguageChange",C),x.language=C,o.runHooks("afterLanguageChange",C)):Q5(w)}function Q(w,C){const E=w==="className"?o.rootElement:o.table;if(g)q(E,C);else{let D=[],B=[];x[w]&&(D=Array.isArray(x[w])?x[w]:mP(x[w])),C&&(B=Array.isArray(C)?C:mP(C));const y=gP(D,B),_=gP(B,D);y.length&&ue(E,y),_.length&&q(E,_)}x[w]=C}this.init=function(){c.setData(S.data),o.runHooks("beforeInit"),(ro()||US())&&q(o.rootElement,"mobile"),this.updateSettings(m,!0),this.view=new ipe(this),h=bP.getInstance(o,S,j),f=Cve(o),d.init(),Fo(this)&&(Kbe(o.rootPortalElement),IK(m.licenseKey,this.rootWrapperElement)),o.runHooks("init"),this.render(),g&&o.rootElement.offsetParent===null&&o5(o.rootElement,()=>{o.view._wt.wtOverlays.updateLastSpreaderSize(),o.view.adjustElementsSize(),o.render()}),typeof g=="object"&&(o.runHooks("afterChange",g[0],g[1]),g=!1),o.runHooks("afterInit")};function me(){let w=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,w=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&w===!1&&(w=!0,this.onQueueEmpty(this.valid))}}}function fe(w,C,E){if(!w.length){E();return}const D=o.getActiveEditor(),B=new me;let y=!0;B.onQueueEmpty=()=>{D&&y&&D.cancelChanges(),E()};for(let _=w.length-1;_>=0;_--){const[P,L,,I]=w[_],A=l.propToCol(L);let V;Number.isInteger(A)?V=o.getCellMeta(P,A):V={...Object.getPrototypeOf(S),...S},o.getCellValidator(V)&&(B.addValidatorToQueue(),o.validateCell(I,V,(function(H,$){return function(U){if(typeof U!="boolean")throw new Error("Validation error: result is not boolean");U===!1&&$.allowInvalid===!1&&(y=!1,w.splice(H,1),$.valid=!0),B.removeValidatorFormQueue()}})(_,V),C))}B.checkIfQueueIsEmpty()}function ye(w,C){for(let D=w.length-1;D>=0;D--){let B=!1;if(w[D]===null){w.splice(D,1);continue}if(!((w[D][2]===null||w[D][2]===void 0)&&(w[D][3]===null||w[D][3]===void 0))){if(S.allowInsertRow)for(;w[D][0]>o.countRows()-1;){const{delta:y}=l.createRow(void 0,void 0,{source:"auto"});if(y===0){B=!0;break}}if(o.dataType==="array"&&(!S.columns||S.columns.length===0)&&S.allowInsertColumn)for(;l.propToCol(w[D][1])>o.countCols()-1;){const{delta:y}=l.createCol(void 0,void 0,{source:"auto"});if(y===0){B=!0;break}}B||l.set(w[D][0],w[D][1],w[D][3])}}if(w.length>0){u.adjustRowsAndCols(),o.runHooks("beforeChangeRender",w,C),h.closeEditor(),o.view.adjustElementsSize(),o.render(),h.prepareEditor(),o.runHooks("afterChange",w,C||"edit");const D=o.getActiveEditor();D&&se(D.refreshValue)&&D.refreshValue()}else o.render()}this._createCellCoords=function(w,C){return o.view._wt.createCellCoords(w,C)},this._createCellRange=function(w,C,E){return o.view._wt.createCellRange(w,C,E)},this.validateCell=function(w,C,E,D){let B=o.getCellValidator(C);function y(_){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||C.hidden===!0){E(_);return}const L=C.visualCol,I=C.visualRow,A=o.getCell(I,L,!0);if(A&&A.nodeName!=="TH"){const V=o.rowIndexMapper.getRenderableFromVisualIndex(I),H=o.columnIndexMapper.getRenderableFromVisualIndex(L);o.view._wt.getSetting("cellRenderer",V,H,A)}E(_)}AK(B)&&(B=(function(_){return function(P,L){L(_.test(P))}})(B)),ht(B)?(w=o.runHooks("beforeValidate",w,C.visualRow,C.prop,D),o._registerImmediate(()=>{B.call(C,w,_=>{o&&(_=o.runHooks("afterValidate",_,w,C.visualRow,C.prop,D),C.valid=_,y(_),o.runHooks("postAfterValidate",_,w,C.visualRow,C.prop,D))})})):o._registerImmediate(()=>{C.valid=!0,y(C.valid,!1)})};function Oe(w,C,E){return Array.isArray(w)?w:[[w,C,E]]}function Ce(w,C){const E=o.runHooks("beforeChange",w,C||"edit"),D=w.filter(y=>y!==null);if(E===!1||D.length===0){var B;return(B=o.getActiveEditor())===null||B===void 0||B.cancelChanges(),[]}for(let y=D.length-1;y>=0;y--){const[_,P,,L]=D[y],I=l.propToCol(P);let A;Number.isInteger(I)?A=o.getCellMeta(_,I):A={...Object.getPrototypeOf(S),...S},D[y][3]=bx(L,A)}return D}this.setDataAtCell=function(w,C,E,D){const B=Oe(w,C,E),y=[];let _=D,P,L,I;for(P=0,L=B.length;P<L;P++){const[V,H,$]=B[P];if(typeof B[P]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof H!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");H>=this.countCols()?I=H:I=l.colToProp(H),y.push([V,I,c.getAtCell(this.toPhysicalRow(V),H),$])}!_&&typeof w=="object"&&(_=C);const A=Ce(y,_);o.runHooks("afterSetDataAtCell",A,_),fe(A,_,()=>{ye(A,_)})},this.setDataAtRowProp=function(w,C,E,D){const B=Oe(w,C,E),y=[];let _=D,P,L;for(P=0,L=B.length;P<L;P++){const[A,V,H]=B[P];y.push([A,V,c.getAtCell(this.toPhysicalRow(A),V),H])}!_&&typeof w=="object"&&(_=C);const I=Ce(y,D);o.runHooks("afterSetDataAtRowProp",I,_),fe(I,_,()=>{ye(I,_)})},this.listen=function(){o&&!o.isListening()&&(Ex.forEach(w=>{o!==w&&w.unlisten()}),_x=o.guid,o.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(_x=null,o.runHooks("afterUnlisten"))},this.isListening=function(){return _x===o.guid},this.destroyEditor=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;h.closeEditor(w),o.view.render(),C&&j.isSelected()&&h.prepareEditor()},this.populateFromArray=function(w,C,E,D,B,y,_){if(!(typeof E=="object"&&typeof E[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const P=typeof D=="number"?o._createCellCoords(D,B):null;return u.populateFromArray(o._createCellCoords(w,C),E,P,y,_)},this.spliceCol=function(w,C,E){for(var D=arguments.length,B=new Array(D>3?D-3:0),y=3;y<D;y++)B[y-3]=arguments[y];return l.spliceCol(w,C,E,...B)},this.spliceRow=function(w,C,E){for(var D=arguments.length,B=new Array(D>3?D-3:0),y=3;y<D;y++)B[y-3]=arguments[y];return l.spliceRow(w,C,E,...B)},this.getSelected=function(){if(j.isSelected())return lt(j.getSelectedRange(),w=>{let{from:C,to:E}=w;return[C.row,C.col,E.row,E.col]})},this.getSelectedLast=function(){const w=this.getSelected();let C;return w&&w.length>0&&(C=w[w.length-1]),C},this.getSelectedActive=function(){const w=this.getSelectedRangeActive();if(!w)return;const{from:C,to:E}=w;return[C.row,C.col,E.row,E.col]},this.getSelectedRange=function(){if(j.isSelected())return Array.from(j.getSelectedRange())},this.getSelectedRangeLast=function(){const w=this.getSelectedRange();let C;return w&&w.length>0&&(C=w[w.length-1]),C},this.getSelectedRangeActive=function(){return j.getActiveSelectedRange()},this.getActiveSelectionLayerIndex=function(){return j.getActiveSelectionLayerIndex()},this.emptySelectedCells=function(w){if(!j.isSelected()||this.countRows()===0||this.countCols()===0)return;const C=[];k(j.getSelectedRange(),E=>{if(E.isSingleHeader())return;const D=E.getTopStartCorner(),B=E.getBottomEndCorner();pe(D.row,B.row,y=>{pe(D.col,B.col,_=>{this.getCellMeta(y,_).readOnly||C.push([y,_,null])})})}),C.length>0&&this.setDataAtCell(C,w)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const w=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(w,0),!this.isRenderSuspended()&&w===this.renderSuspendedCounter&&o.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||o.view.render())},this.batchRender=function(w){this.suspendRender();const C=w();return this.resumeRender(),C},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const C=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(C,0),(!this.isExecutionSuspended()&&C===this.executionSuspendedCounter||w)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const E=w();return this.resumeExecution(C),E},this.batch=function(w){this.suspendRender(),this.suspendExecution();const C=w();return this.resumeExecution(),this.resumeRender(),C},this.refreshDimensions=function(){if(!o.view)return;const w=o.view,{width:C,height:E}=w.getLastSize(),{width:D,height:B}=o.rootElement.getBoundingClientRect(),y=D!==C||B!==E;o.runHooks("beforeRefreshDimensions",{width:C,height:E},{width:D,height:B},y)!==!1&&((y||w._wt.wtOverlays.scrollableElement===o.rootWindow)&&(w.setLastSize(D,B),w.adjustElementsSize(),o.render()),o.runHooks("afterRefreshDimensions",{width:C,height:E},{width:D,height:B},y))},this.updateData=function(w,C){O2(w,E=>{l=E},E=>{l=E,o.columnIndexMapper.fitToLength(this.getInitialColumnCount()),o.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),j.refresh()},{hotInstance:o,dataMap:l,dataSource:c,internalSource:"updateData",source:C,metaManager:R,firstRun:g})},this.loadData=function(w,C){O2(w,E=>{l=E},()=>{R.clearCellsCache(),o.initIndexMappers(),u.adjustRowsAndCols(),j.refresh(),g&&(g=[null,"loadData"])},{hotInstance:o,dataMap:l,dataSource:c,internalSource:"loadData",source:C,metaManager:R,firstRun:g})},this.getInitialColumnCount=function(){const w=S.columns;let C=0;if(Array.isArray(w))C=w.length;else if(ht(w))if(o.dataType==="array"){const E=this.countSourceCols();for(let D=0;D<E;D+=1)w(D)&&(C+=1)}else(o.dataType==="object"||o.dataType==="function")&&(C=l.colToPropCache.length);else if(se(S.dataSchema)){const E=l.getSchema();C=Array.isArray(E)?E.length:zS(E)}else C=this.countSourceCols();return C},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(w,C,E,D){return Nt(w)?l.getAll():l.getRange(o._createCellCoords(w,C),o._createCellCoords(E,D),l.DESTINATION_RENDERER)},this.getCopyableText=function(w,C,E,D){return l.getCopyableText(o._createCellCoords(w,C),o._createCellCoords(E,D))},this.getCopyableData=function(w,C){return l.getCopyable(w,l.colToProp(C))},this.getCopyableSourceData=function(w,C){return c.getCopyable(w,l.colToProp(C))},this.getSchema=function(){return l.getSchema()},this.updateSettings=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const E=(g?o.loadData:o.updateData).bind(this);let D=!1,B,y;if(se(w.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(se(w.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(se(w.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');se(w.rowHeights)&&se(w.minRowHeights)&&Ue("Both `rowHeights` and `minRowHeights` are defined in your configuration. As one is the alias of the other, only one of them can be used at a time. `rowHeights` will be used as the row height configuration.");for(B in w)if(!(B==="data"||B==="language"))if(B==="className")Q("className",w.className);else if(B==="tableClassName"&&o.table)Q("tableClassName",w.tableClassName),o.view._wt.wtOverlays.syncOverlayTableClassNames();else if(le.getSingleton().isRegistered(B)||le.getSingleton().isDeprecated(B)){const A=w[B];ht(A)?(le.getSingleton().addAsFixed(B,A,o),S[B]=A):Array.isArray(A)&&(le.getSingleton().add(B,A,o),S[B]=A)}else!C&&ln(w,B)&&(x[B]=w[B]);if(C)o.useTheme(S.themeName||z2(o.rootContainer));else{const A=o.getCurrentThemeName();ln(w,"themeName")&&A!==w.themeName&&o.useTheme(w.themeName)}Fv.has(o)&&o.stylesHandler.getThemeName()!==void 0&&Fv.delete(o),Fo(o)&&!Fv.has(o)&&o.stylesHandler.isClassicTheme()&&(g5("The stylesheet you are using is deprecated and will be removed in version 17.0. Please update your theme configuration to ensure compatibility with future releases."),Fv.add(o)),w.data===void 0&&S.data===void 0?E(null,"updateSettings"):w.data!==void 0?E(w.data,"updateSettings"):w.columns!==void 0&&(l.createMap(),o.initIndexMappers()),!g&&w.language&&ee(w.language);const _=o.countCols(),P=S.columns;if(P&&ht(P)&&(D=!0),(w.cell!==void 0||w.cells!==void 0||w.columns!==void 0)&&R.clearCache(),_>0)for(B=0,y=0;B<_;B++){if(P){const A=D?P(B):P[y];A&&R.updateColumnMeta(y,A)}y+=1}se(w.cell)&&Ye(w.cell,A=>{o.setCellMetaObject(A.row,A.col,A)}),o.runHooks("afterCellMetaReset");let L=o.rootElement.style.height;L!==""&&(L=parseInt(o.rootElement.style.height,10)),C&&o.rootElement.getAttribute("style")&&o.rootElement.setAttribute("data-initialstyle",o.rootElement.getAttribute("style"));let I=w.height;if(typeof w.height<"u")if(ht(I)&&(I=I()),I=o.runHooks("beforeHeightChange",I),I===null){const A=o.rootElement.getAttribute("data-initialstyle");A&&(A.indexOf("height")>-1||A.indexOf("overflow")>-1)?o.rootElement.setAttribute("style",A):(o.rootElement.style.height="",o.rootElement.style.overflow="")}else I!==void 0&&(o.rootElement.style.height=isNaN(I)?`${I}`:`${I}px`,o.rootElement.style.overflow="hidden");if(typeof w.width<"u"){let A=w.width;ht(A)&&(A=A()),A=o.runHooks("beforeWidthChange",A),o.rootElement.style.width=isNaN(A)?`${A}`:`${A}px`}C||(o.view&&(o.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),o.view._wt.exportSettingsAsClassNames()),o.runHooks("afterUpdateSettings",w)),u.adjustRowsAndCols(),o.view&&!g&&(o.render(),o.view._wt.wtOverlays.adjustElementsSize()),!C&&o.view&&(L===""||I===""||I===void 0)&&L!==I&&o.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const w=o.getSelectedRangeActive();if(S.getValue){if(ht(S.getValue))return S.getValue.call(o);if(w)return o.getData()[w.highlight.row][S.getValue]}else if(w)return o.getDataAtCell(w.highlight.row,w.highlight.col);return null},this.getSettings=function(){return S},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(w,C,E,D,B){u.alter(w,C,E,D,B)},this.getCell=function(w,C){let E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,D=C,B=w;if(C>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(C)))return null;D=this.columnIndexMapper.getRenderableFromVisualIndex(C)}if(w>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(w)))return null;B=this.rowIndexMapper.getRenderableFromVisualIndex(w)}return B===null||D===null||B===void 0||D===void 0?null:o.view.getCellAtCoords(o._createCellCoords(B,D),E)},this.getCoords=function(w){const C=this.view._wt.wtTable.getCoords(w);if(C===null)return null;const{row:E,col:D}=C;let B=E,y=D;return E>=0&&(B=this.rowIndexMapper.getVisualFromRenderableIndex(E)),D>=0&&(y=this.columnIndexMapper.getVisualFromRenderableIndex(D)),o._createCellCoords(B,y)},this.colToProp=function(w){return l.colToProp(w)},this.propToCol=function(w){return l.propToCol(w)},this.toVisualRow=w=>this.rowIndexMapper.getVisualFromPhysicalIndex(w),this.toVisualColumn=w=>this.columnIndexMapper.getVisualFromPhysicalIndex(w),this.toPhysicalRow=w=>this.rowIndexMapper.getPhysicalFromVisualIndex(w),this.toPhysicalColumn=w=>this.columnIndexMapper.getPhysicalFromVisualIndex(w),this.getDataAtCell=function(w,C){return l.get(w,l.colToProp(C))},this.getDataAtRowProp=function(w,C){return l.get(w,C)},this.getDataAtCol=function(w){const C=[],E=l.getRange(o._createCellCoords(0,w),o._createCellCoords(S.data.length-1,w),l.DESTINATION_RENDERER);for(let D=0;D<E.length;D+=1)for(let B=0;B<E[D].length;B+=1)C.push(E[D][B]);return C},this.getDataAtProp=function(w){const C=[],E=l.getRange(o._createCellCoords(0,l.propToCol(w)),o._createCellCoords(S.data.length-1,l.propToCol(w)),l.DESTINATION_RENDERER);for(let D=0;D<E.length;D+=1)for(let B=0;B<E[D].length;B+=1)C.push(E[D][B]);return C},this.getSourceData=function(w,C,E,D){let B;return w===void 0?B=c.getData():B=c.getByRange(o._createCellCoords(w,C),o._createCellCoords(E,D)),B},this.getSourceDataArray=function(w,C,E,D){let B;return w===void 0?B=c.getData(!0):B=c.getByRange(o._createCellCoords(w,C),o._createCellCoords(E,D),!0),B},this.getSourceDataAtCol=function(w){return c.getAtColumn(w)},this.setSourceDataAtCell=function(w,C,E,D){const B=Oe(w,C,E),y=this.hasHook("afterSetSourceDataAtCell"),_=[],P=(I,A)=>{const V=this.toVisualRow(I),H=this.toVisualColumn(A);return Number.isInteger(H)?this.getCellMeta(V,H):{...Object.getPrototypeOf(S),...S}};y&&k(B,I=>{let[A,V,H]=I;const $=bx(H,P(A,V));_.push([A,V,c.getAtCell(A,V),$])}),k(B,I=>{let[A,V,H]=I;const $=bx(H,P(A,V));c.setAtCell(A,V,$)}),y&&this.runHooks("afterSetSourceDataAtCell",_,D),this.render();const L=o.getActiveEditor();L&&se(L.refreshValue)&&L.refreshValue()},this.getSourceDataAtRow=function(w){return c.getAtRow(w)},this.getSourceDataAtCell=function(w,C){return c.getAtCell(w,C)},this.getDataAtRow=function(w){return l.getRange(o._createCellCoords(w,0),o._createCellCoords(w,this.countCols()-1),l.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(w,C,E,D){const B=w===void 0?[0,0,this.countRows(),this.countCols()]:[w,C,E,D],[y,_]=B;let[,,P,L]=B,I=null,A=null;P===void 0&&(P=y),L===void 0&&(L=_);let V="mixed";return pe(Math.max(Math.min(y,P),0),Math.max(y,P),H=>{let $=!0;return pe(Math.max(Math.min(_,L),0),Math.max(_,L),U=>(A=this.getCellMeta(H,U).type,I?$=I===A:I=A,$)),V=$?A:"mixed",$}),V},this.removeCellMeta=function(w,C,E){const[D,B]=[this.toPhysicalRow(w),this.toPhysicalColumn(C)];let y=R.getCellMetaKeyValue(D,B,E);o.runHooks("beforeRemoveCellMeta",w,C,E,y)!==!1&&(R.removeCellMeta(D,B,E),o.runHooks("afterRemoveCellMeta",w,C,E,y)),y=null},this.spliceCellsMeta=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var E=arguments.length,D=new Array(E>2?E-2:0),B=2;B<E;B++)D[B-2]=arguments[B];if(D.length>0&&!Array.isArray(D[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");C>0&&R.removeRow(this.toPhysicalRow(w),C),D.length>0&&k(D.reverse(),y=>{R.createRow(this.toPhysicalRow(w)),k(y,(_,P)=>this.setCellMetaObject(w,P,_))}),o.render()},this.setCellMetaObject=function(w,C,E){typeof E=="object"&&Ye(E,(D,B)=>{this.setCellMeta(w,C,B,D)})},this.setCellMeta=function(w,C,E,D){if(o.runHooks("beforeSetCellMeta",w,C,E,D)===!1)return;let y=w,_=C;w<this.countRows()&&(y=this.toPhysicalRow(w)),C<this.countCols()&&(_=this.toPhysicalColumn(C)),R.setCellMeta(y,_,E,D),o.runHooks("afterSetCellMeta",w,C,E,D)},this.getCellsMeta=function(){return R.getCellsMeta()},this.getCellMeta=function(w,C){let E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},D=this.toPhysicalRow(w),B=this.toPhysicalColumn(C);return D===null&&(D=w),B===null&&(B=C),R.getCellMeta(D,B,{visualRow:w,visualColumn:C,...E})},this.getColumnMeta=function(w){return R.getColumnMeta(this.toPhysicalColumn(w))},this.getCellMetaAtRow=function(w){return R.getCellsMetaAtRow(w)},this.isColumnModificationAllowed=function(){return!(o.dataType==="object"||S.columns)},this.getCellRenderer=function(w,C){const E=typeof w=="number"?o.getCellMeta(w,C).renderer:w.renderer;return typeof E=="string"?iC(E):Nt(E)?iC("text"):E},this.getCellEditor=function(w,C){const E=typeof w=="number"?o.getCellMeta(w,C).editor:w.editor;return typeof E=="string"?nC(E):Nt(E)?nC("text"):E},this.getCellValidator=function(w,C){const E=typeof w=="number"?o.getCellMeta(w,C).validator:w.validator;return typeof E=="string"?MO(E):E},this.validateCells=function(w){this._validateCells(w)},this.validateRows=function(w,C){if(!Array.isArray(w))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(C,w)},this.validateColumns=function(w,C){if(!Array.isArray(w))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(C,void 0,w)},this._validateCells=function(w,C,E){const D=new me;w&&(D.onQueueEmpty=w);let B=o.countRows()-1;for(;B>=0;){if(C!==void 0&&C.indexOf(B)===-1){B-=1;continue}let y=o.countCols()-1;for(;y>=0;){if(E!==void 0&&E.indexOf(y)===-1){y-=1;continue}D.addValidatorToQueue(),o.validateCell(o.getDataAtCell(B,y),o.getCellMeta(B,y),_=>{if(typeof _!="boolean")throw new Error("Validation error: result is not boolean");_===!1&&(D.valid=!1),D.removeValidatorFormQueue()},"validateCells"),y-=1}B-=1}D.checkIfQueueIsEmpty()},this.getRowHeader=function(w){let C=S.rowHeaders,E=w;return E!==void 0&&(E=o.runHooks("modifyRowHeader",E)),E===void 0?(C=[],pe(o.countRows()-1,D=>{C.push(o.getRowHeader(D))})):Array.isArray(C)&&C[E]!==void 0?C=C[E]:ht(C)?C=C(E):C&&typeof C!="string"&&typeof C!="number"&&(C=E+1),C},this.hasRowHeaders=function(){return!!S.rowHeaders},this.hasColHeaders=function(){if(S.colHeaders!==void 0&&S.colHeaders!==null)return!!S.colHeaders;for(let w=0,C=o.countCols();w<C;w++)if(o.getColHeader(w))return!0;return!1},this.getColHeader=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const E=o.runHooks("modifyColHeader",w);if(E===void 0){const P=[],L=o.countCols();for(let I=0;I<L;I++)P.push(o.getColHeader(I));return P}let D=S.colHeaders;const B=function(P){const L=[],I=o.countCols();let A=0;for(;A<I;A++)ht(S.columns)&&S.columns(A)&&L.push(A);return L[P]},y=o.toPhysicalColumn(E),_=B(y);return S.colHeaders===!1?D=null:S.columns&&ht(S.columns)&&S.columns(_)&&S.columns(_).title?D=S.columns(_).title:S.columns&&S.columns[y]&&S.columns[y].title?D=S.columns[y].title:Array.isArray(S.colHeaders)&&S.colHeaders[y]!==void 0?D=S.colHeaders[y]:ht(S.colHeaders)?D=S.colHeaders(y):S.colHeaders&&typeof S.colHeaders!="string"&&typeof S.colHeaders!="number"&&(D=e0(E)),D=o.runHooks("modifyColumnHeaderValue",D,w,C),D},this._getColWidthFromSettings=function(w){let C;if(w>=0&&(C=o.getCellMeta(0,w).width),(C===void 0||C===S.width)&&(C=S.colWidths),C!=null){switch(typeof C){case"object":C=C[w];break;case"function":C=C(w);break}typeof C=="string"&&(C=Number.parseInt(C,10))}return C},this.getColWidth=function(w,C){let E=o._getColWidthFromSettings(w);return E=o.runHooks("modifyColWidth",E,w,C),E===void 0&&(E=If),E},this._getRowHeightFromSettings=function(w){var C;const E=o.stylesHandler.getDefaultRowHeight(w);let D=(C=S.rowHeights)!==null&&C!==void 0?C:S.minRowHeights;if(D!=null){switch(typeof D){case"object":D=D[w];break;case"function":D=D(w);break}typeof D=="string"&&(D=Number.parseInt(D,10))}return D!=null&&D<E?E:D},this.getRowHeight=function(w,C){let E=o._getRowHeightFromSettings(w);return E=o.runHooks("modifyRowHeight",E,w,C),E},this.countSourceRows=function(){return c.countRows()},this.countSourceCols=function(){return c.countFirstRowKeys()},this.countRows=function(){return l.getLength()},this.countCols=function(){const w=S.maxCols,C=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(w,C)},this.countRenderedRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return o.view._wt.drawn?o.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=0;return RP(o.countRows()-1,E=>{if(o.isEmptyRow(E))C+=1;else if(w===!0)return!1}),C},this.countEmptyCols=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,C=0;return RP(o.countCols()-1,E=>{if(o.isEmptyCol(E))C+=1;else if(w===!0)return!1}),C},this.isEmptyRow=function(w){return S.isEmptyRow.call(o,w)},this.isEmptyCol=function(w){return S.isEmptyCol.call(o,w)},this.selectCell=function(w,C,E,D){let B=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,y=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return Nt(w)||Nt(C)?!1:this.selectCells([[w,C,E,D]],B,y)},this.selectCells=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;C===!1&&f.suspend();const D=j.selectCells(w);return D&&E&&o.listen(),f.resume(),D},this.selectColumns=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w,E=arguments.length>2?arguments[2]:void 0;return j.selectColumns(w,C,E)},this.selectRows=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w,E=arguments.length>2?arguments[2]:void 0;return j.selectRows(w,C,E)},this.deselectCell=function(){j.deselect()},this.selectAll=function(){let w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:w,E=arguments.length>2?arguments[2]:void 0;f.skipNextScrollCycle(),j.selectAll(w,C,E)};const Te=(w,C)=>w.getNearestNotHiddenIndex(C,1,!0);this.scrollViewportTo=function(w,C){if(typeof w=="number"){var E;w={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(E=arguments[4])!==null&&E!==void 0?E:!0}}const{row:D,col:B,considerHiddenIndexes:y}=w??{};let _=D,P=B;if(ht(C)&&this.addHookOnce("afterScroll",C),y===void 0||y){const V=Number.isInteger(D)&&D>=0,H=Number.isInteger(B)&&B>=0,$=V?Te(this.rowIndexMapper,D):void 0,U=H?Te(this.columnIndexMapper,B):void 0;if($===null||U===null)return!1;_=V?o.rowIndexMapper.getRenderableFromVisualIndex($):D,P=H?o.columnIndexMapper.getRenderableFromVisualIndex(U):B}const L=Number.isInteger(_),I=Number.isInteger(P);let A=!1;return L&&_>=0&&I&&P>=0?A=o.view.scrollViewport(o._createCellCoords(_,P),w.horizontalSnap,w.verticalSnap):L&&_>=0&&(I&&P<0||!I)?A=o.view.scrollViewportVertically(_,w.verticalSnap):I&&P>=0&&(L&&_<0||!L)&&(A=o.view.scrollViewportHorizontally(P,w.horizontalSnap)),ht(C)&&(A?this.view.render():(this.removeHook("afterScroll",C),this._registerMicrotask(()=>C()))),A},this.scrollToFocusedCell=function(w){if(!this.selection.isSelected())return!1;ht(w)&&this.addHookOnce("afterScroll",w);const{highlight:C}=this.getSelectedRangeActive(),E=this.scrollViewportTo(C.toObject());return E?this.view.render():ht(w)&&(this.removeHook("afterScroll",w),this._registerMicrotask(()=>w())),E},this.destroy=function(){o._clearTimeouts(),o._clearImmediates(),o.view&&o.view.destroy(),c&&c.destroy(),c=null,Fo(this)&&(Xbe(),this.getFocusScopeManager().destroy()),this.getShortcutManager().destroy(),T.clear(),R.clearCache(),Ex.delete(this.guid),a.destroy(),h&&h.destroy(),o.rootContainer&&ca(o.rootContainer),o.rootPortalElement&&o.rootPortalElement.remove(),o.batchExecution(()=>{o.rowIndexMapper.unregisterAll(),o.columnIndexMapper.unregisterAll(),M.getItems().forEach(w=>{let[,C]=w;C.destroy()}),M.clear(),o.runHooks("afterDestroy")},!0),le.getSingleton().destroy(o),Ye(o,(w,C,E)=>{ht(w)?E[C]=$e(C):C!=="guid"&&(E[C]=null)}),o.isDestroyed=!0,l&&l.destroy(),l=null,u=null,j=null,h=null,o=null};function $e(w){return()=>{throw new Error(`The "${w}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return h.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return o.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return o.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return o.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return o.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return o.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return o.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return o.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return o.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return o.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return o.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return o.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return o.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(w){return M.getItem(Fi(w))},this.getPluginName=function(w){return w===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:M.getId(w)},this.getInstance=function(){return o},this.addHook=function(w,C,E){le.getSingleton().add(w,C,o,E)},this.hasHook=function(w){return le.getSingleton().has(w,o)||le.getSingleton().has(w)},this.addHookOnce=function(w,C,E){le.getSingleton().once(w,C,o,E)},this.removeHook=function(w,C){le.getSingleton().remove(w,C,o)},this.runHooks=function(w,C,E,D,B,y,_){return le.getSingleton().run(o,w,C,E,D,B,y,_)},this.getTranslatedPhrase=function(w,C){return l3(S.language,w,C)},this.toHTML=()=>yP(this),this.toTableElement=()=>{const w=this.rootDocument.createElement("div");return w.insertAdjacentHTML("afterbegin",yP(this)),w.firstElementChild},this.timeouts=[],this.useTheme=w=>{const C=!!g;this.stylesHandler.useTheme(w);const E=this.stylesHandler.getThemeName();C||(o.render(),o.scrollViewportTo(0,0),z2(this.rootContainer)&&(ue(this.rootContainer,/ht-theme-.*/g),E&&q(this.rootContainer,E))),this.runHooks("afterSetTheme",E,C)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(w){let C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,E=w;typeof E=="function"&&(E=setTimeout(E,C)),this.timeouts.push(E)},this._clearTimeouts=function(){k(this.timeouts,w=>{clearTimeout(w)})},this.immediates=[],this._registerImmediate=function(w){this.immediates.push(setImmediate(w))},this._clearImmediates=function(){k(this.immediates,w=>{clearImmediate(w)})},this._registerMicrotask=function(w){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||w()})},this._getEditorManager=function(){return h};const Me=Wbe({handleEvent(){return o.isListening()},beforeKeyDown:w=>this.runHooks("beforeKeyDown",w),afterKeyDown:w=>{this.isDestroyed||o.runHooks("afterDocumentKeyDown",w)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",w=>{w.ctrlKey===!1&&w.metaKey===!1&&Me.releasePressedKeys()}),this.getShortcutManager=function(){return Me},d=new Pve(o);const X=Fo(this)?Tve(o):null;this.getFocusManager=function(){return d},this.getFocusScopeManager=function(){if(!Fo(o))throw new Error("The FocusScopeManager is only available for the main Handsontable instance.");return X},TO().forEach(w=>{const C=Tw(w);M.addItem(w,new C(this))}),kbe(o),Fo(this)&&Nbe(o),Me.setActiveContextName("grid"),le.getSingleton().run(o,"construct")}function Y2(t,e,n){t.addEventListener(e,n,!1)}function G2(t,e,n){t.removeEventListener(e,n,!1)}function Vv(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function _3(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:h=>h.value,...e},i=t.body,r=t.createTextNode(""),s=t.createElement("span");let o;function a(){var h,d;r.textContent=n.textContent(o),s.style.position="absolute",s.style.fontSize=Vv(o).fontSize,s.style.fontFamily=Vv(o).fontFamily,s.style.whiteSpace="pre",i.appendChild(s);const f=parseInt(((h=Vv(o))===null||h===void 0?void 0:h.paddingInlineStart)||0,10),g=parseInt(((d=Vv(o))===null||d===void 0?void 0:d.paddingInlineEnd)||0,10),m=s.clientWidth+f+g+1;i.removeChild(s);const p=o.style;p.height=`${n.minHeight}px`,n.minWidth>m?p.width=`${n.minWidth}px`:m>n.maxWidth?p.width=`${n.maxWidth}px`:p.width=`${m}px`;const v=o.scrollHeight?o.scrollHeight-1:0;n.minHeight>v?p.height=`${n.minHeight}px`:n.maxHeight<v?(p.height=`${n.maxHeight}px`,p.overflowY="visible"):p.height=`${v}px`}function l(){t.defaultView.setTimeout(a,0)}function c(h){if(h&&h.minHeight)if(h.minHeight==="inherit")n.minHeight=o.clientHeight;else{const d=parseInt(h.minHeight,10);isNaN(d)||(n.minHeight=d)}if(h&&h.maxHeight)if(h.maxHeight==="inherit")n.maxHeight=o.clientHeight;else{const d=parseInt(h.maxHeight,10);isNaN(d)||(n.maxHeight=d)}if(h&&h.minWidth)if(h.minWidth==="inherit")n.minWidth=o.clientWidth;else{const d=parseInt(h.minWidth,10);isNaN(d)||(n.minWidth=d)}if(h&&h.maxWidth)if(h.maxWidth==="inherit")n.maxWidth=o.clientWidth;else{const d=parseInt(h.maxWidth,10);isNaN(d)||(n.maxWidth=d)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(r))}function u(h,d){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;o=h,c(d),o.nodeName==="TEXTAREA"&&(o.style.resize="none",o.style.height=`${n.minHeight}px`,o.style.minWidth=`${n.minWidth}px`,o.style.maxWidth=`${n.maxWidth}px`,o.style.overflowY="hidden"),f&&(Y2(o,"input",a),Y2(o,"keydown",l)),a()}return{init:u,resize:a,unObserve(){G2(o,"input",a),G2(o,"keydown",l)}}}function q2(t,e){const n=pO(e),i=e.value.split(`
`);let r=n,s=0;for(let o=0;o<i.length;o++){const a=i[o];o!==0&&(s+=i[o-1].length+1);const l=s+a.length;if(t==="home"?r=s:t==="end"&&(r=l),n<=l)break}Rw(e,r)}function tu(t,e,n){return(e=Zbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zbe(t){var e=Qbe(t,"string");return typeof e=="symbol"?e:e+""}function Qbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const eye="ht_editor_visible",Bv="ht_editor_hidden",K2="textEditor",tye="text";class Uh extends lg{static get EDITOR_TYPE(){return tye}constructor(e){super(e),tu(this,"eventManager",new As(this)),tu(this,"autoResize",_3(this.hot.rootDocument)),tu(this,"TEXTAREA",void 0),tu(this,"textareaStyle",void 0),tu(this,"TEXTAREA_PARENT",void 0),tu(this,"textareaParentStyle",void 0),tu(this,"layerClass",void 0),this.eventManager=new As(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),Xm(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,i,r,s,o){const a=this.state;if(super.prepare(e,n,i,r,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=o;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==wn.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===wn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),Rw(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),he(this.TEXTAREA,[["data-hot-input",""],co(-1)]),q(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),q(this.TEXTAREA_PARENT,"handsontableInputHolder"),Ee(this.TEXTAREA_PARENT,this.layerClass)&&ue(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,Bv),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){GK()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",ue(this.TEXTAREA_PARENT,this.layerClass),q(this.TEXTAREA_PARENT,Bv)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;pe(e.length-1,i=>{const r=e[i];if(Ee(r,"handsontableEditor"))return n=!0,!1}),Ee(this.TEXTAREA_PARENT,Bv)&&ue(this.TEXTAREA_PARENT,Bv),n?(this.layerClass=eye,q(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),q(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==wn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:i,width:r,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();const l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(r,s),minHeight:Math.min(o,a),maxWidth:s,maxHeight:a},!0)}bindEvents(){hO()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===wn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===wn.EDITING&&this.focus()})}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>se(this.hot.getSelected()),group:K2},r=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;q2(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;q2(a,this.TEXTAREA)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(K2)}}const nye="base",iye="htTextEllipsis";function Iw(t,e,n,i,r,s,o){const a=o.ariaTags,l=[],c=[],u=[],h=[];o.className&&q(e,o.className),o.readOnly?(l.push(o.readOnlyCellClassName),a&&h.push(XV())):a&&u.push(XV()[0]),o.valid===!1&&o.invalidCellClassName?(l.push(o.invalidCellClassName),a&&h.push(JV())):(c.push(o.invalidCellClassName),a&&u.push(JV()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&l.push(o.noWordWrapClassName),!s&&o.placeholder&&l.push(o.placeholderCellClassName),o.textEllipsis&&l.push(iye),ue(e,c),q(e,l),ra(e,u),he(e,h)}Iw.RENDERER_TYPE=nye;const rye="text";function pl(t,e,n,i,r,s,o){Iw.apply(this,[t,e,n,i,r,s,o]);let a=s;!a&&o.placeholder&&(a=o.placeholder),a=Pt(a),o.trimWhitespace&&(a=a.trim()),Tc(e,a)}pl.RENDERER_TYPE=rye;const sye="text",E3={CELL_TYPE:sye,editor:Uh,renderer:pl};ms(E3);He.editors={BaseEditor:lg};function He(t,e){const n=new R3(t,e||{},zO);return n.init(),n}He.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new R3(t,e,zO)};He.DefaultSettings=g3();He.hooks=le.getSingleton();He.CellCoords=xh;He.CellRange=rg;He.packageName="handsontable";He.buildDate="20/11/2025 13:26:54";He.version="16.2.0";He.languages={dictionaryKeys:Upe,getLanguageDictionary:a3,getLanguagesDictionaries:Xpe,registerLanguageDictionary:o3,getTranslatedPhrase:l3};function X2(t,e,n){return(e=oye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oye(t){var e=aye(t,"string");return typeof e=="symbol"?e:e+""}function aye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const J2="handsontableEditor",lye="handsontable";class zH extends Uh{constructor(){super(...arguments),X2(this,"isFlippedVertically",!1),X2(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return lye}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),Rw(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,i,r,s,o){super.prepare(e,n,i,r,s,o);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(c,u){const h=this.getSourceData(u.row,u.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&On(l,o.handsontable),this.htOptions=l}beginEditing(e,n){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedActive()){const r=this.htEditor.getValue();r!==void 0&&this.setValue(r)}super.finishEditing(e,n,i)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let i=n.top;if(e.isVerticallyScrollableByWindow()){const a=e.getTableOffset().top-this.hot.rootWindow.scrollY;i=Math.max(i+a,0)}const r=this.getDropdownHeight(),s=e.getWorkspaceHeight()-i-n.height,o=r>s&&i>s+n.height;return o?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:o,spaceAbove:i,spaceBelow:s}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let i=n.start+n.width;if(e.isHorizontallyScrollableByWindow()){const a=e.getTableOffset().left-this.hot.rootWindow.scrollX;i=Math.max(i+a,0)}const r=this.getDropdownWidth(),s=e.getWorkspaceWidth()-i+n.width,o=r>s&&i>s;return o?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:o,spaceInlineStart:i,spaceInlineEnd:s}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:n}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-n)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:J2,relativeToGroup:Vc,position:"before"},r=(s,o)=>{const a=this.htEditor;if(s!==void 0&&(s<0||this.isFlippedVertically&&s>a.countRows()-1?a.deselectCell():a.selectCell(s,0),a.getData().length))return o.preventDefault(),es(o),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const o=this.htEditor;let a,l;return!o.getSelectedActive()&&this.isFlippedVertically?a=o.countRows()-1:o.getSelectedActive()&&(this.isFlippedVertically?(l=o.getSelectedActive()[0],a=Math.max(0,l-1)):(l=o.getSelectedActive()[0],a=l-1)),r(a,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const o=this.htEditor;let a,l;if(!o.getSelectedActive()&&!this.isFlippedVertically)a=0;else if(o.getSelectedActive()){if(this.isFlippedVertically)a=o.getSelectedActive()[0]+1;else if(!this.isFlippedVertically){const c=o.countRows()-1;l=o.getSelectedActive()[0],a=Math.min(c,l+1)}}return r(a,s)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(J2)}}function cye(t,e){x3(t,e),e.add(t)}function Z2(t,e,n){x3(t,e),e.set(t,n)}function x3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xx(t,e,n){return(e=uye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uye(t){var e=hye(t,"string");return typeof e=="symbol"?e:e+""}function hye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Tx(t,e){return t.get(Ul(t,e))}function Ul(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const dye="autocomplete";var Mx=new WeakMap,Q2=new WeakMap,El=new WeakSet;class UH extends zH{constructor(){super(...arguments),cye(this,El),xx(this,"query",null),xx(this,"strippedChoices",[]),xx(this,"rawChoices",[]),Z2(this,Mx,this.hot.guid.slice(0,9)),Z2(this,Q2,Ew(()=>{this.focus()},100))}static get EDITOR_TYPE(){return dye}getValue(){const e=this.rawChoices.find(n=>{const i=this.stripValueIfNeeded(n);return(Ul(El,this,Ug).call(this,i)?i.value:i)===this.TEXTAREA.value});return se(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),q(this.htContainer,"autocompleteEditor"),q(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&he(this.TEXTAREA,[Che(),ghe(),NK("listbox"),xhe()])}prepare(e,n,i,r,s,o){super.prepare(e,n,i,r,s,o),this.hot.getSettings().ariaTags&&he(this.TEXTAREA,[Ts("false"),The(`${Tx(Mx,this)}-listbox-${e}-${n}`)]),this.htOptions={...this.htOptions,valueGetter:a=>Ul(El,this,Ug).call(this,a)?a.value:a}}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=i?.length,{row:s,col:o}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",a=>this.onBeforeKeyDown(a)),this.htEditor.addHook("afterScroll",Tx(Q2,this)),this.htEditor.updateSettings({colWidths:e?[yn(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(a,l,c,u,h,d,f)=>{pl(a,l,c,u,h,d,f);const{filteringCaseSensitive:g,allowHtml:m,locale:p}=this.cellProperties,v=this.query;let b=Pt(d),R,S;b&&!m&&(R=g===!0?b.indexOf(v):b.toLocaleLowerCase(p).indexOf(v.toLocaleLowerCase(p)),R!==-1&&(S=b.substr(R,v.length),b=b.replace(S,`<strong>${S}</strong>`))),n&&he(l,[mhe(),...i?[Ihe(r)]:[],...i?[Ohe(i.indexOf(d)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${u}`]]),l.innerHTML=b},afterSelectionEnd:(a,l)=>{if(n){const c=h=>{he(h,[lO()]),he(this.TEXTAREA,...Mhe(h.id))},u=this.htEditor.getCell(a,l,!0);u!==null?c(u):this.htEditor.addHookOnce("afterScrollVertically",()=>{const h=this.htEditor.getCell(a,l,!0);c(h)})}}}),n&&(he(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...Ja()),he(this.htEditor.rootElement,[DK(),Phe("polite"),Ahe("text"),["id",`${Tx(Mx,this)}-listbox-${s}-${o}`]]),he(this.TEXTAREA,...Ts("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&he(this.TEXTAREA,[Ts("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}finishEditing(e,n,i){if(this.isOpened()){const r=this.hot.getSelectedRangeActive();(Nt(r)||se(r)&&!r.includes(this.hot._createCellCoords(this.row,this.col)))&&(e=!0)}super.finishEditing(e,n,i)}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=pO(this.TEXTAREA),i=r5(this.TEXTAREA),r=this.cellProperties.sortByRelevance,s=this.cellProperties.filter,o=this.stripValueIfNeeded(this.getValue()),a=Ul(El,this,Ug).call(this,o)?o.value:o;let l=null,c=e;r||(c=c.toSorted());const u=[],h=this.cellProperties.locale,d=this.cellProperties.filteringCaseSensitive,f=d?a:a.toLocaleLowerCase(h);for(let g=0;g<c.length;g++){const m=Ul(El,this,Ug).call(this,c[g])?ia(Pt(c[g].value)):ia(Pt(c[g]));if((d?m:m.toLocaleLowerCase(h)).indexOf(f)!==-1&&(u.push(g),s===!1))break}s===!1?o.length>0&&(l=u[0]):(c=u.map(g=>c[g]),l=c.indexOf(f)>-1?c.indexOf(f):0),this.strippedChoices=c,c.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Ym([c])),c.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(l)),this.hot.listen(),Rw(this.TEXTAREA,n,n===i?void 0:i)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:n,spaceAbove:i,spaceBelow:r}=e;return this.limitDropdownIfNeeded(n?i:r),e}limitDropdownIfNeeded(e){const n=this.getDropdownHeight();if(n>e){let i=0,r=0,s=null;do r=this.htEditor.stylesHandler.getDefaultRowHeight(),i+=r;while(i<e);s=i-r,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-s}px`),this.setDropdownHeight(i-r)}}updateDropdownDimensions(){const e=s5(),n=this.getTargetEditorWidth()+e,i=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:n,height:i}),Ul(El,this,eW).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),Ul(El,this,eW).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const r=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)}const n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:n},(r,s)=>s).reduce((r,s)=>{const o=this.hot.stylesHandler.getDefaultRowHeight()+(s===0?1:0);return r+o},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const n=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(n.borderInlineStartWidth,10)+parseInt(n.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,i=r=>Pt(n?r:ia(r));return e.every(r=>Ul(El,this,Ug).call(this,r))?e.map(r=>({key:i(r.key),value:i(r.value)})):e.map(r=>i(r))}onBeforeKeyDown(e){if(u5(e.keyCode)||e.keyCode===be.BACKSPACE||e.keyCode===be.DELETE||e.keyCode===be.INSERT){let n=10;if(e.keyCode===be.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function eW(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+Sn(this.hot.rootDocument)})}function Ug(t){return Re(t)&&se(t.key)&&se(t.value)}const fye="checkbox";class T3 extends lg{static get EDITOR_TYPE(){return fye}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');Ee(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}const uc=()=>window,Ss=()=>window.document,$P=(t,e)=>window.setTimeout(t,e),Vo=function(t,e,n,i){t.addEventListener(e,n,!!i)},Ma=function(t,e,n,i){t.removeEventListener(e,n,!!i)},gye=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Vr=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},Px=function(t,e){Vr(t,e)||(t.className=t.className===""?e:t.className+" "+e)},Ax=function(t,e){t.className=gye((" "+t.className+" ").replace(" "+e+" "," "))},YH=function(t){return/Array/.test(Object.prototype.toString.call(t))},Ur=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},mye=function(t){let e=t.getDay();return e===0||e===6},pye=function(t){return t%4===0&&t%100!==0||t%400===0},tW=function(t,e){return[31,pye(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Wv=function(t){Ur(t)&&t.setHours(0,0,0,0)},jv=function(t,e){return t.getTime()===e.getTime()},gC=function(t,e,n){let i,r;for(i in e)r=t[i]!==void 0,r&&typeof e[i]=="object"&&e[i]!==null&&e[i].nodeName===void 0?Ur(e[i])?n&&(t[i]=new Date(e[i].getTime())):YH(e[i])?n&&(t[i]=e[i].slice(0)):t[i]=gC({},e[i],n):(n||!r)&&(t[i]=e[i]);return t},nW=function(t,e,n){let i=Ss().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=gC(i,n),t.dispatchEvent(i)},iW=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},_o={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},rW=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},wye=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},vye=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),i=t.getDay(),r=e,s=r-1,o=7,a=function(d){return(d+o-1)%o};t.setDate(n+s-a(i));let l=new Date(t.getFullYear(),0,r),c=1440*60*1e3,u=(t.getTime()-l.getTime())/c;return 1+Math.round((u-s+a(l.getDay()))/o)},bye=function(t,e,n,i,r){let s=new Date(i,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(s).isoWeek():vye(s,r))+"</td>"},yye=function(t,e,n,i){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},Cye=function(t){return"<tbody>"+t.join("")+"</tbody>"},Sye=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+rW(t,e)+'">'+rW(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},Rye=function(t,e,n,i,r,s){let o,a,l,c=t._o,u=n===c.minYear,h=n===c.maxYear,d='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',f,g,m=!0,p=!0;for(l=[],o=0;o<12;o++)l.push('<option value="'+(n===r?o-e:12+o-e)+'"'+(o===i?' selected="selected"':"")+(u&&o<c.minMonth||h&&o>c.maxMonth?' disabled="disabled"':"")+">"+c.i18n.months[o]+"</option>");for(f='<div class="pika-label">'+c.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",YH(c.yearRange)?(o=c.yearRange[0],a=c.yearRange[1]+1):(o=n-c.yearRange,a=1+n+c.yearRange),l=[];o<a&&o<=c.maxYear;o++)o>=c.minYear&&l.push('<option value="'+o+'"'+(o===n?' selected="selected"':"")+">"+o+"</option>");return g='<div class="pika-label">'+n+c.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",c.showMonthAfterYear?d+=g+f:d+=f+g,u&&(i===0||c.minMonth>=i)&&(m=!1),h&&(i===11||c.maxMonth<=i)&&(p=!1),e===0&&(d+='<button class="pika-prev'+(m?"":" is-disabled")+'" type="button">'+c.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(p?"":" is-disabled")+'" type="button">'+c.i18n.nextMonth+"</button>"),d+="</div>"},_ye=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+Sye(t)+Cye(e)+"</table>"};function FP(t){let e=this,n=e.config(t);e._onMouseDown=function(r){if(!e._v)return;r=r||uc().event;let s=r.target||r.srcElement;if(s)if(Vr(s,"is-disabled")||(Vr(s,"pika-button")&&!Vr(s,"is-empty")&&!Vr(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),n.bound&&$P(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Vr(s,"pika-prev")?e.prevMonth():Vr(s,"pika-next")&&e.nextMonth()),Vr(s,"pika-select"))e._c=!0;else if(r.preventDefault)r.preventDefault();else return r.returnValue=!1,!1},e._onChange=function(r){r=r||uc().event;let s=r.target||r.srcElement;s&&(Vr(s,"pika-select-month")?e.gotoMonth(s.value):Vr(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(r){if(r=r||uc().event,e.isVisible())switch(r.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let r=this.moment(n.field.value,n.format,n.formatStrict);return r&&r.isValid()?r.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(r){let s;r.firedBy!==e&&(s=e._parseFieldValue(),Ur(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let r=Ss().activeElement;do if(Vr(r,"pika-single"))return;while(r=r.parentNode);e._c||(e._b=$P(function(){e.hide()},50)),e._c=!1},e._onClick=function(r){r=r||uc().event;let s=r.target||r.srcElement,o=s;if(s){!hasEventListeners&&Vr(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),Vo(s,"change",e._onChange)));do if(Vr(o,"pika-single")||o===n.trigger)return;while(o=o.parentNode);e._v&&s!==n.trigger&&o!==n.trigger&&e.hide()}},e.el=Ss().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Vo(e.el,"mousedown",e._onMouseDown,!0),Vo(e.el,"touchend",e._onMouseDown,!0),Vo(e.el,"change",e._onChange),n.keyboardInput&&Vo(Ss(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?Ss().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Vo(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let i=n.defaultDate;Ur(i)?n.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Vo(n.trigger,"click",e._onInputClick),Vo(n.trigger,"focus",e._onInputFocus),Vo(n.trigger,"blur",e._onInputBlur)):this.show()}FP.prototype={config:function(t){this._o||(this._o=gC({},_o,!0));let e=gC(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,Ur(e.minDate)||(e.minDate=!1),Ur(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),YH(e.yearRange)){let i=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||_o.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,Ur(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return Ur(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",nW(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!Ur(t))return;let n=this._o.minDate,i=this._o.maxDate;Ur(n)&&t<n?t=n:Ur(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),Wv(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),nW(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(Ur(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=r<n.getTime()||i.getTime()<r}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,i=parseInt(e)*24*60*60*1e3,r;t==="add"?r=new Date(n.valueOf()+i):t==="subtract"&&(r=new Date(n.valueOf()-i)),this.setDate(r)},adjustCalendars:function(){this.calendars[0]=iW(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=iW({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Wv(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=_o.minDate,this._o.minYear=_o.minYear,this._o.minMonth=_o.minMonth,this._o.startRange=_o.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Wv(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=_o.maxDate,this._o.maxYear=_o.maxYear,this._o.maxMonth=_o.maxMonth,this._o.endRange=_o.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,i=e.maxYear,r=e.minMonth,s=e.maxMonth,o="",a;this._y<=n&&(this._y=n,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=i&&(this._y=i,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+Rye(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=o,e.bound&&e.field.type!=="hidden"&&$P(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,i,r,s,o,a,l,c,u;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,i=uc().innerWidth||Ss().documentElement.clientWidth,r=uc().innerHeight||Ss().documentElement.clientHeight,s=Ss().body.scrollTop||Ss().documentElement.scrollTop,c=!0,u=!0,l=t.getBoundingClientRect(),o=l.left+uc().pageXOffset,a=l.bottom+uc().pageYOffset,(this._o.reposition&&o+e>i||this._o.position.indexOf("right")>-1&&o-e+t.offsetWidth>0)&&(o=o-e+t.offsetWidth,c=!1),(this._o.reposition&&a+n>r+s||this._o.position.indexOf("top")>-1&&a-n-t.offsetHeight>0)&&(a=a-n-t.offsetHeight,u=!1),o<0&&(o=0),a<0&&(a=0),this.el.style.left=o+"px",this.el.style.top=a+"px",Px(this.el,c?"left-aligned":"right-aligned"),Px(this.el,u?"bottom-aligned":"top-aligned"),Ax(this.el,c?"right-aligned":"left-aligned"),Ax(this.el,u?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let i=this._o,r=new Date,s=tW(t,e),o=new Date(t,e,1).getDay(),a=[],l=[];Wv(r),i.firstDay>0&&(o-=i.firstDay,o<0&&(o+=7));let c=e===0?11:e-1,u=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=tW(h,c),g=s+o,m=g;for(;m>7;)m-=7;g+=7-m;let p=!1;for(let v=0,b=0;v<g;v++){let R=new Date(t,e,1+(v-o)),S=Ur(this._d)?jv(R,this._d):!1,x=jv(R,r),M=i.events.indexOf(R.toDateString())!==-1,T=v<o||v>=s+o,O=1+(v-o),W=e,N=t,G=i.startRange&&jv(i.startRange,R),j=i.endRange&&jv(i.endRange,R),ne=i.startRange&&i.endRange&&i.startRange<R&&R<i.endRange,ee=i.minDate&&R<i.minDate||i.maxDate&&R>i.maxDate||i.disableWeekends&&mye(R)||i.disableDayFn&&i.disableDayFn(R);T&&(v<o?(O=f+O,W=c,N=h):(O=O-s,W=u,N=d));let Q={day:O,month:W,year:N,hasEvent:M,isSelected:S,isToday:x,isDisabled:ee,isEmpty:T,isStartRange:G,isEndRange:j,isInRange:ne,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&S&&(p=!0),l.push(wye(Q)),++b===7&&(i.showWeekNumber&&l.unshift(bye(this,v-o,e,t,i.firstWeekOfYearMinDays)),a.push(yye(l,i.isRTL,i.pickWholeWeek,p)),l=[],b=0,p=!1)}return _ye(i,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),Ax(this.el,"is-hidden"),this._o.bound&&(Vo(Ss(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Ma(Ss(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),Px(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Ma(this.el,"mousedown",this._onMouseDown,!0),Ma(this.el,"touchend",this._onMouseDown,!0),Ma(this.el,"change",this._onChange),t.keyboardInput&&Ma(Ss(),"keydown",this._onKeyChange),t.field&&(Ma(t.field,"change",this._onInputChange),t.bound&&(Ma(t.trigger,"click",this._onInputClick),Ma(t.trigger,"focus",this._onInputFocus),Ma(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function Eye(t,e){xye(t,e),e.add(t)}function xye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sW(t,e,n){return(e=Tye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tye(t){var e=Mye(t,"string");return typeof e=="symbol"?e:e+""}function Mye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ix(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const M3="date",oW="dateEditor",Pye="DD/MM/YYYY";var zv=new WeakSet;class P3 extends Uh{constructor(){super(...arguments),Eye(this,zv),sW(this,"parentDestroyed",!1),sW(this,"$datePicker",null)}static get EDITOR_TYPE(){return M3}init(){if(typeof Z!="function")throw new Error("You need to include moment.js to your project.");if(typeof FP!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),q(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Ee(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,i,r,s,o){super.prepare(e,n,i,r,s,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:oW})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const r=this.hot._getEditorManager();r.closeEditor(),this.hot.view.render(),r.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(oW),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=Ix(zv,this,Ox).call(this),i=this.hot.view.isMouseDown(),r=e?RO(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new FP(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Z),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,Z(s,n,!0).isValid()&&this.$datePicker.setMoment(Z(s,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!r&&!i&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,Z(s,n,!0).isValid()&&this.$datePicker.setMoment(Z(s,n),!0),!r&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,i={};this.cellProperties&&this.cellProperties.datePickerConfig&&yw(i,this.cellProperties.datePickerConfig);const r=i.onSelect,s=i.onClose;return i.field=n,i.trigger=n,i.container=this.datePicker,i.bound=!1,i.keyboardInput=!1,i.format=(e=i.format)!==null&&e!==void 0?e:Ix(zv,this,Ox).call(this),i.reposition=i.reposition||!1,i.isRTL=!1,i.onSelect=o=>{let a=o;isNaN(a.getTime())||(a=Z(a).format(Ix(zv,this,Ox).call(this))),this.setValue(a),r&&r(),ro()&&this.hideDatepicker()},i.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),s&&s()},i}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==wn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:r}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:o}=(n=s.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,a=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),l=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),c=r.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),u=r.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=c&&this.col<=u){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+An(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-yn(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}function Ox(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:Pye}const Aye="dropdown";class A3 extends UH{static get EDITOR_TYPE(){return Aye}prepare(e,n,i,r,s,o){o.filter=!1,o.strict=!0,super.prepare(e,n,i,r,s,o)}}const Iye="numeric";class I3 extends Uh{static get EDITOR_TYPE(){return Iye}}function Oye(t,e,n){return(e=Hye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hye(t){var e=kye(t,"string");return typeof e=="symbol"?e:e+""}function kye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Dye="password";class O3 extends Uh{constructor(){super(...arguments),Oye(this,"autoResize",_3(this.hot.rootDocument,{textContent:e=>"".repeat(e.value.length)}))}static get EDITOR_TYPE(){return Dye}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,ca(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...co(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const Hx="ht_editor_visible",aW="selectEditor",Nye="select";class H3 extends lg{static get EDITOR_TYPE(){return Nye}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...jh()),e.appendChild(this.hot.rootDocument.createTextNode("")),q(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Ee(this.selectWrapper,Hx)&&ue(this.selectWrapper,Hx),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,i,r,s,o){super.prepare(e,n,i,r,s,o);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),ca(this.select),Ye(l,(c,u)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=u,$c(h,c),this.select.appendChild(h)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let i=0,r=e.length;i<r;i++)n[e[i]]=e[i];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==wn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:i,height:r}=this.getEditedCellRect(),s=this.selectWrapper.style;s.height=`${r}px`,s.width=`${i}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${n}px`,s.margin="0px",q(this.selectWrapper,Hx)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={group:aW};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const r=this.select.selectedIndex-1;r>=0&&(this.select[r].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const r=this.select.selectedIndex+1;r<=this.select.length-1&&(this.select[r].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(aW)}}const Lye="time";class k3 extends Uh{static get EDITOR_TYPE(){return Lye}prepare(e,n,i,r,s,o){super.prepare(e,n,i,r,s,o),this.TEXTAREA.dir="ltr"}}function $ye(){wr(lg),wr(UH),wr(T3),wr(P3),wr(A3),wr(zH),wr(I3),wr(O3),wr(H3),wr(Uh),wr(k3)}const Fye="html";function GH(t,e,n,i,r,s,o){Iw.apply(this,[t,e,n,i,r,s,o]),$c(e,s??"",!1)}GH.RENDERER_TYPE=Fye;const Vye="autocomplete";function cg(t,e,n,i,r,s,o){const{rootDocument:a}=t,l=o.allowHtml?GH:pl,c=a.createElement("DIV"),u=t.getSettings().ariaTags;if(c.className="htAutocompleteArrow",u&&c.setAttribute(...jh()),c.appendChild(a.createTextNode("")),l.apply(this,[t,e,n,i,r,s,o]),e.firstChild||e.appendChild(a.createTextNode("")),e.insertBefore(c,e.firstChild),q(e,"htAutocomplete"),!t.acArrowListener){const h=new As(t);t.acArrowListener=function(d){Ee(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,i),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}cg.RENDERER_TYPE=Vye;const Bye="dropdown";function qH(t,e,n,i,r,s,o){cg.apply(this,[t,e,n,i,r,s,o])}qH.RENDERER_TYPE=Bye;const lW=new WeakMap,cW=new WeakMap,Wye="htBadValue",kf="data-row",Df="data-col",jye="checkboxRenderer",D3="checkbox";le.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:i,type:r,row:s,column:o,prop:a}=e;if(r!==D3||!i)return;const{value:l,property:c}=i;let u=n;if(l)u=typeof l=="function"?l(s,o,a,n):l;else if(c){const h=this.getDataAtRowProp(s,c);u=h!==null?h:n}return`${Pt(u).length}`});function KH(t,e,n,i,r,s,o){const{rootDocument:a}=t,l=t.getSettings().ariaTags;Iw.apply(this,[t,e,n,i,r,s,o]),zye(t);let c=Uye(a);const u=o.label;let h=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),ca(e),s===o.checkedTemplate||Pt(s).toLocaleLowerCase(o.locale)===Pt(o.checkedTemplate).toLocaleLowerCase(o.locale)?c.checked=!0:s===o.uncheckedTemplate||Pt(s).toLocaleLowerCase(o.locale)===Pt(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?c.checked=!1:hn(s)?q(c,"noValue"):(c.style.display="none",q(c,Wye),h=!0),he(c,[[kf,n],[Df,i]]),l&&he(c,[Jr(c.checked?t.getTranslatedPhrase(MH):t.getTranslatedPhrase(PH)),FK(c.checked),phe()]),!h&&u){let m="";if(u.value)m=typeof u.value=="function"?u.value.call(this,n,i,r,s):u.value;else if(u.property){const v=t.getDataAtRowProp(n,u.property);m=v!==null?v:""}const p=Yye(a,m,u.separated!==!0);u.position==="before"?u.separated?(e.appendChild(p),e.appendChild(c)):(p.appendChild(c),c=p):(!u.position||u.position==="after")&&(u.separated?(e.appendChild(c),e.appendChild(p)):(p.insertBefore(c,p.firstChild),c=p))}(!u||u&&!u.separated)&&e.appendChild(c),h&&e.appendChild(a.createTextNode("#bad-value#")),lW.has(t)||(lW.set(t,!0),d());function d(){const p=t.getShortcutManager().getContext("grid"),v={group:jye,relativeToGroup:Vc,position:"before"};p.addShortcuts([{keys:[["space"]],callback:()=>(f(),!g()),runOnlyIf:()=>{var b;return(b=t.getSelectedRangeActive())===null||b===void 0?void 0:b.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!g()),runOnlyIf:()=>{const b=t.getSelectedRangeActive();return t.getSettings().enterBeginsEditing&&b?.highlight.isCell()&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!g()),runOnlyIf:()=>{var b;return(b=t.getSelectedRangeActive())===null||b===void 0?void 0:b.highlight.isCell()}}],v)}function f(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const p=t.getSelectedRange(),v=[],b=new Map;let R=[],S=0;if(p){for(let x=0;x<p.length;x++){const{row:M,col:T}=p[x].getTopStartCorner(),{row:O,col:W}=p[x].getBottomEndCorner();for(let N=M;N<=O;N+=1)for(let G=T;G<=W;G+=1){const j=t.getCellMeta(N,G);if(j.hidden)continue;const ne={checkedTemplate:j.checkedTemplate,uncheckedTemplate:j.uncheckedTemplate};if(j.type!=="checkbox"){m===!0&&!j.readOnly&&(b.has(v.length)?b.set(v.length,[...b.get(v.length),[N,G,null]]):b.set(v.length,[[N,G,null]]));continue}if(j.readOnly===!0)continue;typeof j.checkedTemplate>"u"&&(j.checkedTemplate=!0),typeof j.uncheckedTemplate>"u"&&(j.uncheckedTemplate=!1);const ee=t.getDataAtCell(N,G);m===!1?[j.checkedTemplate,j.checkedTemplate.toString()].includes(ee)?R.push([N,G,j.uncheckedTemplate,ne]):[j.uncheckedTemplate,j.uncheckedTemplate.toString(),null,void 0].includes(ee)&&R.push([N,G,j.checkedTemplate,ne]):R.push([N,G,j.uncheckedTemplate,ne]),S+=1}v.push(S),S=0}R.every(x=>{let[,,M]=x;return M===R[0][2]})?R=R.map(x=>{let[M,T,O]=x;return[M,T,O]}):R=R.map(x=>{let[M,T,,O]=x;return[M,T,O.checkedTemplate]}),R.length>0&&v.forEach((x,M)=>{let T=R.splice(0,x);b.size&&b.has(M)&&(T=[...T,...b.get(M)]),t.setDataAtCell(T)})}}function g(){const m=t.getSelectedRange();if(m){for(let p=0;p<m.length;p++){const v=m[p].getTopStartCorner(),b=m[p].getBottomEndCorner();for(let R=v.row;R<=b.row;R++)for(let S=v.col;S<=b.col;S++){if(t.getCellMeta(R,S).readOnly)continue;const M=t.getCell(R,S);if(sa(M)&&M.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}KH.RENDERER_TYPE=D3;function zye(t){let e=cW.get(t);if(!e){const{rootElement:n}=t;e=new As(t),e.addEventListener(n,"click",i=>qye(i,t)),e.addEventListener(n,"mouseup",i=>Gye(i,t)),e.addEventListener(n,"change",i=>Kye(i,t)),cW.set(t,e)}return e}function Uye(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function Yye(t,e,n){const i=t.createElement("label");i.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const r=t.createTextNode(e);if(n){const s=t.createElement("span");s.appendChild(r),i.appendChild(s)}else i.appendChild(r);return i.cloneNode(!0)}function Gye(t,e){const{target:n}=t;XH(n)&&(!n.hasAttribute(kf)||!n.hasAttribute(Df)||setTimeout(e.listen,10))}function qye(t,e){const{target:n}=t;if(!XH(n)||!n.hasAttribute(kf)||!n.hasAttribute(Df))return;const i=parseInt(n.getAttribute(kf),10),r=parseInt(n.getAttribute(Df),10);e.getCellMeta(i,r).readOnly&&t.preventDefault()}function Kye(t,e){const{target:n}=t;if(!XH(n)||!n.hasAttribute(kf)||!n.hasAttribute(Df))return;const i=parseInt(n.getAttribute(kf),10),r=parseInt(n.getAttribute(Df),10),s=e.getCellMeta(i,r);if(!s.readOnly){let o=null;t.target.checked?o=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:o=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(i,r,o)}}function XH(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const Xye="handsontable";function JH(t,e,n,i,r,s,o){cg.apply(this,[t,e,n,i,r,s,o])}JH.RENDERER_TYPE=Xye;var Jye=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zye(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var kx,uW;function Qye(){return uW||(uW=1,kx={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),kx}var Dx,hW;function N3(){if(hW)return Dx;hW=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(l,c,u,h,d,f,g){if(!isNaN(+l))return+l;let m="",p=l.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(p!==l)return-1*n(p,c,u,h,d,f);for(let M=0;M<t.length;M++){let T=t[M];if(m=l.replace(RegExp(`([0-9 ])(${T.key})$`),"$1"),m!==l)return n(m,c,u,h,d,f)*T.factor}if(m=l.replace("%",""),m!==l)return n(m,c,u,h,d,f)/100;let v=parseFloat(l);if(isNaN(v))return;let b=h(v);if(b&&b!=="."&&(m=l.replace(new RegExp(`${e(b)}$`),""),m!==l))return n(m,c,u,h,d,f);let R={};Object.keys(f).forEach(M=>{R[f[M]]=M});let S=Object.keys(R).sort().reverse(),x=S.length;for(let M=0;M<x;M++){let T=S[M],O=R[T];if(m=l.replace(T,""),m!==l){let W;switch(O){case"thousand":W=Math.pow(10,3);break;case"million":W=Math.pow(10,6);break;case"billion":W=Math.pow(10,9);break;case"trillion":W=Math.pow(10,12);break}return n(m,c,u,h,d,f)*W}}}function i(l,c,u){let h=l.replace(u,"");return h=h.replace(new RegExp(`([0-9])${e(c.thousands)}([0-9])`,"g"),"$1$2"),h=h.replace(c.decimal,"."),h}function r(l,c,u="",h,d,f,g){if(l==="")return;if(l===d)return 0;let m=i(l,c,u);return n(m,c,u,h,d,f)}function s(l,c){if(!(l.indexOf(":")&&c.thousands!==":"))return!1;let h=l.split(":");if(h.length!==3)return!1;let d=+h[0],f=+h[1],g=+h[2];return!isNaN(d)&&!isNaN(f)&&!isNaN(g)}function o(l){let c=l.split(":"),u=+c[0],h=+c[1];return+c[2]+60*h+3600*u}function a(l,c){const u=ek();let h=u.currentDelimiters(),d=u.currentCurrency().symbol,f=u.currentOrdinal(),g=u.getZeroFormat(),m=u.currentAbbreviations(),p;if(typeof l=="string")s(l,h)?p=o(l):p=r(l,h,d,f,g,m);else if(typeof l=="number")p=l;else return;if(p!==void 0)return p}return Dx={unformat:a},Dx}var Nx,dW;function ZH(){if(dW)return Nx;dW=1;let t=N3();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],i=["trillion","billion","million","thousand"],r=["prefix","infix","postfix"],s=["sign","parenthesis"],o={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},c={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(p,v)=>v.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:p=>p.output==="byte"},characteristic:{type:"number",restriction:p=>p>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:i},average:"boolean",lowPrecision:{type:"boolean",restriction:(p,v)=>v.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:r},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:p=>p>=0,message:"value must be positive"},{restriction:(p,v)=>!v.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:p=>p>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:s},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(p,v)=>v.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},u={languageTag:{type:"string",mandatory:!0,restriction:p=>p.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:o,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(p,v){let b=d(p),R=g(v);return b&&R}function d(p){return t.unformat(p)!==void 0}function f(p,v,b,R=!1){let S=Object.keys(p).map(x=>{if(!v[x])return console.error(`${b} Invalid key: ${x}`),!1;let M=p[x],T=v[x];if(typeof T=="string"&&(T={type:T}),T.type==="format"){if(!f(M,c,`[Validate ${x}]`,!0))return!1}else if(typeof M!==T.type)return console.error(`${b} ${x} type mismatched: "${T.type}" expected, "${typeof M}" provided`),!1;if(T.restrictions&&T.restrictions.length){let O=T.restrictions.length;for(let W=0;W<O;W++){let{restriction:N,message:G}=T.restrictions[W];if(!N(M,p))return console.error(`${b} ${x} invalid value: ${G}`),!1}}return T.restriction&&!T.restriction(M,p)?(console.error(`${b} ${x} invalid value: ${T.message}`),!1):T.validValues&&T.validValues.indexOf(M)===-1?(console.error(`${b} ${x} invalid value: must be among ${JSON.stringify(T.validValues)}, "${M}" provided`),!1):!(T.children&&!f(M,T.children,`[Validate ${x}]`))});return R||S.push(...Object.keys(v).map(x=>{let M=v[x];if(typeof M=="string"&&(M={type:M}),M.mandatory){let T=M.mandatory;if(typeof T=="function"&&(T=T(p)),T&&p[x]===void 0)return console.error(`${b} Missing mandatory key "${x}"`),!1}return!0})),S.reduce((x,M)=>x&&M,!0)}function g(p){return f(p,c,"[Validate format]")}function m(p){return f(p,u,"[Validate language]")}return Nx={validate:h,validateFormat:g,validateInput:d,validateLanguage:m},Nx}function eCe(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function tCe(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function nCe(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function iCe(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function rCe(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function sCe(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function oCe(t,e){let i=t.split(".")[0].match(/0+/);i&&(e.characteristic=i[0].length)}function aCe(t,e){let n=t.split(".")[1];if(n){let i=n.match(/0+/);i&&(e.mantissa=i[0].length)}}function lCe(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function cCe(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function uCe(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function hCe(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function dCe(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function fCe(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function gCe(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function mCe(t,e={}){return typeof t!="string"?t:(t=eCe(t,e),t=tCe(t,e),nCe(t,e),sCe(t,e),oCe(t,e),dCe(t,e),cCe(t,e),uCe(t,e),aCe(t,e),hCe(t,e),lCe(t,e),iCe(t,e),rCe(t,e),fCe(t,e),gCe(t,e),e)}var QH={parseFormat:mCe};var Lx,fW;function ek(){if(fW)return Lx;fW=1;const t=Qye(),e=ZH(),n=QH;let i={},r,s={},o=null,a={};function l(u){r=u}function c(){return s[r]}return i.languages=()=>Object.assign({},s),i.currentLanguage=()=>r,i.currentBytes=()=>c().bytes||{},i.currentCurrency=()=>c().currency,i.currentAbbreviations=()=>c().abbreviations,i.currentDelimiters=()=>c().delimiters,i.currentOrdinal=()=>c().ordinal,i.currentDefaults=()=>Object.assign({},c().defaults,a),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),c().timeFormat),i.setDefaults=u=>{u=n.parseFormat(u),e.validateFormat(u)&&(a=u)},i.getZeroFormat=()=>o,i.setZeroFormat=u=>o=typeof u=="string"?u:null,i.hasZeroFormat=()=>o!==null,i.languageData=u=>{if(u){if(s[u])return s[u];throw new Error(`Unknown tag "${u}"`)}return c()},i.registerLanguage=(u,h=!1)=>{if(!e.validateLanguage(u))throw new Error("Invalid language data");s[u.languageTag]=u,h&&l(u.languageTag)},i.setLanguage=(u,h=t.languageTag)=>{if(!s[u]){let d=u.split("-")[0],f=Object.keys(s).find(g=>g.split("-")[0]===d);if(!s[f]){l(h);return}l(f);return}l(u)},i.registerLanguage(t),r=t.languageTag,Lx=i,Lx}function pCe(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}function wCe(t,e){t.forEach(n=>{let i;try{i=pCe(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}i&&e.registerLanguage(i)})}var vCe=t=>({loadLanguagesInNode:e=>wCe(e,t)}),L3={exports:{}};(function(t){(function(e){var n,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,s=Math.floor,o="[BigNumber Error] ",a=o+"Number primitive has more than 15 significant digits: ",l=1e14,c=14,u=9007199254740991,h=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],d=1e7,f=1e9;function g(M){var T,O,W,N=X.prototype={constructor:X,toString:null,valueOf:null},G=new X(1),j=20,ne=4,ee=-7,Q=21,me=-1e7,fe=1e7,ye=!1,Oe=1,Ce=0,Te={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},$e="0123456789abcdefghijklmnopqrstuvwxyz",Me=!0;function X(y,_){var P,L,I,A,V,H,$,U,z=this;if(!(z instanceof X))return new X(y,_);if(_==null){if(y&&y._isBigNumber===!0){z.s=y.s,!y.c||y.e>fe?z.c=z.e=null:y.e<me?z.c=[z.e=0]:(z.e=y.e,z.c=y.c.slice());return}if((H=typeof y=="number")&&y*0==0){if(z.s=1/y<0?(y=-y,-1):1,y===~~y){for(A=0,V=y;V>=10;V/=10,A++);A>fe?z.c=z.e=null:(z.e=A,z.c=[y]);return}U=String(y)}else{if(!i.test(U=String(y)))return W(z,U,H);z.s=U.charCodeAt(0)==45?(U=U.slice(1),-1):1}(A=U.indexOf("."))>-1&&(U=U.replace(".","")),(V=U.search(/e/i))>0?(A<0&&(A=V),A+=+U.slice(V+1),U=U.substring(0,V)):A<0&&(A=U.length)}else{if(b(_,2,$e.length,"Base"),_==10&&Me)return z=new X(y),D(z,j+z.e+1,ne);if(U=String(y),H=typeof y=="number"){if(y*0!=0)return W(z,U,H,_);if(z.s=1/y<0?(U=U.slice(1),-1):1,X.DEBUG&&U.replace(/^0\.0*|\./,"").length>15)throw Error(a+y)}else z.s=U.charCodeAt(0)===45?(U=U.slice(1),-1):1;for(P=$e.slice(0,_),A=V=0,$=U.length;V<$;V++)if(P.indexOf(L=U.charAt(V))<0){if(L=="."){if(V>A){A=$;continue}}else if(!I&&(U==U.toUpperCase()&&(U=U.toLowerCase())||U==U.toLowerCase()&&(U=U.toUpperCase()))){I=!0,V=-1,A=0;continue}return W(z,String(y),H,_)}H=!1,U=O(U,_,10,z.s),(A=U.indexOf("."))>-1?U=U.replace(".",""):A=U.length}for(V=0;U.charCodeAt(V)===48;V++);for($=U.length;U.charCodeAt(--$)===48;);if(U=U.slice(V,++$)){if($-=V,H&&X.DEBUG&&$>15&&(y>u||y!==s(y)))throw Error(a+z.s*y);if((A=A-V-1)>fe)z.c=z.e=null;else if(A<me)z.c=[z.e=0];else{if(z.e=A,z.c=[],V=(A+1)%c,A<0&&(V+=c),V<$){for(V&&z.c.push(+U.slice(0,V)),$-=c;V<$;)z.c.push(+U.slice(V,V+=c));V=c-(U=U.slice(V)).length}else V-=$;for(;V--;U+="0");z.c.push(+U)}}else z.c=[z.e=0]}X.clone=g,X.ROUND_UP=0,X.ROUND_DOWN=1,X.ROUND_CEIL=2,X.ROUND_FLOOR=3,X.ROUND_HALF_UP=4,X.ROUND_HALF_DOWN=5,X.ROUND_HALF_EVEN=6,X.ROUND_HALF_CEIL=7,X.ROUND_HALF_FLOOR=8,X.EUCLID=9,X.config=X.set=function(y){var _,P;if(y!=null)if(typeof y=="object"){if(y.hasOwnProperty(_="DECIMAL_PLACES")&&(P=y[_],b(P,0,f,_),j=P),y.hasOwnProperty(_="ROUNDING_MODE")&&(P=y[_],b(P,0,8,_),ne=P),y.hasOwnProperty(_="EXPONENTIAL_AT")&&(P=y[_],P&&P.pop?(b(P[0],-f,0,_),b(P[1],0,f,_),ee=P[0],Q=P[1]):(b(P,-f,f,_),ee=-(Q=P<0?-P:P))),y.hasOwnProperty(_="RANGE"))if(P=y[_],P&&P.pop)b(P[0],-f,-1,_),b(P[1],1,f,_),me=P[0],fe=P[1];else if(b(P,-f,f,_),P)me=-(fe=P<0?-P:P);else throw Error(o+_+" cannot be zero: "+P);if(y.hasOwnProperty(_="CRYPTO"))if(P=y[_],P===!!P)if(P)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))ye=P;else throw ye=!P,Error(o+"crypto unavailable");else ye=P;else throw Error(o+_+" not true or false: "+P);if(y.hasOwnProperty(_="MODULO_MODE")&&(P=y[_],b(P,0,9,_),Oe=P),y.hasOwnProperty(_="POW_PRECISION")&&(P=y[_],b(P,0,f,_),Ce=P),y.hasOwnProperty(_="FORMAT"))if(P=y[_],typeof P=="object")Te=P;else throw Error(o+_+" not an object: "+P);if(y.hasOwnProperty(_="ALPHABET"))if(P=y[_],typeof P=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(P))Me=P.slice(0,10)=="0123456789",$e=P;else throw Error(o+_+" invalid: "+P)}else throw Error(o+"Object expected: "+y);return{DECIMAL_PLACES:j,ROUNDING_MODE:ne,EXPONENTIAL_AT:[ee,Q],RANGE:[me,fe],CRYPTO:ye,MODULO_MODE:Oe,POW_PRECISION:Ce,FORMAT:Te,ALPHABET:$e}},X.isBigNumber=function(y){if(!y||y._isBigNumber!==!0)return!1;if(!X.DEBUG)return!0;var _,P,L=y.c,I=y.e,A=y.s;e:if({}.toString.call(L)=="[object Array]"){if((A===1||A===-1)&&I>=-f&&I<=f&&I===s(I)){if(L[0]===0){if(I===0&&L.length===1)return!0;break e}if(_=(I+1)%c,_<1&&(_+=c),String(L[0]).length==_){for(_=0;_<L.length;_++)if(P=L[_],P<0||P>=l||P!==s(P))break e;if(P!==0)return!0}}}else if(L===null&&I===null&&(A===null||A===1||A===-1))return!0;throw Error(o+"Invalid BigNumber: "+y)},X.maximum=X.max=function(){return C(arguments,-1)},X.minimum=X.min=function(){return C(arguments,1)},X.random=(function(){var y=9007199254740992,_=Math.random()*y&2097151?function(){return s(Math.random()*y)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(P){var L,I,A,V,H,$=0,U=[],z=new X(G);if(P==null?P=j:b(P,0,f),V=r(P/c),ye)if(crypto.getRandomValues){for(L=crypto.getRandomValues(new Uint32Array(V*=2));$<V;)H=L[$]*131072+(L[$+1]>>>11),H>=9e15?(I=crypto.getRandomValues(new Uint32Array(2)),L[$]=I[0],L[$+1]=I[1]):(U.push(H%1e14),$+=2);$=V/2}else if(crypto.randomBytes){for(L=crypto.randomBytes(V*=7);$<V;)H=(L[$]&31)*281474976710656+L[$+1]*1099511627776+L[$+2]*4294967296+L[$+3]*16777216+(L[$+4]<<16)+(L[$+5]<<8)+L[$+6],H>=9e15?crypto.randomBytes(7).copy(L,$):(U.push(H%1e14),$+=7);$=V/7}else throw ye=!1,Error(o+"crypto unavailable");if(!ye)for(;$<V;)H=_(),H<9e15&&(U[$++]=H%1e14);for(V=U[--$],P%=c,V&&P&&(H=h[c-P],U[$]=s(V/H)*H);U[$]===0;U.pop(),$--);if($<0)U=[A=0];else{for(A=-1;U[0]===0;U.splice(0,1),A-=c);for($=1,H=U[0];H>=10;H/=10,$++);$<c&&(A-=c-$)}return z.e=A,z.c=U,z}})(),X.sum=function(){for(var y=1,_=arguments,P=new X(_[0]);y<_.length;)P=P.plus(_[y++]);return P},O=(function(){var y="0123456789";function _(P,L,I,A){for(var V,H=[0],$,U=0,z=P.length;U<z;){for($=H.length;$--;H[$]*=L);for(H[0]+=A.indexOf(P.charAt(U++)),V=0;V<H.length;V++)H[V]>I-1&&(H[V+1]==null&&(H[V+1]=0),H[V+1]+=H[V]/I|0,H[V]%=I)}return H.reverse()}return function(P,L,I,A,V){var H,$,U,z,J,ce,re,Pe,Je=P.indexOf("."),at=j,Ae=ne;for(Je>=0&&(z=Ce,Ce=0,P=P.replace(".",""),Pe=new X(L),ce=Pe.pow(P.length-Je),Ce=z,Pe.c=_(x(p(ce.c),ce.e,"0"),10,I,y),Pe.e=Pe.c.length),re=_(P,L,I,V?(H=$e,y):(H=y,$e)),U=z=re.length;re[--z]==0;re.pop());if(!re[0])return H.charAt(0);if(Je<0?--U:(ce.c=re,ce.e=U,ce.s=A,ce=T(ce,Pe,at,Ae,I),re=ce.c,J=ce.r,U=ce.e),$=U+at+1,Je=re[$],z=I/2,J=J||$<0||re[$+1]!=null,J=Ae<4?(Je!=null||J)&&(Ae==0||Ae==(ce.s<0?3:2)):Je>z||Je==z&&(Ae==4||J||Ae==6&&re[$-1]&1||Ae==(ce.s<0?8:7)),$<1||!re[0])P=J?x(H.charAt(1),-at,H.charAt(0)):H.charAt(0);else{if(re.length=$,J)for(--I;++re[--$]>I;)re[$]=0,$||(++U,re=[1].concat(re));for(z=re.length;!re[--z];);for(Je=0,P="";Je<=z;P+=H.charAt(re[Je++]));P=x(P,U,H.charAt(0))}return P}})(),T=(function(){function y(L,I,A){var V,H,$,U,z=0,J=L.length,ce=I%d,re=I/d|0;for(L=L.slice();J--;)$=L[J]%d,U=L[J]/d|0,V=re*$+U*ce,H=ce*$+V%d*d+z,z=(H/A|0)+(V/d|0)+re*U,L[J]=H%A;return z&&(L=[z].concat(L)),L}function _(L,I,A,V){var H,$;if(A!=V)$=A>V?1:-1;else for(H=$=0;H<A;H++)if(L[H]!=I[H]){$=L[H]>I[H]?1:-1;break}return $}function P(L,I,A,V){for(var H=0;A--;)L[A]-=H,H=L[A]<I[A]?1:0,L[A]=H*V+L[A]-I[A];for(;!L[0]&&L.length>1;L.splice(0,1));}return function(L,I,A,V,H){var $,U,z,J,ce,re,Pe,Je,at,Ae,Ze,dt,fn,fi,os,gn,Or,$t=L.s==I.s?1:-1,Ht=L.c,rt=I.c;if(!Ht||!Ht[0]||!rt||!rt[0])return new X(!L.s||!I.s||(Ht?rt&&Ht[0]==rt[0]:!rt)?NaN:Ht&&Ht[0]==0||!rt?$t*0:$t/0);for(Je=new X($t),at=Je.c=[],U=L.e-I.e,$t=A+U+1,H||(H=l,U=m(L.e/c)-m(I.e/c),$t=$t/c|0),z=0;rt[z]==(Ht[z]||0);z++);if(rt[z]>(Ht[z]||0)&&U--,$t<0)at.push(1),J=!0;else{for(fi=Ht.length,gn=rt.length,z=0,$t+=2,ce=s(H/(rt[0]+1)),ce>1&&(rt=y(rt,ce,H),Ht=y(Ht,ce,H),gn=rt.length,fi=Ht.length),fn=gn,Ae=Ht.slice(0,gn),Ze=Ae.length;Ze<gn;Ae[Ze++]=0);Or=rt.slice(),Or=[0].concat(Or),os=rt[0],rt[1]>=H/2&&os++;do{if(ce=0,$=_(rt,Ae,gn,Ze),$<0){if(dt=Ae[0],gn!=Ze&&(dt=dt*H+(Ae[1]||0)),ce=s(dt/os),ce>1)for(ce>=H&&(ce=H-1),re=y(rt,ce,H),Pe=re.length,Ze=Ae.length;_(re,Ae,Pe,Ze)==1;)ce--,P(re,gn<Pe?Or:rt,Pe,H),Pe=re.length,$=1;else ce==0&&($=ce=1),re=rt.slice(),Pe=re.length;if(Pe<Ze&&(re=[0].concat(re)),P(Ae,re,Ze,H),Ze=Ae.length,$==-1)for(;_(rt,Ae,gn,Ze)<1;)ce++,P(Ae,gn<Ze?Or:rt,Ze,H),Ze=Ae.length}else $===0&&(ce++,Ae=[0]);at[z++]=ce,Ae[0]?Ae[Ze++]=Ht[fn]||0:(Ae=[Ht[fn]],Ze=1)}while((fn++<fi||Ae[0]!=null)&&$t--);J=Ae[0]!=null,at[0]||at.splice(0,1)}if(H==l){for(z=1,$t=at[0];$t>=10;$t/=10,z++);D(Je,A+(Je.e=z+U*c-1)+1,V,J)}else Je.e=U,Je.r=+J;return Je}})();function w(y,_,P,L){var I,A,V,H,$;if(P==null?P=ne:b(P,0,8),!y.c)return y.toString();if(I=y.c[0],V=y.e,_==null)$=p(y.c),$=L==1||L==2&&(V<=ee||V>=Q)?S($,V):x($,V,"0");else if(y=D(new X(y),_,P),A=y.e,$=p(y.c),H=$.length,L==1||L==2&&(_<=A||A<=ee)){for(;H<_;$+="0",H++);$=S($,A)}else if(_-=V,$=x($,A,"0"),A+1>H){if(--_>0)for($+=".";_--;$+="0");}else if(_+=A-H,_>0)for(A+1==H&&($+=".");_--;$+="0");return y.s<0&&I?"-"+$:$}function C(y,_){for(var P,L,I=1,A=new X(y[0]);I<y.length;I++)L=new X(y[I]),(!L.s||(P=v(A,L))===_||P===0&&A.s===_)&&(A=L);return A}function E(y,_,P){for(var L=1,I=_.length;!_[--I];_.pop());for(I=_[0];I>=10;I/=10,L++);return(P=L+P*c-1)>fe?y.c=y.e=null:P<me?y.c=[y.e=0]:(y.e=P,y.c=_),y}W=(function(){var y=/^(-?)0([xbo])(?=\w[\w.]*$)/i,_=/^([^.]+)\.$/,P=/^\.([^.]+)$/,L=/^-?(Infinity|NaN)$/,I=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(A,V,H,$){var U,z=H?V:V.replace(I,"");if(L.test(z))A.s=isNaN(z)?null:z<0?-1:1;else{if(!H&&(z=z.replace(y,function(J,ce,re){return U=(re=re.toLowerCase())=="x"?16:re=="b"?2:8,!$||$==U?ce:J}),$&&(U=$,z=z.replace(_,"$1").replace(P,"0.$1")),V!=z))return new X(z,U);if(X.DEBUG)throw Error(o+"Not a"+($?" base "+$:"")+" number: "+V);A.s=null}A.c=A.e=null}})();function D(y,_,P,L){var I,A,V,H,$,U,z,J=y.c,ce=h;if(J){e:{for(I=1,H=J[0];H>=10;H/=10,I++);if(A=_-I,A<0)A+=c,V=_,$=J[U=0],z=s($/ce[I-V-1]%10);else if(U=r((A+1)/c),U>=J.length)if(L){for(;J.length<=U;J.push(0));$=z=0,I=1,A%=c,V=A-c+1}else break e;else{for($=H=J[U],I=1;H>=10;H/=10,I++);A%=c,V=A-c+I,z=V<0?0:s($/ce[I-V-1]%10)}if(L=L||_<0||J[U+1]!=null||(V<0?$:$%ce[I-V-1]),L=P<4?(z||L)&&(P==0||P==(y.s<0?3:2)):z>5||z==5&&(P==4||L||P==6&&(A>0?V>0?$/ce[I-V]:0:J[U-1])%10&1||P==(y.s<0?8:7)),_<1||!J[0])return J.length=0,L?(_-=y.e+1,J[0]=ce[(c-_%c)%c],y.e=-_||0):J[0]=y.e=0,y;if(A==0?(J.length=U,H=1,U--):(J.length=U+1,H=ce[c-A],J[U]=V>0?s($/ce[I-V]%ce[V])*H:0),L)for(;;)if(U==0){for(A=1,V=J[0];V>=10;V/=10,A++);for(V=J[0]+=H,H=1;V>=10;V/=10,H++);A!=H&&(y.e++,J[0]==l&&(J[0]=1));break}else{if(J[U]+=H,J[U]!=l)break;J[U--]=0,H=1}for(A=J.length;J[--A]===0;J.pop());}y.e>fe?y.c=y.e=null:y.e<me&&(y.c=[y.e=0])}return y}function B(y){var _,P=y.e;return P===null?y.toString():(_=p(y.c),_=P<=ee||P>=Q?S(_,P):x(_,P,"0"),y.s<0?"-"+_:_)}return N.absoluteValue=N.abs=function(){var y=new X(this);return y.s<0&&(y.s=1),y},N.comparedTo=function(y,_){return v(this,new X(y,_))},N.decimalPlaces=N.dp=function(y,_){var P,L,I,A=this;if(y!=null)return b(y,0,f),_==null?_=ne:b(_,0,8),D(new X(A),y+A.e+1,_);if(!(P=A.c))return null;if(L=((I=P.length-1)-m(this.e/c))*c,I=P[I])for(;I%10==0;I/=10,L--);return L<0&&(L=0),L},N.dividedBy=N.div=function(y,_){return T(this,new X(y,_),j,ne)},N.dividedToIntegerBy=N.idiv=function(y,_){return T(this,new X(y,_),0,1)},N.exponentiatedBy=N.pow=function(y,_){var P,L,I,A,V,H,$,U,z,J=this;if(y=new X(y),y.c&&!y.isInteger())throw Error(o+"Exponent not an integer: "+B(y));if(_!=null&&(_=new X(_)),H=y.e>14,!J.c||!J.c[0]||J.c[0]==1&&!J.e&&J.c.length==1||!y.c||!y.c[0])return z=new X(Math.pow(+B(J),H?y.s*(2-R(y)):+B(y))),_?z.mod(_):z;if($=y.s<0,_){if(_.c?!_.c[0]:!_.s)return new X(NaN);L=!$&&J.isInteger()&&_.isInteger(),L&&(J=J.mod(_))}else{if(y.e>9&&(J.e>0||J.e<-1||(J.e==0?J.c[0]>1||H&&J.c[1]>=24e7:J.c[0]<8e13||H&&J.c[0]<=9999975e7)))return A=J.s<0&&R(y)?-0:0,J.e>-1&&(A=1/A),new X($?1/A:A);Ce&&(A=r(Ce/c+2))}for(H?(P=new X(.5),$&&(y.s=1),U=R(y)):(I=Math.abs(+B(y)),U=I%2),z=new X(G);;){if(U){if(z=z.times(J),!z.c)break;A?z.c.length>A&&(z.c.length=A):L&&(z=z.mod(_))}if(I){if(I=s(I/2),I===0)break;U=I%2}else if(y=y.times(P),D(y,y.e+1,1),y.e>14)U=R(y);else{if(I=+B(y),I===0)break;U=I%2}J=J.times(J),A?J.c&&J.c.length>A&&(J.c.length=A):L&&(J=J.mod(_))}return L?z:($&&(z=G.div(z)),_?z.mod(_):A?D(z,Ce,ne,V):z)},N.integerValue=function(y){var _=new X(this);return y==null?y=ne:b(y,0,8),D(_,_.e+1,y)},N.isEqualTo=N.eq=function(y,_){return v(this,new X(y,_))===0},N.isFinite=function(){return!!this.c},N.isGreaterThan=N.gt=function(y,_){return v(this,new X(y,_))>0},N.isGreaterThanOrEqualTo=N.gte=function(y,_){return(_=v(this,new X(y,_)))===1||_===0},N.isInteger=function(){return!!this.c&&m(this.e/c)>this.c.length-2},N.isLessThan=N.lt=function(y,_){return v(this,new X(y,_))<0},N.isLessThanOrEqualTo=N.lte=function(y,_){return(_=v(this,new X(y,_)))===-1||_===0},N.isNaN=function(){return!this.s},N.isNegative=function(){return this.s<0},N.isPositive=function(){return this.s>0},N.isZero=function(){return!!this.c&&this.c[0]==0},N.minus=function(y,_){var P,L,I,A,V=this,H=V.s;if(y=new X(y,_),_=y.s,!H||!_)return new X(NaN);if(H!=_)return y.s=-_,V.plus(y);var $=V.e/c,U=y.e/c,z=V.c,J=y.c;if(!$||!U){if(!z||!J)return z?(y.s=-_,y):new X(J?V:NaN);if(!z[0]||!J[0])return J[0]?(y.s=-_,y):new X(z[0]?V:ne==3?-0:0)}if($=m($),U=m(U),z=z.slice(),H=$-U){for((A=H<0)?(H=-H,I=z):(U=$,I=J),I.reverse(),_=H;_--;I.push(0));I.reverse()}else for(L=(A=(H=z.length)<(_=J.length))?H:_,H=_=0;_<L;_++)if(z[_]!=J[_]){A=z[_]<J[_];break}if(A&&(I=z,z=J,J=I,y.s=-y.s),_=(L=J.length)-(P=z.length),_>0)for(;_--;z[P++]=0);for(_=l-1;L>H;){if(z[--L]<J[L]){for(P=L;P&&!z[--P];z[P]=_);--z[P],z[L]+=l}z[L]-=J[L]}for(;z[0]==0;z.splice(0,1),--U);return z[0]?E(y,z,U):(y.s=ne==3?-1:1,y.c=[y.e=0],y)},N.modulo=N.mod=function(y,_){var P,L,I=this;return y=new X(y,_),!I.c||!y.s||y.c&&!y.c[0]?new X(NaN):!y.c||I.c&&!I.c[0]?new X(I):(Oe==9?(L=y.s,y.s=1,P=T(I,y,0,3),y.s=L,P.s*=L):P=T(I,y,0,Oe),y=I.minus(P.times(y)),!y.c[0]&&Oe==1&&(y.s=I.s),y)},N.multipliedBy=N.times=function(y,_){var P,L,I,A,V,H,$,U,z,J,ce,re,Pe,Je,at,Ae=this,Ze=Ae.c,dt=(y=new X(y,_)).c;if(!Ze||!dt||!Ze[0]||!dt[0])return!Ae.s||!y.s||Ze&&!Ze[0]&&!dt||dt&&!dt[0]&&!Ze?y.c=y.e=y.s=null:(y.s*=Ae.s,!Ze||!dt?y.c=y.e=null:(y.c=[0],y.e=0)),y;for(L=m(Ae.e/c)+m(y.e/c),y.s*=Ae.s,$=Ze.length,J=dt.length,$<J&&(Pe=Ze,Ze=dt,dt=Pe,I=$,$=J,J=I),I=$+J,Pe=[];I--;Pe.push(0));for(Je=l,at=d,I=J;--I>=0;){for(P=0,ce=dt[I]%at,re=dt[I]/at|0,V=$,A=I+V;A>I;)U=Ze[--V]%at,z=Ze[V]/at|0,H=re*U+z*ce,U=ce*U+H%at*at+Pe[A]+P,P=(U/Je|0)+(H/at|0)+re*z,Pe[A--]=U%Je;Pe[A]=P}return P?++L:Pe.splice(0,1),E(y,Pe,L)},N.negated=function(){var y=new X(this);return y.s=-y.s||null,y},N.plus=function(y,_){var P,L=this,I=L.s;if(y=new X(y,_),_=y.s,!I||!_)return new X(NaN);if(I!=_)return y.s=-_,L.minus(y);var A=L.e/c,V=y.e/c,H=L.c,$=y.c;if(!A||!V){if(!H||!$)return new X(I/0);if(!H[0]||!$[0])return $[0]?y:new X(H[0]?L:I*0)}if(A=m(A),V=m(V),H=H.slice(),I=A-V){for(I>0?(V=A,P=$):(I=-I,P=H),P.reverse();I--;P.push(0));P.reverse()}for(I=H.length,_=$.length,I-_<0&&(P=$,$=H,H=P,_=I),I=0;_;)I=(H[--_]=H[_]+$[_]+I)/l|0,H[_]=l===H[_]?0:H[_]%l;return I&&(H=[I].concat(H),++V),E(y,H,V)},N.precision=N.sd=function(y,_){var P,L,I,A=this;if(y!=null&&y!==!!y)return b(y,1,f),_==null?_=ne:b(_,0,8),D(new X(A),y,_);if(!(P=A.c))return null;if(I=P.length-1,L=I*c+1,I=P[I]){for(;I%10==0;I/=10,L--);for(I=P[0];I>=10;I/=10,L++);}return y&&A.e+1>L&&(L=A.e+1),L},N.shiftedBy=function(y){return b(y,-u,u),this.times("1e"+y)},N.squareRoot=N.sqrt=function(){var y,_,P,L,I,A=this,V=A.c,H=A.s,$=A.e,U=j+4,z=new X("0.5");if(H!==1||!V||!V[0])return new X(!H||H<0&&(!V||V[0])?NaN:V?A:1/0);if(H=Math.sqrt(+B(A)),H==0||H==1/0?(_=p(V),(_.length+$)%2==0&&(_+="0"),H=Math.sqrt(+_),$=m(($+1)/2)-($<0||$%2),H==1/0?_="5e"+$:(_=H.toExponential(),_=_.slice(0,_.indexOf("e")+1)+$),P=new X(_)):P=new X(H+""),P.c[0]){for($=P.e,H=$+U,H<3&&(H=0);;)if(I=P,P=z.times(I.plus(T(A,I,U,1))),p(I.c).slice(0,H)===(_=p(P.c)).slice(0,H))if(P.e<$&&--H,_=_.slice(H-3,H+1),_=="9999"||!L&&_=="4999"){if(!L&&(D(I,I.e+j+2,0),I.times(I).eq(A))){P=I;break}U+=4,H+=4,L=1}else{(!+_||!+_.slice(1)&&_.charAt(0)=="5")&&(D(P,P.e+j+2,1),y=!P.times(P).eq(A));break}}return D(P,P.e+j+1,ne,y)},N.toExponential=function(y,_){return y!=null&&(b(y,0,f),y++),w(this,y,_,1)},N.toFixed=function(y,_){return y!=null&&(b(y,0,f),y=y+this.e+1),w(this,y,_)},N.toFormat=function(y,_,P){var L,I=this;if(P==null)y!=null&&_&&typeof _=="object"?(P=_,_=null):y&&typeof y=="object"?(P=y,y=_=null):P=Te;else if(typeof P!="object")throw Error(o+"Argument not an object: "+P);if(L=I.toFixed(y,_),I.c){var A,V=L.split("."),H=+P.groupSize,$=+P.secondaryGroupSize,U=P.groupSeparator||"",z=V[0],J=V[1],ce=I.s<0,re=ce?z.slice(1):z,Pe=re.length;if($&&(A=H,H=$,$=A,Pe-=A),H>0&&Pe>0){for(A=Pe%H||H,z=re.substr(0,A);A<Pe;A+=H)z+=U+re.substr(A,H);$>0&&(z+=U+re.slice(A)),ce&&(z="-"+z)}L=J?z+(P.decimalSeparator||"")+(($=+P.fractionGroupSize)?J.replace(new RegExp("\\d{"+$+"}\\B","g"),"$&"+(P.fractionGroupSeparator||"")):J):z}return(P.prefix||"")+L+(P.suffix||"")},N.toFraction=function(y){var _,P,L,I,A,V,H,$,U,z,J,ce,re=this,Pe=re.c;if(y!=null&&(H=new X(y),!H.isInteger()&&(H.c||H.s!==1)||H.lt(G)))throw Error(o+"Argument "+(H.isInteger()?"out of range: ":"not an integer: ")+B(H));if(!Pe)return new X(re);for(_=new X(G),U=P=new X(G),L=$=new X(G),ce=p(Pe),A=_.e=ce.length-re.e-1,_.c[0]=h[(V=A%c)<0?c+V:V],y=!y||H.comparedTo(_)>0?A>0?_:U:H,V=fe,fe=1/0,H=new X(ce),$.c[0]=0;z=T(H,_,0,1),I=P.plus(z.times(L)),I.comparedTo(y)!=1;)P=L,L=I,U=$.plus(z.times(I=U)),$=I,_=H.minus(z.times(I=_)),H=I;return I=T(y.minus(P),L,0,1),$=$.plus(I.times(U)),P=P.plus(I.times(L)),$.s=U.s=re.s,A=A*2,J=T(U,L,A,ne).minus(re).abs().comparedTo(T($,P,A,ne).minus(re).abs())<1?[U,L]:[$,P],fe=V,J},N.toNumber=function(){return+B(this)},N.toPrecision=function(y,_){return y!=null&&b(y,1,f),w(this,y,_,2)},N.toString=function(y){var _,P=this,L=P.s,I=P.e;return I===null?L?(_="Infinity",L<0&&(_="-"+_)):_="NaN":(y==null?_=I<=ee||I>=Q?S(p(P.c),I):x(p(P.c),I,"0"):y===10&&Me?(P=D(new X(P),j+I+1,ne),_=x(p(P.c),P.e,"0")):(b(y,2,$e.length,"Base"),_=O(x(p(P.c),I,"0"),10,y,L,!0)),L<0&&P.c[0]&&(_="-"+_)),_},N.valueOf=N.toJSON=function(){return B(this)},N._isBigNumber=!0,M!=null&&X.set(M),X}function m(M){var T=M|0;return M>0||M===T?T:T-1}function p(M){for(var T,O,W=1,N=M.length,G=M[0]+"";W<N;){for(T=M[W++]+"",O=c-T.length;O--;T="0"+T);G+=T}for(N=G.length;G.charCodeAt(--N)===48;);return G.slice(0,N+1||1)}function v(M,T){var O,W,N=M.c,G=T.c,j=M.s,ne=T.s,ee=M.e,Q=T.e;if(!j||!ne)return null;if(O=N&&!N[0],W=G&&!G[0],O||W)return O?W?0:-ne:j;if(j!=ne)return j;if(O=j<0,W=ee==Q,!N||!G)return W?0:!N^O?1:-1;if(!W)return ee>Q^O?1:-1;for(ne=(ee=N.length)<(Q=G.length)?ee:Q,j=0;j<ne;j++)if(N[j]!=G[j])return N[j]>G[j]^O?1:-1;return ee==Q?0:ee>Q^O?1:-1}function b(M,T,O,W){if(M<T||M>O||M!==s(M))throw Error(o+(W||"Argument")+(typeof M=="number"?M<T||M>O?" out of range: ":" not an integer: ":" not a primitive number: ")+String(M))}function R(M){var T=M.c.length-1;return m(M.e/c)==T&&M.c[T]%2!=0}function S(M,T){return(M.length>1?M.charAt(0)+"."+M.slice(1):M)+(T<0?"e":"e+")+T}function x(M,T,O){var W,N;if(T<0){for(N=O+".";++T;N+=O);M=N+M}else if(W=M.length,++T>W){for(N=O,T-=W;--T;N+=O);M+=N}else T<W&&(M=M.slice(0,T)+"."+M.slice(T));return M}n=g(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(Jye)})(L3);var $3=L3.exports;const Gs=ek(),bCe=ZH(),yCe=QH,CCe=$3,pi={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Ow={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:F3,decimalSuffixes:mC}=Gs.currentBytes(),tk={general:{scale:1024,suffixes:mC},binary:{scale:1024,suffixes:F3},decimal:{scale:1e3,suffixes:mC}};function SCe(t,e={},n){if(typeof e=="string"&&(e=yCe.parseFormat(e)),!bCe.validateFormat(e))return"ERROR: invalid format";let r=e.prefix||"",s=e.postfix||"",o=RCe(t,e,n);return o=WCe(o,r),o=jCe(o,s),o}function RCe(t,e,n){switch(e.output){case"currency":return e=jd(e,Gs.currentCurrencyDefaultFormat()),ICe(t,e,Gs);case"percent":return e=jd(e,Gs.currentPercentageDefaultFormat()),ACe(t,e,Gs,n);case"byte":return e=jd(e,Gs.currentByteDefaultFormat()),TCe(t,e,Gs,n);case"time":return e=jd(e,Gs.currentTimeDefaultFormat()),PCe(t);case"ordinal":return e=jd(e,Gs.currentOrdinalDefaultFormat()),MCe(t,e,Gs);default:return Hw({instance:t,providedFormat:e})}}function _Ce(t){let e=tk.decimal;return c0(t._value,e.suffixes,e.scale).suffix}function ECe(t){let e=tk.binary;return c0(t._value,e.suffixes,e.scale).suffix}function xCe(t){let e=tk.general;return c0(t._value,e.suffixes,e.scale).suffix}function c0(t,e,n){let i=e[0],r=Math.abs(t);if(r>=n){for(let s=1;s<e.length;++s){let o=Math.pow(n,s),a=Math.pow(n,s+1);if(r>=o&&r<a){i=e[s],t=t/o;break}}i===e[0]&&(t=t/Math.pow(n,e.length-1),i=e[e.length-1])}return{value:t,suffix:i}}function TCe(t,e,n,i){let r=e.base||"binary",s=Object.assign({},Ow,e);const{binarySuffixes:o,decimalSuffixes:a}=n.currentBytes();let c={general:{scale:1024,suffixes:a||mC,marker:"bd"},binary:{scale:1024,suffixes:o||F3,marker:"b"},decimal:{scale:1e3,suffixes:a||mC,marker:"d"}}[r],{value:u,suffix:h}=c0(t._value,c.suffixes,c.scale);return`${Hw({instance:i(u),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${s.spaceSeparated?" ":""}${h}`}function MCe(t,e,n){let i=n.currentOrdinal(),r=Object.assign({},Ow,e),s=Hw({instance:t,providedFormat:e,state:n}),o=i(t._value);return`${s}${r.spaceSeparated?" ":""}${o}`}function PCe(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),i=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${i<10?"0":""}${i}`}function ACe(t,e,n,i){let r=e.prefixSymbol,s=Hw({instance:i(t._value*100),providedFormat:e,state:n}),o=Object.assign({},Ow,e);return r?`%${o.spaceSeparated?" ":""}${s}`:`${s}${o.spaceSeparated?" ":""}%`}function ICe(t,e,n){const i=n.currentCurrency();let r=Object.assign({},e),s=Object.assign({},Ow,r),o,a="",l=!!s.totalLength||!!s.forceAverage||s.average,c=r.currencyPosition||i.position,u=r.currencySymbol||i.symbol;const h=s.spaceSeparatedCurrency!==void 0?s.spaceSeparatedCurrency:s.spaceSeparated;r.lowPrecision===void 0&&(r.lowPrecision=!1),h&&(a=" "),c==="infix"&&(o=a+u+a);let d=Hw({instance:t,providedFormat:r,state:n,decimalSeparator:o});return c==="prefix"&&(t._value<0&&s.negative==="sign"?d=`-${a}${u}${d.slice(1)}`:t._value>0&&s.forceSign?d=`+${a}${u}${d.slice(1)}`:d=u+a+d),(!c||c==="postfix")&&(a=!s.spaceSeparatedAbbreviation&&l?"":a,d=d+a+u),d}function OCe({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:i,spaceSeparated:r=!1,totalLength:s=0,roundingFunction:o=Math.round}){let a="",l=Math.abs(t),c=-1;if(e&&i[e]&&pi[e]?(a=i[e],t=t/pi[e]):l>=pi.trillion||n&&o(l/pi.trillion)===1?(a=i.trillion,t=t/pi.trillion):l<pi.trillion&&l>=pi.billion||n&&o(l/pi.billion)===1?(a=i.billion,t=t/pi.billion):l<pi.billion&&l>=pi.million||n&&o(l/pi.million)===1?(a=i.million,t=t/pi.million):(l<pi.million&&l>=pi.thousand||n&&o(l/pi.thousand)===1)&&(a=i.thousand,t=t/pi.thousand),a&&(a=(r?" ":"")+a),s){let h=t<0,d=t.toString().split(".")[0],f=h?d.length-1:d.length;c=Math.max(s-f,0)}return{value:t,abbreviation:a,mantissaPrecision:c}}function HCe({value:t,characteristicPrecision:e}){let[n,i]=t.toExponential().split("e"),r=+n;if(!e)return{value:r,abbreviation:`e${i}`};let s=1;return s<e&&(r=r*Math.pow(10,e-s),i=+i-(e-s),i=i>=0?`+${i}`:i),{value:r,abbreviation:`e${i}`}}function Uv(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function kCe(t,e){let n=t.toString(),[i,r]=n.split("e"),[s,o=""]=i.split(".");if(+r>0)n=s+o+Uv(r-o.length);else{let a=".";+s<0?a=`-0${a}`:a=`0${a}`;let l=(Uv(-r-1)+Math.abs(s)+o).substr(0,e);l.length<e&&(l+=Uv(e-l.length)),n=a+l}return+r>0&&e>0&&(n+=`.${Uv(e)}`),n}function DCe(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?kCe(t,e):new CCe(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function NCe(t,e,n,i,r,s){if(i===-1)return t;let o=DCe(e,i,s),[a,l=""]=o.toString().split(".");if(l.match(/^0+$/)&&(n||r))return a;let c=l.match(/0+$/);return r&&c?`${a}.${l.toString().slice(0,c.index)}`:o.toString()}function LCe(t,e,n,i){let r=t,[s,o]=r.toString().split(".");if(s.match(/^-?0$/)&&n)return o?`${s.replace("0","")}.${o}`:s.replace("0","");const a=e<0&&s.indexOf("-")===0;if(a&&(s=s.slice(1),r=r.slice(1)),s.length<i){let l=i-s.length;for(let c=0;c<l;c++)r=`0${r}`}return a&&(r=`-${r}`),r.toString()}function $Ce(t,e){let n=[],i=0;for(let r=t;r>0;r--)i===e&&(n.unshift(r),i=0),i++;return n}function FCe(t,e,n,i,r){let s=i.currentDelimiters(),o=s.thousands;r=r||s.decimal;let a=s.thousandsSize||3,l=t.toString(),c=l.split(".")[0],u=l.split(".")[1];const h=e<0&&c.indexOf("-")===0;return n&&(h&&(c=c.slice(1)),$Ce(c.length,a).forEach((f,g)=>{c=c.slice(0,f+g)+o+c.slice(f+g)}),h&&(c=`-${c}`)),u?l=c+r+u:l=c,l}function VCe(t,e){return t+e}function BCe(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function WCe(t,e){return e+t}function jCe(t,e){return t+e}function Hw({instance:t,providedFormat:e,state:n=Gs,decimalSeparator:i,defaults:r=n.currentDefaults()}){let s=t._value;if(s===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(s))return s.toString();let o=Object.assign({},Ow,r,e),a=o.totalLength,l=a?0:o.characteristic,c=o.optionalCharacteristic,u=o.forceAverage,h=o.lowPrecision,d=!!a||!!u||o.average,f=a?-1:d&&e.mantissa===void 0?0:o.mantissa,g=a?!1:e.optionalMantissa===void 0?f===-1:o.optionalMantissa,m=o.trimMantissa,p=o.thousandSeparated,v=o.spaceSeparated,b=o.negative,R=o.forceSign,S=o.exponential,x=o.roundingFunction,M="";if(d){let O=OCe({value:s,forceAverage:u,lowPrecision:h,abbreviations:n.currentAbbreviations(),spaceSeparated:v,roundingFunction:x,totalLength:a});s=O.value,M+=O.abbreviation,a&&(f=O.mantissaPrecision)}if(S){let O=HCe({value:s,characteristicPrecision:l});s=O.value,M=O.abbreviation+M}let T=NCe(s.toString(),s,g,f,m,x);return T=LCe(T,s,c,l),T=FCe(T,s,p,n,i),(d||S)&&(T=VCe(T,M)),(R||s<0)&&(T=BCe(T,s,b)),T}function jd(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var zCe=t=>({format:(...e)=>SCe(...e,t),getByteUnit:(...e)=>xCe(...e,t),getBinaryByteUnit:(...e)=>ECe(...e,t),getDecimalByteUnit:(...e)=>_Ce(...e,t),formatOrDefault:jd});const ll=$3;function UCe(t,e,n){let i=new ll(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new ll(r),t._value=i.plus(r).toNumber(),t}function V3(t,e,n){let i=new ll(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new ll(r),t._value=i.minus(r).toNumber(),t}function YCe(t,e,n){let i=new ll(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new ll(r),t._value=i.times(r).toNumber(),t}function GCe(t,e,n){let i=new ll(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new ll(r),t._value=i.dividedBy(r).toNumber(),t}function qCe(t,e,n){let i=e;return n.isNumbro(e)&&(i=e._value),t._value=i,t}function KCe(t,e,n){let i=n(t._value);return V3(i,e,n),Math.abs(i._value)}var XCe=t=>({add:(e,n)=>UCe(e,n,t),subtract:(e,n)=>V3(e,n,t),multiply:(e,n)=>YCe(e,n,t),divide:(e,n)=>GCe(e,n,t),set:(e,n)=>qCe(e,n,t),difference:(e,n)=>KCe(e,n,t),BigNumber:ll});const JCe="2.5.0",pa=ek(),ZCe=ZH(),QCe=vCe(Rn),eSe=N3();let nu=zCe(Rn),Du=XCe(Rn);const tSe=QH;class B3{constructor(e){this._value=e}clone(){return Rn(this._value)}format(e={}){return nu.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=tSe.parseFormat(e)),e=nu.formatOrDefault(e,pa.currentCurrencyDefaultFormat()),e.output="currency",nu.format(this,e)}formatTime(e={}){return e.output="time",nu.format(this,e)}binaryByteUnits(){return nu.getBinaryByteUnit(this)}decimalByteUnits(){return nu.getDecimalByteUnit(this)}byteUnits(){return nu.getByteUnit(this)}difference(e){return Du.difference(this,e)}add(e){return Du.add(this,e)}subtract(e){return Du.subtract(this,e)}multiply(e){return Du.multiply(this,e)}divide(e){return Du.divide(this,e)}set(e){return Du.set(this,W3(e))}value(){return this._value}valueOf(){return this._value}}function W3(t){let e=t;return Rn.isNumbro(t)?e=t._value:typeof t=="string"?e=Rn.unformat(t):isNaN(t)&&(e=NaN),e}function Rn(t){return new B3(W3(t))}Rn.version=JCe;Rn.isNumbro=function(t){return t instanceof B3};Rn.language=pa.currentLanguage;Rn.registerLanguage=pa.registerLanguage;Rn.setLanguage=pa.setLanguage;Rn.languages=pa.languages;Rn.languageData=pa.languageData;Rn.zeroFormat=pa.setZeroFormat;Rn.defaultFormat=pa.currentDefaults;Rn.setDefaults=pa.setDefaults;Rn.defaultCurrencyFormat=pa.currentCurrencyDefaultFormat;Rn.validate=ZCe.validate;Rn.loadLanguagesInNode=QCe.loadLanguagesInNode;Rn.unformat=eSe.unformat;Rn.BigNumber=Du.BigNumber;var nSe=Rn,iu=Zye(nSe);const iSe="numeric";function j3(t,e){if(Oi(t)){const n=e.numericFormat,i=n&&n.culture||"-",r=n&&n.pattern;if(typeof i<"u"&&!iu.languages()[i]){const s=i.replace("-",""),o=iu.allLanguages?iu.allLanguages[i]:iu[s];o&&iu.registerLanguage(o)}iu.setLanguage(i),t=iu(t).format(r||"0")}return t}function nk(t,e,n,i,r,s,o){let a=s;if(Oi(a)){let c=[];if(Array.isArray(o.className))c=o.className;else{var l;const u=(l=o.className)!==null&&l!==void 0?l:"";u.length&&(c=u.split(" "))}a=j3(a,o),c.indexOf("htLeft")<0&&c.indexOf("htCenter")<0&&c.indexOf("htRight")<0&&c.indexOf("htJustify")<0&&c.push("htRight"),c.indexOf("htNumeric")<0&&c.push("htNumeric"),o.className=c.join(" "),e.dir="ltr"}pl(t,e,n,i,r,a,o)}nk.RENDERER_TYPE=iSe;const rSe="password";function ik(t,e,n,i,r,s,o){pl.apply(this,[t,e,n,i,r,s,o]);const a=o.hashLength||e.innerHTML.length,l=o.hashSymbol||"*";let c="";pe(a-1,()=>{c+=l}),$c(e,c)}ik.RENDERER_TYPE=rSe;const sSe="select";function rk(t,e,n,i,r,s,o){pl.apply(this,[t,e,n,i,r,s,o])}rk.RENDERER_TYPE=sSe;const oSe="time";function sk(t,e,n,i,r,s,o){pl.apply(this,[t,e,n,i,r,s,o]),e.dir="ltr"}sk.RENDERER_TYPE=oSe;function aSe(){Wr(cg),Wr(Iw),Wr(KH),Wr(qH),Wr(JH),Wr(GH),Wr(nk),Wr(ik),Wr(rk),Wr(pl),Wr(sk)}const lSe="autocomplete";function u0(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,gW(n,e)):gW(n,e)(this.source):e(!0)}u0.VALIDATOR_TYPE=lSe;function gW(t,e){const n=t;return function(i){let r=!1;for(let s=0,o=i.length;s<o;s++)if(Cw(n,i[s])){r=!0;break}e(r)}}function z3(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const cSe=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:z3},Symbol.toStringTag,{value:"Module"})),uSe="date";function ok(t,e){const n=v5(M3,this.instance);let i=t,r=!0;i==null&&(i="");let s=Z(i,this.dateFormat||n.defaultDateFormat,!0).isValid(),o=Z(new Date(i)).isValid()||s;if(this.allowEmpty&&i===""&&(o=!0,s=!0),o||(r=!1),!o&&s&&(r=!0),o&&!s)if(this.correctFormat===!0){const a=hSe(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),r=!0}else r=!1;e(r)}ok.VALIDATOR_TYPE=uSe;function hSe(t,e){const n=Z(z3(t)),i=Z(t,e),r=t.search(/[A-Za-z]/g)>-1;let s;return n.isValid()&&n.format("x")===i.format("x")||!i.isValid()||r?s=n:s=i,s.format(e)}const dSe="dropdown";function ak(t,e){u0.apply(this,[t,e])}ak.VALIDATOR_TYPE=dSe;const fSe="numeric";function lk(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Oi(t))}lk.VALIDATOR_TYPE=fSe;const gSe=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],mSe="time";function ck(t,e){const n=this.timeFormat||"h:mm:ss a";let i=!0,r=t;r===null&&(r=""),r=/^\d{3,}$/.test(r)?parseInt(r,10):r;const s=/^\d{1,2}$/.test(r);s&&(r+=":00");const o=Z(r,gSe,!0).isValid()?Z(r):Z(r,n);let a=o.isValid(),l=Z(r,n,!0).isValid()&&!s;if(this.allowEmpty&&r===""&&(a=!0,l=!0),a||(i=!1),!a&&l&&(i=!0),a&&!l)if(this.correctFormat===!0){const c=o.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,c,"timeValidator"),i=!0}else i=!1;e(i)}ck.VALIDATOR_TYPE=mSe;function pSe(){Vu(u0),Vu(ak),Vu(ok),Vu(lk),Vu(ck)}function U3(t){return Re(t)&&t.value!==void 0?t.value:t}function Y3(t,e,n){const i=this.getSourceDataAtCell(this.toPhysicalRow(e),this.toPhysicalColumn(n)),r=s=>Re(s)&&se(s.key)&&se(s.value);return r(i)?r(t)?t:{key:t,value:t}:t}const wSe="autocomplete",vSe={CELL_TYPE:wSe,editor:UH,renderer:cg,validator:u0,valueGetter:U3,valueSetter:Y3};function bSe(t,e,n){const{checkedTemplate:i,uncheckedTemplate:r}=this.getCellMeta(e,n),s=Pt(t),o=s===Pt(i),a=s===Pt(r);return o||a?o?i:r:t}const ySe="checkbox",CSe={CELL_TYPE:ySe,editor:T3,renderer:KH,valueSetter:bSe},SSe="date";function G3(t,e,n,i,r,s,o){cg.apply(this,[t,e,n,i,r,s,o])}G3.RENDERER_TYPE=SSe;const RSe="date",_Se={CELL_TYPE:RSe,editor:P3,renderer:G3,validator:ok};function ESe(t){return U3.call(this,t)}function xSe(t,e,n,i){return Y3.call(this,t,e,n,i)}const TSe="dropdown",MSe={CELL_TYPE:TSe,editor:A3,renderer:qH,validator:ak,filter:!1,strict:!0,valueGetter:ESe,valueSetter:xSe},PSe="handsontable",ASe={CELL_TYPE:PSe,editor:zH,renderer:JH};function ISe(t){if(typeof t=="string"&&y5(t)){const e=C5(t);return Hm(e)?t:e}return t}const OSe="numeric",HSe={CELL_TYPE:OSe,editor:I3,renderer:nk,validator:lk,dataType:"number",valueSetter:ISe},kSe="password",DSe={CELL_TYPE:kSe,editor:O3,renderer:ik,copyable:!1},NSe="select",LSe={CELL_TYPE:NSe,editor:H3,renderer:rk},$Se="time",FSe={CELL_TYPE:$Se,editor:k3,renderer:sk,validator:ck};function VSe(){ms(vSe),ms(CSe),ms(_Se),ms(MSe),ms(ASe),ms(HSe),ms(DSe),ms(LSe),ms(E3),ms(FSe)}function BSe(t,e){q3(t,e),e.add(t)}function cd(t,e,n){return(e=WSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WSe(t){var e=jSe(t,"string");return typeof e=="symbol"?e:e+""}function jSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mW(t,e,n){q3(t,e),e.set(t,n)}function q3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yv(t,e,n){return t.set(uk(t,e),n),n}function mn(t,e){return t.get(uk(t,e))}function uk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pW=new Map([["plugin",Zde],["cell-type",f3],["editor",w5],["renderer",_5],["validator",E5]]),K3=Symbol("mainSetting"),zSe="base",Gv=[];let ru=null;var En=new WeakMap,su=new WeakMap,wW=new WeakSet;class et{static get PLUGIN_KEY(){return zSe}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}static get SETTINGS_VALIDATORS(){return null}constructor(e){BSe(this,wW),mW(this,En,null),cd(this,"eventManager",new As(this)),cd(this,"pluginName",null),cd(this,"pluginsInitializedCallbacks",[]),cd(this,"isPluginsReady",!1),cd(this,"enabled",!1),cd(this,"initialized",!1),mW(this,su,{}),ga(this,"hot",e,{writable:!1}),ru=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this),this.updatePluginSettings(this.hot.getSettings()[this.constructor.PLUGIN_KEY]);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const r=[];if(n.forEach(s=>{const[o,a]=s.split(":");if(!pW.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);pW.get(o)(a)||r.push(` - ${a} (${o})`)}),r.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${r.join(`
`)}
`].join("");Gv.push(s)}}if(ru||(ru=TO()),ru.indexOf(this.pluginName)>=0&&ru.splice(ru.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),ru.length===0){if(Gv.length>0){const r=[`${Gv.join(`
`)}
`,"You have to import and register them manually."].join("");throw Gv.length=0,new Error(r)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){var n=this;const i=this.constructor.DEFAULT_SETTINGS,r=this.constructor.SETTINGS_VALIDATORS;if(e===void 0)return Re(mn(En,this))?Km(mn(En,this),i):mn(En,this);let s;if((Array.isArray(mn(En,this))||Re(mn(En,this)))&&i[K3]===e)if(Array.isArray(mn(En,this)))s=mn(En,this);else{var o;s=(o=mn(En,this)[e])!==null&&o!==void 0?o:i[e]}else if(e.includes(".")){const a=Jy(mn(En,this),e),l=Jy(i,e);Re(a)?s=Km(a,l):s=a!==void 0?a:l}else Re(mn(En,this))?s=Km(mn(En,this),i)[e]:s=i[e];if(typeof s=="function"&&r&&typeof r=="object"){const a=r[e];if(a&&typeof a=="function")return function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];const h=s(...c);if(a(h)===!1){const f=c.map(m=>typeof m=="string"?`"${m}"`:"").join(", "),g=c.length>0?f:"";Ue(`${n.pluginName} Plugin: "${e}" function (${g}) result                is not valid and will be ignored.`);return}return h}}return s}updatePluginSettings(e){const n=this.constructor.SETTINGS_VALIDATORS;if(n&&typeof n=="function"&&typeof e!="object"){if(n(e)===!1){Ue(`${this.pluginName} Plugin: option is not valid and it will be ignored.`);return}return Yv(En,this,e),mn(En,this)}return n&&typeof n=="object"&&typeof e=="object"?((mn(En,this)===null||typeof mn(En,this)!="object")&&Yv(En,this,{...this.constructor.DEFAULT_SETTINGS}),Object.keys(n).forEach(i=>{if(!(i in e))return;const r=n[i];if((r?r(e[i]):!0)===!1){Ue(`${this.pluginName} Plugin: "${i}" option is not valid and it will be ignored.`);return}mn(En,this)[i]=e[i]}),mn(En,this)):(Yv(En,this,e),e)}addHook(e,n,i){mn(su,this)[e]=mn(su,this)[e]||[];const r=mn(su,this)[e];this.hot.addHook(e,n,i),r.push(n),mn(su,this)[e]=r}removeHooks(e){k(mn(su,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=mn(su,this);Ye(e,(n,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){k(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=uk(wW,this,USe).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&(this.updatePluginSettings(e[this.constructor.PLUGIN_KEY]),this.updatePlugin(e)))}updatePlugin(){}destroy(){var e;Yv(En,this,null),(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),Ye(this,(n,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}}function USe(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function ou(t,e,n){return(e=YSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function YSe(t){var e=GSe(t,"string");return typeof e=="symbol"?e:e+""}function GSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let hk=class{constructor(e){ou(this,"hot",null),ou(this,"container",null),ou(this,"injected",!1),ou(this,"rows",[]),ou(this,"columns",[]),ou(this,"samples",null),ou(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),k(this.rows,n=>{const{height:i}=n.table.getBoundingClientRect();e(n.row,Math.ceil(i))})}getWidths(e){this.injected||this.injectTable(),k(this.columns,n=>{const{width:i}=n.table.getBoundingClientRect();e(n.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{k(i.strings,r=>{n.appendChild(this.createColElement(r.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,r),i.appendChild(r)),this.samples.forEach(s=>{k(s.strings,o=>{const a=o.col,l=this.hot.getCellMeta(e,a),c=this.hot.getCellRenderer(l),u=n.createElement("td");u.setAttribute("ghost-table",1),c(this.hot,u,e,a,this.hot.colToProp(a),o.value,l),i.appendChild(u)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const r=e.createElement("th");i.push([-1,r]),n.appendChild(r)}this.samples.forEach(r=>{k(r.strings,s=>{const o=s.col,a=e.createElement("th");i.push([o,a]),n.appendChild(a)})}),this.table.tHead.appendChild(n),k(i,r=>{const[s,o]=r;this.hot.view.appendColHeader(s,o)})}createCol(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment();return this.samples.forEach(r=>{k(r.strings,s=>{const o=s.row,a=this.hot.getCellMeta(o,e),l=this.hot.getCellRenderer(a),c=n.createElement("td"),u=n.createElement("tr");c.setAttribute("ghost-table",1),l(this.hot,c,o,e,this.hot.colToProp(e),s.value,a),u.appendChild(c),i.appendChild(u)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const i=this.hot.rootDocument.createElement("col");let r=0;n>=0&&e>=0&&(r=this.hot.getCellMeta(n,e).colspan);let s=this.hot.getColWidth(e);if(r>1)for(let o=e+1;o<e+r;o++)s+=this.hot.getColWidth(o);return i.style.width=`${s}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("table"),s=n.createElement("thead"),o=n.createElement("tbody"),a=n.createElement("colgroup"),l=n.createElement("tr"),c=n.createElement("th");return this.isVertical()&&r.appendChild(a),this.isHorizontal()&&(l.appendChild(c),s.appendChild(l),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(s),this.isVertical()&&o.appendChild(l),r.appendChild(o),q(r,e),i.appendChild(r),{fragment:i,table:r,tHead:s,tBody:o,colGroup:a,tr:l,th:c}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return q(r,s),i.appendChild(r),{fragment:i,container:r}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Yg(t,e,n){return(e=qSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qSe(t){var e=KSe(t,"string");return typeof e=="symbol"?e:e+""}function KSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class h0{static get SAMPLE_COUNT(){return 3}constructor(e){Yg(this,"samples",null),Yg(this,"dataFactory",null),Yg(this,"customSampleCount",null),Yg(this,"allowDuplicates",!1),Yg(this,"includeHidden",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:h0.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}setIncludeHidden(e){this.includeHidden=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,i){const r=new Map,{from:s,to:o}=typeof i=="number"?{from:i,to:i}:i;return pe(s,o,a=>{const l=this.generateSample(e,n,a);r.set(a,l)}),r}generateSample(e,n,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const r=new Map,s=e==="row"?"col":"row",o=[];return pe(n.from,n.to,a=>{const l=e==="row"?this.dataFactory(i,a,this):this.dataFactory(a,i,this);if(l===!1)return;const{value:c,bundleSeed:u}=l,h=typeof u=="string"&&u.length>0;let d;h?d=u:Re(c)?d=`${Object.keys(c).length}`:Array.isArray(c)?d=`${c.length}`:d=`${Pt(c).length}`,r.has(d)||r.set(d,{needed:this.getSampleCount(),strings:[]});const f=r.get(d);f.needed&&(!(o.indexOf(c)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:c,[s]:a}),o.push(c),f.needed-=1)}),r}}function XSe(t,e){X3(t,e),e.add(t)}function $x(t,e,n){X3(t,e),e.set(t,n)}function X3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gg(t,e,n){return(e=JSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JSe(t){var e=ZSe(t,"string");return typeof e=="symbol"?e:e+""}function ZSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hc(t,e){return t.get(Cr(t,e))}function pC(t,e,n){return t.set(Cr(t,e),n),n}function Cr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("modifyAutoColumnSizeSeed");const Fx="autoColumnSize",QSe=10,e0e="autoColumnSize";var dk=new WeakMap,zd=new WeakMap,Nf=new WeakMap,zr=new WeakSet;class tp extends et{static get PLUGIN_KEY(){return Fx}static get PLUGIN_PRIORITY(){return QSe}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),XSe(this,zr),Gg(this,"ghostTable",new hk(this.hot)),Gg(this,"samplesGenerator",new h0((n,i)=>{const r=this.hot.toPhysicalRow(n),s=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(s))return!1;const o=this.hot.getCellMeta(n,i);let a="";o.spanned||(a=this.hot.getDataAtCell(n,i));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,o,a)),{value:a,bundleSeed:l}})),Gg(this,"inProgress",!1),Gg(this,"measuredColumns",0),Gg(this,"columnWidthsMap",new Fc),$x(this,dk,!1),$x(this,zd,[]),$x(this,Nf,[]),this.hot.columnIndexMapper.registerMap(e0e,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,i,r)=>Cr(zr,this,vW).call(this,n,i,r))}isEnabled(){return this.hot.getSettings()[Fx]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Cr(zr,e,i0e).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Cr(zr,e,r0e).call(e,...r)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Cr(zr,e,o0e).call(e,...r)}),this.addHook("beforeRender",()=>Cr(zr,this,n0e).call(this)),this.addHook("modifyColWidth",(i,r)=>this.getColumnWidth(r,i)),this.addHook("init",()=>Cr(zr,this,s0e).call(this)),super.enablePlugin()}updatePlugin(){pC(Nf,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,i)=>Cr(zr,this,vW).call(this,e,n,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const i=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,s=typeof n=="number"?{from:n,to:n}:n;pe(r.from,r.to,o=>{let a=this.hot.toPhysicalColumn(o);a===null&&(a=o),(i||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&Cr(zr,this,J3).call(this,o,s)}),this.ghostTable.columns.length&&(Cr(zr,this,Z3).call(this),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countCols()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){Op(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+tp.CALCULATION_STEP,r)},e,n),i=i+tp.CALCULATION_STEP+1,i<r?s=Ip(o):(Op(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,n),i=a+1),i<r?o():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Fx];let n=tp.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return Re(e)&&(n=e.syncLimit,oO(n)?n=EO(i,n):n>>=0),Math.min(n,i)}getColumnWidth(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=n;return r===void 0&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof r=="number"&&(r=Math.max(r,If))),r}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,r,s)=>{const o=hc(zd,this).length;return(o-1<s||hc(zd,this)[s]!==r)&&i.push(this.hot.toVisualColumn(s)),o-1<s?hc(zd,this).push(r):hc(zd,this)[s]=r,i},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function t0e(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const i=this.hot.toPhysicalColumn(n);i!==null&&(this.hot._getColWidthFromSettings(i)||Cr(zr,this,J3).call(this,n,e))}),this.ghostTable.columns.length&&(Cr(zr,this,Z3).call(this),this.ghostTable.clean())}function J3(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((i,r)=>this.ghostTable.addColumn(r,i))}function Z3(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function n0e(){this.calculateVisibleColumnsWidth(),this.inProgress||(Cr(zr,this,t0e).call(this,hc(Nf,this)),pC(Nf,this,[]))}function i0e(t,e){e||this.recalculateAllColumnsWidth()}function r0e(t){const e=t.reduce((n,i)=>{let[,r]=i;const s=this.hot.propToCol(r);return Number.isInteger(s)&&n.indexOf(s)===-1&&n.push(s),n},[]);hc(Nf,this).push(...e)}function vW(t,e,n){let i=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function s0e(){pC(zd,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),pC(dk,this,!0)}function o0e(t){if(!hc(dk,this))return;const e=t.reduce((n,i)=>{var r;const s=(r=i.address)===null||r===void 0?void 0:r.col;if(Number.isInteger(s)){const o=this.hot.toVisualColumn(s);n.indexOf(o)===-1&&n.push(o)}return n},[]);hc(Nf,this).push(...e)}const Ju={horizontal:"horizontal",vertical:"vertical"};function a0e(t,e,n){let i,r,s;return e[0]===t[0]&&e[1]<t[1]?(s="left",i=n(e[0],e[1]),r=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(s="right",i=n(e[0],t[3]+1),r=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",i=n(e[0],e[1]),r=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",i=n(t[2]+1,e[1]),r=n(e[2],e[3])),i&&i.normalize(),r&&r.normalize(),{directionOfDrag:s,startOfDragCoords:i,endOfDragCoords:r}}function l0e(t){const e={};return t===!0?(e.directions=Object.keys(Ju),e.autoInsertRow=!0):Re(t)?(se(t.autoInsertRow)?t.direction===Ju.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,se(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Ju)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function c0e(t,e){u0e(t,e),e.add(t)}function u0e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ud(t,e,n){return(e=h0e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function h0e(t){var e=d0e(t,"string");return typeof e=="symbol"?e:e+""}function d0e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("modifyAutofillRange");le.getSingleton().register("beforeAutofill");le.getSingleton().register("afterAutofill");const bW="autofill",f0e=20,g0e=["fillHandle"],m0e="insert_row_below",p0e=200;var au=new WeakSet;class w0e extends et{constructor(){super(...arguments),c0e(this,au),ud(this,"addingStarted",!1),ud(this,"mouseDownOnCellCorner",!1),ud(this,"mouseDragOutside",!1),ud(this,"handleDraggedCells",0),ud(this,"directions",[]),ud(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return bW}static get PLUGIN_PRIORITY(){return f0e}static get SETTING_KEYS(){return[bW,...g0e]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>hd(au,this,y0e).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>hd(au,this,b0e).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>hd(au,this,C0e).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.hot.getSelectedRangeLast(),{row:i,col:r}=n.getTopStartCorner(),{row:s,col:o}=n.getBottomEndCorner(),a=this.hot.runHooks("modifyCopyableRange",[{startRow:i,startCol:r,endRow:s,endCol:o}]),l=[],c=[],u=[];return k(a,h=>{for(let d=h.startRow;d<=h.endRow;d+=1)l.indexOf(d)===-1&&l.push(d);for(let d=h.startCol;d<=h.endCol;d+=1)c.indexOf(d)===-1&&c.push(d)}),k(l,h=>{const d=[];k(c,f=>{const g=e?this.hot.getSourceDataAtCell(h,f):null;e&&Re(g)?d.push(this.hot.getCopyableSourceData(h,f)):d.push(this.hot.getCopyableData(h,f))}),u.push(d)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,i,r]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),o=s.getTopStartCorner(),a=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[o.row,o.col,a.row,a.col],c=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,n),Math.max(a.row,i),Math.max(a.col,r)],l),{directionOfDrag:u,startOfDragCoords:h,endOfDragCoords:d}=a0e(l,c,(f,g)=>this.hot._createCellCoords(f,g));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),g=this.getSelectionData(!0),m=s.clone(),p=this.hot._createCellRange(h,h,d),v=this.hot.runHooks("beforeAutofill",f,m,p,u);if(v===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let b=v;const R=v;if(["up","left"].indexOf(u)>-1&&!(R.length===1&&R[0].length===0))if(b=[],u==="up"){const S=d.row-h.row+1,x=S%R.length;for(let M=0;M<S;M++)b.push(R[(M+(R.length-x))%R.length])}else{const S=d.col-h.col+1,x=S%R[0].length;for(let M=0;M<R.length;M++){b.push([]);for(let T=0;T<S;T++)b[M].push(R[M][(T+(R[M].length-x))%R[M].length])}}if(g.some(S=>S.some(x=>Re(x)))){const S=hd(au,this,v0e).call(this,b,g,h,d,u);S.length&&(b=S)}this.hot.populateFromArray(h.row,h.col,b,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(c),this.hot.runHooks("afterAutofill",b,m,p,u),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),i=n.getBottomEndCorner();let r=e;if(this.directions.includes(Ju.vertical)&&this.directions.includes(Ju.horizontal)){const s=n.getTopStartCorner();(i.col<=e.col||s.col>=e.col)&&(r=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||s.row>e.row)&&(r=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(Ju.vertical))r=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(Ju.horizontal))r=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(m0e,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},p0e)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&n[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),i=this.hot.countRows();let r;for(let s=e[2]+1;s<i;s++){for(let l=e[1];l<=e[3];l++){const c=n[s][l];if(!hn(c))return-1}const o=n[s][e[1]-1],a=n[s][e[3]+1];(!hn(o)||!hn(a))&&(r=s)}return r}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...lt(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,i=yi(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+An(this.hot.table),r=yi(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+yn(this.hot.table);return e.clientY>i&&e.clientX<=r}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>hd(au,this,S0e).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>hd(au,this,R0e).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=l0e(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function v0e(t,e,n,i){const r=[];for(let s=Math.min(n.row,i.row);s<=Math.max(n.row,i.row);s+=1){r.push([]);for(let o=Math.min(n.col,i.col);o<=Math.max(n.col,i.col);o+=1){const a=this.hot.getSourceDataAtCell(s,o),l=s-Math.min(n.row,i.row),c=o-Math.min(n.col,i.col),u=l%e.length,h=c%e[0].length;Re(a)?r[l][c]=e[u][h]:r[l][c]=t[u][h]}}return r}function b0e(){this.selectAdjacent()&&this.fillIn()}function y0e(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function C0e(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function S0e(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function R0e(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function _0e(t,e){Q3(t,e),e.add(t)}function yW(t,e,n){Q3(t,e),e.set(t,n)}function Q3(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dd(t,e,n){return(e=E0e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function E0e(t){var e=x0e(t,"string");return typeof e=="symbol"?e:e+""}function x0e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eX(t,e,n){return t.set(Yr(t,e),n),n}function wC(t,e){return t.get(Yr(t,e))}function Yr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Vx="autoRowSize",T0e=40,M0e="autoRowSize",CW="htFirstDatasetColumnNotRendered",SW="htAutoRowSize";var $p=new WeakMap,fk=new WeakMap,ps=new WeakSet;class np extends et{static get PLUGIN_KEY(){return Vx}static get PLUGIN_PRIORITY(){return T0e}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),_0e(this,ps),dd(this,"headerHeight",null),dd(this,"ghostTable",new hk(this.hot)),dd(this,"samplesGenerator",new h0((n,i)=>{const r=this.hot.toPhysicalColumn(i);if(this.hot.columnIndexMapper.isHidden(r)||n>=0&&i>=0&&this.hot.getCellMeta(n,i).hidden)return!1;let s;return n>=0?s=this.hot.getDataAtCell(n,i):n===-1&&(s=this.hot.getColHeader(i)),{value:s}})),dd(this,"inProgress",!1),dd(this,"measuredRows",0),dd(this,"rowHeightsMap",new Fc),yW(this,$p,[]),yW(this,fk,!1),this.hot.rowIndexMapper.registerMap(M0e,this.rowHeightsMap),this.addHook("beforeRowResize",(n,i,r)=>Yr(ps,this,RW).call(this,n,i,r))}isEnabled(){const e=this.hot.getSettings()[Vx];return e===!0||Re(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Yr(ps,e,O0e).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Yr(ps,e,H0e).call(e,...r)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return Yr(ps,e,D0e).call(e,...r)}),this.addHook("beforeViewRender",()=>Yr(ps,this,A0e).call(this)),this.addHook("beforeRender",()=>Yr(ps,this,I0e).call(this)),this.addHook("modifyRowHeight",(i,r)=>this.getRowHeight(r,i)),this.addHook("init",()=>Yr(ps,this,k0e).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),q(this.hot.rootElement,SW),super.enablePlugin()}disablePlugin(){this.headerHeight=null,ue(this.hot.rootElement,SW),super.disablePlugin(),Yr(ps,this,tX).call(this,!1),this.addHook("beforeRowResize",(e,n,i)=>Yr(ps,this,RW).call(this,e,n,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const i=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,s=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(o.get(-1))}pe(r.from,r.to,o=>{let a=this.hot.toPhysicalRow(o);a===null&&(a=o),(i||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(o,s).forEach((c,u)=>this.ghostTable.addRow(u,c))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,a)=>{o<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),a)})},!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countRows()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){Op(s),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+np.CALCULATION_STEP,r)},e,n),i=i+np.CALCULATION_STEP+1,i<r?s=Ip(o):(Op(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,n),i=a+1),i<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Vx];let n=np.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return Re(e)&&(n=e.syncLimit,oO(n)?n=EO(i,n):n>>=0),Math.min(n,i)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.stylesHandler.getDefaultRowHeight(e);if(e<0){var i;return(i=this.headerHeight)!==null&&i!==void 0?i:n}const r=this.hot.toPhysicalRow(e);if(this.hot.rowIndexMapper.isHidden(r))return n;const s=this.rowHeightsMap.getValueAtIndex(r);let o=n;return s!==null&&s>n&&(o=s,!this.hot.stylesHandler.isClassicTheme()&&e===this.hot.view.getFirstRenderedVisibleRow()&&(o+=1)),o}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{pe(Math.min(n,i),Math.max(n,i),r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function P0e(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((r,s)=>this.ghostTable.addRow(s,r))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,i)=>{const r=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(r,i)})},!0),this.ghostTable.clean())}function tX(t){const e=this.hot.getFirstRenderedVisibleColumn(),n=this.hot.columnIndexMapper.getPhysicalFromVisualIndex(e);t===!1||n===this.hot.columnIndexMapper.getPhysicalFromRenderableIndex(0)?ue(this.hot.rootElement,CW):q(this.hot.rootElement,CW)}function A0e(){Yr(ps,this,tX).call(this)}function I0e(){this.calculateVisibleRowsHeight(),this.inProgress||(Yr(ps,this,P0e).call(this,wC($p,this)),eX($p,this,[]))}function RW(t,e,n){let i=t;return n&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function O0e(t,e){e||this.recalculateAllRowsHeight()}function H0e(t){const e=t.reduce((n,i)=>{let[r]=i;return n.indexOf(r)===-1&&n.push(r),n},[]);wC($p,this).push(...e)}function k0e(){this.recalculateAllRowsHeight(),eX(fk,this,!0)}function D0e(t){if(!wC(fk,this))return;const e=t.reduce((n,i)=>{var r;const s=(r=i.address)===null||r===void 0?void 0:r.row;if(Number.isInteger(s)){const o=this.hot.toVisualRow(s);n.indexOf(o)===-1&&n.push(o)}return n},[]);wC($p,this).push(...e)}const{getListWithInsertedItems:N0e,getListWithRemovedItems:L0e}=G5("physicallyIndexed");class $0e extends zh{constructor(){super(e=>e)}insert(e,n){const i=JO(this.indexedValues,n);this.indexedValues=N0e(i,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=L0e(this.indexedValues,e);this.indexedValues=XO(n,e),super.remove(e)}}const{getListWithInsertedItems:F0e,getListWithRemovedItems:V0e}=G5("physicallyIndexed");class B0e extends zh{constructor(){super(e=>e)}insert(e,n){this.indexedValues=F0e(this.indexedValues,e,n,(i,r)=>this.getNextValue(r)),super.insert(e,n)}remove(e){this.indexedValues=V0e(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function W0e(t,e){j0e(t,e),e.add(t)}function j0e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function z0e(t,e,n){return(e=U0e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U0e(t){var e=Y0e(t,"string");return typeof e=="symbol"?e:e+""}function Y0e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function G0e(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _W="bindRowsWithHeaders",q0e=210,K0e="loose",EW=new Map([["loose",$0e],["strict",B0e]]);var xW=new WeakSet;class X0e extends et{constructor(){super(...arguments),W0e(this,xW),z0e(this,"headerIndexes",null)}static get PLUGIN_KEY(){return _W}static get PLUGIN_PRIORITY(){return q0e}isEnabled(){return!!this.hot.getSettings()[_W]}enablePlugin(){var e;if(this.enabled)return;const n=(e=EW.get(this.getSetting()))!==null&&e!==void 0?e:EW.get(K0e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",i=>G0e(xW,this,J0e).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function J0e(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Z0e(t,e){nX(t,e),e.add(t)}function Q0e(t,e,n){nX(t,e),e.set(t,n)}function nX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function TW(t,e,n){return(e=eRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eRe(t){var e=tRe(t,"string");return typeof e=="symbol"?e:e+""}function tRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MW(t,e){return t.get(ef(t,e))}function Bx(t,e,n){return t.set(ef(t,e),n),n}function ef(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const cy="collapsibleColumns",nRe=290,iRe=["nestedHeaders"],wf="collapsibleIndicator",PW=cy,AW=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var fd=new WeakMap,qg=new WeakSet;class rRe extends et{constructor(){super(...arguments),Z0e(this,qg),TW(this,"nestedHeadersPlugin",null),TW(this,"headerStateManager",null),Q0e(this,fd,null)}static get PLUGIN_KEY(){return cy}static get PLUGIN_PRIORITY(){return nRe}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[cy,...iRe]}isEnabled(){return!!this.hot.getSettings()[cy]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||Ue("You need to configure the Nested Headers plugin in order to use collapsible headers."),Bx(fd,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>ef(qg,this,aRe).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return ef(qg,e,lRe).call(e,...r)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return ef(qg,e,sRe).call(e,...r)}),this.addHook("beforeOnCellMouseDown",(i,r,s)=>ef(qg,this,oRe).call(this,i,r,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Bx(fd,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:i}=this.hot.getSelectedRangeActive().highlight,{collapsible:r,isCollapsed:s,columnIndex:o}=(e=this.headerStateManager.getHeaderTreeNodeData(n,i))!==null&&e!==void 0?e:{};if(r)return s?this.expandSection({row:n,col:o}):this.collapseSection({row:n,col:o}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.highlight.isHeader())},group:PW,relativeToGroup:Vc,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(PW)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(o){o&&o.parentNode.removeChild(o)};pe(0,e-1,o=>{const a=n.childNodes[o],l=i.childNodes[o],c=r?r.childNodes[o]:null;pe(0,a.childNodes.length-1,u=>{let h=a.childNodes[u].querySelector(`.${wf}`);s(h),l&&l.childNodes[u]&&(h=l.childNodes[u].querySelector(`.${wf}`),s(h)),r&&c&&c.childNodes[u]&&(h=c.childNodes[u].querySelector(`.${wf}`),s(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(i=>{const{collapsible:r,origColspan:s,headerLevel:o,columnIndex:a,isCollapsed:l}=i;if(r===!0&&s>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:a}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!AW.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const i=Ec(e,f=>{let{row:g}=f;return g<0});let r=i.length>0;k(i,f=>{var g;let{row:m,col:p}=f;const{collapsible:v,isCollapsed:b}=(g=this.headerStateManager.getHeaderSettings(m,p))!==null&&g!==void 0?g:{};if(!v||b&&n==="collapse"||!b&&n==="expand")return r=!1,!1});const s=[],o=[];r&&k(i,f=>{let{row:g,col:m}=f;const{colspanCompensation:p,affectedColumns:v,rollbackModification:b}=this.headerStateManager.triggerNodeModification(n,g,m);p>0&&(o.push(...v),s.push(b))});const a=this.getCollapsedColumns();let l=[];n==="collapse"?l=PK([...a,...o]):n==="expand"&&(l=Ec(a,f=>!o.includes(f)));const c=AW.get(n);if(this.hot.runHooks(c.beforeHook,a,l,r)===!1){k(s,f=>{f()});return}this.hot.batchExecution(()=>{k(o,f=>{MW(fd,this).setValueAtIndex(this.hot.toPhysicalColumn(f),c.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeActive();if(n==="collapse"&&h&&d){const{row:f,col:g}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(g))&&o.includes(g)){const p=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,v=g>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(g,1,!0):g;p!==null&&v!==null&&this.hot.selectCell(p,v)}}this.hot.runHooks(c.afterHook,a,l,r,h),this.hot.view.adjustElementsSize(),this.hot.render()}getCollapsedColumns(){return MW(fd,this).getHiddenIndexes()}destroy(){Bx(fd,this,null),super.destroy()}}function sRe(t,e,n){var i;const{collapsible:r,origColspan:s,isCollapsed:o}=(i=this.headerStateManager.getHeaderSettings(n,t))!==null&&i!==void 0?i:{},a=r&&s>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let c=e.querySelector(`.${wf}`);if(ra(e,[Ts("")[0]]),a)c||(c=this.hot.rootDocument.createElement("div"),q(c,wf),e.querySelector("div:first-child").appendChild(c)),ue(c,["collapsed","expanded"]),o?(q(c,"collapsed"),Tc(c,"+"),l&&he(e,...Ts(!1))):(q(c,"expanded"),Tc(c,"-"),l&&he(e,...Ts(!0))),l&&he(c,...jh());else{var u;(u=c)===null||u===void 0||u.remove()}}function oRe(t,e){Ee(t.target,wf)&&(Ee(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Ee(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),es(t))}function aRe(){this.updatePlugin()}function lRe(t,e){e||this.updatePlugin()}function lu(t,e,n){return(e=cRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cRe(t){var e=uRe(t,"string");return typeof e=="symbol"?e:e+""}function uRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const hRe=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],dRe=!1,fRe=!0,gRe=!0;class mRe{constructor(e,n){lu(this,"hot",void 0),lu(this,"sortingStates",new n0),lu(this,"sortEmptyCells",dRe),lu(this,"indicator",fRe),lu(this,"headerAction",gRe),lu(this,"compareFunctionFactory",void 0),lu(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Re(e)&&Ye(e,(n,i)=>{hRe.includes(i)&&(this[i]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[i]=n;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Re(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[i,r]=n;return{column:this.hot.toVisualColumn(i),...r}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(se(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function iX(t,e,n){const i=e.locale;return function(r,s){const{sortEmptyCells:o}=n;return typeof r=="string"&&(r=r.toLocaleLowerCase(i)),typeof s=="string"&&(s=s.toLocaleLowerCase(i)),r===s?oa:hn(r)?hn(s)?oa:o&&t==="asc"?on:an:hn(s)?o&&t==="asc"?an:on:isNaN(r)&&!isNaN(s)?t==="asc"?an:on:!isNaN(r)&&isNaN(s)||(isNaN(r)||isNaN(s)||(r=parseFloat(r),s=parseFloat(s)),r<s)?t==="asc"?on:an:r>s?t==="asc"?an:on:oa}}const rX="default";function pRe(t,e,n){return function(i,r){const s=parseFloat(i),o=parseFloat(r),{sortEmptyCells:a}=n;if(s===o||isNaN(s)&&isNaN(o))return oa;if(a){if(hn(i))return t==="asc"?on:an;if(hn(r))return t==="asc"?an:on}return isNaN(s)?an:isNaN(o)?on:s<o?t==="asc"?on:an:s>o?t==="asc"?an:on:oa}}const wRe="numeric";function vRe(t,e,n){const i=e.checkedTemplate,r=e.uncheckedTemplate,{sortEmptyCells:s}=n;return function(o,a){const l=hn(o),c=hn(a),u=l?r:o,h=c?r:a,d=u===r||u===i,f=h===r||h===i;if(s===!1){if(l&&c===!1)return an;if(l===!1&&c)return on}return d===!1&&f?t==="asc"?on:an:d&&f===!1?t==="asc"?an:on:d===!1&&f===!1?iX(t,e,n)(o,a):u===r&&h===i?t==="asc"?on:an:u===i&&h===r?t==="asc"?an:on:oa}}const bRe="checkbox";function yRe(t,e,n){return uX(t,e.dateFormat,n)}const CRe="date";function SRe(t,e,n){return uX(t,e.timeFormat,n)}const RRe="time",{register:kw,getItem:IW,hasItem:_Re}=ks("sorting.compareFunctionFactory"),{register:sX,getItem:ERe}=ks("sorting.mainSortComparator");function oX(t){return _Re(t)?IW(t):IW(rX)}kw(bRe,vRe);kw(CRe,yRe);kw(rX,iX);kw(wRe,pRe);kw(RRe,SRe);const oa=0,on=-1,an=1;function xRe(t,e){const n=ERe(e);for(var i=arguments.length,r=new Array(i>2?i-2:0),s=2;s<i;s++)r[s-2]=arguments[s];t.sort(n(...r))}const vC="asc",bC="desc",aX="colHeader";function TRe(t){if(Re(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[vC,bC].includes(n)}function MRe(t){if(t.some(n=>TRe(n)===!1))return!1;const e=t.map(n=>{let{column:i}=n;return i});return new Set(e).size===e.length}function OW(t){if(t!==bC)return t===vC?bC:vC}function lX(t){return t.querySelector(`.${aX}`)}function cX(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function gk(t,e,n){return t===-1&&e>=0&&Pc(n)===!1}function uX(t,e,n){return function(i,r){const{sortEmptyCells:s}=n;if(i===r)return oa;if(hn(i))return hn(r)?oa:s&&t==="asc"?on:an;if(hn(r))return s&&t==="asc"?an:on;const o=Z(i,e),a=Z(r,e);return o.isValid()?a.isValid()?a.isAfter(o)?t==="asc"?on:an:a.isBefore(o)?t==="asc"?an:on:oa:on:an}}function PRe(t,e){Ue(ct`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const ARe="ascending",IRe="descending",hX="indicatorDisabled",dX="columnSorting",fX="sortAction",gX=new Map([[vC,ARe],[bC,IRe]]);function ORe(t,e,n,i){const r=[dX];if(i&&r.push(fX),n===!1)return r.push(hX),r;const s=t.getSortOrderOfColumn(e);return se(s)&&r.push(gX.get(s)),r}function HRe(){return Array.from(gX.values()).concat(fX,hX,dX)}function kRe(t,e){return function(n,i){const[,...r]=n,[,...s]=i;return(function(a){const l=t[a],c=e[a],u=r[a],h=s[a],d=c.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:oX(c.type))(l,c,d)(u,h)})(0)}}function DRe(t,e){NRe(t,e),e.add(t)}function NRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qv(t,e,n){return(e=LRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LRe(t){var e=$Re(t,"string");return typeof e=="symbol"?e:e+""}function $Re(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ud(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const yC="columnSorting",FRe=50,CC="append",VRe="replace",HW=yC;sX(yC,kRe);le.getSingleton().register("beforeColumnSort");le.getSingleton().register("afterColumnSort");const Kg=new WeakMap;var Nu=new WeakSet;class mX extends et{constructor(){super(...arguments),DRe(this,Nu),qv(this,"columnStatesManager",null),qv(this,"columnMetaCache",null),qv(this,"pluginKey",yC),qv(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return yC}static get PLUGIN_PRIORITY(){return FRe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(Kg.has(this.hot)&&Kg.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),PRe(Kg.get(this.hot),this.pluginKey);return}this.enabled||(Kg.set(this.hot,this.pluginKey),this.columnStatesManager=new mRe(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Fc(n=>{let i=this.hot.toVisualColumn(n);return i===null&&(i=n),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,i)=>Ud(Nu,this,BRe).call(this,n,i)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ud(Nu,e,jRe).call(e,...i)}),this.addHook("afterOnCellMouseDown",(n,i)=>this.onAfterOnCellMouseDown(n,i)),this.addHook("afterInit",()=>Ud(Nu,this,VP).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ud(Nu,e,WRe).call(e,...i)}),this.hot.view&&Ud(Nu,this,VP).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,i)=>{const r=lX(i);cX(n,i)===!1||r===null||this.updateHeaderClasses(r)};Kg.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:Vc,position:"before",group:HW})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(HW)}sort(e){const n=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",n,i,r)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new q5),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",n,r?i:n,r),r&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return se(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return MRe(e)&&e.every(i=>{let{column:r}=i;return r<=n&&r>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),i=r=>{let{column:s,...o}=r;return{column:this.hot.toPhysicalColumn(s),...o}};n.initialConfig=lt(e,i),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,i=r=>{let{column:s,...o}=r;return{column:this.hot.toVisualColumn(s),...o}};return se(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=lt(n.initialConfig,i)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(se(n)){const r=OW(n);return se(r)?{column:e,sortOrder:r}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:OW()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:CC;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=i!==-1,s=this.getSortConfig(),o=this.getColumnNextConfig(e);if(r){if(Nt(o))return[...s.slice(0,i),...s.slice(i+1)];if(n===CC)return[...s.slice(0,i),...s.slice(i+1),o];if(n===VRe)return[...s.slice(0,i),o,...s.slice(i+1)]}return se(o)?s.concat(o):s}getPluginColumnConfig(e){if(Re(e)){const n=e[this.pluginKey];if(Re(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(r);return Array.isArray(s.columns)?Object.assign(i,n,this.getPluginColumnConfig(s.columns[e])):ht(s.columns)?Object.assign(i,n,this.getPluginColumnConfig(s.columns(e))):Object.assign(i,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),i=Object.create(n);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],i=this.hot.countRows(),r=c=>lt(e,u=>this.hot.getDataAtCell(c,u.column));for(let c=0;c<this.getNumberOfRowsToSort(i);c+=1)n.push([this.hot.toPhysicalRow(c)].concat(r(c)));const s=lt(n,c=>c[0]);xRe(n,this.pluginKey,lt(e,c=>c.sortOrder),lt(e,c=>this.getFirstCellSettings(c.column)));for(let c=n.length;c<i;c+=1)n.push([c].concat(r(c)));const o=lt(n,c=>c[0]),a=new Map(lt(s,(c,u)=>[c,o[u]])),l=lt(this.hot.rowIndexMapper.getIndexesSequence(),c=>a.has(c)?a.get(c):c);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(Re(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Re(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(ue(e,HRe()),this.enabled!==!1){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];q(e,ORe(...i))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),se(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&Ee(e.target,aX)}onAfterOnCellMouseDown(e,n){if(gk(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const i=this.hot.getActiveEditor(),r=this.getColumnNextConfig(n.col);i!=null&&i.isOpened()&&this.hot.getCellValidator(i.row,i.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(r)}):this.sort(r)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function VP(){const t=this.getAllSavedSortSettings();if(Re(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function BRe(t,e){const n=lX(e);if(cX(t,e)===!1||n===null)return;const i=this.getFirstCellSettings(t)[this.pluginKey],r=i.indicator,s=i.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,r,s),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(t);he(e,...Ehe(o?`${o}ending`:"none"))}}function WRe(t){t===!0&&this.hot.view&&Ud(Nu,this,VP).call(this)}function jRe(t,e,n,i){gk(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function Wx(t){return t==null||isNaN(t)}function zRe(t,e){if(typeof t!="number")return t;const n=i=>i.toString();switch(typeof e){case"number":return n(t.toFixed(Math.min(Math.max(0,e),100)));case"boolean":return e?n(Math.round(t)):t;case"string":if(e==="auto"){const i=Math.round(t).toString().length;return n(t.toFixed(8-i))}return t;default:return t}}function cu(t,e,n){return(e=URe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function URe(t){var e=YRe(t,"string");return typeof e=="symbol"?e:e+""}function YRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class GRe{constructor(e,n){cu(this,"plugin",void 0),cu(this,"hot",void 0),cu(this,"endpoints",[]),cu(this,"settings",void 0),cu(this,"settingsType","array"),cu(this,"currentEndpoint",null),cu(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),k(i,r=>{const s={};this.assignSetting(r,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(r,s,"reversedRowCoords",!1),this.assignSetting(r,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,s,"sourceColumn",r.destinationColumn),this.assignSetting(r,s,"type","sum"),this.assignSetting(r,s,"forceNumeric",!1),this.assignSetting(r,s,"suppressDataTypeErrors",!0),this.assignSetting(r,s,"customFunction",null),this.assignSetting(r,s,"readOnly",!0),this.assignSetting(r,s,"roundFloat",!1),n.push(s)}),n}assignSetting(e,n,i,r){if(i==="ranges"&&e[i]===void 0){n[i]=r;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(r instanceof Error)throw r;n[i]=r}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-e[i]-1:n[i]=e[i]}resetSetupBeforeStructureAlteration(e,n,i){if(this.settingsType!=="function")return;const r=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();k(s,o=>{r==="row"&&o.destinationRow>=n&&(e==="insert_row"?o.alterRowOffset=i:e==="remove_row"&&(o.alterRowOffset=-1*i)),r==="col"&&o.destinationColumn>=n&&(e==="insert_col"?o.alterColumnOffset=i:e==="remove_col"&&(o.alterColumnOffset=-1*i))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,n,i,r,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(s==="auto")return;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,c=this.getAllEndpoints(),u=e.indexOf("move_row")===0,h=n;k(c,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*i),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*i)}),this.resetAllEndpoints(c,!u),u?k(c,d=>{this.extendEndpointRanges(d,h,r[0],r.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):k(c,d=>{this.shiftEndpointCoordinates(d,h)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,i,r){k(e.ranges,s=>{s[1]&&(n>=s[0]&&n<=s[1]?i>s[1]?s[1]+=r:i<s[0]&&(s[0]-=r):i>=s[0]&&i<=s[1]&&(s[1]-=r,n<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,i=[],r=[];k(n,s=>{const o=[];if(s[1])for(let a=s[0];a<=s[1];a++)o.push(this.hot.toPhysicalRow(a));else o.push(this.hot.toPhysicalRow(s[0]));r.push(o)}),k(r,s=>{let o=[];k(s,(a,l)=>{l===0?o.push(a):s[l]!==s[l-1]+1&&(o.push(s[l-1]),i.push(o),o=[],o.push(a)),l===s.length-1&&(o.push(a),i.push(o))})}),e.ranges=i}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,k(e.ranges,i=>{k(i,(r,s)=>{r>=n&&(i[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(r=>{const s=r.alterRowOffset||0,o=r.alterColumnOffset||0;return r.destinationRow+s>=this.hot.countRows()||r.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],k(e,r=>{this.resetEndpointValue(r,n)}),this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],k(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],k(e,(i,r,s)=>{`${i[2]||""}`!=`${i[3]}`&&k(this.getAllEndpoints(),(o,a)=>{this.hot.propToCol(s[r][1])===o.sourceColumn&&n.indexOf(a)===-1&&n.push(a)})}),k(n,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const i=this.hot.getCellMeta(n,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?i:0)),this.hot.toVisualColumn(e.destinationColumn+(n?r:0)),""])}setEndpointValue(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const o=this.hot.getCellMeta(s,e.destinationColumn);(n==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}e.result=zRe(e.result,e.roundFloat),i?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){Ue("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function qRe(t,e){KRe(t,e),e.add(t)}function KRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function XRe(t,e,n){return(e=JRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JRe(t){var e=ZRe(t,"string");return typeof e=="symbol"?e:e+""}function ZRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gd(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const jx="columnSummary",QRe=220;var uu=new WeakSet;class e_e extends et{constructor(){super(...arguments),qRe(this,uu),XRe(this,"endpoints",null)}static get PLUGIN_KEY(){return jx}static get PLUGIN_PRIORITY(){return QRe}isEnabled(){return!!this.hot.getSettings()[jx]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[jx],this.endpoints=new GRe(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gd(uu,e,t_e).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gd(uu,e,i_e).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gd(uu,e,n_e).call(e,...i)}),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gd(uu,e,r_e).call(e,...i)}),this.addHook("afterUpdateData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gd(uu,e,s_e).call(e,...i)}),this.addHook("beforeCreateRow",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,i,null,r)),this.addHook("beforeCreateCol",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,i,null,r)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,i,null,r)),this.addHook("afterCreateCol",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,i,null,r)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return gd(uu,e,o_e).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return Ye(e.ranges,i=>{n+=this.getPartialSum(i,e.sourceColumn)}),n}getPartialSum(e,n){let i=0,r=e[1]||e[0],s=null,o=0;do{if(s=this.getCellValue(r,n),s=Wx(s)?null:s,s!==null){const a=(`${s}`.split(".")[1]||[]).length||1;a>o&&(o=a)}i+=s||0,r-=1}while(r>=e[0]);return Math.round(i*10**o)/10**o}calculateMinMax(e,n){let i=null;return Ye(e.ranges,r=>{const s=this.getPartialMinMax(r,e.sourceColumn,n);if(i===null&&s!==null&&(i=s),s!==null)switch(n){case"min":i=Math.min(i,s);break;case"max":i=Math.max(i,s);break}}),i===null?"Not enough data":i}getPartialMinMax(e,n,i){let r=null,s=e[1]||e[0],o;do{if(o=this.getCellValue(s,n),o=Wx(o)?null:o,r===null)r=o;else if(o!==null)switch(i){case"min":r=Math.min(r,o);break;case"max":r=Math.max(r,o);break}s-=1}while(s>=e[0]);return r}countEmpty(e,n){let i,r=0,s=e[1]||e[0];do i=this.getCellValue(s,n),i=Wx(i)?null:i,i===null&&(r+=1),s-=1;while(s>=e[0]);return r}countEntries(e){let n=0;const i=e.ranges;return Ye(i,r=>{const s=r[1]===void 0?1:r[1]-r[0]+1,o=this.countEmpty(r,e.sourceColumn);n+=s,n-=o}),n}calculateAverage(e){const n=this.calculateSum(e),i=this.countEntries(e);return n/i}getCellValue(e,n){const i=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(n);let s=this.hot.getSourceDataAtCell(e,n),o="";if(i!==null&&r!==null&&(o=this.hot.getCellMeta(i,r).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(ct`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function t_e(){this.endpoints.initEndpoints()}function n_e(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function i_e(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function r_e(t,e){e||this.endpoints.refreshAllEndpoints()}function s_e(t,e){e||this.endpoints.refreshAllEndpoints()}function o_e(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function a_e(t,e){pX(t,e),e.add(t)}function zx(t,e,n){pX(t,e),e.set(t,n)}function pX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yd(t,e){return t.get(mk(t,e))}function BP(t,e,n){return t.set(mk(t,e),n),n}function mk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var SC=new WeakMap,Kv=new WeakMap,Xv=new WeakMap,kW=new WeakSet;class wX{constructor(){a_e(this,kW),zx(this,SC,!0),zx(this,Kv,null),zx(this,Xv,new ResizeObserver(e=>mk(kW,this,l_e).call(this,e)))}setObservedElement(e){BP(Kv,this,e)}unobserve(){Yd(Xv,this).unobserve(Yd(Kv,this))}observe(){BP(SC,this,!0),Yd(Xv,this).observe(Yd(Kv,this))}destroy(){Yd(Xv,this).disconnect()}}function l_e(t){if(Yd(SC,this)||!Array.isArray(t)||!t.length){BP(SC,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:i,blockSize:r}=n[0];this.runLocalHooks("resize",i,r)})}pt(wX,ti);function xl(t,e,n){c_e(t,e),e.set(t,n)}function c_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _t(t,e){return t.get(vX(t,e))}function Eo(t,e,n){return t.set(vX(t,e),n),n}function vX(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var md=new WeakMap,Ux=new WeakMap,Yx=new WeakMap,Pa=new WeakMap,Tl=new WeakMap,Ml=new WeakMap,Jv=new WeakMap,pd=new WeakMap;class Zu{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n,i){var r=this;xl(this,md,void 0),xl(this,Ux,void 0),xl(this,Yx,!1),xl(this,Pa,null),xl(this,Tl,void 0),xl(this,Ml,void 0),xl(this,Jv,!0),xl(this,pd,new wX),Eo(md,this,e),Eo(Ux,this,i),Eo(Yx,this,n),Eo(Tl,this,this.createEditor()),Eo(Ml,this,_t(Tl,this).style),_t(pd,this).setObservedElement(this.getInputElement()),_t(pd,this).addLocalHook("resize",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return r.runLocalHooks("resize",...o)}),this.hide()}setPosition(e,n){_t(Ml,this).left=`${e}px`,_t(Ml,this).top=`${n}px`}setSize(e,n){if(e&&n){const i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${n}px`}}getSize(){return{width:yn(this.getInputElement()),height:An(this.getInputElement())}}observeSize(){_t(pd,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){_t(Ml,this).display="block",Eo(Jv,this,!1)}hide(){_t(pd,this).unobserve(),_t(Jv,this)||(_t(Ml,this).display="none"),Eo(Jv,this,!0)}isVisible(){return _t(Ml,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return _t(md,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=_t(md,this).createElement("div"),n=_t(md,this).createElement("textarea");return e.style.display="none",Eo(Pa,this,_t(md,this).createElement("div")),_t(Pa,this).setAttribute("dir",_t(Yx,this)?"rtl":"ltr"),q(_t(Pa,this),Zu.CLASS_EDITOR_CONTAINER),_t(Ux,this).appendChild(_t(Pa,this)),q(e,Zu.CLASS_EDITOR),q(n,Zu.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),_t(Pa,this).appendChild(e),e}getInputElement(){return _t(Tl,this).querySelector(`.${Zu.CLASS_INPUT}`)}getEditorElement(){return _t(Tl,this)}destroy(){const e=_t(Pa,this)?_t(Pa,this).parentNode:null;_t(Tl,this).parentNode.removeChild(_t(Tl,this)),Eo(Tl,this,null),Eo(Ml,this,null),_t(pd,this).destroy(),e&&e.removeChild(_t(Pa,this))}}pt(Zu,ti);function Gx(t,e,n){return(e=u_e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function u_e(t){var e=h_e(t,"string");return typeof e=="symbol"?e:e+""}function h_e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const d_e=250,f_e=250;class bX{constructor(e){Gx(this,"wasLastActionShow",!0),Gx(this,"showDebounced",null),Gx(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},f_e)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:d_e;this.showDebounced=Ew(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}pt(bX,ti);function g_e(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function m_e(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function hu(t,e){const n={};return k(t,i=>{i.forAll((r,s)=>{r>=0&&s>=0&&(n[r]||(n[r]=[]),n[r][s]=e(r,s))})}),n}function Yl(t,e,n,i,r){k(t,s=>{s.forAll((o,a)=>{o>=0&&a>=0&&p_e(o,a,e,n,i,r)})})}function p_e(t,e,n,i,r,s){const o=r(t,e);let a=i;o.className&&(n==="vertical"?a=g_e(o.className,i):a=m_e(o.className,i)),s(t,e,"className",a)}function yX(t){return`<span class="selected"></span>${t}`}function uy(t,e){let n=!1;return Array.isArray(t)&&k(t,i=>(i.forAll((r,s)=>{if(r>=0&&s>=0&&e(r,s))return n=!0,!1}),n)),n}function d0(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:i}=e.defaultView,{top:r,left:s}=i.getBoundingClientRect();n.top=r,n.left=s}return n}const Xe="---------";function w_e(){return{name:Xe}}const bs="alignment";function v_e(){return{key:bs,name(){return this.getTranslatedPhrase(_1)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeActive();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${bs}:left`,name(){return this.getTranslatedPhrase(E1)},callback(){const t=this.getSelectedRange(),e=hu(t,(r,s)=>this.getCellMeta(r,s).className),n="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,t,n,i),Yl(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{key:`${bs}:center`,name(){return this.getTranslatedPhrase(x1)},callback(){const t=this.getSelectedRange(),e=hu(t,(r,s)=>this.getCellMeta(r,s).className),n="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,t,n,i),Yl(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{key:`${bs}:right`,name(){return this.getTranslatedPhrase(T1)},callback(){const t=this.getSelectedRange(),e=hu(t,(r,s)=>this.getCellMeta(r,s).className),n="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,t,n,i),Yl(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{key:`${bs}:justify`,name(){return this.getTranslatedPhrase(M1)},callback(){const t=this.getSelectedRange(),e=hu(t,(r,s)=>this.getCellMeta(r,s).className),n="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,t,n,i),Yl(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{name:Xe},{key:`${bs}:top`,name(){return this.getTranslatedPhrase(P1)},callback(){const t=this.getSelectedRange(),e=hu(t,(r,s)=>this.getCellMeta(r,s).className),n="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,t,n,i),Yl(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{key:`${bs}:middle`,name(){return this.getTranslatedPhrase(A1)},callback(){const t=this.getSelectedRange(),e=hu(t,(r,s)=>this.getCellMeta(r,s).className),n="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,i),Yl(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1},{key:`${bs}:bottom`,name(){return this.getTranslatedPhrase(I1)},callback(){const t=this.getSelectedRange(),e=hu(t,(r,s)=>this.getCellMeta(r,s).className),n="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,t,n,i),Yl(t,n,i,(r,s)=>this.getCellMeta(r,s),(r,s,o,a)=>this.setCellMeta(r,s,o,a)),this.render()},disabled:!1}]}}}const f0="clear_column";function b_e(){return{key:f0,name(){return this.getTranslatedPhrase(u1)},callback(t,e){const n=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,i)=>{if(n<0||i<0)return!0;const{readOnly:r}=this.getCellMeta(n,i);return r?!0:(e=!0,!1)}),!e}}}const Dw="col_left";function y_e(){return{key:Dw,name(){return this.getTranslatedPhrase(r1)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Nw="col_right";function C_e(){return{key:Nw,name(){return this.getTranslatedPhrase(s1)},callback(){const t=this.getSelectedRangeActive().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Lw="make_read_only";function S_e(){return{key:Lw,checkable:!0,ariaChecked(){return uy(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(oC)},name(){let t=this.getTranslatedPhrase(oC);return uy(this.getSelectedRange(),(n,i)=>this.getCellMeta(n,i).readOnly)&&(t=yX(t)),t},callback(){const t=this.getSelectedRange(),e=uy(t,(n,i)=>this.getCellMeta(n,i).readOnly);k(t,n=>{n.forAll((i,r)=>{i>=0&&r>=0&&this.setCellMeta(i,r,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeActive();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const g0="redo";function R_e(){return{key:g0,name(){return this.getTranslatedPhrase(c1)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const $w="remove_col";function __e(){return{key:$w,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(a1,e)},callback(){this.alter("remove_col",_we(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const m0="remove_row";function E_e(){return{key:m0,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(o1,e)},callback(){this.alter("remove_row",Ewe(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const p0="row_above";function x_e(){return{key:p0,name(){return this.getTranslatedPhrase(n1)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const w0="row_below";function T_e(){return{key:w0,name(){return this.getTranslatedPhrase(i1)},callback(){const t=this.getSelectedRangeActive().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const Fp="no_items";function M_e(){return{key:Fp,name(){return this.getTranslatedPhrase(t1)},disabled:!0,isCommand:!1}}const v0="undo";function P_e(){return{key:v0,name(){return this.getTranslatedPhrase(l1)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const A_e=[p0,w0,Dw,Nw,f0,m0,$w,v0,g0,Lw,bs,Xe,Fp],I_e={[Xe]:w_e,[Fp]:M_e,[p0]:x_e,[w0]:T_e,[Dw]:y_e,[Nw]:C_e,[f0]:b_e,[m0]:E_e,[$w]:__e,[v0]:P_e,[g0]:R_e,[Lw]:S_e,[bs]:v_e};function CX(){const t={};return Ye(I_e,(e,n)=>{t[n]=e()}),t}function O_e(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(C1):this.getTranslatedPhrase(y1)},callback(){const e=this.getSelectedRangeActive();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function H_e(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(S1)},callback(){this.getSelectedRangeActive().forAll((n,i)=>{n>=0&&i>=0&&t.removeCommentAtCell(n,i,!1)}),this.render()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function k_e(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(R1);return uy(this.getSelectedRange(),(i,r)=>t.getCommentMeta(i,r,hy))?yX(e):e},callback(){this.getSelectedRangeActive().forAll((n,i)=>{if(n>=0&&i>=0){const r=!!t.getCommentMeta(n,i,hy);t.updateCommentMeta(n,i,{[hy]:!r})}})},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function D_e(t,e){SX(t,e),e.add(t)}function du(t,e,n){SX(t,e),e.set(t,n)}function SX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function N_e(t,e,n){return(e=L_e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L_e(t){var e=$_e(t,"string");return typeof e=="symbol"?e:e+""}function $_e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qo(t,e,n){return t.set(Xn(t,e),n),n}function je(t,e){return t.get(Xn(t,e))}function Xn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const RC="comments",F_e=60,Wa="comment",Dm="value",RX="style",hy="readOnly",Xg=RC,WP=`plugin:${RC}`;var xt=new WeakMap,zo=new WeakMap,b0=new WeakMap,dy=new WeakMap,_C=new WeakMap,jP=new WeakMap,EC=new WeakMap,oi=new WeakSet;class V_e extends et{constructor(){super(...arguments),D_e(this,oi),N_e(this,"range",{}),du(this,xt,null),du(this,zo,null),du(this,b0,!1),du(this,dy,!1),du(this,_C,!1),du(this,jP,null),du(this,EC,"")}static get PLUGIN_KEY(){return RC}static get PLUGIN_PRIORITY(){return F_e}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[RC]}enablePlugin(){var e=this;this.enabled||(je(xt,this)||(Qo(xt,this,new Zu(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),je(xt,this).addLocalHook("resize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Xn(oi,e,q_e).call(e,...i)}),this.hot.addHook("afterSetTheme",(n,i)=>{i||this.hide()})),je(zo,this)||Qo(zo,this,new bX(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,i,r,s,o,a)=>Xn(oi,this,U_e).call(this,n,a)),this.addHook("afterScroll",()=>Xn(oi,this,K_e).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>Xn(oi,this,DW).call(this,n)),this.addHook("beforeCompositionStart",n=>Xn(oi,this,DW).call(this,n)),je(zo,this).addLocalHook("hide",()=>this.hide()),je(zo,this).addLocalHook("show",(n,i)=>this.showAtCell(n,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){je(zo,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),i=e.addContext(WP);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const r=this.hot.getSelectedRangeActive();Qo(dy,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(r),this.show(),this.focusEditor(),e.setActiveContextName(WP),this.hot._registerTimeout(()=>{Qo(dy,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var r;return(r=this.hot.getSelectedRangeActive())===null||r===void 0?void 0:r.highlight.isCell()},group:Xg}),i.addShortcut({keys:[["Escape"]],callback:()=>{je(xt,this).setValue(je(EC,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>je(xt,this).isVisible()&&je(xt,this).isFocused(),group:Xg}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>je(xt,this).isVisible()&&je(xt,this).isFocused(),group:Xg}),i.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{Qo(_C,this,!0),je(xt,this).setValue(je(xt,this).getValue()),this.setComment(),this.hide(),e.setActiveContextName("grid")},group:Xg})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Xg)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>Xn(oi,this,j_e).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Xn(oi,this,B_e).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>Xn(oi,this,z_e).call(this)),this.eventManager.addEventListener(n,"focus",()=>Xn(oi,this,G_e).call(this)),this.eventManager.addEventListener(n,"blur",()=>Xn(oi,this,Y_e).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",i=>Xn(oi,this,W_e).call(this,i))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=xc(e.target,"TD","TBODY");return!!(n&&Ee(n,"htCommentCell")&&xc(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=je(xt,this).getValue();let i="";e!=null?i=e:n!=null&&(i=n);const{row:r,col:s}=Xn(oi,this,Gd).call(this);this.updateCommentMeta(r,s,{[Dm]:i}),this.hot.render()}setCommentAtCell(e,n,i){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:n,col:i}=Xn(oi,this,Gd).call(this);this.hot.setCellMeta(n,i,Wa),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(i)}getComment(){const{row:e,col:n}=Xn(oi,this,Gd).call(this);return this.getCommentMeta(e,n,Dm)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Dm)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:n,col:i}=Xn(oi,this,Gd).call(this);if(n<0||n>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(n,i);return je(zo,this).cancelHiding(),je(xt,this).setValue((e=r[Wa]?r[Wa][Dm]:null)!==null&&e!==void 0?e:""),je(xt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){je(xt,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!je(xt,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{row:r,col:s}=Xn(oi,this,Gd).call(this);let o=n.getRenderableFromVisualIndex(r),a=i.getRenderableFromVisualIndex(s);const l=o===null;je(xt,this).setPosition(0,0),o===null&&(o=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1))),a===null&&(a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(s,-1)));const c=o===null,u=a===null;o=o??0,a=a??0;const{rootWindow:h,view:{_wt:d}}=this.hot,{wtTable:f}=d,g=d.getCell({row:o,col:a},!0),m=this.getCommentMeta(r,s,RX);m?je(xt,this).setSize(m.width,m.height):je(xt,this).resetSize();const p=u?0:f.getColumnWidth(a),v=l&&!c?An(g):0,{left:b,top:R,width:S,height:x}=g.getBoundingClientRect(),{width:M,height:T}=je(xt,this).getSize(),{innerWidth:O,innerHeight:W}=this.hot.rootWindow,N=this.hot.rootDocument.documentElement,G=Sn(this.hot.rootDocument),j=wO(this.hot.rootWindow)?G:0,ne=vO(this.hot.rootWindow)?G:0;let ee=b+h.scrollX+p,Q=R+h.scrollY+v;this.hot.isRtl()&&(ee-=M+p),this.hot.isLtr()&&b+S+M>O-j?ee=b+h.scrollX-M-1:this.hot.isRtl()&&ee<-(N.scrollWidth-N.clientWidth)&&(ee=b+h.scrollX+p+1),R+T>W-ne&&(Q-=T-x+1),je(xt,this).setPosition(ee,Q),je(xt,this).setReadOnlyState(this.getCommentMeta(r,s,hy)),je(xt,this).observeSize()}focusEditor(){je(xt,this).focus()}updateCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n)[Wa];let s;r?(s=Vi(r),yw(s,i)):s=i,this.hot.setCellMeta(e,n,Wa,s)}getCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n);if(r[Wa])return r[Wa][i]}addToContextMenu(e){e.items.push({name:Xe},O_e(this),H_e(this),k_e(this))}getEditorInputElement(){return je(xt,this).getInputElement()}destroy(){var e,n;(e=je(xt,this))===null||e===void 0||e.destroy(),(n=je(zo,this))===null||n===void 0||n.destroy(),super.destroy()}}function B_e(t){if(!(!this.hot.view||!this.hot.view._wt)&&!je(b0,this)&&!this.targetIsCommentTextArea(t)){const e=xc(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function W_e(t){t.stopPropagation()}function j_e(t){const{rootDocument:e}=this.hot;if(!(je(b0,this)||je(xt,this).isFocused()||Ee(t.target,"wtBorder")||je(jP,this)===t.target||!je(xt,this)))if(Qo(jP,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));je(zo,this).show(n)}else wc(t.target,e)&&!this.targetIsCommentTextArea(t)&&je(zo,this).hide()}function z_e(){Qo(b0,this,!1)}function U_e(t,e){e[Wa]&&e[Wa][Dm]&&q(t,e.commentedCellClassName)}function Y_e(){if(je(_C,this)){Qo(_C,this,!1);return}Qo(EC,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function G_e(){Qo(EC,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(WP)}function q_e(t,e){const{row:n,col:i}=Xn(oi,this,Gd).call(this);this.updateCommentMeta(n,i,{[RX]:{width:t,height:e}})}function DW(t){je(xt,this).isFocused()&&es(t)}function K_e(){je(dy,this)||this.hide()}function Gd(){return this.range instanceof rg?this.range.highlight:this.hot._createCellCoords(this.range.from.row,this.range.from.col)}function qx(t,e,n){return(e=X_e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function X_e(t){var e=J_e(t,"string");return typeof e=="symbol"?e:e+""}function J_e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _X{constructor(e){qx(this,"hot",void 0),qx(this,"commands",{}),qx(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const s=e.split(":"),o=s[0],a=s.length===2?s[1]:null;let l=this.commands[o];if(!l)throw new Error(`Menu command '${o}' not exists.`);if(a&&l.submenu&&(l=Z_e(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||ln(l,"submenu"))return;const c=[];typeof l.callback=="function"&&c.push(l.callback),typeof this.commonCallback=="function"&&c.push(this.commonCallback),i.unshift(s.join(":")),k(c,u=>u.apply(this.hot,i))}}function Z_e(t,e){let n;return k(e,i=>{const r=i.key?i.key.split(":"):null;if(Array.isArray(r)&&r[1]===t)return n=i,!1}),n}function Kx(t,e,n){return(e=Q_e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q_e(t){var e=eEe(t,"string");return typeof e=="symbol"?e:e+""}function eEe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class EX{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Kx(this,"hot",void 0),Kx(this,"predefinedItems",CX()),Kx(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,Ye(e,(i,r)=>{let s="";i.name===Xe?(n[Xe]=i,s=Xe):isNaN(parseInt(r,10))?(i.key=i.key===void 0?r:i.key,n[r]=i,s=i.key):(n[i.key]=i,s=i.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return tEe(e,this.defaultOrderPattern,this.predefinedItems)}}function tEe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let r=t;return r&&r.items?r=r.items:Array.isArray(r)||(r=e),Re(r)?Ye(r,(s,o)=>{let a=n[typeof s=="string"?s:o];a||(a=s),Re(s)?On(a,s):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=o),i.push(a)}):k(r,(s,o)=>{let a=n[s];!a&&A_e.indexOf(s)>=0||(a||(a={name:s,key:`${o}`}),Re(s)&&On(a,s),a.key===void 0&&(a.key=o),i.push(a))}),i}function Pl(t,e,n){return(e=nEe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nEe(t){var e=iEe(t,"string");return typeof e=="symbol"?e:e+""}function iEe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rEe{constructor(e,n){Pl(this,"top",void 0),Pl(this,"topRelative",void 0),Pl(this,"left",void 0),Pl(this,"leftRelative",void 0),Pl(this,"scrollTop",void 0),Pl(this,"scrollLeft",void 0),Pl(this,"cellHeight",void 0),Pl(this,"cellWidth",void 0);const i=n.scrollY,r=n.scrollX;let s,o,a,l,c,u;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),a=parseInt(e.left,10),c=e.height||0,u=e.width||0,o=s,l=a,s+=i,a+=r):this.type==="event"&&(s=parseInt(e.pageY,10),a=parseInt(e.pageX,10),c=e.target.clientHeight,u=e.target.clientWidth,o=s-i,l=a-r),this.top=s,this.topRelative=o,this.left=a,this.leftRelative=l,this.scrollTop=i,this.scrollLeft=r,this.cellHeight=c,this.cellWidth=u}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.document.documentElement.clientWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Jg(t,e,n){sEe(t,e),e.set(t,n)}function sEe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fe(t,e){return t.get(xX(t,e))}function Zv(t,e,n){return t.set(xX(t,e),n),n}function xX(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ji=new WeakMap,hr=new WeakMap,dr=new WeakMap,Xx=new WeakMap,wd=new WeakMap;class oEe{constructor(e){Jg(this,ji,void 0),Jg(this,hr,void 0),Jg(this,dr,void 0),Jg(this,Xx,!1),Jg(this,wd,{above:0,below:0,left:0,right:0}),Zv(Xx,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return Fe(wd,this)[e]=n,this}setElement(e){return Zv(ji,this,e),this}setParentElement(e){return Zv(hr,this,e),this}updatePosition(e){Zv(dr,this,new rEe(e,Fe(ji,this).ownerDocument.defaultView)),Fe(Xx,this)?(Fe(dr,this).fitsBelow(Fe(ji,this))?this.setPositionBelowCursor():Fe(dr,this).fitsAbove(Fe(ji,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){Fe(ji,this).dir==="rtl"?Fe(dr,this).fitsOnLeft(Fe(ji,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():Fe(dr,this).fitsOnRight(Fe(ji,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=Fe(wd,this).above+Fe(dr,this).top-Fe(ji,this).offsetHeight;if(Fe(hr,this)){const i=Fe(hr,this).ownerDocument.defaultView.getComputedStyle(Fe(hr,this).querySelector(".ht_master")),r=Number.parseInt(i.paddingTop,10),s=Number.parseInt(i.borderTop,10);e=Fe(dr,this).top+Fe(dr,this).cellHeight-Fe(ji,this).scrollHeight+r+s}Fe(ji,this).style.top=`${e}px`}setPositionBelowCursor(){let e=Fe(wd,this).below+Fe(dr,this).top+1;if(Fe(hr,this)){const i=Fe(hr,this).ownerDocument.defaultView.getComputedStyle(Fe(hr,this).querySelector(".ht_master")),r=Number.parseInt(i.paddingTop,10),s=Number.parseInt(i.borderTop,10);e=Fe(dr,this).top-r-s}Fe(ji,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=Fe(dr,this).left;if(Fe(hr,this)){const n=Fe(hr,this).ownerDocument.defaultView,i=Number.parseInt(n.getComputedStyle(Fe(hr,this).querySelector(".htCore")).borderRightWidth,10);e+=Fe(dr,this).cellWidth+i}else e+=Fe(wd,this).right;Fe(ji,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=Fe(wd,this).left+Fe(dr,this).left-Fe(ji,this).offsetWidth;if(Fe(hr,this)){const n=Fe(hr,this).ownerDocument.defaultView,i=Number.parseInt(n.getComputedStyle(Fe(hr,this).querySelector(".htCore")).borderLeftWidth,10);e-=i}Fe(ji,this).style.left=`${e}px`}}function TX(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:i=()=>{},onClear:r=()=>{}}=t;const s=new Set;let o=Ke(e,-1,m()-1);function a(v,b){const R=m()-1;return v<0&&(v=R),v>R&&(v=0),s.has(v)?-1:(s.add(v),i(v,!1)===!1&&(v=a(b===1?++v:--v,b)),v)}function l(v){v>-1&&v<m()&&i(v,!0)!==!1&&(o=v)}function c(v){v>-1&&v<m()&&(o=v)}function u(){return o}function h(){m()>0&&(s.clear(),o=a(0,1))}function d(){m()>0&&(s.clear(),o=a(m()-1,-1))}function f(){m()>0&&(s.clear(),o=a(++o,1))}function g(){m()>0&&(s.clear(),o=a(--o,-1))}function m(){return Math.max(n(),0)}function p(){s.clear(),o=e,r()}return{setCurrentPage:l,setPageCursorAt:c,getCurrentPage:u,toFirstItem:h,toLastItem:d,toNextItem:f,toPreviousItem:g,getSize:m,clear:p}}function aEe(t){return lt(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function zP(t){return ln(t,"submenu")}function UP(t){return new RegExp(Xe,"i").test(t.name)}function fy(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function NW(t){return ln(t,"disableSelection")}function lEe(t){return Ee(t,"htSeparator")}function cEe(t){return Ee(t,"htSubmenu")}function uEe(t){return Ee(t,"htDisabled")}function hEe(t){return Ee(t,"htSelectionDisabled")}function dEe(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function MX(t,e){const n=t.slice(0);for(let i=0;i<n.length&&n[i].name===e;)n.shift();return n}function fEe(t,e){let n=t.slice(0);return n.reverse(),n=MX(n,e),n.reverse(),n}function gEe(t){const e=[];return k(t,(n,i)=>{i>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function mEe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xe,n=t.slice(0);return n=MX(n,e),n=fEe(n,e),n=gEe(n),n}function pEe(t){return t.checkable===!0}function wEe(t){return TX({size:()=>t.countRows(),onItemSelect(e,n){const i=t.getCell(e,0);if(!i||lEe(i)||uEe(i)||hEe(i))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function vEe(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,r)=>{const s=e.getSettings(),o=typeof s.tabMoves=="function"?s.tabMoves(i):s.tabMoves;r.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const i=n.getSelectedActive();if(i){const r=t.openSubMenu(i[0]);r&&r.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedActive()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const r=n.getSelectedActive();r&&(n.getSourceDataAtRow(r[0]).submenu?t.openSubMenu(r[0]).getNavigator().toFirstItem():(t.executeCommand(i),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedActive()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedActive()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const PX="menu",LW=PX;function bEe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];i(vEe(t)),e.forEach(c=>{let{shortcuts:u,contextName:h}=c;r(u,h)});function i(c,u){a(u).addShortcuts(c,{group:PX})}function r(c,u){const h=a(u);c.forEach(d=>{let{keys:f}=d;f.forEach(g=>h.removeShortcutsByKeys(g))}),n.push({shortcuts:c,contextName:u}),i(c,u)}function s(){return[...n]}function o(c){return c?`${LW}:${c}`:LW}function a(c){var u;const h=t.hotMenu.getShortcutManager(),d=o(c);return(u=h.getContext(d))!==null&&u!==void 0?u:h.addContext(d)}function l(c){t.hotMenu.getShortcutManager().setActiveContextName(o(c))}return{addCustomShortcuts:r,getCustomShortcuts:s,getContext:a,listen:l}}function yEe(t){return(e,n,i,r,s,o)=>{const a=e.getSourceDataAtRow(i),l=t.rootDocument.createElement("div"),c=typeof o=="function"?o.call(t):o,u=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(ca(n),q(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!fy(a,t)&&!NW(a)&&!UP(a);he(n,[...pEe(a)?[fhe(),Jr(u),FK(h)]:[dhe(),Jr(c)],...d?[co(-1)]:[],...fy(a,t)?[Pm()]:[],...zP(a)?[Ts(!1)]:[]])}n.className="",n.appendChild(l),UP(a)?q(n,"htSeparator"):typeof a.renderer=="function"?(q(n,"htCustomMenuRenderer"),n.appendChild(a.renderer(e,l,i,r,s,c))):$c(l,c),fy(a,t)?q(n,"htDisabled"):NW(a)?q(n,"htSelectionDisabled"):zP(a)&&q(n,"htSubmenu")}}function Jx(t,e,n){CEe(t,e),e.set(t,n)}function CEe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xo(t,e,n){return(e=SEe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SEe(t){var e=REe(t,"string");return typeof e=="symbol"?e:e+""}function REe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zx(t,e,n){return t.set(AX(t,e),n),n}function Al(t,e){return t.get(AX(t,e))}function AX(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const $W=215;var vd=new WeakMap,Qv=new WeakMap,eb=new WeakMap;class ug{get tableBorderWidth(){return Al(eb,this)===void 0&&this.hotMenu&&Zx(eb,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Al(eb,this)}constructor(e,n){var i=this;xo(this,"hot",void 0),xo(this,"options",void 0),xo(this,"eventManager",new As(this)),xo(this,"container",void 0),xo(this,"positioner",void 0),xo(this,"hotMenu",null),xo(this,"hotSubMenus",{}),xo(this,"parentMenu",void 0),xo(this,"menuItems",null),xo(this,"origOutsideClickDeselects",null),Jx(this,vd,void 0),Jx(this,Qv,void 0),Jx(this,eb,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:$W,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new oEe(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return i.parentMenu.runLocalHooks("afterSelectionChange",...s)}),this.hot.addHook("afterSetTheme",(r,s)=>{this.options.container!==this.hot.rootPortalElement&&(ue(this.options.container,/ht-theme-.*/g),q(this.options.container,r)),s||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=al(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Al(vd,this)}getKeyboardShortcutsCtrl(){return Al(Qv,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedActive()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedActive())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=Ew(a=>this.openSubMenu(a),300),n=this.options.minWidth||$W;let i=!1,r=Ec(this.menuItems,a=>(a.key===Fp&&(i=!0),dEe(a,this.hot)));if(r.length<1&&!i)r.push(CX()[Fp]);else if(r.length===0)return;r=mEe(r,Xe);let s=!1;const o={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return se(a)&&a<n?n:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:yEe(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(a,l)=>{this.hotMenu.stylesHandler.isClassicTheme()?Al(vd,this).setCurrentPage(l.row):Al(vd,this).setPageCursorAt(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},afterOnCellContextMenu:a=>{a.preventDefault(),Zy()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,c,u,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!Zy()||!Pc(a))&&s&&this.hasSelectedItem()&&(ro()||US()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),Zx(vd,this,wEe(this.hotMenu)),Zx(Qv,this,bEe(this)),Al(Qv,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Al(vd,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedActive();if(n){const i=this.parentMenu.hotMenu.getCell(n[0],0);he(i,[Ts(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!cEe(n))return!1;const i=this.hotMenu.getSourceDataAtRow(e),r=new ug(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(i.submenu.items),r.open(),r.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=r,this.hot.getSettings().ariaTags&&he(n,[Ts(!0)]),r}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[n.key];if(i){i.destroy(),delete this.hotSubMenus[n.key];const r=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&he(r,[Ts(!1)])}}closeAllSubMenus(){k(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const i=this.hot.getSelectedRange(),r=i?aEe(i):[];this.runLocalHooks("executeCommand",n.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,r,e)}isCommandPassive(e){return e.isCommand===!1||UP(e)||fy(e,this.hot)||zP(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,i=e.hider.style,r=e.holder.style,s=parseInt(i.width,10),o=Un(n,(a,l,c)=>{const h=this.hotMenu.getCell(c,0)?An(this.hotMenu.getCell(c,0)):0;return a+(l.name===Xe?1:h)},0);this.hotMenu.stylesHandler.isClassicTheme()?(r.width=`${s+3}px`,r.height=`${o+3}px`):(r.width=`${s}px`,r.height=`${o}px`),i.height=r.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let i=e,r;return i&&(ht(i)&&(i=i.call(this.hot),i===null||Nt(i)?i="":i=i.toString()),i=i.replace(/[^A-Za-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,r=n.querySelector(`.${this.options.className}.${i}`)),r||(r=n.createElement("div"),q(r,`htMenu handsontable ${this.options.className}`),i&&q(r,i),this.options.container.appendChild(r)),r}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&he(this.hotMenu.rootElement,[hhe(),co(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!wc(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!wc(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Ee(e.target,"htCore")&&wc(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}pt(ug,ti);function _Ee(t,e){EEe(t,e),e.add(t)}function EEe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qx(t,e,n){return(e=xEe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xEe(t){var e=TEe(t,"string");return typeof e=="symbol"?e:e+""}function TEe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Nm="contextMenu",MEe=70,FW=Nm;le.getSingleton().register("afterContextMenuDefaultOptions");le.getSingleton().register("beforeContextMenuShow");le.getSingleton().register("afterContextMenuShow");le.getSingleton().register("afterContextMenuHide");le.getSingleton().register("afterContextMenuExecute");var Zg=new WeakSet;class y0 extends et{constructor(){super(...arguments),_Ee(this,Zg),Qx(this,"commandExecutor",new _X(this.hot)),Qx(this,"itemsFactory",null),Qx(this,"menu",null)}static get PLUGIN_KEY(){return Nm}static get PLUGIN_PRIORITY(){return MEe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[p0,w0,Xe,Dw,Nw,Xe,m0,$w,Xe,v0,g0,Xe,Lw,Xe,bs]}isEnabled(){return!!this.hot.getSettings()[Nm]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[Nm];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new ug(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>tb(Zg,this,AEe).call(this)),this.menu.addLocalHook("afterOpen",()=>tb(Zg,this,IEe).call(this)),this.menu.addLocalHook("afterClose",()=>tb(Zg,this,OEe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return e.executeCommand.call(e,...r)}),this.addHook("afterOnCellContextMenu",i=>tb(Zg,this,PEe).call(this,i)),this.addHook("beforeDialogShow",()=>this.close()),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=d0(this.menu.container,this.hot.rootDocument);this.open({left:n.left+i.left,top:n.top+i.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:FW})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(FW)}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),Ye(i,(r,s)=>{this.menu.setOffset(s,r)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new EX(this.hot,y0.DEFAULT_ITEMS);const e=this.hot.getSettings()[Nm],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),k(i,r=>this.commandExecutor.registerCommand(r.key,r))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function PEe(t){const e=this.hot.getSettings(),n=e.rowHeaders,i=e.colHeaders;function r(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const s=t.target;if(this.close(),Ee(s,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||i)&&!r(s)&&!(Ee(s,"current")&&Ee(s,"wtBorder"))))return;const o=d0(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+o.top,left:t.clientX+o.left})}function AEe(){this.hot.runHooks("beforeContextMenuShow",this)}function IEe(){this.hot.runHooks("afterContextMenuShow",this)}function OEe(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}y0.SEPARATOR={name:Xe};function HEe(t){return{key:"copy",name(){return this.getTranslatedPhrase(h1)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function kEe(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeActive(),n=e?Ke(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(g1,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function DEe(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeActive(),n=e?Ke(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(f1,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function NEe(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeActive(),n=e?Ke(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(d1,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function LEe(t){return{key:"cut",name(){return this.getTranslatedPhrase(m1)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class $Ee{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class FEe{constructor(){this.clipboardData=new $Ee}preventDefault(){}composedPath(){return[]}}function VEe(t,e){IX(t,e),e.add(t)}function bd(t,e,n){IX(t,e),e.set(t,n)}function IX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yi(t,e){return t.get(tf(t,e))}function yd(t,e,n){return t.set(tf(t,e),n),n}function tf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Il=new WeakMap,eT=new WeakMap,Qg=new WeakMap,YP=new WeakMap,GP=new WeakMap,em=new WeakMap,tm=new WeakSet;class BEe{constructor(e){let{countRows:n,countColumns:i,rowsLimit:r,columnsLimit:s,countColumnHeaders:o}=e;VEe(this,tm),bd(this,Il,void 0),bd(this,eT,void 0),bd(this,Qg,void 0),bd(this,YP,void 0),bd(this,GP,void 0),bd(this,em,void 0),yd(eT,this,n),yd(Qg,this,i),yd(YP,this,r),yd(GP,this,s),yd(em,this,o)}setSelectedRange(e){yd(Il,this,e)}getCellsRange(){if(Yi(eT,this).call(this)===0||Yi(Qg,this).call(this)===0)return null;const{row:e,col:n}=Yi(Il,this).getTopStartCorner(),{row:i,col:r}=Yi(Il,this).getBottomEndCorner(),s=tf(tm,this,WEe).call(this,e,i),o=tf(tm,this,tT).call(this,n,r);return{isRangeTrimmed:i!==s||r!==o,startRow:e,startCol:n,endRow:s,endCol:o}}getMostBottomColumnHeadersRange(){if(Yi(Qg,this).call(this)===0||Yi(em,this).call(this)===0)return null;const{col:e}=Yi(Il,this).getTopStartCorner(),{col:n}=Yi(Il,this).getBottomEndCorner(),i=tf(tm,this,tT).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(Yi(Qg,this).call(this)===0||Yi(em,this).call(this)===0)return null;const{col:e}=Yi(Il,this).getTopStartCorner(),{col:n}=Yi(Il,this).getBottomEndCorner(),i=tf(tm,this,tT).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-Yi(em,this).call(this),startCol:e,endRow:-1,endCol:i}}}function tT(t,e){return Math.min(e,Math.max(t+Yi(GP,this).call(this)-1,t))}function WEe(t,e){return Math.min(e,Math.max(t+Yi(YP,this).call(this)-1,t))}function OX(t){const e=[],n=[];return k(t,i=>{const r=Math.min(i.startRow,i.endRow),s=Math.max(i.startRow,i.endRow);pe(r,s,l=>{e.indexOf(l)===-1&&e.push(l)});const o=Math.min(i.startCol,i.endCol),a=Math.max(i.startCol,i.endCol);pe(o,a,l=>{n.indexOf(l)===-1&&n.push(l)})}),{rows:e,columns:n}}function jEe(t,e){HX(t,e),e.add(t)}function Ol(t,e,n){HX(t,e),e.set(t,n)}function HX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nm(t,e,n){return(e=zEe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zEe(t){var e=UEe(t,"string");return typeof e=="symbol"?e:e+""}function UEe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yr(t,e){return t.get(Ai(t,e))}function zs(t,e,n){return t.set(Ai(t,e),n),n}function Ai(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("afterCopyLimit");le.getSingleton().register("modifyCopyableRange");le.getSingleton().register("beforeCut");le.getSingleton().register("afterCut");le.getSingleton().register("beforePaste");le.getSingleton().register("afterPaste");le.getSingleton().register("beforeCopy");le.getSingleton().register("afterCopy");const nT="copyPaste",YEe=80,GEe=["fragmentSelection"],kX="application/ht-source-data-json-html",VW=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var qP=new WeakMap,KP=new WeakMap,XP=new WeakMap,Cd=new WeakMap,nb=new WeakMap,ib=new WeakMap,Sd=new WeakMap,xC=new WeakMap,Gi=new WeakSet;class qEe extends et{constructor(){super(...arguments),jEe(this,Gi),nm(this,"columnsLimit",1/0),nm(this,"rowsLimit",1/0),nm(this,"pasteMode","overwrite"),nm(this,"uiContainer",this.hot.rootDocument.body),Ol(this,qP,!1),Ol(this,KP,!1),Ol(this,XP,!1),Ol(this,Cd,"cells-only"),Ol(this,nb,!1),Ol(this,ib,!1),Ol(this,Sd,new BEe({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Ol(this,xC,!1),nm(this,"copyableRanges",[])}static get PLUGIN_KEY(){return nT}static get SETTING_KEYS(){return[nT,...GEe]}static get PLUGIN_PRIORITY(){return YEe}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[nT]}enablePlugin(){var e,n,i=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),zs(qP,this,this.getSetting("copyColumnHeaders")),zs(KP,this,this.getSetting("copyColumnGroupHeaders")),zs(XP,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",r=>Ai(Gi,this,JEe).call(this,r)),this.addHook("afterSelection",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return Ai(Gi,i,ZEe).call(i,...s)}),this.addHook("afterSelectionEnd",()=>Ai(Gi,this,QEe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),Sw()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return Ai(Gi,i,exe).call(i,...s)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return Ai(Gi,i,txe).call(i,...s)}),this.addHook("afterSelection",()=>Ai(Gi,this,nxe).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";zs(Cd,this,e),zs(nb,this,!0),Ai(Gi,this,BW).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){zs(ib,this,!0),Ai(Gi,this,BW).call(this,"cut")}getRangedCopyableData(e){return cC(this.getRangedData(e))}getRangedData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=[],{rows:r,columns:s}=OX(e);return k(r,o=>{const a=[];k(s,l=>{if(o<0)a.push(this.hot.getColHeader(l,o));else{let c=n?this.hot.getCopyableSourceData(o,l):this.hot.getCopyableData(o,l);n&&Re(c)&&(c=JSON.stringify(c)),a.push(c)}}),i.push(a)}),i}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const i=new FEe;e&&i.clipboardData.setData("text/plain",e),n&&i.clipboardData.setData("text/html",n),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeActive();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}yr(Sd,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);yr(Cd,this)==="column-headers-only"?n.set("headers",yr(Sd,this).getMostBottomColumnHeadersRange()):(yr(Cd,this)==="with-column-headers"?n.set("headers",yr(Sd,this).getMostBottomColumnHeadersRange()):yr(Cd,this)==="with-column-group-headers"&&n.set("headers",yr(Sd,this).getAllColumnHeadersRange()),n.set("cells",yr(Sd,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(r=>r!==null).map(r=>{let{startRow:s,startCol:o,endRow:a,endCol:l}=r;return{startRow:s,startCol:o,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=n.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:r,startCol:s,endRow:o,endCol:a}=i;this.hot.runHooks("afterCopyLimit",o-r+1,a-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getSelectedRangeActive();if(!e.length)return[null,null,null,null];const r=e.length,s=e[0].length,o=[],{row:a,col:l}=i.getTopStartCorner(),{row:c,col:u}=i.getBottomEndCorner();let h=a,d=l,f=a,g=l;for(;o.length<r||h<=c;){const{skipRowOnPaste:p,visualRow:v}=this.hot.getCellMeta(h,l);if(h=v+1,p===!0)continue;f=v,d=l;const b=[],R=o.length%r;for(;b.length<s||d<=u;){var m;const{skipColumnOnPaste:S,visualCol:x}=this.hot.getCellMeta(v,d),M=this.hot.getSourceDataAtCell(v,d),T=b.length%s;if(d=x+1,S===!0)continue;g=x;const O=n==null||(m=n[R])===null||m===void 0?void 0:m[T];let W=e[R][T];if(n&&OK(O)){const N=JSON.parse(O);(Re(M)||M===null)&&(W=N)}b.push(W)}o.push(b)}return zs(xC,this,!0),this.hot.populateFromArray(a,l,o,void 0,void 0,"CopyPaste.paste",this.pasteMode),[a,l,f,g]}onCopy(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!yr(nb,this)||this.isEditorOpened()||sa(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!Xm(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),zs(nb,this,!1);const s=this.getRangedData(this.copyableRanges),o=this.getRangedData(this.copyableRanges,!0),a=Ai(Gi,this,KEe).call(this,this.copyableRanges);this.hot.runHooks("beforeCopy",s,this.copyableRanges,a)&&(Ai(Gi,this,WW).call(this,e,s,o),this.hot.runHooks("afterCopy",s,this.copyableRanges,a)),zs(Cd,this,"cells-only")}onCut(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!yr(ib,this)||this.isEditorOpened()||sa(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!Xm(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),zs(ib,this,!1);const s=this.getRangedData(this.copyableRanges),o=this.getRangedData(this.copyableRanges,!0);this.hot.runHooks("beforeCut",s,this.copyableRanges)&&(Ai(Gi,this,WW).call(this,e,s,o),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",s,this.copyableRanges))}onPaste(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||sa(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!Xm(n,this.hot.rootElement)))return;e.preventDefault();let s,o;if(e&&typeof e.clipboardData<"u"){const h=e.clipboardData.getData(kX);h&&(o=SP(h,this.hot.rootDocument).data);const d=WS(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});d&&/(<table)|(<TABLE)/g.test(d)?s=SP(d,this.hot.rootDocument).data:s=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(s=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof s=="string"&&(s=Awe(s)),s===void 0||s&&s.length===0||this.hot.runHooks("beforePaste",s,this.copyableRanges)===!1)return;const[a,l,c,u]=this.populateValues(s,o);a!==null&&l!==null&&this.hot.selectCell(a,l,Math.min(this.hot.countRows()-1,c),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",s,this.copyableRanges)}destroy(){super.destroy()}}function BW(t){if(Sw()){const e=this.hot.getSelectedRangeActive();if(e){const{row:n,col:i}=e.highlight,r=this.hot.getCell(n,i,!0);r&&a5(r,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function KEe(t){const{rows:e}=OX(t);let n=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function XEe(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i&&yO(i)}}}function DX(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i!=null&&i.hasAttribute("contenteditable")&&CO(i)}}}function WW(t,e,n){const i=cC(e);if(t&&t.clipboardData){const r=CP(e),s=CP(n);t.clipboardData.setData("text/plain",i),t.clipboardData.setData("text/html",[VW,r].join("")),t.clipboardData.setData(kX,[VW,s].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i)}function JEe(t){t.items.push({name:"---------"},HEe(this)),yr(qP,this)&&t.items.push(NEe(this)),yr(KP,this)&&t.items.push(DEe(this)),yr(XP,this)&&t.items.push(kEe(this)),t.items.push(LEe(this))}function ZEe(t,e,n,i,r){yr(xC,this)&&(r.value=!0),zs(xC,this,!1)}function QEe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function exe(){Ai(Gi,this,DX).call(this)}function txe(){Ai(Gi,this,XEe).call(this)}function nxe(){Ai(Gi,this,DX).call(this)}function NX(t,e){return`border_row${t}col${e}`}function Lm(){return{width:1,color:"#000"}}function Za(){return{hide:!0}}function ixe(){return{width:1,color:"#000",cornerVisible:!1}}function iT(t){if(se(t.start)||se(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(se(t.end)||se(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function im(t){return se(t.start)&&(t.left=t.start),se(t.end)&&(t.right=t.end),t}function rT(t,e){return{id:NX(t,e),border:ixe(),row:t,col:e,top:Za(),bottom:Za(),start:Za(),end:Za()}}function rxe(t,e){return ln(e,"border")&&e.border&&(t.border=e.border),ln(e,"top")&&se(e.top)&&(e.top?(Re(e.top)||(e.top=Lm()),t.top=e.top):(e.top=Za(),t.top=e.top)),ln(e,"bottom")&&se(e.bottom)&&(e.bottom?(Re(e.bottom)||(e.bottom=Lm()),t.bottom=e.bottom):(e.bottom=Za(),t.bottom=e.bottom)),ln(e,"start")&&se(e.start)&&(e.start?(Re(e.start)||(e.start=Lm()),t.start=e.start):(e.start=Za(),t.start=e.start)),ln(e,"end")&&se(e.end)&&(e.end?(Re(e.end)||(e.end=Lm()),t.end=e.end):(e.end=Za(),t.end=e.end)),t}function cl(t,e){let n=!1;return k(t.getSelectedRange(),i=>{i.forAll((r,s)=>{if(r<0||s<0)return;const o=t.getCellMeta(r,s).borders;if(o)if(e){if(!ln(o[e],"hide")||o[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function C0(t){return`<span class="selected"></span>${t}`}function sxe(t){return t.some(e=>se(e.left)||se(e.right))}function oxe(t){return t.some(e=>se(e.start)||se(e.end))}const axe=new Map([["left","start"],["right","end"]]);function lxe(t){var e;return(e=axe.get(t))!==null&&e!==void 0?e:t}function cxe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(D1);return cl(this,"bottom")&&(e=C0(e)),e},callback(e,n){const i=cl(this,"bottom");t.prepareBorder(n,"bottom",i)}}}function uxe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(N1);return cl(this,e)&&(n=C0(n)),n},callback(n,i){const r=cl(this,e);t.prepareBorder(i,e,r)}}}function hxe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(L1)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!cl(this)}}}function dxe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(k1);return cl(this,e)&&(n=C0(n)),n},callback(n,i){const r=cl(this,e);t.prepareBorder(i,e,r)}}}function fxe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(H1);return cl(this,"top")&&(e=C0(e)),e},callback(e,n){const i=cl(this,"top");t.prepareBorder(n,"top",i)}}}function gxe(t,e){mxe(t,e),e.add(t)}function mxe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pxe(t,e,n){return(e=wxe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wxe(t){var e=vxe(t,"string");return typeof e=="symbol"?e:e+""}function vxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function sT(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gy="customBorders",bxe=90,jW=["dashed","dotted","solid"];var rb=new WeakSet;class yxe extends et{constructor(){super(...arguments),gxe(this,rb),pxe(this,"savedBorders",[])}static get PLUGIN_KEY(){return gy}static get PLUGIN_PRIORITY(){return bxe}isEnabled(){return!!this.hot.getSettings()[gy]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>sT(rb,this,Sxe).call(this,e)),this.addHook("init",()=>sT(rb,this,Rxe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let i=["top","bottom","start","end"],r=null;n&&(this.checkSettingsCohesion([n]),i=Object.keys(n),r=iT(n));const s=Of(e),o=Np(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});k(e,a=>{o(a).forAll((l,c)=>{k(i,u=>{this.prepareBorderFromCustomAdded(l,c,r,lxe(u))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=Of(e),i=Np(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),r=[];return k(e,s=>{i(s).forAll((o,a)=>{k(this.savedBorders,l=>{l.row===o&&l.col===a&&r.push(im(l))})})}),r}clearBorders(e){e?this.setBorders(e):(k(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const r=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,r,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:r})}prepareBorderFromCustomAdded(e,n,i,r){const s=this.hot.countRows(),o=this.hot.countCols();if(e>=s||n>=o)return;let a=rT(e,n);i&&(a=rxe(a,i),k(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,i),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",im(a)),this.insertBorderIntoSettings(a,r)}prepareBorderFromCustomAddedRange(e,n){const i=Math.min(e.to.row,this.hot.countRows()-1),r=Math.min(e.to.col,this.hot.countCols()-1);pe(e.from.row,i,s=>{pe(e.from.col,r,o=>{const a=rT(s,o);let l=0;s===e.from.row&&ln(n,"top")&&(l+=1,a.top=n.top),s===e.to.row&&ln(n,"bottom")&&(l+=1,a.bottom=n.bottom),o===e.from.col&&ln(n,"start")&&(l+=1,a.start=n.start),o===e.to.col&&ln(n,"end")&&(l+=1,a.end=n.end),l>0&&(this.hot.setCellMeta(s,o,"borders",im(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,n){const i=NX(e,n);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,i,r){let s=this.hot.getCellMeta(e,n).borders;!s||s.border===void 0?s=rT(e,n):s=iT(s),r?(s[i]=Za(),this.countHide(s)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(s,i,r)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,n,"borders",im(s)))):(s[i]=Lm(),this.checkCustomSelectionsFromContextMenu(s,i,r)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,n,"borders",im(s)))}prepareBorder(e,n,i){k(e,r=>{let{start:s,end:o}=r;if(s.row===o.row&&s.col===o.col)n==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,n,i);else switch(n){case"noBorders":pe(s.col,o.col,a=>{pe(s.row,o.row,l=>{this.removeAllBorders(l,a)})});break;case"top":pe(s.col,o.col,a=>{this.setBorder(s.row,a,n,i)});break;case"bottom":pe(s.col,o.col,a=>{this.setBorder(o.row,a,n,i)});break;case"start":pe(s.row,o.row,a=>{this.setBorder(a,s.col,n,i)});break;case"end":pe(s.row,o.row,a=>{this.setBorder(a,o.col,n,i)});break}})}createCustomBorders(e){k(e,n=>{const i=iT(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,i):this.prepareBorderFromCustomAdded(n.row,n.col,i)})}countHide(e){const{top:n,bottom:i,start:r,end:s}=e;return Un([n,i,r,s],(a,l)=>{let c=a;return l&&l.hide&&(c+=1),c},0)}clearBordersFromSelectionSettings(e){const n=lt(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){k(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){k(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=lt(this.savedBorders,i=>i.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):k(this.savedBorders,(r,s)=>{if(e.id===r.id)return this.savedBorders[s]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,i){let r=!1;return k(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const o=this.hot.view._wt.selectionManager.getBorderInstances(s);return k(o,a=>{a.toggleHiddenClass(n,i)}),r=!0,!1}}),r}checkCustomSelections(e,n,i){const r=this.countHide(e);let s=!1;return r===4?(this.removeAllBorders(e.row,e.col),s=!0):k(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){if(o.visualCellRange=n,o.commit(),i){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);k(a,l=>{l.changeBorderStyle(i,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[gy];if(Array.isArray(e)){const n=Vi(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=sxe(e),i=oxe(e);if(n&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".');sT(rb,this,Cxe).call(this,e)}destroy(){super.destroy()}}function Cxe(t){t.forEach(e=>{Object.keys(e).forEach(n=>{const i=e[n].style;se(i)&&!jW.includes(i)?(Ue(`The "${i}" border style is not supported. Please use one of the following styles: ${jW.join(", ")}.
The border style will be ignored.`),delete e[n].style):se(i)&&i==="solid"&&delete e[n].style})})}function Sxe(t){this.hot.getSettings()[gy]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(O1)},disabled(){const e=this.getSelectedRangeActive();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[fxe(this),dxe(this),cxe(this),uxe(this),hxe(this)]}})}function Rxe(){this.changeBorderSettings()}function _xe(t,e){Exe(t,e),e.add(t)}function Exe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oT(t,e,n){return(e=xxe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xxe(t){var e=Txe(t,"string");return typeof e=="symbol"?e:e+""}function Txe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const UW="dragToScroll",Mxe=100;var aT=new WeakSet;class Pxe extends et{constructor(){super(...arguments),_xe(this,aT),oT(this,"boundaries",null),oT(this,"callback",null),oT(this,"listening",!1)}static get PLUGIN_KEY(){return UW}static get PLUGIN_PRIORITY(){return Mxe}isEnabled(){return!!this.hot.getSettings()[UW]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>zW(aT,this,YW).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>zW(aT,this,YW).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let i=0,r=0;n<this.boundaries.top?r=n-this.boundaries.top:n>this.boundaries.bottom&&(r=n-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",i=>this.onMouseMove(i)),n=al(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function YW(t){if(Pc(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,i)=>{var r,s;const o=(r=e.scrollLeft)!==null&&r!==void 0?r:e.scrollX,a=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(o+Math.sign(n)*50,a+Math.sign(i)*20)}),this.listen()}function Axe(t,e){LX(t,e),e.add(t)}function Ixe(t,e,n){LX(t,e),e.set(t,n)}function LX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lT(t,e,n){return(e=Oxe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oxe(t){var e=Hxe(t,"string");return typeof e=="symbol"?e:e+""}function Hxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function kxe(t,e){return t.get(ys(t,e))}function $X(t,e,n){return t.set(ys(t,e),n),n}function ys(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("afterDropdownMenuDefaultOptions");le.getSingleton().register("beforeDropdownMenuShow");le.getSingleton().register("afterDropdownMenuShow");le.getSingleton().register("afterDropdownMenuHide");le.getSingleton().register("afterDropdownMenuExecute");const my="dropdownMenu",Dxe=230,Vp="changeType",cT=my;var S0=new WeakMap,qs=new WeakSet;class R0 extends et{static get PLUGIN_KEY(){return my}static get PLUGIN_PRIORITY(){return Dxe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Dw,Nw,Xe,$w,Xe,f0,Xe,Lw,Xe,bs]}constructor(e){super(e),Axe(this,qs),lT(this,"commandExecutor",new _X(this.hot)),lT(this,"itemsFactory",null),lT(this,"menu",null),Ixe(this,S0,!1),this.hot.addHook("afterGetColHeader",(n,i)=>ys(qs,this,Lxe).call(this,n,i))}isEnabled(){return this.hot.getSettings()[my]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new EX(this.hot,R0.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return ys(qs,e,jxe).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return ys(qs,e,Wxe).call(e,...s)}),this.addHook("beforeDialogShow",()=>this.close());const n=this.hot.getSettings()[my],i={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const r=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new ug(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>ys(qs,this,$xe).call(this)),this.menu.addLocalHook("afterOpen",()=>ys(qs,this,Fxe).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>ys(qs,this,Vxe).call(this,s)),this.menu.addLocalHook("afterClose",()=>ys(qs,this,Bxe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e.executeCommand.call(e,...o)}),k(r,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:i}=this.hot.getSelectedRangeActive();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:r}=this.hot.getSelectedRangeActive(),s=d0(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,r.col,!0).querySelector(`.${Vp}`),a=o.getBoundingClientRect();this.open({left:a.left+s.left,top:a.top+o.offsetHeight+s.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:cT},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isCell()&&!this.menu.isOpened()},group:cT}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(cT)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>ys(qs,this,Nxe).call(this,e))}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),Ye(i,(r,s)=>{this.menu.setOffset(s,r)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function FX(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Nxe(t){if(Ee(t.target,Vp)){const e=d0(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),$X(S0,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function Lxe(t,e){const n=e.parentNode;if(!n)return;const i=n.parentNode.childNodes,r=Array.prototype.indexOf.call(i,n);if(t<0||r!==i.length-1)return;const s=e.querySelector(`.${Vp}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const o=this.hot.rootDocument.createElement("button");o.className=Vp,o.type="button",o.tabIndex=-1,this.hot.getSettings().ariaTags&&(he(o,[jh(),Jr(" ")]),he(e,[NK("menu")])),o.onclick=function(){return!1},e.firstChild.insertBefore(o,e.firstChild.firstChild)}function $xe(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Fxe(){this.hot.runHooks("afterDropdownMenuShow",this),ys(qs,this,FX).call(this,this.menu)}function Vxe(t){ys(qs,this,FX).call(this,t)}function Bxe(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Wxe(t){return kxe(S0,this)?null:t}function jxe(t){Ee(t.target,Vp)&&$X(S0,this,!0)}R0.SEPARATOR={name:Xe};function GW(t,e,n){return(e=zxe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zxe(t){var e=Uxe(t,"string");return typeof e=="symbol"?e:e+""}function Uxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yxe{constructor(e){GW(this,"hot",void 0),GW(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:i,endCol:r}=this._getDataRange(),s=this.options,o=[];return pe(e,i,a=>{const l=[];!s.exportHiddenRows&&this._isHiddenRow(a)||(pe(n,r,c=>{!s.exportHiddenColumns&&this._isHiddenColumn(c)||l.push(this.hot.getDataAtCell(a,c))}),o.push(l))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:i}=this._getDataRange(),r=this.hot.getRowHeader();pe(n,i,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(r[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:i}=this._getDataRange(),r=this.hot.getColHeader();pe(n,i,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(r[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[i=0,r=0,s=n,o=e]=this.options.range;return i=Math.max(i,0),r=Math.max(r,0),s=Math.min(s,n),o=Math.min(o,e),{startRow:i,startCol:r,endRow:s,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function qW(t,e,n){return(e=Gxe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gxe(t){var e=qxe(t,"string");return typeof e=="symbol"?e:e+""}function qxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pk{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){qW(this,"dataProvider",void 0),qW(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=uo(this.constructor.DEFAULT_OPTIONS);const i=new Date;return n=On(uo(pk.DEFAULT_OPTIONS),n),n=On(n,e),n.filename=BS(n.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),n}}function Kxe(t,e){Xxe(t,e),e.add(t)}function Xxe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KW(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const VX="\r",Jxe='"',Zxe=`
`,Qxe="=",eTe="+",tTe="-",nTe="@",iTe="	";var uT=new WeakSet;class rTe extends pk{constructor(){super(...arguments),Kxe(this,uT)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const r=i.length>0,s=this.dataProvider.getRowHeaders(),o=s.length>0;let a=e.bom?"\uFEFF":"";return r&&(i=lt(i,l=>this._escapeCell(l,{force:!0,sanitizeValue:e.sanitizeValues})),o&&(a+=e.columnDelimiter),a+=i.join(e.columnDelimiter),a+=e.rowDelimiter),k(n,(l,c)=>{c>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(s[c],{sanitizeValue:e.sanitizeValues}),a+=e.columnDelimiter);const u=l.map(h=>this._escapeCell(h,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);a+=u}),a}_escapeCell(e){let{force:n=!1,sanitizeValue:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=Pt(e);return r===""||(i&&(n=!0),i instanceof RegExp?r=KW(uT,this,oTe).call(this,r,i):typeof i=="function"?r=i(r):i&&(r=KW(uT,this,sTe).call(this,r)),(n||r.indexOf(VX)>=0||r.indexOf(Jxe)>=0||r.indexOf(Zxe)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`)),r}}function sTe(t){return t.startsWith(Qxe)||t.startsWith(eTe)||t.startsWith(tTe)||t.startsWith(nTe)||t.startsWith(iTe)||t.startsWith(VX)?`'${t}`:t}function oTe(t,e){return e.test(t)?`'${t}`:t}const aTe="csv",JP={[aTe]:rTe};function lTe(t,e,n){return typeof JP[t]=="function"?new JP[t](e,n):null}const cTe="exportFile",uTe=240;class hTe extends et{static get PLUGIN_KEY(){return cTe}static get PLUGIN_PRIORITY(){return uTe}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:r}=this.hot,s=this._createTypeFormatter(e,n),o=this._createBlob(s),a=r.URL||r.webkitURL,l=i.createElement("a"),c=`${s.options.filename}.${s.options.fileExtension}`;if(l.download!==void 0){const u=a.createObjectURL(o);l.style.display="none",l.setAttribute("href",u),l.setAttribute("download",c),i.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),i.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(u)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,c)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!JP[e])throw new Error(`Export format type "${e}" is not supported.`);return lTe(e,new Yxe(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Rd(t,e,n){return(e=dTe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dTe(t){var e=fTe(t,"string");return typeof e=="symbol"?e:e+""}function fTe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fw{constructor(e,n){let{id:i,stateless:r=!0}=n;Rd(this,"hot",void 0),Rd(this,"id",void 0),Rd(this,"elements",[]),Rd(this,"hidden",!1),Rd(this,"stateId",""),Rd(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new n0)}getElements(){return this.elements}reset(){k(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),k(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}pt(Fw,ti);const Bp={};function Ac(t,e){if(!Bp[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:i}=Bp[t];let r=e;return i.inputValuesDecorator&&(r=i.inputValuesDecorator(r)),function(s){return n.apply(s.meta.instance,[].concat([s],[r]))}}function Qu(t){if(!Bp[t])throw Error(`Filter condition "${t}" does not exist.`);return Bp[t].descriptor}function Ln(t,e,n){n.key=t,Bp[t]={condition:e,descriptor:n}}const ui="none";function gTe(){return!0}Ln(ui,gTe,{name:i0,inputsCount:0,showOperators:!1});const ip="empty";function mTe(t){return hn(t.value)}Ln(ip,mTe,{name:z1,inputsCount:0,showOperators:!0});const py="not_empty";function pTe(t,e){return!Ac(ip,e)(t)}Ln(py,pTe,{name:U1,inputsCount:0,showOperators:!0});const rp="eq";function wTe(t,e){let[n]=e;return Pt(t.value).toLocaleLowerCase(t.meta.locale)===Pt(n)}Ln(rp,wTe,{name:Y1,inputsCount:1,showOperators:!0});const wy="neq";function vTe(t,e){return!Ac(rp,e)(t)}Ln(wy,vTe,{name:G1,inputsCount:1,showOperators:!0});const BX="gt";function bTe(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}Ln(BX,bTe,{name:Z1,inputsCount:1,showOperators:!0});const WX="gte";function yTe(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}Ln(WX,yTe,{name:Q1,inputsCount:1,showOperators:!0});const jX="lt";function CTe(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}Ln(jX,CTe,{name:eH,inputsCount:1,showOperators:!0});const zX="lte";function STe(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}Ln(zX,STe,{name:tH,inputsCount:1,showOperators:!0});const wk="date_after";function RTe(t,e){let[n]=e;const i=Z(t.value,t.meta.dateFormat),r=Z(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)>=0}Ln(wk,RTe,{name:rH,inputsCount:1,showOperators:!0});const vk="date_before";function _Te(t,e){let[n]=e;const i=Z(t.value,t.meta.dateFormat),r=Z(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)<=0}Ln(vk,_Te,{name:sH,inputsCount:1,showOperators:!0});const TC="between";function ETe(t,e){let[n,i]=e,r=n,s=i;if(t.meta.type==="numeric"){const o=parseFloat(r,10),a=parseFloat(s,10);r=Math.min(o,a),s=Math.max(o,a)}else if(t.meta.type==="date"){const o=Ac(vk,[s]),a=Ac(wk,[r]);return o(t)&&a(t)}return t.value>=r&&t.value<=s}Ln(TC,ETe,{name:nH,inputsCount:2,showOperators:!0});const UX="not_between";function xTe(t,e){return!Ac(TC,e)(t)}Ln(UX,xTe,{name:iH,inputsCount:2,showOperators:!0});const YX="begins_with";function TTe(t,e){let[n]=e;return Pt(t.value).toLocaleLowerCase(t.meta.locale).startsWith(Pt(n))}Ln(YX,TTe,{name:q1,inputsCount:1,showOperators:!0});const GX="ends_with";function MTe(t,e){let[n]=e;return Pt(t.value).toLocaleLowerCase(t.meta.locale).endsWith(Pt(n))}Ln(GX,MTe,{name:K1,inputsCount:1,showOperators:!0});const bk="contains";function PTe(t,e){let[n]=e;return Pt(t.value).toLocaleLowerCase(t.meta.locale).indexOf(Pt(n))>=0}Ln(bk,PTe,{name:X1,inputsCount:1,showOperators:!0});const qX="not_contains";function ATe(t,e){return!Ac(bk,e)(t)}Ln(qX,ATe,{name:J1,inputsCount:1,showOperators:!0});const KX="date_tomorrow";function ITe(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(-1,"days").startOf("day"),"d"):!1}Ln(KX,ITe,{name:aH,inputsCount:0});const XX="date_today";function OTe(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().startOf("day"),"d"):!1}Ln(XX,OTe,{name:oH,inputsCount:0});const JX="date_yesterday";function HTe(t){const e=Z(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Z().subtract(1,"days").startOf("day"),"d"):!1}Ln(JX,HTe,{name:lH,inputsCount:0});WK();function kTe(t,e){let n=t;return n===""&&(n=`(${e})`),n}function Vw(t){const e=new Set(t);return function(n){return e.has(n)}}function yk(t){return t??""}function ZP(t){return Array.from(new Set(t)).map(e=>yk(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function XW(t,e,n,i){const r=[],s=t===e;let o;return s||(o=Vw(e)),t.forEach(a=>{let l=!1;(s||o(a))&&(l=!0);const c={checked:l,value:a,visualValue:kTe(a,n)};i&&i(c),r.push(c)}),r}const eh="by_value";function DTe(t,e){let[n]=e;return n(t.value)}Ln(eh,DTe,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Vw(e)]},showOperators:!1});const Wp={};function NTe(t){if(!Wp[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Wp[t].func;return function(n,i){return e(n,i)}}function LTe(t){return Wp[t].name}function Ck(t,e,n){Wp[t]={name:e,func:n}}const bc="conjunction",$Te=hH;function FTe(t,e){return t.every(n=>n.func(e))}Ck(bc,$Te,FTe);const MC="disjunction",VTe=r0;function BTe(t,e){return t.some(n=>n.func(e))}Ck(MC,VTe,BTe);const Sk="disjunctionWithExtraCondition",WTe=r0;function jTe(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}Ck(Sk,WTe,jTe);const zTe="numeric",ZX="text",UTe="date",JW={[zTe]:[ui,Xe,ip,py,Xe,rp,wy,Xe,BX,WX,jX,zX,TC,UX],[ZX]:[ui,Xe,ip,py,Xe,rp,wy,Xe,YX,GX,Xe,bk,qX],[UTe]:[ui,Xe,ip,py,Xe,rp,wy,Xe,vk,wk,TC,Xe,KX,XX,JX]};function YTe(t){const e=[];let n=t;return JW[n]||(n=ZX),k(JW[n],i=>{let r;i===Xe?r={name:Xe}:r=uo(Qu(i)),e.push(r)}),e}function rm(t,e,n){return(e=GTe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GTe(t){var e=qTe(t,"string");return typeof e=="symbol"?e:e+""}function qTe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const hT="built",dT="building",ZW=["click","input","keydown","keypress","keyup","focus","blur","change"];let so=class QX{static get DEFAULTS(){return uo({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){rm(this,"hot",void 0),rm(this,"eventManager",new As(this)),rm(this,"options",void 0),rm(this,"_element",void 0),rm(this,"buildState",void 0),this.hot=e,this.options=On(QX.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===dT?this._element:this.buildState===hT?(this.update(),this._element):(this.buildState=dT,this.build(),this.buildState=hT,this._element)}isBuilt(){return this.buildState===hT}translateIfPossible(e){return typeof e=="string"&&e.startsWith(sr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,i)=>{this.eventManager.addEventListener(n,i,r=>this.runLocalHooks(i,r,this))};if(this.buildState||(this.buildState=dT),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&q(this._element,this.options.className),this.options.children.length)k(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),Ye(this.options,(i,r)=>{n[r]!==void 0&&r!=="className"&&r!=="tagName"&&r!=="children"&&(n[r]=this.translateIfPossible(i))}),this._element.appendChild(n),k(ZW,i=>e(n,i))}else k(ZW,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};pt(so,ti);function KTe(t,e){e4(t,e),e.add(t)}function XTe(t,e,n){e4(t,e),e.set(t,n)}function e4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sb(t,e){return t.get(Rk(t,e))}function JTe(t,e,n){return t.set(Rk(t,e),n),n}function Rk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _d=new WeakMap,QW=new WeakSet;class yc extends so{static get DEFAULTS(){return uo({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,On(yc.DEFAULTS,n)),KTe(this,QW),XTe(this,_d,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>Rk(QW,this,ZTe).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");JTe(_d,this,this._element.firstChild),q(this._element,"htUIInput"),q(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(sb(_d,this).type=this.options.type,sb(_d,this).placeholder=this.translateIfPossible(this.options.placeholder),sb(_d,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&sb(_d,this).focus()}}function ZTe(t){this.options.value=t.target.value}function QTe(t,e){t4(t,e),e.add(t)}function sm(t,e,n){t4(t,e),e.set(t,n)}function t4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ed(t,e,n){return t.set(sp(t,e),n),n}function en(t,e){return t.get(sp(t,e))}function sp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gn=new WeakMap,ob=new WeakMap,ab=new WeakMap,fT=new WeakMap,lb=new WeakMap,cb=new WeakSet;class jp extends so{static get DEFAULTS(){return uo({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,On(jp.DEFAULTS,n)),QTe(this,cb),sm(this,Gn,null),sm(this,ob,[]),sm(this,ab,void 0),sm(this,fT,void 0),sm(this,lb,void 0),this.registerHooks()}getMenu(){return en(Gn,this)}registerHooks(){this.addLocalHook("click",()=>sp(cb,this,nMe).call(this))}setItems(e){Ed(ob,this,this.translateNames(e)),en(Gn,this)&&en(Gn,this).setMenuItems(en(ob,this))}translateNames(e){return k(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),Ed(Gn,this,new ug(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),en(Gn,this).setMenuItems(en(ob,this));const e=new so(this.hot,{className:"htUISelectCaption"}),n=new so(this.hot,{className:"htUISelectDropdown"});Ed(ab,this,e),Ed(fT,this,e.element),Ed(lb,this,n),this.hot.getSettings().ariaTags&&(he(n.element,[jh()]),he(this._element,[DK()])),k([e,n],i=>this._element.appendChild(i.element)),en(Gn,this).addLocalHook("select",i=>sp(cb,this,eMe).call(this,i)),en(Gn,this).addLocalHook("afterClose",()=>sp(cb,this,tMe).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=en(Gn,this).hot.getTranslatedPhrase(i0),en(fT,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();en(Gn,this)&&(en(Gn,this).open(),en(Gn,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),en(Gn,this).getNavigator().toFirstItem(),en(Gn,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){en(Gn,this)&&en(Gn,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){en(Gn,this)&&(en(Gn,this).destroy(),Ed(Gn,this,null)),en(ab,this)&&en(ab,this).destroy(),en(lb,this)&&en(lb,this).destroy(),super.destroy()}}function eMe(t){t.name!==Xe&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function tMe(){this.runLocalHooks("afterClose")}function nMe(){this.openOptions()}function iMe(t,e){rMe(t,e),e.add(t)}function rMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ej(t,e,n){return(e=sMe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sMe(t){var e=oMe(t,"string");return typeof e=="symbol"?e:e+""}function oMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function tj(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gT=new WeakSet;class QP extends Fw{constructor(e,n){super(e,{id:n.id,stateless:!1}),iMe(this,gT),ej(this,"name",""),ej(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new jp(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new yc(this.hot,{placeholder:wH})),this.elements.push(new yc(this.hot,{placeholder:vH})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>tj(gT,this,aMe).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),k(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>tj(gT,this,lMe).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=uo(e.command);n.name.startsWith(dn)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),k(e.args,(i,r)=>{if(r>n.inputsCount-1)return!1;const s=this.getInputElement(r);s.setValue(i),s[n.inputsCount>r?"show":"hide"](),r||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||Qu(ui),n=[];return k(this.getInputElements(),(i,r)=>{e.inputsCount>r&&n.push(i.getValue())}),{command:e,args:n}}updateState(e,n){const i=Qu(e?e.name:ui);this.state.setValueAtIndex(n,{command:i,args:e?e.args:[]}),e||k(this.getInputElements(),r=>r.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof jp)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof yc)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,s,o)=>{q(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&q(n.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=o,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||k(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[Qu(ui)];if(e!==null){const{visualIndex:i}=e;n=YTe(this.hot.getDataType(0,i,this.hot.countRows(),i))}k(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function aMe(t){k(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function lMe(t){Eh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),es(t))}function nj(t,e,n){cMe(t,e),e.set(t,n)}function cMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function om(t,e){return t.get(n4(t,e))}function ij(t,e,n){return t.set(n4(t,e),n),n}function n4(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xd=new WeakMap,mT=new WeakMap;class PC extends so{static get DEFAULTS(){return uo({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,On(PC.DEFAULTS,n)),nj(this,xd,void 0),nj(this,mT,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),ij(mT,this,e),ij(xd,this,this._element.firstChild),om(xd,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(om(mT,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?om(xd,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(om(xd,this).checked=e)}focus(){this.isBuilt()&&om(xd,this).focus()}}function uMe(t,e){hMe(t,e),e.add(t)}function hMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dMe(t,e,n){return(e=fMe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fMe(t){var e=gMe(t,"string");return typeof e=="symbol"?e:e+""}function gMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mMe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const rj=0;var sj=new WeakSet;class pMe extends Fw{constructor(e,n){super(e,{id:n.id,stateless:!1}),uMe(this,sj),dMe(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuOperators"),k(this.elements,i=>n.appendChild(i.element)),n)}}buildOperatorsElement(){const e=[bc,MC];k(e,n=>{const i=new PC(this.hot,{name:"operator",label:{htmlFor:n,textContent:LTe(n)},value:n,checked:n===e[rj],id:n});i.addLocalHook("change",r=>mMe(sj,this,wMe).call(this,r)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error(ct`Radio button with index ${e} doesn't exist.`);k(this.elements,(n,i)=>{n.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof PC&&n.isChecked());return e?e.getValue():bc}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&k(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bc,n=arguments.length>1?arguments[1]:void 0,i=e;i===Sk&&(i=MC),this.state.setValueAtIndex(n,i)}reset(){this.setChecked(rj)}}function wMe(t){this.setState(t.target.value)}function vMe(t,e,n){bMe(t,e),e.set(t,n)}function bMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pT(t,e){return t.get(i4(t,e))}function yMe(t,e,n){return t.set(i4(t,e),n),n}function i4(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var am=new WeakMap;class zp extends so{static get DEFAULTS(){return uo({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,On(zp.DEFAULTS,n)),vMe(this,am,void 0)}build(){super.build(),yMe(am,this,this._element.firstChild)}update(){this.isBuilt()&&(pT(am,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&pT(am,this).focus()}activate(){pT(am,this).click()}}function CMe(t,e){r4(t,e),e.add(t)}function Td(t,e,n){r4(t,e),e.set(t,n)}function r4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ke(t,e){return t.get(nf(t,e))}function Vs(t,e,n){return t.set(nf(t,e),n),n}function nf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const oj="multipleSelect.itemBox";var Xs=new WeakMap,Bt=new WeakMap,wT=new WeakMap,Aa=new WeakMap,Hl=new WeakMap,kl=new WeakMap,lm=new WeakSet;class Up extends so{static get DEFAULTS(){return uo({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,On(Up.DEFAULTS,n)),CMe(this,lm),Td(this,Xs,[]),Td(this,Bt,void 0),Td(this,wT,void 0),Td(this,Aa,void 0),Td(this,Hl,void 0),Td(this,kl,void 0),Vs(Aa,this,new yc(this.hot,{placeholder:pH,className:"htUIMultipleSelectSearch"})),Vs(Hl,this,new zp(this.hot,{textContent:dH,className:"htUISelectAll"})),Vs(kl,this,new zp(this.hot,{textContent:fH,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return ke(Bt,this)}registerHooks(){ke(Aa,this).addLocalHook("keydown",e=>nf(lm,this,RMe).call(this,e)),ke(Aa,this).addLocalHook("input",e=>nf(lm,this,SMe).call(this,e)),ke(Hl,this).addLocalHook("click",e=>nf(lm,this,_Me).call(this,e)),ke(kl,this).addLocalHook("click",e=>nf(lm,this,EMe).call(this,e))}setItems(e){var n;Vs(Xs,this,e),(n=ke(Bt,this))===null||n===void 0||n.loadData(ke(Xs,this))}setLocale(e){Vs(wT,this,e)}getLocale(){return ke(wT,this)}getItems(){return[...ke(Xs,this)]}getValue(){return TMe(ke(Xs,this))}getSearchInputElement(){return ke(Aa,this)}getSelectAllElement(){return ke(Hl,this)}getClearAllElement(){return ke(kl,this)}isSelectedAllValues(){return ke(Xs,this).length===this.getValue().length}build(){var e;super.build();const{rootDocument:n}=this.hot,i=n.createElement("div"),r=new so(this.hot,{className:"htUISelectionControls",children:[ke(Hl,this),ke(kl,this)]});this._element.appendChild(ke(Aa,this).element),this._element.appendChild(r.element),this._element.appendChild(i),(e=ke(Bt,this))===null||e===void 0||e.destroy(),q(i,"htUIMultipleSelectHot"),Vs(Bt,this,new this.hot.constructor(i,{data:[[]],columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(a,l,c,u,h,d)=>{a.title=d.instance.getDataAtRowProp(l,d.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{ke(Bt,this).listen()},modifyColWidth:a=>{const l=ke(Bt,this).container.scrollWidth-Sn(n);return a!==void 0&&a<l?l:a},autoColumnSize:!0,autoRowSize:!1,hiddenRows:!0,maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),ke(Bt,this).init();const o=ke(Bt,this).getShortcutManager().getContext("grid");o.removeShortcutsByKeys(["Tab"]),o.removeShortcutsByKeys(["Shift","Tab"]),o.addShortcut({keys:[["Escape"]],callback:a=>{this.runLocalHooks("keydown",a,this)},group:oj}),o.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:a=>{ke(Bt,this).deselectCell(),this.runLocalHooks("keydown",a,this),this.runLocalHooks("listTabKeydown",a,this)},group:oj})}focus(){this.isBuilt()&&ke(Bt,this).listen()}reset(){ke(Aa,this).reset(),ke(Hl,this).reset(),ke(kl,this).reset()}update(){!this.isBuilt()||ke(Bt,this).rootElement.offsetHeight===0||(ke(Bt,this).updateSettings({data:xMe(ke(Xs,this),this.options.value)}),super.update())}destroy(){var e;(e=ke(Bt,this))===null||e===void 0||e.destroy(),ke(Aa,this).destroy(),ke(kl,this).destroy(),ke(Hl,this).destroy(),Vs(Aa,this,null),Vs(kl,this,null),Vs(Hl,this,null),Vs(Bt,this,null),Vs(Xs,this,null),super.destroy()}}function SMe(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());if(this.options.searchMode==="apply"){const n=ke(Bt,this).getPlugin("hiddenRows");n.showRows(n.getHiddenRows()),ke(Xs,this).forEach((i,r)=>{i.checked=`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0,i.checked||n.hideRow(r)}),ke(Bt,this).view.adjustElementsSize(),ke(Bt,this).render()}else{let n;e===""?n=[...ke(Xs,this)]:n=ke(Xs,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),ke(Bt,this).loadData(n)}}function RMe(t){this.runLocalHooks("keydown",t,this),SO(Eh,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),es(t),ke(Bt,this).listen(),ke(Bt,this).selectCell(0,0))}function _Me(t){const e=[];t.preventDefault(),ke(Bt,this).getSourceData().forEach((n,i)=>{n.checked=!0,e.push(UO(n,i)[0])}),ke(Bt,this).setSourceDataAtCell(e)}function EMe(t){const e=[];t.preventDefault(),ke(Bt,this).getSourceData().forEach((n,i)=>{n.checked=!1,e.push(UO(n,i)[0])}),ke(Bt,this).setSourceDataAtCell(e)}function xMe(t,e){const n=Vw(e);return t.map(i=>(i.checked=n(i.value),i))}function TMe(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function MMe(t,e){PMe(t,e),e.add(t)}function PMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aj(t,e,n){return(e=AMe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AMe(t){var e=IMe(t,"string");return typeof e=="symbol"?e:e+""}function IMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ub(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cm=new WeakSet;class OMe extends Fw{constructor(e,n){super(e,{id:n.id,stateless:!1}),MMe(this,cm),aj(this,"name",""),aj(this,"searchMode",void 0),this.name=n.name,this.searchMode=n.searchMode,this.elements.push(new Up(this.hot,{searchMode:this.searchMode})),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>ub(cm,this,HMe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>ub(cm,this,kMe).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===eh){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?ui:eh},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(i,r,s,o,a)=>{const[l]=Ec(r,h=>h.name===eh),c={},u=this.hot.getTranslatedPhrase(aC);if(l){const h=o(i,a),d=lt(h,b=>b.value),f=new Map(h.map(b=>[b.value,this.hot.getCellMeta(b.meta.visualRow,b.meta.visualCol)])),g=ZP(d);s&&(l.args[0]=s);const m=[],p=XW(g,l.args[0],u,b=>{b.checked&&m.push(b.value),ub(cm,this,lj).call(this,b,f)}),v=e.editedConditionStack.column;c.locale=this.hot.getCellMeta(0,v).locale,c.args=[m],c.command=Qu(eh),c.itemsSnapshot=p}else c.args=[],c.command=Qu(ui);this.state.setValueAtIndex(i,c)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Up)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,s,o)=>{q(n.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return q(a,"htFiltersMenuLabel"),a.textContent=o,n.appendChild(a),n.parentElement.hasAttribute("ghost-table")||k(this.elements,l=>n.appendChild(l.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(aC),n=this._getColumnVisibleValues(),i=n.map(l=>l.value),r=new Map(n.map(l=>[l.value,l.meta])),s=ZP(i),o=XW(s,s,e,l=>{ub(cm,this,lj).call(this,l,r)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(s);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:lt(this.hot.getDataAtCol(e.visualIndex),(n,i)=>({value:yk(n),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function HMe(t){Eh(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),es(t)),Eh(t.keyCode,"ENTER")&&(this.searchMode==="apply"&&this.runLocalHooks("accept"),es(t))}function lj(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function kMe(t,e){return e.type==="numeric"?j3(t,e):t}var s4;function DMe(t,e){NMe(t,e),e.add(t)}function NMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LMe(t,e,n){return(e=$Me(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Me(t){var e=FMe(t,"string");return typeof e=="symbol"?e:e+""}function FMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VMe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var cj=new WeakSet;class Yp extends Fw{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),DMe(this,cj),LMe(this,"name",""),this.name=n.name,this.elements.push(new yc(this.hot,{type:"button",value:gH,className:"htUIButton htUIButtonOK",identifier:Yp.BUTTON_OK})),this.elements.push(new yc(this.hot,{type:"button",value:mH,className:"htUIButton htUIButtonCancel",identifier:Yp.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){k(this.elements,e=>{e.addLocalHook("click",(n,i)=>VMe(cj,this,BMe).call(this,n,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(q(n.parentNode,"htFiltersMenuActionBar"),k(this.elements,i=>n.appendChild(i.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}s4=Yp;function BMe(t,e){e.options.identifier===s4.BUTTON_OK?this.accept():this.cancel()}function vT(t,e,n){return(e=WMe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function WMe(t){var e=jMe(t,"string");return typeof e=="symbol"?e:e+""}function jMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uj="ConditionCollection.filteringStates";class _k{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;vT(this,"hot",void 0),vT(this,"isMapRegistrable",void 0),vT(this,"filteringStates",new n0),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(uj,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var i;const r=this.filteringStates.getValueAtIndex(n),s=(i=r?.conditions)!==null&&i!==void 0?i:[],o=r?.operation;return this.isMatchInConditions(s,e,o)}isMatchInConditions(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:bc;return e.length?NTe(i)(e,n):!0}addCondition(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:bc,r=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,o=n.args.map(u=>typeof u=="string"?u.toLocaleLowerCase(s):u),a=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==i)throw Error(ct`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(Nt(Wp[i]))throw new Error(ct`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const c=this.getConditions(e);c.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:a,args:o,func:Ac(a,o)}]},r):c.push({name:a,args:o,func:Ac(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[i,{operation:r,conditions:s}]=n;return e.push({column:i,operation:r,conditions:s.map(o=>{let{name:a,args:l}=o;return{name:a,args:[...l]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(i=>this.addCondition(n.column,i))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const i=this.getConditions(e);return n?i.some(r=>r.name===n):i.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(uj),this.filteringStates=null,this.clearLocalHooks()}}pt(_k,ti);function hj(t,e,n){return(e=zMe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zMe(t){var e=UMe(t,"string");return typeof e=="symbol"?e:e+""}function UMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class o4{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];hj(this,"conditionCollection",void 0),hj(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return k(this.conditionCollection.getFilteredColumns(),(n,i)=>{let r=this.columnDataFactory(n);i&&(r=this._getIntersectData(r,e)),e=this.filterByColumn(n,r)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return k(n,r=>{r!==void 0&&this.conditionCollection.isMatch(r,e)&&i.push(r)}),i}_getIntersectData(e,n){const i=[];return k(n,r=>{const s=r.meta.visualRow;e[s]!==void 0&&(i[s]=e[s])}),i}}function YMe(t,e){GMe(t,e),e.add(t)}function GMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fu(t,e,n){return(e=qMe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qMe(t){var e=KMe(t,"string");return typeof e=="symbol"?e:e+""}function KMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bT(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hb=new WeakSet;class a4{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];YMe(this,hb),fu(this,"hot",void 0),fu(this,"conditionCollection",void 0),fu(this,"columnDataFactory",void 0),fu(this,"changes",[]),fu(this,"grouping",!1),fu(this,"latestEditedColumnPosition",-1),fu(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",r=>bT(hb,this,XMe).call(this,r)),this.conditionCollection.addLocalHook("afterRemove",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("afterAdd",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("beforeClean",()=>bT(hb,this,JMe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>bT(hb,this,ZMe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,k(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const r=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const o=r.slice(0,s),a=r.slice(s);a.length&&a[0].column===e&&a.shift();const l=c5(function(u,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new _k(i.hot,!1),g=[].concat(u,d);f.importAllConditions(g);const m=i.columnDataFactory(h);let p;f.isEmpty()?p=m:p=new o4(f,b=>i.columnDataFactory(b)).filter(),p=lt(p,b=>b.meta.visualRow);const v=Vw(p);return f.destroy(),Ec(m,b=>v(b.meta.visualRow))})(o),c=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:c},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),Ye(this,(e,n)=>{this[n]=null})}}function XMe(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function JMe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function ZMe(){k(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}pt(a4,ti);function QMe(t){return TX({initialPage:0,size:()=>t.length,onItemSelect:(n,i)=>{const r=t[n];if(r instanceof Up)return i;if(r.element&&!Mc(r.element))return!1;r.focus()}})}const um="filters";function ePe(t,e){let n=-1,i;const r=QMe(e),s=h=>()=>{i.isOpened()&&i.getKeyboardShortcutsCtrl().listen(um),r.setCurrentPage(e.indexOf(h))};e.forEach(h=>{h instanceof so&&(h.addLocalHook("click",s(h)),h.addLocalHook("focus",s(h)),h.addLocalHook("afterClose",s(h)))}),l(t);function o(h){const d=i.getKeyboardShortcutsCtrl(),f=h.getKeyboardShortcutsCtrl();r.clear(),f.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:d.getContext(um),callback:()=>{h.isSubMenu()&&h.close(),d.listen(um)}}]),!h.isSubMenu()&&d.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:g=>{const m=i.getNavigator();m.getCurrentPage()>-1&&(n=m.getCurrentPage()),m.clear(),g.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{i.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:g=>{const m=e[r.getCurrentPage()];m instanceof jp&&(m.openOptions(),g.preventDefault()),m instanceof zp&&(m.activate(),g.preventDefault()),m instanceof so||g.preventDefault()}}],um)}function a(){i.focus(),i.getKeyboardShortcutsCtrl().listen(um)}function l(h){h.addLocalHook("afterSelectionChange",d=>{d.key.startsWith("filter_")||r.clear()}),h.addLocalHook("afterSubmenuOpen",o),h.addLocalHook("afterOpen",o),i=h}function c(){return i}function u(){return n}return{...r,listen:a,setMenu:l,getMenu:c,getLastMenuPage:u}}function tPe(t,e){l4(t,e),e.add(t)}function yT(t,e,n){l4(t,e),e.set(t,n)}function l4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hm(t,e,n){return(e=nPe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nPe(t){var e=iPe(t,"string");return typeof e=="symbol"?e:e+""}function iPe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vy(t,e,n){return t.set(mr(t,e),n),n}function Cs(t,e){return t.get(mr(t,e))}function mr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const eA="filters",rPe=250,dj=eA;var La=new WeakMap,tA=new WeakMap,ju=new WeakMap,Dr=new WeakSet;class sPe extends et{static get PLUGIN_KEY(){return eA}static get PLUGIN_PRIORITY(){return rPe}static get DEFAULT_SETTINGS(){return{searchMode:"show"}}static get SETTINGS_VALIDATORS(){return{searchMode:e=>typeof e=="string"&&["show","apply"].includes(e)}}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,tPe(this,Dr),hm(this,"dropdownMenuPlugin",null),hm(this,"conditionCollection",null),hm(this,"conditionUpdateObserver",null),hm(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),hm(this,"filtersRowsMap",null),yT(this,La,void 0),yT(this,tA,new WeakSet),yT(this,ju,[]),this.hot.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return mr(Dr,n,dPe).call(n,...r)})}isEnabled(){return!!this.hot.getSettings()[eA]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Aw),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,i=n&&n.uiContainer||this.hot.rootPortalElement,r=a=>(a.addLocalHook("accept",()=>mr(Dr,this,fj).call(this,"accept")),a.addLocalHook("cancel",()=>mr(Dr,this,fj).call(this,"cancel")),a.addLocalHook("change",l=>mr(Dr,this,hPe).call(this,a,l)),a),s=()=>`${this.hot.getTranslatedPhrase(cH)}:`,o=()=>`${this.hot.getTranslatedPhrase(uH)}:`;if(!this.components.get("filter_by_condition")){const a=new QP(this.hot,{id:"filter_by_condition",name:s,addSeparator:!1,menuContainer:i});a.addLocalHook("afterClose",()=>mr(Dr,this,gj).call(this)),this.components.set("filter_by_condition",r(a))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new pMe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const a=new QP(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});a.addLocalHook("afterClose",()=>mr(Dr,this,gj).call(this)),this.components.set("filter_by_condition2",r(a))}if(!this.components.get("filter_by_value")){const a=this.getSetting("searchMode");this.components.set("filter_by_value",r(new OMe(this.hot,{id:"filter_by_value",name:o,searchMode:a})))}if(this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new Yp(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new _k(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new a4(this.hot,this.conditionCollection,a=>this.getDataMapAtColumn(a)),this.conditionUpdateObserver.addLocalHook("update",a=>mr(Dr,this,fPe).call(this,a))),this.components.forEach(a=>a.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];return mr(Dr,e,uPe).call(e,...l)}),this.addHook("beforeDropdownMenuShow",()=>mr(Dr,this,cPe).call(this)),this.addHook("afterDropdownMenuShow",()=>mr(Dr,this,aPe).call(this)),this.addHook("afterDropdownMenuHide",()=>mr(Dr,this,lPe).call(this)),this.addHook("afterChange",a=>mr(Dr,this,oPe).call(this,a)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Cs(La,this)&&this.dropdownMenuPlugin.enabled){const a=[{focus:()=>{const c=Cs(La,this).getMenu(),u=c.getNavigator(),h=Cs(La,this).getLastMenuPage();c.focus(),h>0?u.setCurrentPage(h):u.toFirstItem()}},...Array.from(this.components).map(c=>{let[,u]=c;return u.getElements()}).flat()];vy(La,this,ePe(this.dropdownMenuPlugin.menu,a));const l=c=>{Cs(La,this).listen(),c.preventDefault(),Eh(c.keyCode,"TAB")&&(c.shiftKey?Cs(La,this).toPreviousItem():Cs(La,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,i)=>{n.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:dj})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dj)}addCondition(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:bc;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:n},args:i},r)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let r=[];const s=this.exportConditions(),o=this.hot.runHooks("beforeFilter",s,Cs(ju,this));if(o!==!1&&i){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=lt(n.filter(),c=>c.meta.visualRow);const l=Vw(r);pe(this.hot.countSourceRows()-1,c=>{l(c)||a.push(c)}),k(a,c=>{this.filtersRowsMap.setValueAtIndex(c,!0)})},!0),!e&&!r.length&&this.hot.deselectCell(),vy(ju,this,this.exportConditions())}else o!==!1&&!i?(vy(ju,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(Cs(ju,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeActive().highlight.col),o!==!1&&(this.hot.runHooks("afterFilter",s),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),i=[];return k(this.hot.getSourceDataAtCol(n),(r,s)=>{var o;const{row:a,col:l,visualCol:c,visualRow:u,type:h,instance:d,dateFormat:f,locale:g}=this.hot.getCellMeta(s,n),m=(o=this.hot.getDataAtCell(this.hot.toVisualRow(s),n))!==null&&o!==void 0?o:r;i.push({meta:{row:a,col:l,visualCol:c,visualRow:u,type:h,instance:d,dateFormat:f,locale:g},value:yk(m)})}),i}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),i=ZP(n);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var n;const i=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(r=>{r.isHidden()||r.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,i,r){let s=e;return s===MC&&n.command.key!==ui&&i.command.key!==ui&&r.command.key!==ui?s=Sk:r.command.key!==ui&&(n.command.key===ui||i.command.key===ui)&&(s=bc),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new o4(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return k(r,o=>{k(n.menuItems,(a,l)=>{a.key===o.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,r=i.getPlugin("hiddenRows");for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];const l=this.getIndexesOfComponents(...o);e?r.showRows(l):r.hideRows(l),i.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function oPe(t){t&&k(t,e=>{const[,n]=e,i=this.hot.propToCol(n);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function aPe(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function lPe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function cPe(){const t=this.dropdownMenuPlugin.menu;Cs(tA,this).has(t)||Cs(La,this).setMenu(t),Cs(tA,this).add(t)}function uPe(t){t.items.push({name:Xe}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function fj(t){var e;if(t==="accept"){const i=this.getSelectedColumn();if(i===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:r}=i,s=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,o,a);this.conditionUpdateObserver.groupChanges();let c=this.conditionCollection.getColumnStackPosition(r);c===-1&&(c=void 0),this.conditionCollection.removeConditions(r),s.command.key!==ui&&(this.conditionCollection.addCondition(r,s,l,c),o.command.key!==ui&&this.conditionCollection.addCondition(r,o,l,c)),a.command.key!==ui&&this.conditionCollection.addCondition(r,a,l,c),this.conditionUpdateObserver.flush(),this.components.forEach(u=>u.saveState(r)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function hPe(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===QP&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function gj(){this.setListeningDropdownMenu()}function dPe(t,e,n){const i=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(i)&&n===this.hot.view.getColumnHeadersCount()-1?q(e,"htFiltersActive"):ue(e,"htFiltersActive")}function fPe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:i},conditionArgsChange:r}=t;Array.isArray(r)&&vy(ju,this,Cs(ju,this).map(a=>(a.column===i&&n.length>0&&a.conditions.forEach(l=>{l.name==="by_value"&&(l.args=[[...r]])}),a)));const s=n.filter(a=>a.name===eh),o=n.filter(a=>a.name!==eh);if(s.length>=2||o.length>=3)Ue(ct`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const a=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(o[0],i),this.components.get("filter_by_condition2").updateState(o[1],i),this.components.get("filter_operators").updateState(a,i),this.components.get("filter_by_value").updateState(t)}}const c4="internal-use-in-handsontable",nA={licenseKey:c4,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function u4(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Hi])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function h4(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function gPe(t){var e;const n=t[Hi],i=h4(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=u4(t);return{...nA,...i,...r}}function mPe(t){var e;const n=t[Hi],i=h4(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=u4(t);return{...i,...r}}function pPe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function _0(){const t="engine_relationship",e=ks(Hi);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function Ek(){const t="shared_engine_usage",e=ks(Hi);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function wPe(t){const e=t.getSettings(),n=e[Hi],i=n?.engine;if(n===!0||Nt(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var r;return vPe((r=i.hyperformula)!==null&&r!==void 0?r:i,e,t)}else if(typeof i=="object"&&Nt(i.hyperformula)){const s=_0(),o=Ek().get(i);return s.has(i)||s.set(i,[]),s.get(i).push(t),o&&o.push(t.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:c4}),(i.getConfig().leapYear1900!==nA.leapYear1900||Cw(i.getConfig().nullDate,nA.nullDate)===!1)&&Ue(ct`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function vPe(t,e,n){const i=e[Hi],r=gPe(e),s=_0(),o=Ek();bPe(t,i.functions),yPe(t,i.language);const a=t.buildEmpty(r);return s.set(a,[n]),o.set(a,[n.guid]),CPe(a,i.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function mj(t){var e;const n=_0(),i=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(i.map(r=>[r.getPlugin("formulas").sheetId,r]))}function pj(t,e){if(t){const n=_0(),i=n.get(t),r=Ek(),s=r.get(t);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&n.delete(t)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(r.delete(t),t.destroy()))}}function bPe(t,e){e&&e.forEach(n=>{const{name:i,plugin:r,translations:s}=n;try{t.registerFunction(i,r,s)}catch(o){Ue(o.message)}})}function yPe(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(i){Ue(i.message)}}}function CPe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:i,expression:r,scope:s,options:o}=n;try{t.addNamedExpression(i,r,s,o)}catch(a){Ue(a.message)}}),t.resumeEvaluation())}function SPe(t,e){return(Nt(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const d4="DD/MM/YYYY";function RPe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function _Pe(t){return RPe(t)?t.substr(1):t}function EPe(t){return typeof t=="string"&&t.startsWith("=")}function xk(t,e){return typeof t=="string"&&e==="date"}function f4(t,e){return Z(t,e,!0).isValid()}function g4(t,e){return Z(t,e,!0).format(d4)}function xPe(t,e){return Z(t,d4,!0).format(e)}function m4(t,e){const i=new Date(Date.UTC(0,0,t+-1));return Z(i).format(e)}function TPe(t,e,n){const i=Array.from(Array(n).keys()).filter(s=>t.includes(s)===!1);if(e===0){var r;return(r=i[e])!==null&&r!==void 0?r:0}return i[e-1]+1}function MPe(t,e){const n=[];return t.forEach(i=>{const r={from:i,to:e};n.forEach(s=>{const o=s.from>s.to,a=s.to<=r.from;s.from>r.from&&a&&o&&(r.from+=1)}),r.from>=e&&(e+=1),n.push(r)}),n}function PPe(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(r=>{const s=r.from<r.to;r.from>e.from&&s&&(r.from-=1)})}),t}function Tk(t,e,n){const i=MPe(t,TPe(t,e,n));return PPe(i)}function gu(t,e,n){APe(t,e),e.set(t,n)}function APe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ft(t,e){return t.get(p4(t,e))}function Dl(t,e,n){return t.set(p4(t,e),n),n}function p4(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dm=new WeakMap,Nl=new WeakMap,Nr=new WeakMap,db=new WeakMap,CT=new WeakMap,ST=new WeakMap,fb=new WeakMap;class wj{constructor(e,n,i){gu(this,dm,void 0),gu(this,Nl,void 0),gu(this,Nr,void 0),gu(this,db,[]),gu(this,CT,[]),gu(this,ST,void 0),gu(this,fb,[]),Dl(dm,this,e),Dl(Nl,this,n),Dl(Nr,this,i)}setRemovedHfIndexes(e){return Dl(fb,this,e.map(n=>{const i=Ft(Nl,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(i)})),Ft(fb,this)}getRemovedHfIndexes(){return Ft(fb,this)}getHfIndexFromVisualIndex(e){const n=Ft(Nl,this).getIndexesSequence(),i=Ft(Nl,this).getNotTrimmedIndexes();return n.indexOf(i[e],e)}syncMoves(e){const i=`move${Fi(Ft(dm,this))}s`;Ft(Nr,this).getEngine().batch(()=>{e.forEach(r=>{const s=r.from!==r.to,o=r.from+1!==r.to;s&&o&&Ft(Nr,this).getEngine()[i](Ft(Nr,this).getSheetId(),r.from,1,r.to)})})}storeMovesInformation(e,n,i){i!==!1&&(Dl(CT,this,e.map(r=>this.getHfIndexFromVisualIndex(r))),Dl(ST,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(Ft(Nr,this).isPerformingUndoRedo()||e===!1||n===!1)return;const i=Tk(Ft(CT,this),Ft(ST,this),Ft(Nl,this).getNumberOfIndexes());Ft(Nr,this).getSheetId()===null?Ft(Nr,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${Fi(Ft(dm,this))}Order`;return n=>{if(Ft(Nr,this).isPerformingUndoRedo())return;const i=Ft(Nl,this).getIndexesSequence();if(n==="update"&&i.length>0){const r=Ft(db,this).map(l=>i.indexOf(l)),s=Ft(Nr,this).getEngine().getSheetDimensions(Ft(Nr,this).getSheetId());let o;Ft(dm,this)==="row"?o=s.height:o=s.width;const a=r.length;for(let l=a;l<o;l+=1)r.push(l);Ft(Nr,this).getEngine()[e](Ft(Nr,this).getSheetId(),r)}Dl(db,this,i)}}init(){Dl(db,this,Ft(Nl,this).getIndexesSequence())}}function mu(t,e,n){IPe(t,e),e.set(t,n)}function IPe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ia(t,e){return t.get(w4(t,e))}function pu(t,e,n){return t.set(w4(t,e),n),n}function w4(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gb=new WeakMap,mb=new WeakMap,RT=new WeakMap,_T=new WeakMap,ET=new WeakMap,xT=new WeakMap,TT=new WeakMap;class OPe{constructor(e,n,i){mu(this,gb,void 0),mu(this,mb,void 0),mu(this,RT,void 0),mu(this,_T,!1),mu(this,ET,!1),mu(this,xT,null),mu(this,TT,null),pu(gb,this,new wj("row",e,this)),pu(mb,this,new wj("column",n,this)),pu(RT,this,i)}getForAxis(e){return e==="row"?Ia(gb,this):Ia(mb,this)}setPerformUndo(e){pu(_T,this,e)}setPerformRedo(e){pu(ET,this,e)}isPerformingUndoRedo(){return Ia(_T,this)||Ia(ET,this)}getSheetId(){return Ia(TT,this)}getEngine(){return Ia(xT,this)}getPostponeAction(){return Ia(RT,this)}setupSyncEndpoint(e,n){pu(xT,this,e),pu(TT,this,n),Ia(gb,this).init(),Ia(mb,this).init()}}function HPe(t,e){v4(t,e),e.add(t)}function wu(t,e,n){return(e=kPe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kPe(t){var e=DPe(t,"string");return typeof e=="symbol"?e:e+""}function DPe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MT(t,e,n){v4(t,e),e.set(t,n)}function v4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ic(t,e,n){return t.set(We(t,e),n),n}function mh(t,e){return t.get(We(t,e))}function We(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Hi="formulas",NPe=["maxRows","maxColumns","language"],LPe=260;le.getSingleton().register("afterNamedExpressionAdded");le.getSingleton().register("afterNamedExpressionRemoved");le.getSingleton().register("afterSheetAdded");le.getSingleton().register("afterSheetRemoved");le.getSingleton().register("afterSheetRenamed");le.getSingleton().register("afterFormulasValuesUpdate");const hg=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var ul=new WeakMap,E0=new WeakMap,fm=new WeakMap,Ge=new WeakSet;class $Pe extends et{constructor(){var e;super(...arguments),e=this,HPe(this,Ge),MT(this,ul,!1),MT(this,E0,!1),MT(this,fm,[["valuesUpdated",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return We(Ge,e,eAe).call(e,...i)}],["namedExpressionAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return We(Ge,e,tAe).call(e,...i)}],["namedExpressionRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return We(Ge,e,nAe).call(e,...i)}],["sheetAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return We(Ge,e,iAe).call(e,...i)}],["sheetRenamed",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return We(Ge,e,rAe).call(e,...i)}],["sheetRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return We(Ge,e,sAe).call(e,...i)}]]),wu(this,"staticRegister",ks("formulas")),wu(this,"engine",null),wu(this,"sheetId",null),wu(this,"sheetName",null),wu(this,"indexSyncer",null),wu(this,"rowAxisSyncer",null),wu(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Hi}static get PLUGIN_PRIORITY(){return LPe}static get SETTING_KEYS(){return[Hi,...NPe]}isEnabled(){return!!this.hot.getSettings()[Hi]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=wPe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){Ue("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,We(Ge,this,Gp).call(this));i!==!1&&We(Ge,this,op).call(this,i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,vj).call(n,...r)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,bj).call(n,...r)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,vj).call(n,...r)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,bj).call(n,...r)}),this.addHook("modifyData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,WPe).call(n,...r)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,jPe).call(n,...r)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,FPe).call(n,...r)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,zPe).call(n,...r)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,yj).call(n,...r)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,yj).call(n,...r)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,UPe).call(n,...r)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,YPe).call(n,...r)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,KPe).call(n,...r)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,XPe).call(n,...r)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,GPe).call(n,...r)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,qPe).call(n,...r)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,JPe).call(n,...r)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,ZPe).call(n,...r)}),this.indexSyncer=new OPe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,r,s,o)=>{this.rowAxisSyncer.storeMovesInformation(i,r,o)}),this.hot.addHook("beforeColumnMove",(i,r,s,o)=>{this.columnAxisSyncer.storeMovesInformation(i,r,o)}),this.hot.addHook("afterRowMove",(i,r,s,o,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("afterColumnMove",(i,r,s,o,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("beforeColumnFreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,r)}),this.hot.addHook("afterColumnFreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.hot.addHook("beforeColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,r)}),this.hot.addHook("afterColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,BPe).call(n,...r)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,QPe).call(n,...r)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return We(Ge,n,VPe).call(n,...r)}),mh(fm,this).forEach(i=>{let[r,s]=i;return this.engine.on(r,s)}),super.enablePlugin()}}disablePlugin(){mh(fm,this).forEach(e=>{let[n,i]=e;return this.engine.off(n,i)}),pj(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=mPe(this.hot.getSettings());pPe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const i=this.hot.getSettings()[Hi];if(se(i)&&se(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const r=this.hot.getSettings()[Hi].sheetName;if(r&&this.engine.doesSheetExist(r))this.switchSheet(this.sheetName);else{const s=this.addSheet(r??void 0,We(Ge,this,Gp).call(this));We(Ge,this,op).call(this,s)}}super.updatePlugin(e)}destroy(){mh(fm,this).forEach(e=>{var n;let[i,r]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(i,r)}),Ic(fm,this,null),pj(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(se(n)&&!U5(n))return Ue("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return Ue("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(i),n),i}catch(i){return Ue(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){_O(`The sheet named \`${e}\` does not exist, switch aborted.`);return}We(Ge,this,op).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${Fi(Hi)}.switchSheet`)}getCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const r=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(n);return r!==null&&s!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(r=>{var s;const o=r==null||(s=r.address)===null||s===void 0?void 0:s.sheet;o!==void 0&&(i.has(o)||i.add(o))}),mj(this.engine).forEach((r,s)=>{if((n||s!==this.sheetId)&&i.has(s)){var o;r.render(),(o=r.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=s=>{var o;const{row:a,col:l,sheet:c}=(o=s?.address)!==null&&o!==void 0?o:{};return se(c)?`${c}:${a}x${l}`:""},r=new Set(n.map(s=>i(s)));e.forEach(s=>{var o,a;const{row:l,col:c}=(o=s.address)!==null&&o!==void 0?o:{};if(se(l)===!1||se(c)===!1||l>=this.hot.countRows()||c>=this.hot.countCols())return;const u=s==null||(a=s.address)===null||a===void 0?void 0:a.sheet,h=i(s);if(u!==void 0&&!r.has(h)){const d=mj(this.engine).get(u);if(!d)return;d.validateCell(d.getDataAtCell(l,c),d.getCellMeta(l,c),()=>{})}})}syncChangeWithEngine(e,n,i){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r)){Ue(`Not possible to set cell data at ${JSON.stringify(r)}`);return}const s=this.hot.getCellMeta(e,n);return xk(i,s.type)&&(f4(i,s.dateFormat)?i=g4(i,s.dateFormat):EPe(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(r,i)}}function op(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function b4(t,e,n){if(Re(n)&&n!==null){const i=this.hot.toVisualRow(t),r=this.hot.toVisualColumn(e),s=this.hot.getCellMeta(i,r).valueGetter;return s?s.call(this.hot,n):n.toString()}return n}function Gp(t,e,n,i){return this.hot.getSourceDataArray(t,e,n,i).map((r,s)=>r.map((o,a)=>We(Ge,this,b4).call(this,s,a,o)))}function FPe(t,e,n){const i=this.hot.propToCol(n);if(this.isFormulaCellType(e,i)){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},s=this.hot.getCellMeta(e,i);let o=this.engine.getCellValue(r);return s.type==="date"&&Oi(o)&&(o=m4(o,s.dateFormat)),typeof o=="object"&&o!==null?o.value:o}return t}function VPe(t,e,n){const{row:i,col:r}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),{row:a,col:l}=n.getTopStartCorner(),{row:c,col:u}=n.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(c),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:g,col:m}=h.start,{row:p,col:v}=h.end,b=p-g+1,R=v-m+1;for(let S=0;S<f.length;S+=1)for(let x=0;x<f[S].length;x+=1){const M=f[S][x],T=g+S%b,O=m+x%R,W=this.hot.getCellMeta(T,O);xk(M,W.type)&&(M.startsWith("'")?f[S][x]=M.slice(1):this.isFormulaCellType(T,O,this.sheetId)===!1&&(f[S][x]=xPe(M,W.dateFormat)))}return f}function vj(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(Fi(Hi))||Ic(E0,this,Nt(this.hot.getSettings().data))}function BPe(){if(mh(E0,this)){this.switchSheet(this.sheetName);return}const t=We(Ge,this,Gp).call(this);t.forEach((n,i)=>{n.forEach((r,s)=>{const o=this.hot.getCellMeta(i,s,{skipMetaExtension:!0}),a=o.dateFormat;xk(r,o.type)&&(f4(r,a)?t[i][s]=g4(r,a):r.startsWith("=")||(t[i][s]=`'${r}`))})}),Ic(ul,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Ic(ul,this,!1)}function bj(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(Fi(Hi)))return;const i=SPe(this.engine,this.hot.getSettings()[Hi].sheetName);if(We(Ge,this,op).call(this,i),n!=="updateSettings")if(mh(E0,this))this.switchSheet(this.sheetName);else{const r=We(Ge,this,Gp).call(this);if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){Ic(ul,this,!0);const s=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),Ic(ul,this,!1)}}}function WPe(t,e,n,i){if(i!=="get"||mh(ul,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const r=this.getCellType(t,e);if(r==="VALUE"||r==="EMPTY"){n.value=_Pe(n.value);return}const s={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let o=this.engine.getCellValue(s);const a=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});a.type==="date"&&Oi(o)&&(o=m4(o,a.dateFormat)),n.value=typeof o=="object"&&o!==null?o.value:o}function jPe(t,e,n,i){if(i!=="get"||mh(ul,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(t),s=this.hot.propToCol(e);if(r===null||s===null)return;const o=this.getCellType(r,s);if(o==="VALUE"||o==="EMPTY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};n.value=this.engine.getCellSerialized(l)}function yj(t,e){if(hg(e))return;const n=[],i=[],r=this.engine.batch(()=>{t.forEach(s=>{let[o,a,,l]=s;const c=this.hot.propToCol(a),u=this.hot.toPhysicalRow(o),h=this.hot.toPhysicalColumn(c),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};l=We(Ge,this,b4).call(this,u,h,l),u!==null&&h!==null?this.syncChangeWithEngine(o,c,l):n.push([o,c,l]),i.push({address:d})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{n.forEach(o=>{let[a,l,c]=o;this.syncChangeWithEngine(a,l,c)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(r),this.validateDependentCells(r,i)}function zPe(t,e){if(hg(e))return;const n=[],i=[];t.forEach(r=>{let[s,o,,a]=r;const l=this.hot.propToCol(o);if(!Oi(l))return;const c={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(c)){Ue(`Not possible to set source cell data at ${JSON.stringify(c)}`);return}i.push({address:c}),n.push(...this.engine.setCellContents(c,a))}),this.renderDependentSheets(n),this.validateDependentCells(n,i)}function UPe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function YPe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function GPe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function qPe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function KPe(t,e,n){if(hg(n))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function XPe(t,e,n){if(hg(n))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function JPe(t,e,n,i){if(hg(i))return;const r=this.rowAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{r.forEach(o=>{this.engine.removeRows(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function ZPe(t,e,n,i){if(hg(i))return;const r=this.columnAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{r.forEach(o=>{this.engine.removeColumns(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function QPe(t,e,n){var i;Ic(ul,this,!0);const r=We(Ge,this,Gp).call(this,n,0,n+(((i=e.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());Ic(ul,this,!1),r.forEach((s,o)=>{s.forEach((a,l)=>{this.engine.setCellContents({col:l,row:n+o,sheet:this.sheetId},[[a]])})})}function eAe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function tAe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function nAe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function iAe(t){this.hot.runHooks("afterSheetAdded",t)}function rAe(t,e){We(Ge,this,op).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function sAe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function oAe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedActive();let n=0;if(Array.isArray(e)){const[,i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(V1,n)},callback(){const{from:e,to:n}=this.getSelectedRangeActive(),i=Math.max(Math.min(e.col,n.col),0),r=Math.max(e.col,n.col),s=[];for(let l=i;l<=r;l+=1)s.push(l);t.hideColumns(s);const o=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function aAe(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(B1,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],s=e[e.length-1];r=(n=this.columnIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,s=(i=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(e),this.view.adjustElementsSize(),this.render(),s-r+1===this.countCols()||this.selectColumns(r,s)},disabled:!1,hidden(){const n=lt(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeActive(),r=i.getTopStartCorner().col,s=i.getBottomEndCorner().col,o=this.columnIndexMapper,a=o.getRenderableFromVisualIndex(r),l=o.getRenderableFromVisualIndex(s),c=o.getNotTrimmedIndexes(),u=[];if(r!==s){const h=s-r+1,d=l-a+1;if(h>d){const f=c.slice(r,s+1);u.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<r)u.push(...c.slice(0,r));else if(a===null)u.push(...c.slice(0,this.countCols()));else{const h=this.countCols()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&u.push(...c.slice(s+1))}return k(u,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function lAe(t,e){y4(t,e),e.add(t)}function cAe(t,e,n){y4(t,e),e.set(t,n)}function y4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vu(t,e){return t.get(Gl(t,e))}function Cj(t,e,n){return t.set(Gl(t,e),n),n}function Gl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("beforeHideColumns");le.getSingleton().register("afterHideColumns");le.getSingleton().register("beforeUnhideColumns");le.getSingleton().register("afterUnhideColumns");const Sj="hiddenColumns",uAe=310;var To=new WeakMap,bu=new WeakSet;class hAe extends et{constructor(){super(...arguments),lAe(this,bu),cAe(this,To,null)}static get PLUGIN_KEY(){return Sj}static get PLUGIN_PRIORITY(){return uAe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[Sj]}enablePlugin(){var e=this;this.enabled||(Cj(To,this,new t0),vu(To,this).addLocalHook("init",()=>Gl(bu,this,wAe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,vu(To,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Gl(bu,e,pAe).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>Gl(bu,this,fAe).call(this,n,i,r)),this.addHook("modifyColWidth",(n,i)=>Gl(bu,this,dAe).call(this,n,i),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Gl(bu,e,mAe).call(e,...i)}),this.addHook("modifyCopyableRange",n=>Gl(bu,this,gAe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;const s=vu(To,this).getValues().slice(),o=e.length>0;if(i&&o){const l=e.map(c=>this.hot.toPhysicalColumn(c));k(l,c=>{s[c]=!1}),r=Un(s,(c,u,h)=>(u&&c.push(this.hot.toVisualColumn(h)),c),[])}this.hot.runHooks("beforeUnhideColumns",n,r,i&&o)!==!1&&(i&&o&&vu(To,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,r,i&&o,i&&r.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{k(e,o=>{vu(To,this).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",n,r,i,i&&r.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideColumns(n)}getHiddenColumns(){return lt(vu(To,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return vu(To,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){k(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){Cj(To,this,null),super.destroy()}}function dAe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function fAe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenColumn");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function gAe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,s,o)=>{e.push({startRow:i,endRow:r,startCol:s,endCol:o})};return k(t,i=>{let r=!0,s=0;pe(i.startCol,i.endCol,o=>{this.isHidden(o)?(r||n(i.startRow,i.endRow,s,o-1),r=!0):(r&&(s=o),o===i.endCol&&n(i.startRow,i.endRow,s,o),r=!1)})}),e}function mAe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),q(e,n)}function pAe(t){t.items.push({name:Xe},oAe(this),aAe(this))}function wAe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function vAe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedActive();let n=0;if(Array.isArray(e)){const[i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(W1,n)},callback(){const{from:e,to:n}=this.getSelectedRangeActive(),i=Math.max(Math.min(e.row,n.row),0),r=Math.max(e.row,n.row),s=[];for(let l=i;l<=r;l+=1)s.push(l);t.hideRows(s);const o=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function bAe(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(j1,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],s=e[e.length-1];r=(n=this.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,s=(i=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(e),this.view.adjustElementsSize(),this.render(),s-r+1===this.countRows()||this.selectRows(r,s)},disabled:!1,hidden(){const n=lt(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeActive(),r=i.getTopStartCorner().row,s=i.getBottomEndCorner().row,o=this.rowIndexMapper,a=o.getRenderableFromVisualIndex(r),l=o.getRenderableFromVisualIndex(s),c=o.getNotTrimmedIndexes(),u=[];if(r!==s){const h=s-r+1,d=l-a+1;if(h>d){const f=c.slice(r,s+1);u.push(...f.filter(g=>n.includes(g)))}}else if(a===0&&a<r)u.push(...c.slice(0,r));else if(a===null)u.push(...c.slice(0,this.countRows()));else{const h=this.countRows()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&u.push(...c.slice(s+1))}return k(u,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function yAe(t,e){C4(t,e),e.add(t)}function CAe(t,e,n){C4(t,e),e.set(t,n)}function C4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yu(t,e){return t.get(ql(t,e))}function Rj(t,e,n){return t.set(ql(t,e),n),n}function ql(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("beforeHideRows");le.getSingleton().register("afterHideRows");le.getSingleton().register("beforeUnhideRows");le.getSingleton().register("afterUnhideRows");const _j="hiddenRows",SAe=320;var Mo=new WeakMap,Cu=new WeakSet;class RAe extends et{constructor(){super(...arguments),yAe(this,Cu),CAe(this,Mo,null)}static get PLUGIN_KEY(){return _j}static get PLUGIN_PRIORITY(){return SAe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[_j]}enablePlugin(){var e=this;this.enabled||(Rj(Mo,this,new t0),yu(Mo,this).addLocalHook("init",()=>ql(Cu,this,PAe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,yu(Mo,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ql(Cu,e,MAe).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>ql(Cu,this,EAe).call(this,n,i,r)),this.addHook("modifyRowHeight",(n,i)=>ql(Cu,this,_Ae).call(this,n,i)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ql(Cu,e,TAe).call(e,...i)}),this.addHook("modifyCopyableRange",n=>ql(Cu,this,xAe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;const s=yu(Mo,this).getValues().slice(),o=e.length>0;if(i&&o){const l=e.map(c=>this.hot.toPhysicalRow(c));k(l,c=>{s[c]=!1}),r=Un(s,(c,u,h)=>(u&&c.push(this.hot.toVisualRow(h)),c),[])}this.hot.runHooks("beforeUnhideRows",n,r,i&&o)!==!1&&(i&&o&&yu(Mo,this).setValues(s),this.hot.runHooks("afterUnhideRows",n,r,i&&o,i&&r.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{k(e,o=>{yu(Mo,this).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",n,r,i,i&&r.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideRows(n)}getHiddenRows(){return lt(yu(Mo,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return yu(Mo,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){k(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){Rj(Mo,this,null),super.destroy()}}function _Ae(t,e){return this.isHidden(e)?0:t}function EAe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenRow");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function xAe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,s,o)=>{e.push({startRow:i,endRow:r,startCol:s,endCol:o})};return k(t,i=>{let r=!0,s=0;pe(i.startRow,i.endRow,o=>{this.isHidden(o)?(r||n(s,o-1,i.startCol,i.endCol),r=!0):(r&&(s=o),o===i.endRow&&n(s,o,i.startCol,i.endCol),r=!1)})}),e}function TAe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),q(e,n)}function MAe(t){t.items.push({name:Xe},vAe(this),bAe(this))}function PAe(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function AAe(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(p1)},callback(e,n){const[{start:{col:i}}]=n;t.freezeColumn(i),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function IAe(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(w1)},callback(e,n){const[{start:{col:i}}]=n;t.unfreezeColumn(i),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function OAe(t,e){S4(t,e),e.add(t)}function HAe(t,e,n){S4(t,e),e.set(t,n)}function S4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iA(t,e){return t.get(AC(t,e))}function PT(t,e,n){return t.set(AC(t,e),n),n}function AC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("beforeColumnFreeze");le.getSingleton().register("afterColumnFreeze");le.getSingleton().register("beforeColumnUnfreeze");le.getSingleton().register("afterColumnUnfreeze");const Ej="manualColumnFreeze",kAe=110;var Lu=new WeakMap,AT=new WeakSet;class DAe extends et{constructor(){super(...arguments),OAe(this,AT),HAe(this,Lu,!1)}static get PLUGIN_KEY(){return Ej}static get PLUGIN_PRIORITY(){return kAe}isEnabled(){return!!this.hot.getSettings()[Ej]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>AC(AT,this,NAe).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>AC(AT,this,LAe).call(this,e,n)),super.enablePlugin())}disablePlugin(){PT(Lu,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;iA(Lu,this)||PT(Lu,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;iA(Lu,this)||PT(Lu,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function NAe(t){t.items.push({name:"---------"},AAe(this),IAe(this))}function LAe(t,e){if(iA(Lu,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(i=>i<n))return!1}}function pb(t,e,n){return(e=$Ae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Ae(t){var e=FAe(t,"string");return typeof e=="symbol"?e:e+""}function FAe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const IT=0,xj=1,Tj=2,Md="px";let R4=class{constructor(e){pb(this,"hot",void 0),pb(this,"_element",null),pb(this,"state",IT),pb(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=Tj}build(){this.state===IT&&(this._element=this.hot.rootDocument.createElement("div"),this.state=xj)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=IT}isAppended(){return this.state===Tj}isBuilt(){return this.state>=xj}setPosition(e,n){Oi(e)&&(this._element.style.top=e+Md),Oi(n)&&(this._element.style[this.inlineProperty]=n+Md)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Oi(e)&&(this._element.style.width=e+Md),Oi(n)&&(this._element.style.height=n+Md)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Oi(e)&&(this._element.style.marginTop=e+Md),Oi(n)&&(this._element.style[`margin${Fi(this.inlineProperty)}`]=n+Md)}getOffset(){const e=this._element.style,n=`margin${Fi(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const VAe="ht__manualColumnMove--backlight";let BAe=class extends R4{build(){super.build(),q(this._element,VAe)}};const WAe="ht__manualColumnMove--guideline";let jAe=class extends R4{build(){super.build(),q(this._element,WAe)}};function zAe(t,e){_4(t,e),e.add(t)}function Bs(t,e,n){_4(t,e),e.set(t,n)}function _4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sr(t,e,n){return t.set(Kl(t,e),n),n}function ge(t,e){return t.get(Kl(t,e))}function Kl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("beforeColumnMove");le.getSingleton().register("afterColumnMove");const OT="manualColumnMove",UAe=120,Mj="ht__manualColumnMove",IC="show-ui",rA="on-moving--columns",sA="after-selection--columns";var Ji=new WeakMap,Zl=new WeakMap,Qa=new WeakMap,by=new WeakMap,dc=new WeakMap,Ki=new WeakMap,wb=new WeakMap,ws=new WeakMap,qd=new WeakMap,OC=new WeakMap,ap=new WeakMap,Su=new WeakSet;class YAe extends et{constructor(){super(...arguments),zAe(this,Su),Bs(this,Ji,new BAe(this.hot)),Bs(this,Zl,new jAe(this.hot)),Bs(this,Qa,[]),Bs(this,by,0),Bs(this,dc,!1),Bs(this,Ki,{}),Bs(this,wb,void 0),Bs(this,ws,void 0),Bs(this,qd,void 0),Bs(this,OC,void 0),Bs(this,ap,void 0)}static get PLUGIN_KEY(){return OT}static get PLUGIN_PRIORITY(){return UAe}isEnabled(){return!!this.hot.getSettings()[OT]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kl(Su,e,GAe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kl(Su,e,KAe).call(e,...i)}),this.addHook("afterScrollVertically",()=>Kl(Su,this,JAe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kl(Su,e,ZAe).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,Mj),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ue(this.hot.rootElement,Mj),this.unregisterEvents(),ge(Ji,this).destroy(),ge(Zl,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const i=ge(wb,this),r=this.isMovePossible(e,n),s=this.hot.runHooks("beforeColumnMove",e,n,i,r);if(Sr(wb,this,void 0),s===!1)return;r&&this.hot.columnIndexMapper.moveIndexes(e,n);const o=r&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,i,r,o),o}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const i=this.countFinalIndex(e,n);return Sr(wb,this,n),this.moveColumns(e,i)}isMovePossible(e,n){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,s=n<0,o=e.some(l=>l<0),a=e.some(l=>l>=i);return!(r||s||o||a)}isColumnOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=Un(e,(r,s)=>(s<n&&(r+=1),r),0);return n-i}getColumnsWidth(e,n){const i=this.hot.columnIndexMapper;let r=0;for(let s=e;s<=n;s+=1){const o=i.getRenderableFromVisualIndex(s);s<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(r+=this.hot.view._wt.wtTable.getColumnWidth(o)||0)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[OT];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const i=[];return pe(e,n,r=>{i.push(r)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(ge(ws,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,r=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,ge(ws,this)-1);const o=n.hider.offsetWidth,a=n.TBODY.offsetLeft,l=ge(Ji,this).getOffset().start,c=ge(Ji,this).getSize().width;let u=0,h=0;if(this.hot.isRtl()){const g=this.hot.rootWindow,m=yn(this.hot.rootElement),p=g.innerWidth-ge(qd,this)-m;h=g.innerWidth-ge(Ki,this).eventPageX-p-(i.scrollX===void 0?r:0)}else h=ge(Ki,this).eventPageX-(ge(qd,this)-(i.scrollX===void 0?r:0));if(ge(OC,this)&&(u=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(ge(ws,this))&&(s+=r),s+=u,ge(ws,this)<0)ge(ap,this)>0?ge(Ki,this).col=0:ge(Ki,this).col=e>0?e-1:e;else if(ge(Ki,this).TD.offsetWidth/2+s<=h){const g=ge(ws,this)>=ge(by,this)?ge(by,this)-1:ge(ws,this);ge(Ki,this).col=g+1,s+=ge(Ki,this).TD.offsetWidth}else ge(Ki,this).col=ge(ws,this);let d=h,f=s;h+c+l>=o?d=o-c-l:h+l<a+u&&(d=a+u+Math.abs(l)),s>=o-1?f=o-1:f===0?f=1:i.scrollX!==void 0&&ge(ws,this)<ge(ap,this)&&(f-=ge(qd,this)<=i.scrollX?ge(qd,this):0),ge(Ji,this).setPosition(null,d),ge(Zl,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Kl(Su,this,qAe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Kl(Su,this,XAe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){ge(Ji,this).build(),ge(Zl,this).build()}destroy(){ge(Ji,this).destroy(),ge(Zl,this).destroy(),super.destroy()}}function GAe(t,e,n,i){const r=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),o=this.hot.getSelectedRangeActive(),a=Ee(t.target,"sortAction");if(!o||!s||ge(dc,this)||t.button!==0||a){Sr(dc,this,!1),ge(Qa,this).length=0,ue(this.hot.rootElement,[rA,IC]);return}const l=ge(Zl,this).isBuilt()&&!ge(Zl,this).isAppended(),c=ge(Ji,this).isBuilt()&&!ge(Ji,this).isAppended();l&&c&&(ge(Zl,this).appendTo(r.hider),ge(Ji,this).appendTo(r.hider));const{from:u,to:h}=o,d=Math.min(u.col,h.col),f=Math.max(u.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){i.column=!0,Sr(dc,this,!0);const g=n.firstChild?f5(t,n.firstChild).x:t.offsetX;ge(Ki,this).eventPageX=t.pageX,Sr(ws,this,e.col),ge(Ki,this).TD=n,ge(Ki,this).col=e.col,Sr(Qa,this,this.prepareColumnsToMoving(d,f)),Sr(OC,this,!!this.hot.getSettings().rowHeaders),Sr(by,this,this.hot.countCols()),Sr(ap,this,this.hot.getSettings().fixedColumnsStart),Sr(qd,this,yi(this.hot.rootElement).left);const m=ge(OC,this)?-1:0,p=r.holder.scrollTop+r.getColumnHeaderHeight(0)+1,v=e.col<ge(ap,this),b=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),R=Math.abs(g-(this.hot.isRtl()?n.offsetWidth:0)),S=this.getColumnsWidth(d,e.col-1)+R,x=this.getColumnsWidth(m,d-1)+(v?b:0)+S;ge(Ji,this).setPosition(p,x),ge(Ji,this).setSize(this.getColumnsWidth(d,f),r.hider.offsetHeight-p),ge(Ji,this).setOffset(null,-S),q(this.hot.rootElement,rA)}else ue(this.hot.rootElement,sA),Sr(dc,this,!1),ge(Qa,this).length=0}function qAe(t){ge(dc,this)&&(ge(Ki,this).eventPageX=t.pageX,this.refreshPositions())}function KAe(t,e,n,i){!this.hot.getSelectedRangeActive()||!ge(dc,this)||(ge(Qa,this).indexOf(e.col)>-1?ue(this.hot.rootElement,IC):q(this.hot.rootElement,IC),i.row=!0,i.column=!0,i.cell=!0,Sr(ws,this,e.col),ge(Ki,this).TD=n)}function XAe(){const t=ge(Ki,this).col,e=ge(Qa,this).length;if(Sr(ws,this,void 0),Sr(dc,this,!1),ue(this.hot.rootElement,[rA,IC,sA]),this.hot.selection.isSelectedByColumnHeader()&&q(this.hot.rootElement,sA),e<1||t===void 0)return;const n=ge(Qa,this)[0],i=this.hot.toPhysicalColumn(n),r=this.dragColumns(ge(Qa,this),t);if(ge(Qa,this).length=0,r===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const s=this.hot.toVisualColumn(i),o=s+e-1;this.hot.selectColumns(s,o)}}function JAe(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,i=e+n;ge(Ji,this).setPosition(i),ge(Ji,this).setSize(null,t.hider.offsetHeight-i)}function ZAe(){this.moveBySettingsOrLoad()}function QAe(t,e){E4(t,e),e.add(t)}function Si(t,e,n){E4(t,e),e.set(t,n)}function E4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bn(t,e,n){return t.set(Ks(t,e),n),n}function ae(t,e){return t.get(Ks(t,e))}function Ks(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const HC="manualColumnResize",eIe=130,Pj="manualColumnWidths";var ja=new WeakMap,vb=new WeakMap,Gr=new WeakMap,kC=new WeakMap,ea=new WeakMap,tIe=new WeakMap,vf=new WeakMap,bb=new WeakMap,gr=new WeakMap,$a=new WeakMap,Ah=new WeakMap,DC=new WeakMap,rf=new WeakMap,lp=new WeakMap,Kr=new WeakMap,cp=new WeakMap,Po=new WeakSet;class nIe extends et{static get PLUGIN_KEY(){return HC}static get PLUGIN_PRIORITY(){return eIe}constructor(e){super(e),QAe(this,Po),Si(this,ja,null),Si(this,vb,null),Si(this,Gr,[]),Si(this,kC,null),Si(this,ea,null),Si(this,tIe,null),Si(this,vf,null),Si(this,bb,null),Si(this,gr,this.hot.rootDocument.createElement("DIV")),Si(this,$a,this.hot.rootDocument.createElement("DIV")),Si(this,Ah,null),Si(this,DC,!1),Si(this,rf,0),Si(this,lp,null),Si(this,Kr,void 0),Si(this,cp,void 0),q(ae(gr,this),"manualColumnResizer"),q(ae($a,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[HC]}enablePlugin(){var e=this;this.enabled||(bn(Kr,this,new Fc),ae(Kr,this).addLocalHook("init",()=>Ks(Po,this,iIe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,ae(Kr,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ks(Po,e,cIe).call(e,...i)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ks(Po,e,uIe).call(e,...i)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ks(Po,e,hIe).call(e,...i)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){bn(cp,this,ae(Kr,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",Pj,ae(Kr,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",Pj,e),e.value}setManualSize(e,n){const i=Math.max(n,20),r=this.hot.toPhysicalColumn(e);return ae(Kr,this).setValueAtIndex(r,i),i}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);ae(Kr,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode||ae(rf,this)>1)return;bn(ja,this,e);const{_wt:n}=this.hot.view,i=n.wtTable.getCoords(ae(ja,this)),r=i.col;if(r<0)return;const s=An(ae(ja,this)),o=ae(ja,this).getBoundingClientRect(),a=r<n.getSetting("fixedColumnsStart");let l;a&&(l=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(ae(ja,this),i.row,i.col)),l||(l=n.wtOverlays.topOverlay.getRelativeCellPosition(ae(ja,this),i.row,i.col)),bn(vb,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)),bn(Gr,this,[]);const c=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&c){const u=this.hot.getSelectedRange();k(u,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;pe(d,f,g=>{ae(Gr,this).includes(g)||ae(Gr,this).push(g)})})}ae(Gr,this).includes(ae(vb,this))||bn(Gr,this,[ae(vb,this)]),bn(bb,this,l.start-6),bn(vf,this,parseInt(o.width,10)),ae(gr,this).style.top=`${l.top}px`,ae(gr,this).style[this.inlineDir]=`${ae(bb,this)+ae(vf,this)}px`,ae(gr,this).style.height=`${s}px`,this.hot.rootElement.appendChild(ae(gr,this))}refreshHandlePosition(){ae(gr,this).style[this.inlineDir]=`${ae(bb,this)+ae(kC,this)}px`}setupGuidePosition(){const e=parseInt(An(ae(gr,this)),10),n=parseInt(ae(gr,this).style.top,10)+e,i=this.hot.view.getTableHeight();q(ae(gr,this),"active"),q(ae($a,this),"active"),ae($a,this).style.top=`${n}px`,this.refreshGuidePosition(),ae($a,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(ae($a,this))}refreshGuidePosition(){ae($a,this).style[this.inlineDir]=ae(gr,this).style[this.inlineDir]}hideHandleAndGuide(){ue(ae(gr,this),"active"),ue(ae($a,this),"active")}checkIfColumnHeader(e){const n=xc(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},n=(i,r)=>{const s=this.hot.runHooks("beforeColumnResize",ae(ea,this),i,!0);s!==void 0&&bn(ea,this,s),this.setManualSize(i,ae(ea,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ae(ea,this),i,!0),r&&e()};ae(rf,this)>=2&&(ae(Gr,this).length>1?(k(ae(Gr,this),r=>{n(r)}),e()):k(ae(Gr,this),r=>{n(r,!0)})),bn(rf,this,0),bn(lp,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",i=>Ks(Po,this,rIe).call(this,i)),this.eventManager.addEventListener(n,"mousedown",i=>Ks(Po,this,sIe).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>Ks(Po,this,oIe).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>Ks(Po,this,aIe).call(this)),this.eventManager.addEventListener(ae(gr,this),"contextmenu",()=>Ks(Po,this,lIe).call(this))}destroy(){super.destroy()}}function iIe(){const t=this.hot.getSettings()[HC],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,i)=>{ae(Kr,this).setValueAtIndex(i,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,i)=>{ae(Kr,this).setValueAtIndex(i,n)})},!0),bn(cp,this,t)):t===!0&&Array.isArray(ae(cp,this))&&this.hot.batchExecution(()=>{ae(cp,this).forEach((n,i)=>{ae(Kr,this).setValueAtIndex(i,n)})},!0)}function rIe(t){if(!bO(t.target)&&ae(DC,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(ae(Ah,this)||this.setupHandlePosition(e))}}function sIe(t){t.target.parentNode===this.hot.rootElement&&Ee(t.target,"manualColumnResizer")&&(this.setupHandlePosition(ae(ja,this)),this.setupGuidePosition(),bn(Ah,this,!0),ae(lp,this)===null&&(bn(lp,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(ae(lp,this))),bn(rf,this,ae(rf,this)+1),this.startX=t.pageX,bn(ea,this,ae(vf,this)))}function oIe(t){if(ae(Ah,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();bn(kC,this,ae(vf,this)+e),k(ae(Gr,this),n=>{bn(ea,this,this.setManualSize(n,ae(kC,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function aIe(){const t=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},e=(n,i)=>{this.hot.runHooks("beforeColumnResize",ae(ea,this),n,!1),i&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",ae(ea,this),n,!1)};ae(Ah,this)&&(this.hideHandleAndGuide(),bn(Ah,this,!1),ae(ea,this)!==ae(vf,this)&&(ae(Gr,this).length>1?(k(ae(Gr,this),i=>{e(i)}),t()):k(ae(Gr,this),i=>{e(i,!0)})),this.setupHandlePosition(ae(ja,this)))}function lIe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(ae(gr,this)),this.hot.rootElement.removeChild(ae($a,this)),bn(Ah,this,!1),bn(DC,this,!0),this.hot._registerImmediate(()=>{bn(DC,this,!1)})}function cIe(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalColumn(e),r=ae(Kr,this).getValueAtIndex(i);this.hot.getSettings()[HC]&&r&&(n=r)}return n}function uIe(t,e){const n=ae(Kr,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function hIe(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function HT(t,e,n){return(e=dIe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dIe(t){var e=fIe(t,"string");return typeof e=="symbol"?e:e+""}function fIe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const kT=0,Aj=1,Ij=2,Pd="px";let x4=class{constructor(e){HT(this,"hot",void 0),HT(this,"_element",null),HT(this,"state",kT),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=Ij}build(){this.state===kT&&(this._element=this.hot.rootDocument.createElement("div"),this.state=Aj)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=kT}isAppended(){return this.state===Ij}isBuilt(){return this.state>=Aj}setPosition(e,n){e!==void 0&&(this._element.style.top=e+Pd),n!==void 0&&(this._element.style.left=n+Pd)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+Pd),n&&(this._element.style.height=n+Pd)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+Pd),n&&(this._element.style.marginLeft=n+Pd)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const gIe="ht__manualRowMove--backlight";class mIe extends x4{build(){super.build(),q(this._element,gIe)}}const pIe="ht__manualRowMove--guideline";class wIe extends x4{build(){super.build(),q(this._element,pIe)}}function vIe(t,e){T4(t,e),e.add(t)}function Ad(t,e,n){T4(t,e),e.set(t,n)}function T4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function th(t,e,n){return t.set(Xl(t,e),n),n}function De(t,e){return t.get(Xl(t,e))}function Xl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("beforeRowMove");le.getSingleton().register("afterRowMove");const DT="manualRowMove",bIe=140,Oj="ht__manualRowMove",NC="show-ui",oA="on-moving--rows",aA="after-selection--rows";var Zi=new WeakMap,Ql=new WeakMap,el=new WeakMap,fc=new WeakMap,Rr=new WeakMap,yb=new WeakMap,Ru=new WeakSet;class yIe extends et{constructor(){super(...arguments),vIe(this,Ru),Ad(this,Zi,new mIe(this.hot)),Ad(this,Ql,new wIe(this.hot)),Ad(this,el,[]),Ad(this,fc,void 0),Ad(this,Rr,{}),Ad(this,yb,void 0)}static get PLUGIN_KEY(){return DT}static get PLUGIN_PRIORITY(){return bIe}isEnabled(){return!!this.hot.getSettings()[DT]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Xl(Ru,e,CIe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Xl(Ru,e,RIe).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>Xl(Ru,this,EIe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Xl(Ru,e,xIe).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),q(this.hot.rootElement,Oj),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){ue(this.hot.rootElement,Oj),this.unregisterEvents(),De(Zi,this).destroy(),De(Ql,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const i=De(yb,this),r=this.isMovePossible(e,n),s=this.hot.runHooks("beforeRowMove",e,n,i,r);if(th(yb,this,void 0),s===!1)return;r&&this.hot.rowIndexMapper.moveIndexes(e,n);const o=r&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,i,r,o),o}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const i=this.countFinalIndex(e,n);return th(yb,this,n),this.moveRows(e,i)}isMovePossible(e,n){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,s=n<0,o=e.some(l=>l<0),a=e.some(l=>l>=i);return!(r||s||o||a)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=Un(e,(r,s)=>(s<n&&(r+=1),r),0);return n-i}getRowsHeight(e,n){const i=this.hot.rowIndexMapper;let r=0;for(let s=e;s<=n;s++){const o=i.getRenderableFromVisualIndex(s);o!==null&&(r+=this.hot.view._wt.wtTable.getRowHeight(o)||this.hot.stylesHandler.getDefaultRowHeight())}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[DT];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeActive(),n=[];if(!e)return n;const{from:i,to:r}=e,s=Math.min(i.row,r.row),o=Math.max(i.row,r.row);return pe(s,o,a=>{n.push(a)}),n}refreshPositions(){const e=De(Rr,this).coords,n=this.hot.getFirstFullyVisibleRow(),i=this.hot.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&i<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,o=De(Rr,this).TD,a=this.hot.rootElement,l=yi(a),c=Af(a),u=s.holder.scrollTop,h=this.hot.rootWindow!==c?c.scrollTop:0,d=l.top-h,f=De(Rr,this).eventPageY-d+u,g=s.hider.offsetHeight,m=s.TBODY.offsetTop,p=De(Zi,this).getOffset().top,v=De(Zi,this).getSize().height,b=o.offsetHeight/2,R=o.offsetHeight;let S=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const x=f>=S+b;this.isFixedRowTop(e.row)&&(S+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?De(Rr,this).row=n>0?n-1:n:x?(De(Rr,this).row=e.row+1,S+=e.row===0?R-1:R):De(Rr,this).row=e.row;let M=f,T=S;f+v+p>=g?M=g-v-p:f+p<m&&(M=m+Math.abs(p)),S>=g-1&&(T=g-1),De(Zi,this).setPosition(M),De(Ql,this).setPosition(T)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Xl(Ru,this,SIe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Xl(Ru,this,_Ie).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){De(Zi,this).build(),De(Ql,this).build()}destroy(){De(Zi,this).destroy(),De(Ql,this).destroy(),super.destroy()}}function CIe(t,e,n,i){const{wtTable:r,wtViewport:s}=this.hot.view._wt,o=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeActive();if(!a||!o||De(fc,this)||t.button!==0){th(fc,this,!1),De(el,this).length=0,ue(this.hot.rootElement,[oA,NC]);return}const l=De(Ql,this).isBuilt()&&!De(Ql,this).isAppended(),c=De(Zi,this).isBuilt()&&!De(Zi,this).isAppended();l&&c&&(De(Ql,this).appendTo(r.hider),De(Zi,this).appendTo(r.hider));const{from:u,to:h}=a,d=Math.min(u.row,h.row),f=Math.max(u.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){i.row=!0,th(fc,this,!0),De(Rr,this).eventPageY=t.pageY,De(Rr,this).coords=e,De(Rr,this).TD=n,th(el,this,this.prepareRowsToMoving());const g=r.holder.scrollLeft+s.getRowHeaderWidth(),m=this.getRowsHeight(d,e.row-1)+(t.clientY-n.getBoundingClientRect().top);De(Zi,this).setPosition(null,g),De(Zi,this).setSize(r.hider.offsetWidth-g,this.getRowsHeight(d,f)),De(Zi,this).setOffset(-m,null),q(this.hot.rootElement,oA),this.refreshPositions()}else ue(this.hot.rootElement,aA),th(fc,this,!1),De(el,this).length=0}function SIe(t){De(fc,this)&&(De(Rr,this).eventPageY=t.pageY,this.refreshPositions())}function RIe(t,e,n,i){!this.hot.getSelectedRangeActive()||!De(fc,this)||(De(el,this).indexOf(e.row)>-1?ue(this.hot.rootElement,NC):q(this.hot.rootElement,NC),i.row=!0,i.column=!0,i.cell=!0,De(Rr,this).coords=e,De(Rr,this).TD=n)}function _Ie(){const t=De(Rr,this).row,e=De(el,this).length;if(th(fc,this,!1),ue(this.hot.rootElement,[oA,NC,aA]),this.hot.selection.isSelectedByRowHeader()&&q(this.hot.rootElement,aA),e<1||t===void 0)return;const n=De(el,this)[0],i=this.hot.toPhysicalRow(n),r=this.dragRows(De(el,this),t);if(De(el,this).length=0,r===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const s=this.hot.toVisualRow(i),o=s+e-1;this.hot.selectRows(s,o)}}function EIe(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,i=e+n;De(Zi,this).setPosition(null,i),De(Zi,this).setSize(t.hider.offsetWidth-i)}function xIe(){this.moveBySettingsOrLoad()}function TIe(t,e){M4(t,e),e.add(t)}function Ri(t,e,n){M4(t,e),e.set(t,n)}function M4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function sn(t,e,n){return t.set(za(t,e),n),n}function oe(t,e){return t.get(za(t,e))}function za(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const LC="manualRowResize",MIe=30,Hj="manualRowHeights";var Uo=new WeakMap,Cb=new WeakMap,qr=new WeakMap,up=new WeakMap,ec=new WeakMap,Mk=new WeakMap,bf=new WeakMap,Sb=new WeakMap,Ui=new WeakMap,Bo=new WeakMap,Ih=new WeakMap,$C=new WeakMap,sf=new WeakMap,hp=new WeakMap,eo=new WeakMap,dp=new WeakMap,Ll=new WeakSet;class PIe extends et{static get PLUGIN_KEY(){return LC}static get PLUGIN_PRIORITY(){return MIe}constructor(e){super(e),TIe(this,Ll),Ri(this,Uo,null),Ri(this,Cb,null),Ri(this,qr,[]),Ri(this,up,null),Ri(this,ec,null),Ri(this,Mk,null),Ri(this,bf,null),Ri(this,Sb,null),Ri(this,Ui,this.hot.rootDocument.createElement("DIV")),Ri(this,Bo,this.hot.rootDocument.createElement("DIV")),Ri(this,Ih,!1),Ri(this,$C,!1),Ri(this,sf,0),Ri(this,hp,null),Ri(this,eo,void 0),Ri(this,dp,void 0),q(oe(Ui,this),"manualRowResizer"),q(oe(Bo,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[LC]}enablePlugin(){this.enabled||(sn(eo,this,new Fc),oe(eo,this).addLocalHook("init",()=>za(Ll,this,NIe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,oe(eo,this)),this.addHook("modifyRowHeight",(e,n)=>za(Ll,this,DIe).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){sn(dp,this,oe(eo,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",Hj,oe(eo,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",Hj,e),e.value}setManualSize(e,n){const i=this.hot.toPhysicalRow(e),r=Math.max(n,this.hot.stylesHandler.getDefaultRowHeight());return oe(eo,this).setValueAtIndex(i,r),r}getLastDesiredRowHeight(){return oe(up,this)}setupHandlePosition(e){if(oe(sf,this)>1)return;sn(Uo,this,e);const{view:n}=this.hot,{_wt:i}=n,r=i.wtTable.getCoords(oe(Uo,this)),s=r.row;if(s<0)return;const o=yn(oe(Uo,this)),a=oe(Uo,this).getBoundingClientRect(),l=s<i.getSetting("fixedRowsTop"),c=s>=n.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let u;l?u=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(oe(Uo,this),r.row,r.col):c&&(u=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(oe(Uo,this),r.row,r.col)),u||(u=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(oe(Uo,this),r.row,r.col)),sn(Cb,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),sn(qr,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();k(d,f=>{const g=f.getTopStartCorner().row,m=f.getBottomStartCorner().row;pe(g,m,p=>{oe(qr,this).includes(p)||oe(qr,this).push(p)})})}oe(qr,this).includes(oe(Cb,this))||sn(qr,this,[oe(Cb,this)]),sn(Sb,this,u.top-6),sn(bf,this,parseInt(a.height,10)),oe(Ui,this).style.top=`${oe(Sb,this)+oe(bf,this)}px`,oe(Ui,this).style[this.inlineDir]=`${u.start}px`,oe(Ui,this).style.width=`${o}px`,this.hot.rootElement.appendChild(oe(Ui,this))}refreshHandlePosition(){oe(Ui,this).style.top=`${oe(Sb,this)+oe(up,this)}px`}setupGuidePosition(){const e=parseInt(yn(oe(Ui,this)),10),n=parseInt(oe(Ui,this).style[this.inlineDir],10)+e,i=this.hot.view.getTableWidth();q(oe(Ui,this),"active"),q(oe(Bo,this),"active"),oe(Bo,this).style.top=oe(Ui,this).style.top,oe(Bo,this).style[this.inlineDir]=`${n}px`,oe(Bo,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(oe(Bo,this))}refreshGuidePosition(){oe(Bo,this).style.top=oe(Ui,this).style.top}hideHandleAndGuide(){ue(oe(Ui,this),"active"),ue(oe(Bo,this),"active")}checkIfRowHeader(e){const n=xc(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,r.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&oe(ec,this)<n?n:oe(ec,this)}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},n=(i,r)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);s!==void 0&&sn(ec,this,s),this.setManualSize(i,oe(ec,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),r&&e()};oe(sf,this)>=2&&(oe(qr,this).length>1?(k(oe(qr,this),r=>{n(r)}),e()):k(oe(qr,this),r=>{n(r,!0)})),sn(sf,this,0),sn(hp,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>za(Ll,this,AIe).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>za(Ll,this,IIe).call(this,i)),this.eventManager.addEventListener(n,"mousemove",i=>za(Ll,this,OIe).call(this,i)),this.eventManager.addEventListener(n,"mouseup",()=>za(Ll,this,HIe).call(this)),this.eventManager.addEventListener(oe(Ui,this),"contextmenu",()=>za(Ll,this,kIe).call(this))}destroy(){super.destroy()}}function AIe(t){if(!bO(t.target)&&oe($C,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(oe(Ih,this)||this.setupHandlePosition(e))}}function IIe(t){Ee(t.target,"manualRowResizer")&&(this.setupHandlePosition(oe(Uo,this)),this.setupGuidePosition(),sn(Ih,this,!0),oe(hp,this)===null&&(sn(hp,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(oe(hp,this))),sn(sf,this,oe(sf,this)+1),sn(Mk,this,t.pageY),sn(ec,this,oe(bf,this)))}function OIe(t){oe(Ih,this)&&(sn(up,this,oe(bf,this)+(t.pageY-oe(Mk,this))),k(oe(qr,this),e=>{sn(ec,this,this.setManualSize(e,oe(up,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function HIe(){const t=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},e=(n,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),i&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};oe(Ih,this)&&(this.hideHandleAndGuide(),sn(Ih,this,!1),oe(ec,this)!==oe(bf,this)&&(oe(qr,this).length>1?(k(oe(qr,this),i=>{e(i)}),t()):k(oe(qr,this),i=>{e(i,!0)})),this.setupHandlePosition(oe(Uo,this)))}function kIe(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(oe(Ui,this)),this.hot.rootElement.removeChild(oe(Bo,this)),sn(Ih,this,!1),sn($C,this,!0),this.hot._registerImmediate(()=>{sn($C,this,!1)})}function DIe(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),s=oe(eo,this).getValueAtIndex(r);if(this.hot.getSettings()[LC]&&s){var i;(i=this.hot.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.isEnabled()?n=Math.max(s,n??0):n=s}}return n}function NIe(){const t=this.hot.getSettings()[LC],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,i)=>{oe(eo,this).setValueAtIndex(i,n)}):Array.isArray(t)?(t.forEach((n,i)=>{oe(eo,this).setValueAtIndex(i,n)}),sn(dp,this,t)):t===!0&&Array.isArray(oe(dp,this))&&oe(dp,this).forEach((n,i)=>{oe(eo,this).setValueAtIndex(i,n)})},!0)}var kj={},Dj;function LIe(){if(Dj)return kj;Dj=1;var t=JS();return t("flatMap"),kj}LIe();var Nj={},Lj={},NT,$j;function $Ie(){if($j)return NT;$j=1;var t=jn(),e=zn(),n=ha(),i=II();return NT=function(r,s){(!s||typeof r!="string")&&e(r);var o=i(r);return n(e(o!==void 0?t(o,r):r))},NT}var Fj;function FIe(){if(Fj)return Lj;Fj=1;var t=Ot(),e=jn(),n=Ar(),i=zn(),r=ha(),s=$Ie(),o=kI(),a=Ir(),l=Dc(),c=DI(),u=Lc(),h=!l&&!c("flatMap",function(){}),d=!l&&!h&&u("flatMap",TypeError),f=l||h||d,g=o(function(){for(var m=this.iterator,p=this.mapper,v,b;;){if(b=this.inner)try{if(v=i(e(b.next,b.iterator)),!v.done)return v.value;this.inner=null}catch(R){a(m,"throw",R)}if(v=i(e(this.next,m)),this.done=!!v.done)return;try{this.inner=s(p(v.value,this.counter++),!1)}catch(R){a(m,"throw",R)}}});return t({target:"Iterator",proto:!0,real:!0,forced:f},{flatMap:function(p){i(this);try{n(p)}catch(v){a(this,"throw",v)}return d?e(d,this,p):new g(r(this),{mapper:p,inner:null})}}),Lj}var Vj;function VIe(){return Vj||(Vj=1,FIe()),Nj}VIe();function BIe(t,e,n){WIe(t,e),e.set(t,n)}function WIe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _u(t,e,n){return(e=jIe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jIe(t){var e=zIe(t,"string");return typeof e=="symbol"?e:e+""}function zIe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bj(t,e){return t.get(P4(t,e))}function Rb(t,e,n){return t.set(P4(t,e),n),n}function P4(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Eu=new WeakMap;class Yo{constructor(e,n,i,r,s,o){_u(this,"row",void 0),_u(this,"col",void 0),_u(this,"rowspan",void 0),_u(this,"colspan",void 0),_u(this,"removed",!1),_u(this,"cellCoordsFactory",void 0),_u(this,"cellRangeFactory",void 0),BIe(this,Eu,null),this.row=e,this.col=n,this.rowspan=i,this.colspan=r,this.cellCoordsFactory=s,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:i,rowspan:r,colspan:s}=e;return ct`The merged cell declared with {row: ${n}, col: ${i},\x20
      rowspan: ${r}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:i}=e;return ct`The merged cell declared at [${n}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:i}=e;return ct`The merged cell declared at [${n}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:i}=e;return ct`The merged cell declared at [${n}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:i,rowspan:r,colspan:s}=e;return n<0||i<0||r<0||s<0}static isSingleCell(e){let{rowspan:n,colspan:i}=e;return i===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:i}=e;return i===0||n===0}static isOutOfBounds(e,n,i){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const n=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),Rb(Eu,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const i=e[0]||e[1],r=n+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(n,r),l=Math.max(n,r),c=this[o],u=this[o]+this[s]-1;if(c>=n&&(this[o]+=i),i>0)n<=u&&n>c&&(this[s]+=i);else if(i<0){if(a<=c&&l>=u)return this.removed=!0,Rb(Eu,this,null),!1;if(c>=a&&c<=l){const h=l-c+1,d=Math.abs(i)-h;this[o]-=d+i,this[s]-=h}else if(c<=a&&u>=l)this[s]+=i;else if(c<=a&&u>=a&&u<l){const h=u-a+1;this[s]-=h}}return Rb(Eu,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return Bj(Eu,this)||Rb(Eu,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),Bj(Eu,this)}}function UIe(t,e){YIe(t,e),e.add(t)}function YIe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _b(t,e,n){return(e=GIe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GIe(t){var e=qIe(t,"string");return typeof e=="symbol"?e:e+""}function qIe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var $l=new WeakSet;class FC{constructor(e){UIe(this,$l),_b(this,"plugin",void 0),_b(this,"mergedCells",[]),_b(this,"mergedCellsMatrix",new Map),_b(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:i}=e;return ct`The merged cell declared at [${n}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var i;return this.mergedCellsMatrix.has(e)&&(i=this.mergedCellsMatrix.get(e).get(n))!==null&&i!==void 0?i:!1}getByRange(e){const{row:n,col:i}=e.getTopStartCorner(),{row:r,col:s}=e.getBottomEndCorner(),o=this.mergedCells.length;let a=!1;for(let l=0;l<o;l++){const c=this.mergedCells[l],{row:u,col:h,rowspan:d,colspan:f}=c;if(u>=n&&u+d-1<=r&&h>=i&&h+f-1<=s){a=c;break}}return a}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(r=>{const{row:s,col:o,colspan:a,rowspan:l}=r;for(let c=s;c<s+l;c++)for(let u=o;u<o+a;u++)n.add(`r${c},c${u}`)}),e.filter(r=>{const{row:s,col:o,colspan:a,rowspan:l}=r,c=new Set;let u=!1;for(let h=s;h<s+l;h++){for(let d=o;d<o+a;d++){const f=`r${h},c${d}`;if(n.has(f)){Ue(FC.IS_OVERLAPPING_WARNING(r)),u=!0;break}c.add(f)}if(u)break}return u||n.add(...c),!u})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:r}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),a=[];for(let l=i;l<=s;l++)for(let c=r;c<=o;c++){const u=this.get(l,c);u&&(n||!n&&u.row===l&&u.col===c)&&a.push(u)}return a}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=e.row,r=e.col,s=e.rowspan,o=e.colspan,a=new Yo(i,r,s,o,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(i,r),c=n?!1:this.isOverlapping(a);return!l&&!c?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),xu($l,this,Wj).call(this,a),a):(c&&Ue(FC.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,n){const i=this.get(e,n),r=i?this.mergedCells.indexOf(i):-1;return i&&r!==-1?(this.mergedCells.splice(r,1),xu($l,this,KIe).call(this,i),i):!1}clear(){k(this.mergedCells,e=>{let{row:n,col:i,rowspan:r,colspan:s}=e;pe(n,n+r,o=>{pe(i,i+s,a=>{const l=this.hot.getCell(o,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const i=this.get(e,n);if(!i)return!1;const{row:r,col:s,rowspan:o,colspan:a}=i,l=this.hot.view.getActiveOverlayName(),c=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),u=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),h=Ke(c,r,r+o-1),d=Ke(u,s,s+a-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(h,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(d,1)===n}getFirstRenderableCoords(e,n){const i=this.get(e,n);if(!i||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(r,s)}getStartMostColumnIndex(e,n){const i=xu($l,this,Eb).call(this,e,"col",-1);let r=n;for(let s=0;s<i.length;s++)if(i[s]<=n){r=i[s];break}return r}getEndMostColumnIndex(e,n){const i=xu($l,this,Eb).call(this,e,"col",1);let r=n;for(let s=0;s<i.length;s++)if(i[s]>=n){r=i[s];break}return r}getTopMostRowIndex(e,n){const i=xu($l,this,Eb).call(this,e,"row",-1);let r=n;for(let s=0;s<i.length;s++)if(i[s]<=n){r=i[s];break}return r}getBottomMostRowIndex(e,n){const i=xu($l,this,Eb).call(this,e,"row",1);let r=n;for(let s=0;s<i.length;s++)if(i[s]>=n){r=i[s];break}return r}shiftCollections(e,n,i){const r=[0,0];switch(e){case"right":r[0]+=i;break;case"left":r[0]-=i;break;case"down":r[1]+=i;break;case"up":r[1]-=i;break}const s=[];this.mergedCells.forEach(o=>{o.shift(r,n),o.removed&&s.push(o)}),s.forEach(o=>{this.mergedCells.splice(this.mergedCells.indexOf(o),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(o=>{xu($l,this,Wj).call(this,o)})}}function Eb(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,r=n===1?t.getTopStartCorner():t.getBottomEndCorner(),s=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let o=r.row;n===1?o<=s.row:o>=s.row;o+=n)for(let a=r.col;n===1?a<=s.col:a>=s.col;a+=n){const l=e==="row"?o:a,c=this.get(o,a);let u=l;c&&(u=n===1?c[e]+c[`${e}span`]-1:c[e]),i.has(l)||i.set(l,new Set),i.get(l).add(u)}return Array.from(new Set(Array.from(i.entries()).filter(o=>{let[,a]=o;return a.size===1}).flatMap(o=>{let[,a]=o;return Array.from(a)})))}function Wj(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function KIe(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function LT(t,e,n){return(e=XIe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function XIe(t){var e=JIe(t,"string");return typeof e=="symbol"?e:e+""}function JIe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZIe{constructor(e){LT(this,"plugin",void 0),LT(this,"mergedCellsCollection",void 0),LT(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let i=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?i="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?i="up":n[1]===e[1]&&n[2]===e[2]?i="right":i="left",i}snapDragArea(e,n,i,r){const s=n.slice(0),o=this.getAutofillSize(e,n,i),[a,l,c,u]=e,d=["up","down"].indexOf(i)>-1?c-a+1:u-l+1,f=Math.floor(o/d)*d,g=o-f,m=this.getFarthestCollection(e,n,i,r);if(m){if(i==="down"){const p=m.row+m.rowspan-a-g;s[2]+p>=this.plugin.hot.countRows()?s[2]-=g:s[2]+=g?p:0}else if(i==="right"){const p=m.col+m.colspan-l-g;s[3]+p>=this.plugin.hot.countCols()?s[3]-=g:s[3]+=g?p:0}else if(i==="up"){const p=c-g-m.row+1;s[0]+p<0?s[0]+=g:s[0]-=g?p:0}else if(i==="left"){const p=u-g-m.col+1;s[1]+p<0?s[1]+=g:s[1]-=g?p:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:r,fillSize:o,dragArea:s,cycleLength:d}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),On(this.currentFillData,e)}getAutofillSize(e,n,i){const[r,s,o,a]=e,[l,c,u,h]=n;switch(i){case"up":return r-l;case"down":return u-o;case"left":return s-c;case"right":return h-a;default:return null}}getDragArea(e,n,i){const[r,s,o,a]=e,[l,c,u,h]=n;switch(i){case"up":return[l,c,r-1,a];case"down":{const d=this.mergedCellsCollection.get(u,a),f=d?d.rowspan-1:0;return[o+1,s,u+f,a]}case"left":return[l,c,o,s-1];case"right":{const d=this.mergedCellsCollection.get(u,a),f=d?d.colspan-1:0;return[r,a+f,u,h]}default:return null}}getFarthestCollection(e,n,i,r){const[s,o,a,l]=e,c=["up","down"].indexOf(i)>-1,u=c?a:l,h=c?s:o,d=this.getAutofillSize(e,n,i),f=c?a-s+1:l-o+1,g=Math.floor(d/f)*f,m=d-g;let p=null,v=null,b=null;switch(i){case"up":p="includesVertically",b=u-m+1;break;case"left":p="includesHorizontally",b=u-m+1;break;case"down":p="includesVertically",b=h+m-1;break;case"right":p="includesHorizontally",b=h+m-1;break}return k(r,R=>{R[p](b)&&R.isFarther(v,i)&&(v=R)}),v}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,s=(c,u)=>{switch(r){case"up":return c.row-u>=n.from.row;case"down":return c.row+c.rowspan-1+u<=n.to.row;case"left":return c.col-u>=n.from.column;case"right":return c.col+c.colspan-1+u<=n.to.column;default:return null}};let o=0,a=null,l=1;do for(let c=0;c<i.length;c+=1){if(a=i[c],o=l*this.currentFillData.cycleLength,s(a,o))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan},!0);break}c===i.length-1&&(l+=1)}while(s(a,o));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},i={min:null,max:null};return k(e,r=>{const s=r[0],o=this.plugin.hot.propToCol(r[1]);(n.min===null||s<n.min)&&(n.min=s),(n.max===null||s>n.max)&&(n.max=s),(i.min===null||o<i.min)&&(i.min=o),(i.max===null||o>i.max)&&(i.max=o)}),{from:{row:n.min,column:i.min},to:{row:n.max,column:i.max}}}dragAreaOverlapsCollections(e,n,i){const r=this.getDragArea(e,n,i),[s,o,a,l]=r,c=this.plugin.hot._createCellCoords(s,o),u=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(c,c,u);if(this.mergedCellsCollection.getWithinRange(h,!0).length===0)return!1;const f=this.mergedCellsCollection.getWithinRange(h,!1);return f.length===0?!0:i==="up"||i==="down"?!f.every(g=>{let{colspan:m}=g;return m===h.getWidth()}):!f.every(g=>{let{rowspan:m}=g;return m===h.getHeight()})}}function $T(t,e,n){return(e=QIe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QIe(t){var e=eOe(t,"string");return typeof e=="symbol"?e:e+""}function eOe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tOe{constructor(e){$T(this,"plugin",void 0),$T(this,"hot",void 0),$T(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,i,r){const s=Math.min(i[0],i[2]),o=Math.min(i[1],i[3]),a=Math.max(i[0],i[2]),l=Math.max(i[1],i[3]);if(r===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const u=this.plugin.mergedCellsCollection.get(e,n);if(!u)return;const h=u.getLastRow(),d=u.getLastColumn();if(s<=u.row&&o<=u.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${r}`;if(this.isMergeCellFullySelected(u,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const i=[];if(!n||!e)return!1;for(let r=0;r<e.rowspan;r+=1)for(let s=0;s<e.colspan;s+=1)i.push(this.hot._createCellCoords(e.row+r,e.col+s));for(let r=0;r<i.length;r+=1){const s=[];for(let o=0;o<n.length;o+=1)s[o]=n[o].includes(i[r]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function nOe(t){return{key:"mergeCells",name(){const e=this.getSelectedActive();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(b1)}return this.getTranslatedPhrase(v1)},callback(){const e=this.getSelectedRangeActive();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,i.row,i.col,!1)},disabled(){const e=this.getSelectedActive();return e?Yo.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function fp(t,e,n){return(e=iOe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iOe(t){var e=rOe(t,"string");return typeof e=="symbol"?e:e+""}function rOe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jj{constructor(e){fp(this,"data",void 0),fp(this,"next",null),fp(this,"prev",null),this.data=e}}class xb{constructor(){fp(this,"first",null),fp(this,"last",null)}push(e){const n=new jj(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.last;this.last=n,n.prev=i,i.next=n}return n}unshift(e){const n=new jj(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.first;this.first=n,n.next=i,i.prev=n}}inorder(e){let n=this.first;for(;n;){const i=e(n);if(n===this.last||i===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,i,r;for(;n;){if(n.data===e)return i=n.next,r=n.prev,i&&(i.prev=r),r&&(r.next=i),n===this.first&&(this.first=i),n===this.last&&(this.last=r),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,r){r&&(e(r,r.next),r.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,i;for(;e;)i=e.next,e.next=n,n.prev=e,n=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=n,this.last=i}}function sOe(t,e){A4(t,e),e.add(t)}function Tu(t,e,n){A4(t,e),e.set(t,n)}function A4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wt(t,e){return t.get(VC(t,e))}function Lr(t,e,n){return t.set(VC(t,e),n),n}function VC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ao=new WeakMap,Io=new WeakMap,Oo=new WeakMap,Ho=new WeakMap,lA=new WeakMap,Tb=new WeakMap,Mb=new WeakMap,FT=new WeakSet;class oOe{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:i,columnIndexMapper:r}=e;sOe(this,FT),Tu(this,Ao,new xb),Tu(this,Io,new xb),Tu(this,Oo,null),Tu(this,Ho,null),Tu(this,lA,null),Tu(this,Tb,null),Tu(this,Mb,null),Lr(lA,this,n),Lr(Tb,this,i),Lr(Mb,this,r)}getCurrentVerticalNode(){return wt(Ho,this).data}getFirstVerticalNode(){return wt(Io,this).first.data}getNextVerticalNode(){return wt(Ho,this).next.data}getPrevVerticalNode(){return wt(Ho,this).prev.data}getCurrentHorizontalNode(){return wt(Oo,this).data}getFirstHorizontalNode(){return wt(Ao,this).first.data}getNextHorizontalNode(){return wt(Oo,this).next.data}getPrevHorizontalNode(){return wt(Oo,this).prev.data}setPrevNodeAsActive(){Lr(Ho,this,wt(Ho,this).prev),Lr(Oo,this,wt(Oo,this).prev)}setNextNodeAsActive(){Lr(Ho,this,wt(Ho,this).next),Lr(Oo,this,wt(Oo,this).next)}buildFocusOrder(e){Lr(Ao,this,new xb),e.forEach((n,i)=>{const r=new WeakSet,s=n.getTopStartCorner(),o=n.getBottomEndCorner();for(let a=s.row;a<=o.row;a++)if(!wt(Tb,this).isHidden(a))for(let l=s.col;l<=o.col;l++){if(wt(Mb,this).isHidden(l))continue;const c=VC(FT,this,zj).call(this,{selectedRange:n,selectionLayer:i,listOrder:wt(Ao,this),mergeCellsVisitor:r,row:a,column:l});c&&Lr(Oo,this,c)}}),wt(Ao,this).first&&(wt(Ao,this).first.prev=wt(Ao,this).last,wt(Ao,this).last.next=wt(Ao,this).first),Lr(Io,this,new xb),e.forEach((n,i)=>{const r=new WeakSet,s=n.getTopStartCorner(),o=n.getBottomEndCorner();for(let a=s.col;a<=o.col;a++)if(!wt(Mb,this).isHidden(a))for(let l=s.row;l<=o.row;l++){if(wt(Tb,this).isHidden(l))continue;const c=VC(FT,this,zj).call(this,{selectedRange:n,selectionLayer:i,listOrder:wt(Io,this),mergeCellsVisitor:r,row:l,column:a});c&&Lr(Ho,this,c)}}),wt(Io,this).first&&(wt(Io,this).first.prev=wt(Io,this).last,wt(Io,this).last.next=wt(Io,this).first)}setActiveNode(e,n,i){return wt(Ao,this).inorder(r=>{const{selectionLayer:s,rowStart:o,rowEnd:a,colStart:l,colEnd:c}=r.data;if(s===i&&e>=o&&e<=a&&n>=l&&n<=c)return Lr(Oo,this,r),!0}),wt(Io,this).inorder(r=>{const{selectionLayer:s,rowStart:o,rowEnd:a,colStart:l,colEnd:c}=r.data;if(s===i&&e>=o&&e<=a&&n>=l&&n<=c)return Lr(Ho,this,r),!0}),this}}function zj(t){let{selectedRange:e,selectionLayer:n,listOrder:i,mergeCellsVisitor:r,row:s,column:o}=t;const a=e.getTopStartCorner(),l=e.getBottomEndCorner(),c=e.highlight.clone().normalize(),u=wt(lA,this).call(this,s,o);if(u&&r.has(u))return null;const h={selectionLayer:n,colStart:o,colEnd:o,rowStart:s,rowEnd:s};if(u){if(r.add(u),u.row<a.row||u.row+u.rowspan-1>l.row||u.col<a.col||u.col+u.colspan-1>l.col)return null;h.colStart=u.col,h.colEnd=u.col+u.colspan-1,h.rowStart=u.row,h.rowEnd=u.row+u.rowspan-1}const d=i.push(h);return s===c.row&&o===c.col||u&&c.row>=u.row&&c.row<=u.row+u.rowspan-1&&c.col>=u.col&&c.col<=u.col+u.colspan-1?d:null}function I4(t,e,n){const{rowIndexMapper:i,stylesHandler:r}=t;let s=0;for(let a=e;a<e+n;a++)if(!i.isHidden(a)){var o;s+=(o=t.getRowHeight(a))!==null&&o!==void 0?o:r.getDefaultRowHeight(a)}return s}function aOe(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:i}=e,r=new Map;function s(){}function o(a,l,c){const u=t.mergedCellsCollection.get(l,c);if(!Re(u)){a.removeAttribute("rowspan"),a.removeAttribute("colspan"),r.has(l)&&!e.getSettings().rowHeaders&&(a.style.height=`${r.get(l)}px`,r.delete(l)),a.style.display="";return}const{row:h,col:d,colspan:f,rowspan:g}=u,[m,p]=t.translateMergedCellToRenderable(h,g,d,f),v=t.getSetting("virtualized");if(d===0&&!e.getSettings().rowHeaders){const N=e._getRowHeightFromSettings(l);if(N!==void 0){const j=e.stylesHandler.areCellsBorderBox()?0:1;r.set(l,N-j)}else if(Sw()){const G=I4(e,h,g);r.set(l,G/g)}}const b=n.getRenderableFromVisualIndex(l),R=i.getRenderableFromVisualIndex(c),S=m-b+1,x=p-R+1;let M=n.getNearestNotHiddenIndex(h,1),T=i.getNearestNotHiddenIndex(d,1);if(v){const N=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(N)||(M=Math.max(M,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(N)||(T=Math.max(T,e.getFirstRenderedVisibleColumn()))}const O=Math.min(g,S),W=Math.min(f,x);M===l&&T===c?(a.setAttribute("rowspan",O),a.setAttribute("colspan",W)):(a.removeAttribute("rowspan"),a.removeAttribute("colspan"),a.style.display="none")}return{before:s,after:o}}function lOe(t,e){O4(t,e),e.add(t)}function Pb(t,e,n){O4(t,e),e.set(t,n)}function O4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function VT(t,e,n){return(e=cOe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cOe(t){var e=uOe(t,"string");return typeof e=="symbol"?e:e+""}function uOe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qp(t,e,n){return t.set(Ct(t,e),n),n}function It(t,e){return t.get(Ct(t,e))}function Ct(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}le.getSingleton().register("beforeMergeCells");le.getSingleton().register("afterMergeCells");le.getSingleton().register("beforeUnmergeCells");le.getSingleton().register("afterUnmergeCells");const cA="mergeCells",hOe=150,Uj=cA;var _s=new WeakMap,Es=new WeakMap,ta=new WeakMap,Yj=new WeakMap,Et=new WeakSet;class dOe extends et{constructor(){super(...arguments),lOe(this,Et),VT(this,"mergedCellsCollection",null),VT(this,"autofillCalculations",null),VT(this,"selectionCalculations",null),Pb(this,_s,null),Pb(this,Es,{row:0,col:0}),Pb(this,ta,new oOe({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Pb(this,Yj,aOe(this))}static get PLUGIN_KEY(){return cA}static get PLUGIN_PRIORITY(){return hOe}static get DEFAULT_SETTINGS(){return{[K3]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[cA]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new FC(this),this.autofillCalculations=new ZIe(this),this.selectionCalculations=new tOe(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,fOe).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,mOe).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,pOe).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,wOe).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,vOe).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,qj).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,qj).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,yOe).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,COe).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,SOe).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,Gj).call(e,...i)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,Gj).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,gOe).call(e,...i)}),this.addHook("afterRenderer",function(){return It(Yj,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,bOe).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,ROe).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,_Oe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,EOe).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,xOe).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,TOe).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,MOe).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,POe).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,AOe).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,IOe).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,OOe).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,HOe).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,kOe).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,DOe).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ct(Et,e,NOe).call(e,...i)}),this.addHook("beforeUndoStackChange",(n,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!uO())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:r,rowspan:s}=i;for(let o=r+1;o<r+s;o++)n.push(o)}),n=[...new Set(n)],n.forEach(i=>{const r=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>s?.name==="master"?s:s.clone.wtTable).forEach(s=>{const o=s.getRow(r);o&&(o.style.background=kp(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{var r;i.style.background=(r=kp(i,"backgroundColor"))===null||r===void 0?void 0:r.replace(", 0.99)",")")})},1)}validateSetting(e){return e?Yo.containsNegativeValues(e)?(Ue(Yo.NEGATIVE_VALUES_WARNING(e)),!1):Yo.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(Ue(Yo.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Yo.isSingleCell(e)?(Ue(Yo.IS_SINGLE_CELL(e)),!1):Yo.containsZeroSpan(e)?(Ue(Yo.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(r=>this.validateSetting(r)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),i=[];n.forEach(r=>{const{row:s,col:o,rowspan:a,colspan:l}=r,c=this.hot._createCellCoords(s,o),u=this.hot._createCellCoords(s+a-1,o+l-1),h=this.hot._createCellRange(c,c,u);this.mergeRange(h,!0,!0);for(let d=s;d<s+a;d++)for(let f=o;f<o+l;f++)(d!==s||f!==o)&&i.push([d,f,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;const{from:n,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=e.getTopStartCorner(),s=e.getBottomEndCorner(),o={row:r.row,col:r.col,rowspan:s.row-r.row+1,colspan:s.col-r.col+1},a=[];let l=null;return this.canMergeRange(o,n)?(this.hot.runHooks("beforeMergeCells",e,n),pe(0,o.rowspan-1,u=>{pe(0,o.colspan-1,h=>{let d=null;a[u]||(a[u]=[]),u===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+u,o.col+h,"hidden",!0),a[u][h]=d})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o,n)?(i?l=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,n),l):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),k(i,r=>{this.mergedCellsCollection.remove(r.row,r.col),pe(0,r.rowspan-1,s=>{pe(0,r.colspan-1,o=>{this.hot.removeCellMeta(r.row+s,r.col+o,"hidden"),this.hot.removeCellMeta(r.row+s,r.col+o,"copyable")})}),this.hot.removeCellMeta(r.row,r.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:i}=e.clone().normalize(),r=this.mergedCellsCollection.get(n.row,n.col);r.row===n.row&&r.col===n.col&&r.row+r.rowspan-1===i.row&&r.col+r.colspan-1===i.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,i,r){const s=this.hot._createCellCoords(e,n),o=this.hot._createCellCoords(i,r);this.mergeRange(this.hot._createCellRange(s,s,o))}unmerge(e,n,i,r){const s=this.hot._createCellCoords(e,n),o=this.hot._createCellCoords(i,r);this.unmergeRange(this.hot._createCellRange(s,s,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeActive();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:Uj})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Uj)}modifyViewportRowStart(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(r,s);if(Re(o)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(r,s);if(Re(o)){const a=o.row+o.rowspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(s,r);if(Re(o)){const a=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<n;s+=1){const o=this.mergedCellsCollection.get(s,r);if(Re(o)){const a=o.col+o.colspan-1,l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,i,r){const{rowIndexMapper:s,columnIndexMapper:o}=this.hot;let a,l;n===0?a=s.getNearestNotHiddenIndex(e,1):a=s.getNearestNotHiddenIndex(e+n-1,-1),r===0?l=o.getNearestNotHiddenIndex(i,1):l=o.getNearestNotHiddenIndex(i+r-1,-1);const c=e>=0?s.getRenderableFromVisualIndex(a):e,u=i>=0?o.getRenderableFromVisualIndex(l):i;return[c,u]}}function fOe(){this.generateFromSettings(),this.hot.render()}function gOe(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeActive(),i=n.getTopStartCorner(),r=n.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(i.row===e[s].row&&i.col===e[s].col&&r.row===e[s].row+e[s].rowspan-1&&r.col===e[s].col+e[s].colspan-1)return!1}return t}function mOe(t){It(Es,this).row=t.row,It(Es,this).col=t.col}function pOe(t){const e=this.hot.getSelectedRangeActive(),{highlight:n}=e,{columnIndexMapper:i,rowIndexMapper:r}=this.hot;It(_s,this)&&(r.getRenderableFromVisualIndex(It(_s,this).row)!==null&&(n.row=It(_s,this).row),i.getRenderableFromVisualIndex(It(_s,this).col)!==null&&(n.col=It(_s,this).col),qp(_s,this,null));const s=this.mergedCellsCollection.get(n.row,n.col);if(!s)return;const o=s.col,a=s.col+s.colspan-1;if(t.col<0){const u=n.col>=o&&n.col<=a?o-1:a,h=i.getNearestNotHiddenIndex(u,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,n.col)-1,1)}else if(t.col>0){const u=n.col>=o&&n.col<=a?a+1:o,h=i.getNearestNotHiddenIndex(u,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,h)-1,1)}const l=s.row,c=s.row+s.rowspan-1;if(t.row<0){const u=n.row>=l&&n.row<=c?l-1:c,h=r.getNearestNotHiddenIndex(u,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,n.row)-1,1)}else if(t.row>0){const u=n.row>=l&&n.row<=c?c+1:l,h=r.getNearestNotHiddenIndex(u,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,h)-1,1)}}function wOe(t){const e=this.hot.getSelectedRangeActive(),n=e.clone(),{to:i}=e,{columnIndexMapper:r,rowIndexMapper:s}=this.hot,o=(a,l)=>{n.expand(this.hot._createCellCoords(a,l));for(let c=0;c<this.mergedCellsCollection.mergedCells.length;c+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[c].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+t.col;o(i.row,a),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(a=n.getTopStartCorner().col);const l=r.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,i.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+t.col;o(i.row,a),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(a=n.getBottomEndCorner().col);const l=r.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+t.row;o(a,i.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(a=n.getTopStartCorner().row);const l=s.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,i.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+t.row;o(a,i.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(a=n.getBottomStartCorner().row);const l=s.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,l)-1,1))}}function vOe(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){qp(_s,this,e.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);qp(_s,this,e.clone()),n&&e.assign(n)}function Gj(t,e,n,i){if(t<0||e<0)return;const r=this.mergedCellsCollection.get(t,e);if(!r)return;const{row:s,col:o,colspan:a,rowspan:l}=r,c=s,u=o,h=s+l-1,d=o+a-1;if(i==="render"&&this.getSetting("virtualized")){const f=this.hot.view.getActiveOverlayName(),g=["top","top_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleRow(),m=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(f)?0:this.hot.getFirstRenderedVisibleColumn();return[Ke(g,c,h),Ke(m,u,d),Ke(this.hot.getLastRenderedVisibleRow(),c,h),Ke(this.hot.getLastRenderedVisibleColumn(),u,d)]}return[c,u,h,d]}function bOe(t){t.items.push({name:"---------"},nOe(this))}function qj(){qp(_s,this,null)}function yOe(){if(It(_s,this).isCell())return;const t=this.hot.getSelectedRangeActive(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),i=It(_s,this).clone().normalize();It(ta,this).setActiveNode(i.row,i.col),It(Es,this).row>0||It(Es,this).col>0?It(ta,this).setPrevNodeAsActive():(n==="E-W"&&It(Es,this).col<0||e==="S-N"&&It(Es,this).row<0)&&It(ta,this).setNextNodeAsActive()}function COe(t,e){const{columnIndexMapper:n,rowIndexMapper:i}=this.hot;let r=this.hot.getActiveSelectionLayerIndex(),s=null,o=null;if(It(Es,this).col<0){const{rowEnd:a,colEnd:l,selectionLayer:c}=It(ta,this).getPrevHorizontalNode();o=n.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1),r=c}else if(It(Es,this).col>0){const{rowStart:a,colStart:l,selectionLayer:c}=It(ta,this).getNextHorizontalNode();o=n.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1),r=c}else if(It(Es,this).row<0){const{rowEnd:a,colEnd:l,selectionLayer:c}=It(ta,this).getPrevVerticalNode();o=n.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1),r=c}else if(It(Es,this).row>0){const{rowStart:a,colStart:l,selectionLayer:c}=It(ta,this).getNextVerticalNode();o=n.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1),r=c}if(s!==null||o!==null){this.hot.selection.setActiveSelectionLayerIndex(r);const a=this.hot.getSelectedRangeActive(),l=this.hot._createCellCoords(s,o),c=this.mergedCellsCollection.get(l.row,l.col),u=this.hot.selection.highlight.getFocus();t=l.row,e=l.col,c?a.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(c.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(c.col,1)}):a.highlight.assign(l),u.clear(),u.add(l).commit()}It(ta,this).setActiveNode(t,e,r),qp(Es,this,{row:0,col:0})}function SOe(){It(ta,this).buildFocusOrder(this.hot.getSelectedRange())}function ROe(t,e,n){const i=this.mergedCellsCollection.get(t,e);i&&(i.row!==t||i.col!==e?n.copyable=!1:(n.rowspan=i.rowspan,n.colspan=i.colspan))}function _Oe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function EOe(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function xOe(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const i=this.hot._createCellCoords(e[0],e[1]),r=this.hot._createCellCoords(e[2],e[3]),s=this.hot._createCellRange(i,i,r),o=this.mergedCellsCollection.getWithinRange(s);return o.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,o)}function TOe(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function MOe(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function POe(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function AOe(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function IOe(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function OOe(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeActive(),i=this.mergedCellsCollection.getWithinRange(n);k(i,r=>{n.getBottomEndCorner().row===r.getLastRow()&&n.getBottomEndCorner().col===r.getLastColumn()&&(t[2]=r.row,t[3]=r.col)})}}function HOe(t,e,n,i){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,i)}function kOe(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function DOe(t,e,n,i){if(!(i instanceof MouseEvent))return;const r=this.hot.getSelectedRangeActive(),s=this.mergedCellsCollection.getByRange(r);if(!s)return;const o=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&r.isEqual(this.hot._createCellRange(o,o,a))}function NOe(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let i,r;if(n==="master")i=this.hot.getFirstRenderedVisibleColumn(),r=this.hot.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(n);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return t;const o=this.hot._createCellCoords(e,i),a=this.hot._createCellCoords(e,r),l=this.hot._createCellRange(o,o,a),c=this.mergedCellsCollection.getWithinRange(l,!0),u=c.reduce((d,f)=>{let{rowspan:g}=f;return Math.max(d,g)},1);let h=0;return c.length>1&&c[0].rowspan<u&&(h=u-c[0].rowspan),c.forEach(d=>{let{rowspan:f}=d,g=0;n==="top"||n==="top_inline_start_corner"?g=Math.min(u,this.hot.view.countNotHiddenFixedRowsTop()-e):g=f-h,t=Math.max(t??0,I4(this.hot,e,g))}),t}function LOe(t,e){return function(n,i){const[,...r]=n,[,...s]=i;return(function o(a){const l=t[a],c=e[a],u=r[a],h=s[a],d=c.multiColumnSorting,g=(d.compareFunctionFactory?d.compareFunctionFactory:oX(c.type))(l,c,d)(u,h);if(g===oa){const m=a+1;if(typeof e[m]<"u")return o(m)}return g})(0)}}const H4="sort";function $Oe(t,e,n){const i=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&i.push(`${H4}-${t.getIndexOfColumnInSortQueue(e)+1}`),i}function FOe(t){const e=t.className.split(" "),n=new RegExp(`^${H4}-[0-9]{1,2}$`);return e.filter(i=>n.test(i))}function VOe(t,e,n){return(e=BOe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BOe(t){var e=WOe(t,"string");return typeof e=="symbol"?e:e+""}function WOe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const BC="multiColumnSorting",jOe=170,Kj=BC;sX(BC,LOe);class zOe extends mX{constructor(){super(...arguments),VOe(this,"pluginKey",BC)}static get PLUGIN_KEY(){return BC}static get PLUGIN_PRIORITY(){return jOe}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,CC)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:Vc,position:"before",group:Kj})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Kj)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];super.updateHeaderClasses(e,...i),ue(e,FOe(e)),this.enabled!==!1&&q(e,$Oe(...i))}onAfterOnCellMouseDown(e,n){gk(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,CC))):this.sort(this.getColumnNextConfig(n.col)))}}function Xj(t,e,n){return(e=UOe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function UOe(t){var e=YOe(t,"string");return typeof e=="symbol"?e:e+""}function YOe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const GOe="multipleSelectionHandles",qOe=160;class KOe extends et{constructor(){super(...arguments),Xj(this,"dragged",[]),Xj(this,"lastSetCell",null)}static get PLUGIN_KEY(){return GOe}static get PLUGIN_PRIORITY(){return qOe}isEnabled(){return ro()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function i(r){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(r);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",r=>{let s;if(Ee(r.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeActive(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},r.preventDefault(),!1;if(Ee(r.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeActive(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",r=>{if(Ee(r.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,r.preventDefault(),!1;if(Ee(r.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",r=>{const{rootDocument:s}=this.hot;let o,a,l,c,u,h;if(e.dragged.length===0)return;const d=s.elementFromPoint(r.touches[0].clientX,r.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(o=e.hot.getCoords(d),o.col===-1&&(o.col=0),a=e.hot.getSelectedRangeActive(),l=a.getWidth(),c=a.getHeight(),u=a.getDirection(),l===1&&c===1&&e.hot.selection.setRangeEnd(o),h=e.getCurrentRangeCoords(a,o,e.touchStartRange.direction,u,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),r.preventDefault())})}getCurrentRangeCoords(e,n,i,r,s){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),c=e.getTopEndCorner();let u={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":s==="top"?u={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(l.row,n.col)}:u={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,o.col)};break;case"SE-NW":s==="bottom"&&(u={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,o.col)});break}break;case"NW-SE":switch(r){case"NE-SW":s==="top"?u={start:n,end:l}:u.end=n;break;case"NW-SE":s==="top"?u={start:n,end:a}:u.end=n;break;case"SE-NW":s==="top"?u={start:n,end:o}:u.end=n;break;case"SW-NE":s==="top"?u={start:n,end:c}:u.end=n;break}break;case"SW-NE":switch(r){case"NW-SE":s==="bottom"?u={start:this.hot._createCellCoords(n.row,o.col),end:this.hot._createCellCoords(l.row,n.col)}:u={start:this.hot._createCellCoords(o.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SW-NE":s==="top"?u={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)}:u={start:this.hot._createCellCoords(n.row,o.col),end:this.hot._createCellCoords(o.row,n.col)};break;case"SE-NW":s==="bottom"?u={start:this.hot._createCellCoords(n.row,c.col),end:this.hot._createCellCoords(o.row,n.col)}:s==="top"&&(u={start:l,end:n});break}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(u.end=n);break;case"SE-NW":s==="top"?u.end=n:u={start:n,end:o};break}break}return u}isDragged(){return this.dragged.length>0}}function uA(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:i=!1,crossHiddenColumns:r=[],isCollapsed:s=!1,isHidden:o=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:c=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:i,isCollapsed:s,crossHiddenColumns:r,isHidden:o,isRoot:a,isPlaceholder:l,headerClassNames:c}}function k4(){return{label:"",isPlaceholder:!0}}function XOe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;k(t,r=>{const s=[];let o=0;n.push(s),k(r,a=>{const l=uA();if(Re(a)){const{label:u,colspan:h,headerClassName:d}=a;l.label=Pt(u),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=Pt(a);o+=l.origColspan;let c=!1;if(o>=e&&(l.colspan=l.origColspan-(o-e),l.origColspan=l.colspan,c=!0),s.push(l),l.colspan>1)for(let u=0;u<l.colspan-1;u++)s.push(k4());return!c})});const i=Math.max(...lt(n,r=>r.length));return k(n,r=>{if(r.length<i){const s=lt(new Array(i-r.length),()=>uA());r.splice(r.length,0,...s)}}),n}function BT(t,e,n){JOe(t,e),e.set(t,n)}function JOe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ws(t,e){return t.get(D4(t,e))}function gm(t,e,n){return t.set(D4(t,e),n),n}function D4(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Jj=["label","collapsible"];var Oa=new WeakMap,Mu=new WeakMap,WT=new WeakMap;class ZOe{constructor(){BT(this,Oa,[]),BT(this,Mu,0),BT(this,WT,1/0)}setColumnsLimit(e){gm(WT,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];gm(Oa,this,XOe(e,Ws(WT,this))),gm(Mu,this,Ws(Oa,this).length)}getData(){return Ws(Oa,this)}mergeWith(e){k(e,n=>{let{row:i,col:r,...s}=n;const o=this.getHeaderSettings(i,r);o!==null&&On(o,s,Jj)})}map(e){k(Ws(Oa,this),n=>{k(n,i=>{const r=e({...i});Re(r)&&On(i,r,Jj)})})}getHeaderSettings(e,n){var i;if(e>=Ws(Mu,this)||e<0)return null;const r=Ws(Oa,this)[e];return Array.isArray(r)===!1||n>=r.length?null:(i=r[n])!==null&&i!==void 0?i:null}getHeadersSettings(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=[];if(e>=Ws(Mu,this)||e<0)return r;const s=Ws(Oa,this)[e];let o=0;for(let a=n;a<s.length;a++){const l=s[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=l.colspan,r.push(l),l.colspan>1&&(a+=l.colspan-1),o===i)break;if(o>i)throw new Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return Ws(Mu,this)}getColumnsCount(){return Ws(Mu,this)>0?Ws(Oa,this)[0].length:0}clear(){gm(Oa,this,[]),gm(Mu,this,0)}}function jT(t,e,n){return(e=QOe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function QOe(t){var e=e1e(t,"string");return typeof e=="symbol"?e:e+""}function e1e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const N4="DF-pre-order";function L4(t,e){let n=t.call(e,this);for(let i=0;i<this.childs.length;i++){if(n===!1)return!1;n=L4.call(this.childs[i],t,e)}return n}const t1e="DF-post-order";function $4(t,e){for(let n=0;n<this.childs.length;n++)if($4.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const F4="BF";function n1e(t,e){const n=[this];function i(){if(n.length===0)return;const r=n.shift();n.push(...r.childs),t.call(e,r)!==!1&&i()}i()}const i1e=F4,Zj=new Map([[N4,L4],[t1e,$4],[F4,n1e]]);class WC{constructor(e){jT(this,"data",{}),jT(this,"parent",null),jT(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new WC({...e.data});for(let i=0;i<e.childs.length;i++)n.addChild(this.cloneTree(e.childs[i]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:i1e;if(!Zj.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);Zj.get(n).call(this,e,this)}walkUp(e){const n=this,i=r=>{e.call(n,r)!==!1&&r.parent!==null&&i(r.parent)};i(this)}}function zT(t,e,n){r1e(t,e),e.set(t,n)}function r1e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zi(t,e){return t.get(V4(t,e))}function s1e(t,e,n){return t.set(V4(t,e),n),n}function V4(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Id=new WeakMap,Pu=new WeakMap,Od=new WeakMap;class o1e{constructor(e){zT(this,Id,new Map),zT(this,Pu,new Map),zT(this,Od,null),s1e(Od,this,e)}getRoots(){return Array.from(zi(Id,this).values())}getRootByColumn(e){let n;return zi(Pu,this).has(e)&&(n=zi(Id,this).get(zi(Pu,this).get(e))),n}getNode(e,n){const i=this.getRootByColumn(n);if(!i)return;const r=n-zi(Pu,this).get(n);let s=0,o;return i.walkDown(a=>{const{data:{origColspan:l,headerLevel:c}}=a;if(e===c){if(r>=s&&r<=s+l-1)return o=a,o.data.isRoot=n===o.data.columnIndex,!1;s+=l}}),o}rebuildTreeIndex(){let e=0;zi(Pu,this).clear(),k(zi(Id,this),n=>{let[,{data:{colspan:i}}]=n;for(let r=e;r<e+i;r++)zi(Pu,this).set(r,e);e+=i})}buildTree(){this.clear();const e=zi(Od,this).getColumnsCount();let n=0;for(;n<e;){const i=zi(Od,this).getHeaderSettings(0,n),r=new WC;zi(Id,this).set(n,r),this.buildLeaves(r,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=zi(Od,this).getHeadersSettings(i,n,r);i+=1,k(s,o=>{const a={...o,headerLevel:i-1,columnIndex:n};let l;i===1?(e.data=a,l=e):(l=new WC(a),e.addChild(l)),i<zi(Od,this).getLayersCount()&&this.buildLeaves(l,n,i,o.origColspan),n+=o.origColspan})}clear(){zi(Id,this).clear(),zi(Pu,this).clear()}}function B4(t,e){t.walkDown(n=>{let{data:i,childs:r}=n;if(!i.isHidden&&(e(i.columnIndex),r.length===0))for(let s=1;s<i.colspan;s++)e(i.columnIndex+s)})}function jC(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function zC(t){return jC(t,"origColspan")===t.data.origColspan}function Pk(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(zC(t))return Pk(n[0]);e.isCollapsed=!1;const r=n.slice(1),s=new Set;let o=0;if(r.length>0)k(r,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;o+=l.colspan,B4(a,c=>{s.add(c)})});else{const{colspan:a,origColspan:l,columnIndex:c}=e;o=l-a;for(let u=1;u<l;u++)s.add(c+u)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=o,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):zC(a)&&(l.isCollapsed=jC(a,"isCollapsed"))}),{rollbackModification:()=>Ak(t),affectedColumns:Array.from(s),colspanCompensation:o}}function Ak(t){var e;const{data:n,childs:i}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(zC(t))return Ak(i[0]);n.isCollapsed=!0;const s=i.slice(1),o=new Set;if(s.length>0)k(s,l=>{B4(l,c=>{o.add(c)}),l.data.clonedTree=l.cloneTree(),l.walkDown(c=>{let{data:u}=c;u.isHidden=!0})});else{const{origColspan:l,columnIndex:c}=n;for(let u=1;u<l;u++){const h=c+u;o.add(h)}}const a=n.colspan-((e=jC(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:c}=l;c.colspan-=a,c.colspan<=1?(c.colspan=1,c.isCollapsed=!0):zC(l)&&(c.isCollapsed=jC(l,"isCollapsed"))}),{rollbackModification:()=>Pk(t),affectedColumns:Array.from(o),colspanCompensation:a}}function a1e(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ct`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:s}}=r;if(s)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:s}=r;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function l1e(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(ct`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:s}}=r;if(s)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:s}=r;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const Qj=new Map([["collapse",Ak],["expand",Pk],["hide-column",a1e],["show-column",l1e]]);function c1e(t,e,n){if(!Qj.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return Qj.get(t)(e,n)}function Ab(t){const e=[];return k(t,n=>{n.walkDown(i=>{const r=i.data,{origColspan:s,columnIndex:o,headerLevel:a,crossHiddenColumns:l}=r,c=h1e(e,a);let u=!1;for(let h=o;h<o+s;h++)if(l.includes(h)||u)c.push(k4());else{const f=u1e(r);f.isRoot=!0,c.push(f),u=!0}})}),e}function u1e(t){const{crossHiddenColumns:e,...n}=uA(t);return n}function h1e(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function UT(t,e,n){d1e(t,e),e.set(t,n)}function d1e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mm(t,e,n){return t.set(W4(t,e),n),n}function tn(t,e){return t.get(W4(t,e))}function W4(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ko=new WeakMap,fr=new WeakMap,Au=new WeakMap;class f1e{constructor(){UT(this,ko,new ZOe),UT(this,fr,new o1e(tn(ko,this))),UT(this,Au,[[]])}setState(e){tn(ko,this).setData(e);let n=!1;try{tn(fr,this).buildTree()}catch{tn(fr,this).clear(),tn(ko,this).clear(),n=!0}return mm(Au,this,Ab(tn(fr,this).getRoots())),n}setColumnsLimit(e){tn(ko,this).setColumnsLimit(e)}mergeStateWith(e){const n=lt(e,i=>{let{row:r,...s}=i;return{row:r<0?this.rowCoordsToLevel(r):r,...s}});tn(ko,this).mergeWith(n),tn(fr,this).buildTree(),mm(Au,this,Ab(tn(fr,this).getRoots()))}mapState(e){tn(ko,this).map(e),tn(fr,this).buildTree(),mm(Au,this,Ab(tn(fr,this).getRoots()))}mapNodes(e){return Un(tn(fr,this).getRoots(),(n,i)=>(i.walkDown(r=>{const s=e(r.data);s!==void 0&&n.push(s)}),n),[])}triggerNodeModification(e,n,i){n<0&&(n=this.rowCoordsToLevel(n));const r=tn(fr,this).getNode(n,i);let s;return r&&(s=c1e(e,r,i),mm(Au,this,Ab(tn(fr,this).getRoots()))),s}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var i,r;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(r=tn(Au,this)[e])===null||r===void 0?void 0:r[n])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,n){const i=this.getHeaderTreeNode(e,n);return i?{...i.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=tn(fr,this).getNode(e,n);return i||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=n-e+1;let r=!1,s=null;for(let o=e;o<=n;o++){const a=tn(fr,this).getRootByColumn(o);if(!a)break;r=!0,a.walkDown(l=>{const{columnIndex:c,headerLevel:u,origColspan:h,isHidden:d}=l.data;d||h<=i&&c>=e&&c+h-1<=n&&(s===null||u<s)&&(s=u)},N4)}return r&&s===null?-1:this.levelToRowCoords(s??0)}findLeftMostColumnIndex(e,n){var i;const{isRoot:r}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0};if(r)return n;let s=n-1;for(;s>=0;){var o;const{isRoot:a}=(o=this.getHeaderSettings(e,s))!==null&&o!==void 0?o:{isRoot:!0};if(a)break;s-=1}return s}findRightMostColumnIndex(e,n){var i;const{isRoot:r,origColspan:s}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(r)return n+s-1;let o=n+1;for(;o<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;o+=1}return o-1}getLayersCount(){return tn(ko,this).getLayersCount()}getColumnsCount(){return tn(ko,this).getColumnsCount()}clear(){mm(Au,this,[]),tn(ko,this).clear(),tn(fr,this).clear()}}function pm(t,e,n){return(e=g1e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function g1e(t){var e=m1e(t,"string");return typeof e=="symbol"?e:e+""}function m1e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class p1e{constructor(e,n){pm(this,"hot",void 0),pm(this,"nestedHeaderSettingsGetter",void 0),pm(this,"layersCount",0),pm(this,"container",void 0),pm(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),i=n.length;this.widthsMap.clear();for(let r=0;r<i;r++){const s=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),o=this.hot.toPhysicalColumn(s);this.widthsMap.setValueAtIndex(o,n[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:i}=this.hot,r=n.createDocumentFragment(),s=n.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=i.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const c=n.createElement("tr");for(let u=0;u<a;u++){let h=i.getVisualFromRenderableIndex(u);h===null&&(h=u);const d=n.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let g=f.label;o&&(g+='<button class="changeType"></button>'),$c(d,g),d.colSpan=f.colspan,c.appendChild(d)}}s.appendChild(c)}r.appendChild(s),e.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}}function w1e(t,e){j4(t,e),e.add(t)}function ez(t,e,n){return(e=v1e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function v1e(t){var e=b1e(t,"string");return typeof e=="symbol"?e:e+""}function b1e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hd(t,e,n){j4(t,e),e.set(t,n)}function j4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tl(t,e,n){return t.set(qn(t,e),n),n}function Ve(t,e){return t.get(qn(t,e))}function qn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const tz="nestedHeaders",y1e=280;var Rt=new WeakMap,Fl=new WeakMap,gp=new WeakMap,x0=new WeakMap,UC=new WeakMap,Iu=new WeakMap,ii=new WeakSet;class C1e extends et{constructor(){super(...arguments),w1e(this,ii),Hd(this,Rt,new f1e),Hd(this,Fl,null),Hd(this,gp,null),Hd(this,x0,!1),Hd(this,UC,null),ez(this,"ghostTable",new p1e(this.hot,(e,n)=>this.getHeaderSettings(e,n))),ez(this,"detectedOverlappedHeaders",!1),Hd(this,Iu,()=>{var e;const n=(e=this.hot)===null||e===void 0?void 0:e.getSelectedRangeActive();if(!n)return;const{highlight:i}=n;if(i.isHeader()&&i.col>=0){const s=Ve(Rt,this).findLeftMostColumnIndex(i.row,i.col),o=this.hot.selection.highlight.getFocus();o.visualCellRange.highlight.col=s,o.visualCellRange.from.col=s,o.visualCellRange.to.col=s,o.commit()}})}static get PLUGIN_KEY(){return tz}static get PLUGIN_PRIORITY(){return y1e}isEnabled(){return!!this.hot.getSettings()[tz]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&Ue(ct`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>qn(ii,this,L1e).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qn(ii,e,$1e).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qn(ii,e,E1e).call(e,...r)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qn(ii,e,x1e).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qn(ii,e,T1e).call(e,...r)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qn(ii,e,M1e).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qn(ii,e,P1e).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qn(ii,e,A1e).call(e,...r)}),this.addHook("afterSelection",()=>Ve(Iu,this).call(this)),this.addHook("afterSelectionFocusSet",()=>Ve(Iu,this).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qn(ii,e,S1e).call(e,...r)}),this.addHook("afterGetColumnHeaderRenderers",i=>qn(ii,this,O1e).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qn(ii,e,k1e).call(e,...r)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qn(ii,e,D1e).call(e,...r)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qn(ii,e,R1e).call(e,...r)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qn(ii,e,_1e).call(e,...r)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qn(ii,e,I1e).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qn(ii,e,H1e).call(e,...r)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return qn(ii,e,N1e).call(e,...r)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",Ve(Iu,this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",Ve(Iu,this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Ve(Rt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Ve(Rt,this).setState(e)),this.detectedOverlappedHeaders&&Ue(ct`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,i)=>{const r=n===!0?"hide-column":"show-column";Ve(Rt,this).triggerColumnModification(r,i)}),!Ve(Fl,this)&&this.enabled&&tl(Fl,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(i=>{let{op:r,index:s,newValue:o}=i;if(r==="replace"){const a=o===!0?"hide-column":"show-column";Ve(Rt,this).triggerColumnModification(a,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",Ve(Iu,this)),this.hot.columnIndexMapper.removeLocalHook("cacheUpdated",Ve(Iu,this)),this.clearColspans(),Ve(Rt,this).clear(),Ve(Fl,this).unsubscribe(),tl(Fl,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Ve(Rt,this)}getLayersCount(){return Ve(Rt,this).getLayersCount()}getHeaderSettings(e,n){return Ve(Rt,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<n;o++){const a=i.childNodes[o];if(!a)break;const l=r.childNodes[o],c=s?s.childNodes[o]:null;for(let u=0,h=a.childNodes.length;u<h;u++)a.childNodes[u].removeAttribute("colspan"),ue(a.childNodes[u],"hiddenHeader"),l&&l.childNodes[u]&&(l.childNodes[u].removeAttribute("colspan"),ue(l.childNodes[u],"hiddenHeader")),s&&c&&c.childNodes[u]&&(c.childNodes[u].removeAttribute("colspan"),ue(c.childNodes[u],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,s)=>{var o;const{columnIndexMapper:a,view:l}=this.hot;let c=a.getVisualFromRenderableIndex(r);c===null&&(c=r),s.removeAttribute("colspan"),ue(s,"hiddenHeader"),ue(s,"hiddenHeaderText");const{colspan:u,isHidden:h,isPlaceholder:d,headerClassNames:f}=(o=Ve(Rt,this).getHeaderSettings(e,c))!==null&&o!==void 0?o:{};if(d||h)q(s,"hiddenHeader");else if(u>1){var g,m,p;const{wtOverlays:v}=l._wt,b=(g=v.topInlineStartCornerOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(s),R=(m=v.inlineStartOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(s);!((p=v.topOverlay)===null||p===void 0)&&p.clone.wtTable.THEAD.contains(s)&&c<i&&q(s,"hiddenHeaderText");const x=b||R?Math.min(u,i-r):u;x>1&&s.setAttribute("colspan",x)}if(this.hot.view.appendColHeader(c,s,function(){return n.getColumnHeaderValue(...arguments)},e),!d&&!h){const v=s.querySelector("div.relative");v&&f&&f.length>0&&(ue(v,this.hot.getColumnMeta(c).headerClassName),q(v,f))}}}getColumnHeaderValue(e,n){var i;const{isHidden:r,isPlaceholder:s}=(i=Ve(Rt,this).getHeaderSettings(n,e))!==null&&i!==void 0?i:{};return s||r?"":this.hot.getColHeader(e,n)}destroy(){tl(Rt,this,null),Ve(Fl,this)!==null&&(Ve(Fl,this).unsubscribe(),tl(Fl,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Ve(Rt,this).getHeaderTreeNodeData(e.row,e.col)}}function S1e(t,e){var n;const i=this.hot.getSelectedRangeActive();if(!i)return t;const{highlight:r}=i,{navigableHeaders:s}=this.hot.getSettings(),o=this.hot.selection.isSelectedByColumnHeader(),a=s?r.row:(n=Ve(UC,this))===null||n===void 0?void 0:n.row,l=o?t:r.col,c=a<0&&l>=0;if(tl(UC,this,null),!c)return t;const u=this.hot.getFirstFullyVisibleColumn(),h=this.hot.getLastFullyVisibleColumn(),d=h-u+1,f=Ve(Rt,this).findLeftMostColumnIndex(a,l),g=Ve(Rt,this).findRightMostColumnIndex(a,l),m=g-f+1;if(f<u&&g>h)return f;if(o){let p=null;return f>=u&&g>h?m>d?(e.value="start",p=f):(e.value="end",p=g):f<u&&g<=h&&(m>d?(e.value="end",p=g):(e.value="start",p=f)),p}return f<=u?f:g}function R1e(t,e,n){const i=Ve(Rt,this).getHeaderTreeNodeData(e,t);if(!i)return t;const{columnCursor:r,selectionType:s,selectionWidth:o}=n,{isRoot:a,colspan:l}=Ve(Rt,this).getHeaderSettings(e,t);if(s===DO){if(!a)return i.columnIndex}else if(s===L5&&(l>o-r||!a))return null;return t}function _1e(t,e,n){let{columnHeadersCount:i}=n;if(i!==0)for(let s=0;s<e.length;s++){const{startRow:o,startCol:a,endRow:l,endCol:c}=e[s],u=l-o+1,h=a-c+1;if(o>=0||h===1)break;for(let d=a;d<=c;d++)for(let f=o;f<=l;f++){var r;const g=u+f,m=d-a;if(m===0)continue;((r=Ve(Rt,this).getHeaderTreeNodeData(f,d))===null||r===void 0?void 0:r.isRoot)===!1&&(t[g][m]="")}}}function E1e(t,e,n,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function x1e(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;tl(gp,this,e.clone()),tl(x0,this,!0);const{selection:i}=this.hot,r=i.isSelected()?i.getSelectedRange().current():null,s=[],{columnIndex:o,origColspan:a}=n,l=!i.inInSelection(e);t.shiftKey&&r?e.col<r.from.col?s.push(r.getTopEndCorner().col,o,e.row):e.col>r.from.col?s.push(r.getTopStartCorner().col,o+a-1,e.row):s.push(o,o+a-1,e.row):(XS(t)||Pc(t)&&l||d5(t))&&s.push(o,o+a-1,e.row),i.selectColumns(...s)}function T1e(t,e,n,i){if(!this.hot.view.isMouseDown()||i.column)return;const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;const{columnIndex:s,origColspan:o}=r,a=this.hot.getSelectedRangeActive(),l=a.getTopStartCorner(),c=a.getBottomEndCorner(),{from:u}=a;i.column=!0,i.cell=!0;const h=[],d=Ke(e.row,-1/0,-1);e.col<u.col?h.push(c.col,s,d):e.col>u.col?h.push(l.col,s+o-1,d):h.push(s,s+o-1,d),this.hot.selection.selectColumns(...h)}function M1e(){tl(x0,this,!1)}function P1e(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Ve(x0,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:r,origColspan:s}=Ve(Rt,this).getHeaderTreeNodeData(Ve(gp,this).row,Ve(gp,this).col);if(e.setHighlight(Ve(gp,this)),s>e.getWidth()||r<n||r+s-1>i){const o=Ve(Rt,this).findTopMostEntireHeaderLevel(Ke(n,r,r+s-1),Ke(i,r,r+s-1));e.highlight.row=o,e.highlight.col=e.from.col}}function A1e(t){const{highlight:e}=this.hot.getSelectedRangeActive(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const r=Ve(Rt,this).findLeftMostColumnIndex(n.row,n.col),s=Ve(Rt,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const o=e.col>=r&&e.col<=s?r-1:s,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const o=e.col>=r&&e.col<=s?s+1:r,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function I1e(t,e,n){const i=t.row,r=this._getHeaderTreeNodeDataByCoords({row:i,col:t.col}),s=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col});tl(UC,this,n.clone()),e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),s&&(e.col=s.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),s&&(e.col=s.columnIndex+s.origColspan-1))}function O1e(t){if(Ve(Rt,this).getLayersCount()>0){t.length=0;for(let e=0;e<Ve(Rt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function H1e(t){const e=Ve(Rt,this).getLayersCount();let n=t.startColumn,i=!!e;for(let r=0;r<e;r++){const s=Ve(Rt,this).findLeftMostColumnIndex(r,t.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(i=!1),Oi(o)&&o<t.startColumn){n=o;break}}t.startColumn=i?Ve(Rt,this).getHeaderTreeNodeData(0,n).columnIndex:n}function k1e(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function D1e(t,e,n){var i;const{label:r}=(i=Ve(Rt,this).getHeaderTreeNodeData(n,e))!==null&&i!==void 0?i:{label:""};return r}function N1e(t,e){if(t<0)return this.hot.getCell(t,Ve(Rt,this).findLeftMostColumnIndex(t,e),!0)}function L1e(){this.updatePlugin()}function $1e(t,e){e||this.updatePlugin()}function wm(t,e,n){return(e=F1e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function F1e(t){var e=V1e(t,"string");return typeof e=="symbol"?e:e+""}function V1e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class B1e{constructor(e,n){wm(this,"hot",void 0),wm(this,"data",null),wm(this,"plugin",void 0),wm(this,"parentReference",new WeakMap),wm(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},pe(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,i){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&k(e.__children,r=>{this.cacheNode(r,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,i,r){let s=!1,o=n;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},s=!0,o-=1),i!=null&&o===i?{result:a,end:!0}:r!=null&&a===r?{result:o,end:!0}:(o+=1,a.__children&&k(a.__children,l=>{if(this.parentReference.set(l,s?null:a),o=this.readTreeNodes(l,o,i,r),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return Ye(this.data[0],(n,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(k(i.__children,r=>{n+=1,r.__children&&(n+=this.countChildren(r))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var i;return((i=e.__children)===null||i===void 0?void 0:i[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let i=n;this.hot.runHooks("beforeAddChild",e,i);let r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),i||(i=this.mockNode()),s.__children.push(i),this.rewriteCache();const o=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,n,i){let r=i,s;if(r||(r=this.mockNode()),this.hot.runHooks("beforeAddChild",e,r,n),e){const a=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(n,null,r),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),s=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[n]);r=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,r,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),r=this.getRowParent(i),s=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(r,s+1,null);break;case"above":this.addChildAtIndex(r,s,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const r=[];Array.isArray(e)?(pe(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);r.push(this.getDataObject(f))}),pe(0,r.length-2,d=>{this.detachFromParent(r[d],!1)}),i=r[r.length-1]):i=e;const s=this.getRowIndex(i),o=this.countChildren(i),a=this.getRowIndexWithinParent(i),l=this.getRowParent(i),c=this.getRowParent(l),u=this.getRowIndex(c);let h=null;if(this.hot.runHooks("beforeDetachChild",l,i),a!=null){const d=Array.from(new Array(s+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",s,o+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,o+1,d,this.plugin.pluginName),c){h=u+this.countChildren(c);const f=this.getChild(c,this.countChildren(c)-1),g=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",g+1,o+1,this.plugin.pluginName),c.__children.push(i)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,o+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,i,this.getRowIndex(i)),n&&this.hot.render()}filterData(e,n,i){const r=[];k(i,s=>{r.push(this.getDataObject(s))}),k(r,s=>{const o=this.getRowIndexWithinParent(s),a=this.getRowParent(s);a===null?this.data.splice(o,1):a.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,n,i){const r=this.getDataObject(e-1);let s=null,o=e;r&&r.__children&&r.__children.length===0?(s=r,o=0):e<this.countAllRows()&&(s=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),s?i?s.__children.splice(o,n,...i):s.__children.splice(o,n):i?this.data.splice(o,n,...i):this.data.splice(o,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,i=n;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,i,r){const s=n===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=o.__children.slice(a,a+1),c=e>n;let u=s?this.getRowParent(n-1):this.getRowParent(n);u==null&&(u=this.getRowParent(n-1)),u==null&&(u=this.getDataObject(n-1)),u?u.__children||(u.__children=[]):(u=this.getDataObject(n),u.__children=[]);const h=s||i||r?u.__children.length:this.getRowIndexWithinParent(n),d=o===u;u.__children.splice(h,0,l[0]),o.__children.splice(a+(c&&d?1:0),1),this.syncRowWithRawSource(o),d||this.syncRowWithRawSource(u)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function nz(t,e,n){return(e=W1e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W1e(t){var e=j1e(t,"string");return typeof e=="symbol"?e:e+""}function j1e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ik{constructor(e,n){nz(this,"hot",void 0),nz(this,"plugin",void 0),this.hot=n,this.plugin=e}}class Xo extends Ik{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const i=this.hot.toPhysicalRow(e),r=this.dataManager.getDataObject(i);if(!r)return;const s=this.dataManager.getRowLevel(i),o=n.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]'),c=this.hot.getSettings().ariaTags;if(k(l,u=>{u&&o.removeChild(u)}),q(n,Xo.CSS_CLASSES.indicatorContainer),s){const{rootDocument:u}=this.hot,h=a.cloneNode(!0);o.innerHTML="",pe(0,s-1,()=>{const d=u.createElement("SPAN");q(d,Xo.CSS_CLASSES.emptyIndicator),o.appendChild(d)}),o.appendChild(h)}if(this.dataManager.hasChildren(r)){const u=this.hot.rootDocument.createElement("DIV");c&&he(u,[jh()]),q(n,Xo.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(q(u,`${Xo.CSS_CLASSES.button} ${Xo.CSS_CLASSES.expandButton}`),c&&he(n,[Ts(!1)])):(q(u,`${Xo.CSS_CLASSES.button} ${Xo.CSS_CLASSES.collapseButton}`),c&&he(n,[Ts(!0)])),o.appendChild(u)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);let i=11;this.hot.stylesHandler.isClassicTheme()||(i=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class z1e extends Ik{constructor(e,n){var i;super(e,n),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,r)},shiftStash:function(r,s){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),k(i.lastCollapsedRows,(a,l)=>{a>=r&&a<s&&(i.lastCollapsedRows[l]=a+o)})},applyStash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,r),i.lastCollapsedRows=void 0},trimStash:(r,s)=>{pe(r,r+s-1,o=>{const a=this.lastCollapsedRows.indexOf(o);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(s)&&k(s.__children,l=>{r.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(r,!0,!1),i&&this.trimRows(a),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];k(e,s=>{r.push(...this.collapseChildren(s,!1,!1))}),i&&this.trimRows(r),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return k(e,s=>{r.push(s),n&&this.collapseChildRows(s,r)}),i&&this.trimRows(r),r}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);k(r.__children,s=>{const o=this.dataManager.getRowIndex(s);n.push(o),this.collapseChildRows(o,n)})}i&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return k(e,s=>{r.push(s),n&&this.expandChildRows(s,r)}),i&&this.untrimRows(r),r}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);k(r.__children,s=>{if(!this.isAnyParentCollapsed(s)){const o=this.dataManager.getRowIndex(s);n.push(o),this.expandChildRows(o,n)}})}i&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(s)&&k(s.__children,l=>{const c=this.dataManager.getRowIndex(l);r.push(c)}),a=this.expandRows(r,!0,!1),i&&this.untrimRows(a),n&&this.renderAndAdjust(),a}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];k(e,s=>{r.push(...this.expandChildren(s,!1,!1))}),i&&this.untrimRows(r),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];k(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];k(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{k(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{k(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&k(n.__children,r=>{const s=this.dataManager.getRowIndex(r);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return i=!1,!1}),i}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const i=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const i=this.translateTrimmedRow(n.row);Ee(e.target,Xo.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),es(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.view.adjustElementsSize(),this.hot.render()}}function U1e(t,e,n){Y1e(t,e),e.set(t,n)}function Y1e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function G1e(t,e,n){return(e=q1e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q1e(t){var e=K1e(t,"string");return typeof e=="symbol"?e:e+""}function K1e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function X1e(t,e){return t.get(J1e(t,e))}function J1e(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var iz=new WeakMap;class Z1e extends Ik{constructor(){super(...arguments),G1e(this,"dataManager",this.plugin.dataManager),U1e(this,iz,{row_above:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase($1)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedActive()[0]),r=this.dataManager.getDataObject(i);this.dataManager.addChild(r)},disabled:()=>{const i=this.hot.getSelectedActive();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(F1)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedActive())},disabled:()=>{const i=this.hot.getSelectedActive(),r=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(r)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return pe(0,e.items.length-1,i=>{if(i===0)return k(n,(r,s)=>{e.items.splice(i+s,0,r)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return pe(0,e.items.length-1,n=>{const i=X1e(iz,this)[e.items[n].key];i!=null&&(e.items[n].callback=i)}),e}}function Ib(t,e,n){return(e=Q1e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Q1e(t){var e=eHe(t,"string");return typeof e=="symbol"?e:e+""}function eHe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tHe{constructor(e){Ib(this,"plugin",void 0),Ib(this,"hot",void 0),Ib(this,"dataManager",void 0),Ib(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,i,r){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:i,movePossible:r}))return!1;this.movedToCollapsed=!1;const o=i===this.hot.countRows(),a=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let l=!0;const c=e.map(g=>{if(!l)return!1;const m=this.dataManager.translateTrimmedRow(g);return l=this.shouldAllowMoving(m,a),m}),u=c.indexOf(a)===-1;if(!l||!u)return!1;const h=this.getBaseParent(c),d=this.getTargetParent(o,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(c,a,f),this.moveRows(c,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(c,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,i,r,r&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:i,dropIndex:r,movePossible:s}=e;let o=!1;return Nt(r)&&(Ue(ct`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,i,r,s,!1),o=!0),o}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let i=this.dataManager.getRowParent(e?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}shiftCollapsibleParentsLocations(e,n,i){i||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,i){const r=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,n,this.movedToCollapsed,r)})})}moveCellsMeta(e,n){const i=[],r=Math.max(...e)<n;e.forEach(s=>{i.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(r?i.length:0),0,...i)}selectCells(e,n){const i=e.length;let r=0,s=0;if(this.movedToCollapsed){let o=null;e[i-1]<n?o=this.dataManager.translateTrimmedRow(n-i):o=this.dataManager.translateTrimmedRow(n);const a=this.dataManager.getRowParent(o===null?this.hot.countSourceRows()-1:o-1),l=this.dataManager.getRowIndex(a);r=this.dataManager.untranslateTrimmedRow(l),s=r}else e[i-1]<n?(s=n-1,r=s-i+1):(r=n,s=r+i-1);this.hot.selectCells([[r,0,s,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}}function nHe(t,e){z4(t,e),e.add(t)}function rz(t,e,n){z4(t,e),e.set(t,n)}function z4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function YT(t,e,n){return(e=iHe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iHe(t){var e=rHe(t,"string");return typeof e=="symbol"?e:e+""}function rHe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yy(t,e){return t.get(Kn(t,e))}function YC(t,e,n){return t.set(Kn(t,e),n),n}function Kn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const GC="nestedRows",sHe=300,sz=GC,oHe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var T0=new WeakMap,kd=new WeakMap,ri=new WeakSet;class aHe extends et{constructor(){super(...arguments),nHe(this,ri),YT(this,"dataManager",null),YT(this,"headersUI",null),YT(this,"collapsedRowsMap",null),rz(this,T0,!1),rz(this,kd,!1)}static get PLUGIN_KEY(){return GC}static get PLUGIN_PRIORITY(){return sHe}isEnabled(){return!!this.hot.getSettings()[GC]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Aw),this.dataManager=new B1e(this,this.hot),this.collapsingUI=new z1e(this,this.hot),this.headersUI=new Xo(this,this.hot),this.contextMenuUI=new Z1e(this,this.hot),this.rowMoveController=new tHe(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kn(ri,e,CHe).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kn(ri,e,SHe).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kn(ri,e,uHe).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kn(ri,e,hHe).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kn(ri,e,dHe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kn(ri,e,cHe).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kn(ri,e,mHe).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kn(ri,e,gHe).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kn(ri,e,pHe).call(e,...i)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kn(ri,e,wHe).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kn(ri,e,vHe).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kn(ri,e,bHe).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kn(ri,e,fHe).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kn(ri,e,yHe).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Kn(ri,e,lHe).call(e,...i)}),this.addHook("beforeLoadData",n=>Kn(ri,this,oz).call(this,n)),this.addHook("beforeUpdateData",n=>Kn(ri,this,oz).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:sz,relativeToGroup:Vc,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(sz)}disableCoreAPIModifiers(){YC(kd,this,!0)}enableCoreAPIModifiers(){YC(kd,this,!1)}onModifyRowData(e){if(!yy(kd,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!yy(kd,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,i){return yy(kd,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,i),!1)}destroy(){super.destroy()}}function lHe(t,e,n,i){return this.rowMoveController.onBeforeRowMove(t,e,n,i)}function cHe(t,e,n){this.collapsingUI.toggleState(t,e,n)}function uHe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),YC(T0,this,!0),this.dataManager.getData().slice()}function hHe(t){return this.contextMenuUI.appendOptions(t)}function dHe(t,e){this.headersUI.appendLevelIndicators(t,e)}function fHe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function gHe(t,e,n,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{YC(T0,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function mHe(t,e,n){const i=Array.from(n.reduce((r,s)=>{if(this.dataManager.isParent(s)){const o=this.dataManager.getDataObject(s).__children;return r.add(s),Array.isArray(o)&&o.forEach(a=>r.add(this.dataManager.getRowIndex(a))),r}return r.add(s)},new Set));n.length=0,n.push(...i)}function pHe(){this.collapsingUI.collapsedRowsStash.stash()}function wHe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function vHe(){this.collapsingUI.collapsedRowsStash.stash()}function bHe(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function yHe(){this.dataManager.rewriteCache()}function CHe(){this.headersUI.updateRowHeaderWidth()}function SHe(t,e){yy(T0,this)&&(e.skipRender=!0)}function oz(t){if(!Y5(t)){_O(oHe),this.hot.getSettings()[GC]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function RHe(t,e){U4(t,e),e.add(t)}function Vl(t,e,n){U4(t,e),e.set(t,n)}function U4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function nt(t,e){return t.get(mp(t,e))}function Do(t,e,n){return t.set(mp(t,e),n),n}function mp(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _He=`
<div data-ref="container" class="ht-pagination handsontable">
  <div class="ht-pagination__inner">
    <div data-ref="pageSizeSection" class="ht-page-size-section">
      <span data-ref="pageSizeLabel" class="ht-page-size-section__label"></span>
      <div class="ht-page-size-section__select-wrapper">
        <select data-ref="pageSizeSelect" name="pageSize" data-hot-input></select>
      </div>
    </div>
    <div data-ref="pageCounterSection" class="ht-page-counter-section"></div>
    <nav data-ref="pageNavSection" class="ht-page-navigation-section">
      <button data-ref="first" class="ht-page-navigation-section__button ht-page-first"></button>
      <button data-ref="prev" class="ht-page-navigation-section__button ht-page-prev"></button>
      <span data-ref="pageNavLabel" class="ht-page-navigation-section__label"></span>
      <button data-ref="next" class="ht-page-navigation-section__button ht-page-next"></button>
      <button data-ref="last" class="ht-page-navigation-section__button ht-page-last"></button>
    </nav>
  </div>
</div>
`;var of=new WeakMap,$u=new WeakMap,GT=new WeakMap,_i=new WeakMap,Dd=new WeakMap,gs=new WeakMap,qT=new WeakMap,KT=new WeakMap,Ob=new WeakSet;class Y4{constructor(e){let{rootElement:n,uiContainer:i,isRtl:r,themeName:s,phraseTranslator:o,shouldHaveBorder:a,a11yAnnouncer:l}=e;RHe(this,Ob),Vl(this,of,void 0),Vl(this,$u,void 0),Vl(this,GT,!1),Vl(this,_i,void 0),Vl(this,Dd,void 0),Vl(this,gs,void 0),Vl(this,qT,void 0),Vl(this,KT,void 0),Do(of,this,n),Do($u,this,i),Do(GT,this,r),Do(Dd,this,s),Do(gs,this,o),Do(qT,this,a),Do(KT,this,l),this.install()}install(){var e;if((e=nt(_i,this))!==null&&e!==void 0&&e.container)return;const n=Mf`${_He}`,{container:i,first:r,prev:s,next:o,last:a,pageSizeSelect:l}=n.refs;Do(_i,this,n.refs),i.setAttribute("dir",nt(GT,this)?"rtl":"ltr"),i.tabIndex=-1;const c=h=>h.currentTarget.disabled,u=(h,d,f)=>{d.addEventListener(h,g=>{c(g)||f()})};u("click",r,()=>this.runLocalHooks("firstPageClick")),u("click",s,()=>this.runLocalHooks("prevPageClick")),u("click",o,()=>this.runLocalHooks("nextPageClick")),u("click",a,()=>this.runLocalHooks("lastPageClick")),l.addEventListener("change",()=>{const h=l.value==="auto"?"auto":Number.parseInt(l.value,10);this.runLocalHooks("pageSizeChange",h)}),this.setCounterSectionVisibility(!1),this.setNavigationSectionVisibility(!1),this.setPageSizeSectionVisibility(!1),nt($u,this)?(nt($u,this).appendChild(n.fragment),q(i,[nt(Dd,this),"handsontable"])):nt(of,this).after(n.fragment)}getContainer(){return nt(_i,this).container}getFocusableElements(){const{first:e,prev:n,next:i,last:r,pageSizeSelect:s}=nt(_i,this);return[s,e,n,i,r].filter(o=>!o.disabled)}updateWidth(e){return nt(_i,this).container.style.width=`${e}px`,this}updateTheme(e){if(Do(Dd,this,e),nt($u,this)){const{container:n}=nt(_i,this);ue(n,/ht-theme-.*/g),nt(Dd,this)&&q(n,nt(Dd,this))}return this}getHeight(){return nt(_i,this).container.offsetHeight}refreshBorderState(){const{container:e}=nt(_i,this);return nt($u,this)||nt(qT,this).call(this)?q(e,"ht-pagination--bordered"):ue(e,"ht-pagination--bordered"),this}updateState(e){let{currentPage:n,totalPages:i,firstVisibleRowIndex:r,lastVisibleRowIndex:s,totalRenderedRows:o,pageSizeList:a,pageSize:l,autoPageSize:c}=e;const{first:u,prev:h,next:d,last:f,pageCounterSection:g,pageNavSection:m,pageNavLabel:p,pageSizeSelect:v,pageSizeLabel:b}=nt(_i,this),R=nt(gs,this).call(this,CH,{start:r+1,end:s+1,total:o}),S=nt(gs,this).call(this,SH,{currentPage:n,totalPages:i}),x=nt(gs,this).call(this,lC);g.textContent=R,p.textContent=S,v.textContent="",b.textContent=`${x}:`,he(m,[Jr(nt(gs,this).call(this,bH))]),he(v,[Jr(nt(gs,this).call(this,lC))]),nt(KT,this).call(this,S),this.refreshBorderState(),a.forEach(O=>{const W=O==="auto"?nt(gs,this).call(this,yH):O,N=new Option(W,O);(c&&O==="auto"||!c&&O===l)&&(N.selected=!0),v.add(N)});const M=n===1,T=n===i;if(m.style.display!=="none"){const O=nt(of,this).ownerDocument.activeElement;M?(q(u,"ht-page-navigation-section__button--disabled"),q(h,"ht-page-navigation-section__button--disabled"),u.disabled=!0,h.disabled=!0):(ue(u,"ht-page-navigation-section__button--disabled"),ue(h,"ht-page-navigation-section__button--disabled"),u.disabled=!1,h.disabled=!1),T?(q(d,"ht-page-navigation-section__button--disabled"),q(f,"ht-page-navigation-section__button--disabled"),d.disabled=!0,f.disabled=!0):(ue(d,"ht-page-navigation-section__button--disabled"),ue(f,"ht-page-navigation-section__button--disabled"),d.disabled=!1,f.disabled=!1),[u,h,d,f].includes(O)&&(h.disabled?d.focus():d.disabled&&h.focus())}return he(u,[Jr(nt(gs,this).call(this,RH)),Pm(M)]),he(h,[Jr(nt(gs,this).call(this,_H)),Pm(M)]),he(d,[Jr(nt(gs,this).call(this,EH)),Pm(T)]),he(f,[Jr(nt(gs,this).call(this,xH)),Pm(T)]),this}setPageSizeSectionVisibility(e){const{pageSizeSection:n,pageSizeSelect:i}=nt(_i,this);return n.style.display=e?"":"none",i.disabled=!e,mp(Ob,this,XT).call(this),this}setCounterSectionVisibility(e){return nt(_i,this).pageCounterSection.style.display=e?"":"none",mp(Ob,this,XT).call(this),this}setNavigationSectionVisibility(e){const{pageNavSection:n,first:i,prev:r,next:s,last:o}=nt(_i,this);return n.style.display=e?"":"none",i.disabled=!e,r.disabled=!e,s.disabled=!e,o.disabled=!e,mp(Ob,this,XT).call(this),this}destroy(){var e;(e=nt(_i,this))===null||e===void 0||e.container.remove(),Do(_i,this,null)}}function XT(){const{container:t,pageSizeSection:e,pageCounterSection:n,pageNavSection:i}=nt(_i,this),r=e.style.display!=="none"||n.style.display!=="none"||i.style.display!=="none";nt($u,this)||(r?q(nt(of,this).querySelector(".ht-wrapper"),"htPagination"):ue(nt(of,this).querySelector(".ht-wrapper"),"htPagination")),t.style.display=r?"":"none"}pt(Y4,ti);const EHe=["nestedRows","mergeCells","fixedRowsTop","fixedRowsBottom"];function xHe(t){return EHe.some(e=>{const n=!!t[e];return n&&Ue(ct`The \`pagination\` plugin cannot be used with the \`${e}\` option.\x20
                        This combination is not supported. The plugin will remain disabled.`),n})}function JT(t,e,n){return(e=THe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function THe(t){var e=MHe(t,"string");return typeof e=="symbol"?e:e+""}function MHe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PHe{constructor(){JT(this,"pageSize",1),JT(this,"totalItems",0),JT(this,"totalPages",0)}calculate(e){let{pageSize:n,totalItems:i}=e;this.pageSize=Math.max(n,1),this.totalItems=i,this.totalPages=Math.max(1,Math.ceil(this.totalItems/this.pageSize))}getTotalPages(){return this.totalPages}getState(e){if(e-=1,e<0||e>=this.getTotalPages())return;const n=e*this.pageSize,i=Math.max(0,Math.min(n+this.pageSize-1,this.totalItems-1));return{startIndex:n,endIndex:i,pageSize:this.pageSize}}}function AHe(t,e,n){return(e=IHe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IHe(t){var e=OHe(t,"string");return typeof e=="symbol"?e:e+""}function OHe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HHe{constructor(){AHe(this,"pages",[])}calculate(e){let{itemsSizeProvider:n,viewportSizeProvider:i}=e;const r=n(),s=i(),o=[];let a=0,l=0,c=0;for(let u=0;u<r.length;u++){const h=r[u];c>0&&l+h>=s&&(o.push({startIndex:a,endIndex:u-1,pageSize:c}),a=u,l=0,c=0),l+=h,c+=1}o.push({startIndex:a,endIndex:Math.max(0,r.length-1),pageSize:c}),this.pages=o}getTotalPages(){return this.pages.length}getState(e){if(e-=1,!(e<0||e>=this.getTotalPages()))return this.pages[e]}}const az=new Map([["fixed",PHe],["auto",HHe]]);function lz(t){if(!az.has(t))throw new Error(`Unknown pagination strategy type: ${t}`);const e=az.get(t);return new e}function kHe(t,e){G4(t,e),e.add(t)}function Bl(t,e,n){G4(t,e),e.set(t,n)}function G4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ie(t,e){return t.get(kt(t,e))}function vi(t,e,n){return t.set(kt(t,e),n),n}function kt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const nh="pagination",DHe=900,NHe=`plugin:${nh}`,cz=ct`The \`auto\` page size setting requires the \`autoRowSize\`\x20
  plugin to be enabled. Set the \`autoRowSize: true\` in the configuration to ensure correct behavior.`;var pp=new WeakMap,qi=new WeakMap,Js=new WeakMap,vn=new WeakMap,Zs=new WeakMap,qC=new WeakMap,Cy=new WeakMap,Vt=new WeakSet,ZT=new WeakMap;class LHe extends et{constructor(){super(...arguments),kHe(this,Vt),Bl(this,pp,null),Bl(this,qi,1),Bl(this,Js,10),Bl(this,vn,null),Bl(this,Zs,null),Bl(this,qC,!1),Bl(this,Cy,!1),Bl(this,ZT,()=>{var e;!Ie(qC,this)&&(e=this.hot)!==null&&e!==void 0&&e.view&&kt(Vt,this,ih).call(this)})}static get PLUGIN_KEY(){return nh}static get PLUGIN_PRIORITY(){return DHe}static get DEFAULT_SETTINGS(){return{pageSize:10,pageSizeList:["auto",5,10,20,50,100],initialPage:1,showPageSize:!0,showCounter:!0,showNavigation:!0,uiContainer:null}}isEnabled(){return!!this.hot.getSettings()[nh]}enablePlugin(){var e,n=this;if(xHe(this.hot.getSettings())){this.hot.getSettings()[nh]=!1;return}if(this.enabled)return;const i=this.hot.getSettings()[nh];i?.initialPage!==void 0&&vi(qi,this,this.getSetting("initialPage")),i?.pageSize!==void 0&&vi(Js,this,this.getSetting("pageSize")),vi(pp,this,this.hot.rowIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding",!1)),Ie(Js,this)==="auto"&&!((e=this.hot.getPlugin("autoRowSize"))!==null&&e!==void 0&&e.enabled)&&Ue(cz),vi(Zs,this,lz(Ie(Js,this)==="auto"?"auto":"fixed")),Ie(vn,this)||(vi(vn,this,new Y4({rootElement:this.hot.rootGridElement,uiContainer:this.getSetting("uiContainer"),isRtl:this.hot.isRtl(),themeName:this.hot.getSettings().themeName,phraseTranslator:function(){return n.hot.getTranslatedPhrase(...arguments)},shouldHaveBorder:()=>kt(Vt,this,$He).call(this),a11yAnnouncer:r=>Jbe(r)})),kt(Vt,this,uz).call(this),Ie(vn,this).addLocalHook("firstPageClick",()=>this.firstPage()).addLocalHook("prevPageClick",()=>this.prevPage()).addLocalHook("nextPageClick",()=>this.nextPage()).addLocalHook("lastPageClick",()=>this.lastPage()).addLocalHook("pageSizeChange",r=>this.setPageSize(r))),this.addHook("init",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return kt(Vt,n,GHe).call(n,...s)},-1),this.addHook("beforeSelectAll",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return kt(Vt,n,hz).call(n,...s)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return kt(Vt,n,hz).call(n,...s)}),this.addHook("beforeSetRangeEnd",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return kt(Vt,n,BHe).call(n,...s)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return kt(Vt,n,WHe).call(n,...s)}),this.addHook("beforePaste",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return kt(Vt,n,jHe).call(n,...s)}),this.addHook("afterViewRender",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return kt(Vt,n,zHe).call(n,...s)}),this.addHook("afterRender",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return kt(Vt,n,UHe).call(n,...s)}),this.addHook("afterScrollVertically",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return kt(Vt,n,qHe).call(n,...s)}),this.addHook("afterLanguageChange",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return kt(Vt,n,KHe).call(n,...s)}),this.addHook("beforeHeightChange",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return kt(Vt,n,YHe).call(n,...s)}),this.addHook("afterSetTheme",function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];return kt(Vt,n,XHe).call(n,...s)}),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",Ie(ZT,this)),kt(Vt,this,FHe).call(this),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),kt(Vt,this,ih).call(this),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",Ie(ZT,this)).unregisterMap(this.pluginName),kt(Vt,this,VHe).call(this),Ie(vn,this).destroy(),vi(vn,this,null),super.disablePlugin()}getPaginationData(){const e=Ie(Zs,this).getTotalPages();let n=-1,i=-1;const{pageSize:r,startIndex:s}=Ie(Zs,this).getState(Ie(qi,this)),o=this.hot.countRows();let a=0;for(let l=s;a<r&&!(l>=o);l++)this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(l))||(n===-1&&(n=l),i=l,a+=1);return{currentPage:Ie(qi,this),totalPages:e,pageSize:r,pageSizeList:[...this.getSetting("pageSizeList")],autoPageSize:Ie(Js,this)==="auto",numberOfRenderedRows:this.hot.rowIndexMapper.getRenderableIndexesLength(),firstVisibleRowIndex:n,lastVisibleRowIndex:i}}setPage(e){const n=Ie(qi,this);this.hot.runHooks("beforePageChange",n,e)!==!1&&(vi(qi,this,e),kt(Vt,this,ih).call(this),this.hot.scrollViewportTo({row:0}),this.hot.runHooks("afterPageChange",n,Ie(qi,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPage(){this.setPage(this.getSetting("initialPage"))}setPageSize(e){var n;const i=Ie(Js,this);this.hot.runHooks("beforePageSizeChange",i,e)!==!1&&(e==="auto"&&!((n=this.hot.getPlugin("autoRowSize"))!==null&&n!==void 0&&n.enabled)&&Ue(cz),vi(Zs,this,lz(e==="auto"?"auto":"fixed")),vi(Js,this,e),kt(Vt,this,ih).call(this),this.hot.runHooks("afterPageSizeChange",i,Ie(Js,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPageSize(){this.setPageSize(this.getSetting("pageSize"))}resetPagination(){this.resetPage(),this.resetPageSize(),kt(Vt,this,uz).call(this)}nextPage(){this.setPage(Ie(qi,this)+1)}prevPage(){this.setPage(Ie(qi,this)-1)}firstPage(){this.setPage(1)}lastPage(){this.setPage(Ie(Zs,this).getTotalPages())}hasPreviousPage(){return Ie(qi,this)>1}hasNextPage(){return Ie(qi,this)<Ie(Zs,this).getTotalPages()}getCurrentPageData(){const{firstVisibleRowIndex:e,lastVisibleRowIndex:n}=this.getPaginationData();return e===-1||n===-1?[]:this.hot.getData(e,0,n,this.hot.countCols()-1)}showPageSizeSection(){Ie(vn,this).setPageSizeSectionVisibility(!0),this.hot.runHooks("afterPageSizeVisibilityChange",!0)}hidePageSizeSection(){Ie(vn,this).setPageSizeSectionVisibility(!1),this.hot.runHooks("afterPageSizeVisibilityChange",!1)}showPageCounterSection(){Ie(vn,this).setCounterSectionVisibility(!0),this.hot.runHooks("afterPageCounterVisibilityChange",!0)}hidePageCounterSection(){Ie(vn,this).setCounterSectionVisibility(!1),this.hot.runHooks("afterPageCounterVisibilityChange",!1)}showPageNavigationSection(){Ie(vn,this).setNavigationSectionVisibility(!0),this.hot.runHooks("afterPageNavigationVisibilityChange",!0)}hidePageNavigationSection(){Ie(vn,this).setNavigationSectionVisibility(!1),this.hot.runHooks("afterPageNavigationVisibilityChange",!1)}destroy(){var e;vi(pp,this,null),vi(Zs,this,null),(e=Ie(vn,this))===null||e===void 0||e.destroy(),vi(vn,this,null),super.destroy()}}function uz(){this.getSetting("showPageSize")?this.showPageSizeSection():this.hidePageSizeSection(),this.getSetting("showCounter")?this.showPageCounterSection():this.hidePageCounterSection(),this.getSetting("showNavigation")?this.showPageNavigationSection():this.hidePageNavigationSection()}function ih(){vi(qC,this,!0),Ie(pp,this).clear();const t=this.hot.rowIndexMapper.getRenderableIndexes(),e=t.length,{stylesHandler:n}=this.hot;Ie(Zs,this).calculate({pageSize:Ie(Js,this),totalItems:e,viewportSizeProvider:()=>{const{view:s}=this.hot;if(s.isVerticallyScrollableByWindow()){const a=getComputedStyle(this.hot.rootDocument.body),l=Number.parseInt(a.marginTop,10)+Number.parseInt(a.marginBottom,10),c=this.hot.hasColHeaders()?s._wt.wtTable.getColumnHeaderHeight():0,u=Ie(vn,this).getHeight();return s.getWorkspaceHeight()-u-c-l}const o=s.hasHorizontalScroll()?Sn():0;return s.getViewportHeight()-o},itemsSizeProvider:()=>this.hot.rowIndexMapper.getRenderableIndexes().map(o=>{var a;const l=this.hot.toVisualRow(o);return(a=this.hot.getRowHeight(l))!==null&&a!==void 0?a:n.getDefaultRowHeight(l)})});const i=Ie(Zs,this).getTotalPages();if(vi(qi,this,Ke(Ie(qi,this),1,i)),t.length>0){const{startIndex:s,pageSize:o}=Ie(Zs,this).getState(Ie(qi,this));t.splice(s,o)}t.length>0?this.hot.batchExecution(()=>{t.forEach(s=>Ie(pp,this).setValueAtIndex(s,!0))},!0):this.hot.rowIndexMapper.updateCache(!0),vi(qC,this,!1);const r=this.getPaginationData();Ie(vn,this).updateState({...r,totalRenderedRows:e})}function $He(){if(!this.hot.view)return!0;const{view:t}=this.hot;if(t.isVerticallyScrollableByWindow())return!1;if(t.hasHorizontalScroll()||t.getTableHeight()<t.getWorkspaceHeight())return!0;const{lastVisibleRowIndex:e}=this.getPaginationData();return t.getLastFullyVisibleRow()!==e}function FHe(){this.hot.getFocusScopeManager().registerScope(nh,Ie(vn,this).getContainer(),{shortcutsContextName:NHe,runOnlyIf:()=>this.getSetting("showPageSize")||this.getSetting("showNavigation"),onActivate:t=>{const e=Ie(vn,this).getFocusableElements();e.length>0&&(t==="tab_from_above"?e.at(0).focus():t==="tab_from_below"&&e.at(-1).focus())}})}function VHe(){this.hot.getFocusScopeManager().unregisterScope(nh)}function hz(t,e){const{firstVisibleRowIndex:n,lastVisibleRowIndex:i}=this.getPaginationData();(Ie(qi,this)>1||t.row>=0)&&(t.row=n),e.row=i}function BHe(t){if(this.hot.selection.isSelectedByColumnHeader()){const{lastVisibleRowIndex:e}=this.getPaginationData();t.row=e}}function WHe(){if(!this.hot.getSettings().navigableHeaders)return;const t=this.hot.getSelectedRangeLast();if(!t.isSingle()){const{highlight:e}=t;e.row=Ke(e.row,t.getTopStartCorner().row,t.getBottomEndCorner().row)}}function jHe(t,e){const{firstVisibleRowIndex:n,lastVisibleRowIndex:i}=this.getPaginationData();if(n===-1||i===-1)return!1;e.forEach(r=>{let{startRow:s}=r;if(t.length===0)return;const o=Math.min(t.length-(i-s+1),t.length);t.splice(0,o)})}function zHe(){if(Ie(Js,this)!=="auto"||Ie(Cy,this)){vi(Cy,this,!1);return}kt(Vt,this,ih).call(this),vi(Cy,this,!0),this.hot.view.adjustElementsSize(),this.hot.render()}function UHe(){const{view:t}=this.hot,e=t.isHorizontallyScrollableByWindow()?t.getTotalTableWidth():t.getWorkspaceWidth();Ie(vn,this).updateWidth(e).refreshBorderState()}function YHe(t){return this.getSetting("uiContainer")||!(typeof t=="number"||typeof t=="string"&&/^\d+$/.test(t)||typeof t=="string"&&t.endsWith("px"))?t:`calc(${typeof t=="string"&&t.endsWith("px")?t:`${t}px`} - ${Ie(vn,this).getHeight()}px)`}function GHe(){Ie(Js,this)!=="auto"&&kt(Vt,this,ih).call(this)}function qHe(){Ie(vn,this).refreshBorderState()}function KHe(){kt(Vt,this,ih).call(this)}function XHe(t){Ie(vn,this).updateTheme(t)}function QT(t,e,n){return(e=JHe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function JHe(t){var e=ZHe(t,"string");return typeof e=="symbol"?e:e+""}function ZHe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QHe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;QT(this,"rootWindow",void 0),QT(this,"prefix",void 0),QT(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const i=typeof e>"u"?n:e,r=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return r===null?void 0:JSON.parse(r)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){k(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function eke(t,e,n){return(e=tke(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tke(t){var e=nke(t,"string");return typeof e=="symbol"?e:e+""}function nke(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}le.getSingleton().register("persistentStateSave");le.getSingleton().register("persistentStateLoad");le.getSingleton().register("persistentStateReset");const dz="persistentState",ike=0,fz=new WeakSet;class rke extends et{constructor(){super(...arguments),eke(this,"storage",void 0)}static get PLUGIN_KEY(){return dz}static get PLUGIN_PRIORITY(){return ike}isEnabled(){return!!this.hot.getSettings()[dz]}enablePlugin(){this.enabled||(fz.has(this.hot)||(fz.add(this.hot),g5("The PersistentState plugin is deprecated and will be removed in version 17.0. Please update your settings to ensure compatibility with future versions.")),this.storage||(this.storage=new QHe(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function ske(t,e){oke(t,e),e.add(t)}function oke(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eM(t,e,n){return(e=ake(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ake(t){var e=lke(t,"string");return typeof e=="symbol"?e:e+""}function lke(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gz(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const tM="search",cke=190,uke="htSearchResult",hke=function(t,e,n,i,r){t.getCellMeta(e,n).isSearchResult=r},dke=function(t,e,n){return Nt(t)||t===null||!t.toLocaleLowerCase||t.length===0||Nt(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var nM=new WeakSet;class fke extends et{constructor(){super(...arguments),ske(this,nM),eM(this,"callback",hke),eM(this,"queryMethod",dke),eM(this,"searchResultClass",uke)}static get PLUGIN_KEY(){return tM}static get PLUGIN_PRIORITY(){return cke}isEnabled(){return this.hot.getSettings()[tM]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[tM];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return gz(nM,e,mz).call(e,...r)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return gz(nM,e,mz).call(e,...r)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const r=this.hot.countRows(),s=this.hot.countCols(),o=[],a=this.hot;return pe(0,r-1,l=>{pe(0,s-1,c=>{const u=this.hot.getDataAtCell(l,c),h=this.hot.getCellMeta(l,c),d=h.search.callback||n,g=(h.search.queryMethod||i)(e,u,h);if(g){const m={row:l,col:c,data:u};o.push(m)}d&&d(a,l,c,u,g)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Re(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function mz(t,e,n,i,r,s){const o=s.className||[];let a=[];typeof o=="string"?a=o.split(" "):a.push(...o),this.isEnabled()&&s.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),s.className=a.join(" ")}function Hb(t,e,n){return(e=gke(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gke(t){var e=mke(t,"string");return typeof e=="symbol"?e:e+""}function mke(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class q4{constructor(e){Hb(this,"viewportWidth",void 0),Hb(this,"overwriteColumnWidthFn",void 0),Hb(this,"baseWidths",new Map),Hb(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class pke extends q4{calculate(){const e=Array.from(this.baseWidths).reduce((h,d)=>{let[,f]=d;return h+f},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const i=this.viewportWidth/e,r=[],s=[];let o=this.viewportWidth,a=0;if(this.baseWidths.forEach((h,d)=>{const f=Math.round(h*i),g=this.overwriteColumnWidthFn(f,d);f===g&&f>=If?(r.push([d,g]),a+=g):f!==g&&(r.push([d,g]),s.push(d),o-=g)}),o<=If){this.stretchedWidths.clear();return}const l=o/a;let c=-1,u=0;r.forEach((h,d)=>{let[f,g]=h,m=g;s.includes(f)||(m=Math.round(g*l)),this.stretchedWidths.set(f,m),c=f,d<r.length-1&&(u+=m)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(c,Math.round(this.viewportWidth-u))}}function pz(t,e,n){wke(t,e),e.set(t,n)}function wke(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function iM(t,e){return t.get(K4(t,e))}function kb(t,e,n){return t.set(K4(t,e),n),n}function K4(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Db=new WeakMap,vm=new WeakMap;class vke extends q4{constructor(){super(...arguments),pz(this,Db,0),pz(this,vm,-1)}prepare(e){super.prepare(e),kb(Db,this,0),kb(vm,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),kb(vm,this,e),kb(Db,this,n)}calculate(){if(iM(vm,this)===-1)return;const e=Array.from(this.baseWidths).reduce((i,r)=>{let[,s]=r;return i+s},0),n=Math.max(this.viewportWidth-e+iM(Db,this),0);this.stretchedWidths.set(iM(vm,this),n)}}function bke(t,e){X4(t,e),e.add(t)}function Nb(t,e,n){X4(t,e),e.set(t,n)}function X4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xt(t,e){return t.get(af(t,e))}function rM(t,e,n){return t.set(af(t,e),n),n}function af(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const yke="stretchColumns";var ai=new WeakMap,Nd=new WeakMap,sM=new WeakMap,Lb=new WeakMap,bm=new WeakSet;class Cke{constructor(e){bke(this,bm),Nb(this,ai,void 0),Nb(this,Nd,void 0),Nb(this,sM,new Map([["all",new pke(af(bm,this,wz).bind(this))],["last",new vke(af(bm,this,wz).bind(this))]])),Nb(this,Lb,"none"),rM(ai,this,e),rM(Nd,this,Xt(ai,this).columnIndexMapper.createAndRegisterIndexMap(yke,"physicalIndexToValue"))}useStrategy(e){rM(Lb,this,Xt(sM,this).has(e)?e:"none")}refreshStretching(){if(Xt(Lb,this)==="none"){Xt(Nd,this).clear();return}Xt(ai,this).batchExecution(()=>{Xt(Nd,this).clear();const e=Xt(sM,this).get(Xt(Lb,this));let i=Xt(ai,this).view.getViewportWidth();af(bm,this,Ske).call(this)&&(i-=Sn(Xt(ai,this).rootDocument)),e.prepare({viewportWidth:i});for(let r=0;r<Xt(ai,this).countCols();r++)Xt(ai,this).columnIndexMapper.isHidden(Xt(ai,this).toPhysicalColumn(r))||e.setColumnBaseWidth(r,af(bm,this,Rke).call(this,r));e.calculate(),e.getWidths().forEach(r=>{let[s,o]=r;Xt(Nd,this).setValueAtIndex(Xt(ai,this).toPhysicalColumn(s),o)})},!0)}getStretchedWidth(e){return Xt(Nd,this).getValueAtIndex(Xt(ai,this).toPhysicalColumn(e))}}function Ske(){const{view:t,stylesHandler:e}=Xt(ai,this);if(t.isVerticallyScrollableByWindow())return!1;const n=t.getViewportHeight(),i=Xt(ai,this).countRows(),r=e.getDefaultRowHeight(),s=e.isClassicTheme(),o=u=>s&&u===0?1:0;let a=0,l=!1;for(let u=0;u<i;u++){var c;if(!Xt(ai,this).rowIndexMapper.isHidden(Xt(ai,this).toPhysicalRow(u))&&(a+=((c=Xt(ai,this).getRowHeight(u))!==null&&c!==void 0?c:r)+o(u),a>n)){l=!0;break}}return l}function Rke(t){var e;return(e=Xt(ai,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:If}function wz(t,e){return Xt(ai,this).runHooks("beforeStretchingColumnWidth",t,e)}function _ke(t,e){J4(t,e),e.add(t)}function oM(t,e,n){J4(t,e),e.set(t,n)}function J4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function aM(t,e,n){return t.set(KC(t,e),n),n}function Fa(t,e){return t.get(KC(t,e))}function KC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Eke="stretchColumns",xke=155;var Kd=new WeakMap,$b=new WeakMap,ym=new WeakMap,lM=new WeakSet;class Tke extends et{constructor(){super(...arguments),_ke(this,lM),oM(this,Kd,new Cke(this.hot)),oM(this,$b,null),oM(this,ym,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(i=>{let{contentRect:r}=i;Fa($b,this)!==null&&Fa($b,this)!==r.width&&(this.hot.view.adjustElementsSize(),this.hot.refreshDimensions()),aM($b,this,r.width)})})}))}static get PLUGIN_KEY(){return Eke}static get PLUGIN_PRIORITY(){return xke}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Fa(Kd,this).useStrategy(this.hot.getSettings().stretchH),Fa(ym,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return KC(lM,e,Pke).call(e,...i)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return KC(lM,e,Mke).call(e,...i)},10),super.enablePlugin())}updatePlugin(){Fa(Kd,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Fa(ym,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Fa(Kd,this).getStretchedWidth(e)}destroy(){Fa(ym,this).disconnect(),aM(ym,this,null),aM(Kd,this,null),super.destroy()}}function Mke(t,e,n){if(n===this.pluginName)return;const i=this.getColumnWidth(e);return typeof i=="number"?i:t}function Pke(t){t&&Fa(Kd,this).refreshStretching()}function Ake(t,e){Ike(t,e),e.add(t)}function Ike(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fb(t,e,n){return(e=Oke(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oke(t){var e=Hke(t,"string");return typeof e=="symbol"?e:e+""}function Hke(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const kke="touchScroll",Dke=200;var Vb=new WeakSet;class Nke extends et{constructor(){super(...arguments),Ake(this,Vb),Fb(this,"scrollbars",[]),Fb(this,"clones",[]),Fb(this,"lockedCollection",!1),Fb(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return kke}static get PLUGIN_PRIORITY(){return Dke}static get SETTING_KEYS(){return!0}isEnabled(){return cO()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>cM(Vb,this,Lke).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>cM(Vb,this,$ke).call(this)),this.addHook("afterMomentumScroll",()=>cM(Vb,this,Fke).call(this))}}function Lke(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),i&&this.scrollbars.push(i),r&&r.clone&&this.scrollbars.push(r),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&r.clone&&this.clones.push(r.clone.wtTable.holder.parentNode)}function $ke(){this.freezeOverlays=!0,k(this.clones,t=>{q(t,"hide-tween")})}function Fke(){this.freezeOverlays=!1,k(this.clones,t=>{ue(t,"hide-tween"),q(t,"show-tween")}),this.hot._registerTimeout(()=>{k(this.clones,t=>{ue(t,"show-tween")})},400),k(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Vke(t,e){Bke(t,e),e.add(t)}function Bke(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wke(t,e,n){return(e=jke(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jke(t){var e=zke(t,"string");return typeof e=="symbol"?e:e+""}function zke(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Uke(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Sy="trimRows",Yke=330;var vz=new WeakSet;class Gke extends et{constructor(){super(...arguments),Vke(this,vz),Wke(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return Sy}static get PLUGIN_PRIORITY(){return Yke}isEnabled(){return!!this.hot.getSettings()[Sy]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Aw),this.trimmedRowsMap.addLocalHook("init",()=>Uke(vz,this,qke).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[Sy];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),k(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{k(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",n,r,i,i&&r.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;const s=this.trimmedRowsMap.getValues().slice(),o=e.length>0;i&&o&&(k(e,l=>{s[l]=!1}),r=Un(s,(l,c,u)=>(c&&l.push(u),l),[])),this.hot.runHooks("beforeUntrimRow",n,r,i&&o)!==!1&&(i&&o&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",n,r,i&&o,i&&r.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<n)}destroy(){super.destroy()}}function qke(){const t=this.hot.getSettings()[Sy];Array.isArray(t)&&this.hot.batchExecution(()=>{k(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function Kke(t,e,n){return(e=Xke(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xke(t){var e=Jke(t,"string");return typeof e=="symbol"?e:e+""}function Jke(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ds{constructor(e){Kke(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Bb(t,e,n){return(e=Zke(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zke(t){var e=Qke(t,"string");return typeof e=="symbol"?e:e+""}function Qke(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ok extends Ds{constructor(e){let{stateBefore:n,range:i,type:r,alignment:s}=e;super("cell_alignment"),Bb(this,"stateBefore",void 0),Bb(this,"range",void 0),Bb(this,"type",void 0),Bb(this,"alignment",void 0),this.stateBefore=n,this.range=i,this.type=r,this.alignment=s}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(i,r,s,o)=>{n.done(()=>new Ok({stateBefore:i,range:r,type:s,alignment:o}))})}undo(e,n){k(this.range,i=>{i.forAll((r,s)=>{r>=0&&s>=0&&e.setCellMeta(r,s,"className",this.stateBefore[r][s]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){Yl(this.range,this.type,this.alignment,(i,r)=>e.getCellMeta(i,r),(i,r,s,o)=>e.setCellMeta(i,r,s,o)),e.addHookOnce("afterViewRender",n),e.render()}}function bz(t,e,n){return(e=eDe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eDe(t){var e=tDe(t,"string");return typeof e=="symbol"?e:e+""}function tDe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Hk extends Ds{constructor(e){let{columns:n,finalIndex:i}=e;super("col_move"),bz(this,"columns",void 0),bz(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(i,r)=>{i!==!1&&n.done(()=>new Hk({columns:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),Tk(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),i.moveColumn(a,o)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),i.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function yz(t,e,n){return(e=nDe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nDe(t){var e=iDe(t,"string");return typeof e=="symbol"?e:e+""}function iDe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kk extends Ds{constructor(e){let{currentSortState:n,newSortState:i}=e;super("col_sort"),yz(this,"previousSortState",void 0),yz(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(i,r,s)=>{s&&n.done(()=>new kk({currentSortState:i,newSortState:r}))})}undo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting"),s=r.isEnabled()?r:i;this.previousSortState.length?s.sort(this.previousSortState):s.clearSort(),n()}redo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting");(r.isEnabled()?r:i).sort(this.nextSortState),n()}}function Cz(t,e,n){return(e=rDe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rDe(t){var e=sDe(t,"string");return typeof e=="symbol"?e:e+""}function sDe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Dk extends Ds{constructor(e){let{index:n,amount:i}=e;super("insert_col"),Cz(this,"index",void 0),Cz(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(i,r,s)=>{n.done(()=>new Dk({index:i,amount:r}),s)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function Sz(t,e,n){return(e=oDe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oDe(t){var e=aDe(t,"string");return typeof e=="symbol"?e:e+""}function aDe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nk extends Ds{constructor(e){let{index:n,amount:i}=e;super("insert_row"),Sz(this,"index",void 0),Sz(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(i,r,s)=>{n.done(()=>new Nk({index:i,amount:r}),s)})}undo(e,n){const i=e.countRows(),r=e.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function Wb(t,e,n){return(e=lDe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lDe(t){var e=cDe(t,"string");return typeof e=="symbol"?e:e+""}function cDe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lk extends Ds{constructor(e){let{changes:n,selected:i,countCols:r,countRows:s}=e;super("change"),Wb(this,"changes",void 0),Wb(this,"selected",void 0),Wb(this,"countCols",void 0),Wb(this,"countRows",void 0),this.changes=n,this.selected=i,this.countCols=r,this.countRows=s}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(i,r){const s=i&&i.length;if(!s||!i.find(l=>{const[,,c,u]=l;return c!==u}))return;const a=()=>{const l=i.reduce((u,h)=>(u.push([...h]),u),[]);l.forEach(u=>{u[1]=e.propToCol(u[1])});const c=s>1?this.getSelected():[[l[0][0],l[0][1]]];return new Lk({changes:l,selected:c,countCols:e.countCols(),countRows:e.countRows()})};n.done(a,r)})}undo(e,n){const i=Vi(this.changes);for(let r=0,s=i.length;r<s;r++)i[r].splice(3,1);e.addHookOnce("afterChange",()=>{const r=e.countRows()-this.countRows;r>0&&e.alter("remove_row",null,r,"UndoRedo.undo");const s=e.countCols()-this.countCols;s>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,s,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1),n()}),e.setDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){const i=Vi(this.changes);for(let r=0,s=i.length;r<s;r++)i[r].splice(2,1);e.addHookOnce("afterChange",()=>{e.selectCells(this.selected,!1,!1),n()}),e.setDataAtCell(i,null,null,"UndoRedo.redo")}}function Rz(t,e,n){return(e=uDe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uDe(t){var e=hDe(t,"string");return typeof e=="symbol"?e:e+""}function hDe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $k extends Ds{constructor(e){let{conditionsStack:n,previousConditionsStack:i}=e;super("filter"),Rz(this,"conditionsStack",void 0),Rz(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=i}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(i,r)=>{n.done(()=>new $k({conditionsStack:i,previousConditionsStack:r}))})}undo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.importConditions(this.previousConditionsStack),i.filter()}redo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.importConditions(this.conditionsStack),i.filter()}}function dDe(t,e,n){return(e=fDe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fDe(t){var e=gDe(t,"string");return typeof e=="symbol"?e:e+""}function gDe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Fk extends Ds{constructor(e){let{data:n,cellRange:i}=e;super("merge_cells"),dDe(this,"cellRange",void 0),this.cellRange=i,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(i,r)=>{if(r)return;const s=i.getTopStartCorner(),o=i.getBottomEndCorner(),a=e.getData(s.row,s.col,o.row,o.col);n.done(()=>new Fk({data:a,cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0);const r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange)}}function Z4(t,e,n,i,r){const s=["visualRow","visualCol","row","col","prop"],o=s.length,a=[];return pe(i,r,l=>{pe(e,n,c=>{const u=t.getCellMeta(c,l);if(Object.keys(u).length!==o){const h=Object.fromEntries(Object.entries(u).filter(d=>{let[f]=d;return s.includes(f)===!1}));a.push([u.visualRow,u.visualCol,h])}})}),a}function Ha(t,e,n){return(e=mDe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mDe(t){var e=pDe(t,"string");return typeof e=="symbol"?e:e+""}function pDe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vk extends Ds{constructor(e){let{index:n,indexes:i,data:r,amount:s,headers:o,columnPositions:a,rowPositions:l,fixedColumnsStart:c,removedCellMetas:u}=e;super("remove_col"),Ha(this,"index",void 0),Ha(this,"indexes",void 0),Ha(this,"data",void 0),Ha(this,"amount",void 0),Ha(this,"headers",void 0),Ha(this,"columnPositions",void 0),Ha(this,"rowPositions",void 0),Ha(this,"fixedColumnsStart",void 0),Ha(this,"removedCellMetas",void 0),this.index=n,this.indexes=i,this.data=r,this.amount=s,this.headers=o,this.columnPositions=a.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=c,this.removedCellMetas=u}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(i,r,s,o)=>{const a=()=>{const l=e.getSourceDataArray(),c=(e.countCols()+i)%e.countCols(),u=c+r-1,h=[],d=[],f=[];return pe(l.length-1,g=>{const m=[],p=l[g];pe(c,u,v=>{m.push(p[e.toPhysicalColumn(v)])}),h.push(m)}),pe(r-1,g=>{f.push(e.toPhysicalColumn(c+g))}),Array.isArray(e.getSettings().colHeaders)&&pe(r-1,g=>{d.push(e.getSettings().colHeaders[e.toPhysicalColumn(c+g)]||null)}),new Vk({index:c,indexes:f,data:h,amount:r,headers:d,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:Z4(e,0,e.countRows(),c,u)})};n.done(a,o)})}undo(e,n){const i=e.getSettings();i.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),s=(u,h,d)=>d[this.indexes.indexOf(r[h])],o=this.data.length,a=[];for(let u=0;u<o;u++)a.push(lt(this.data[u],s));const l=lt(this.headers,s),c=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),k(e.getSourceDataArray(),(u,h)=>{k(r,(d,f)=>{u[d]=a[h][f],c.push([h,d,u[d]])})}),typeof this.headers<"u"&&k(l,(u,h)=>{e.getSettings().colHeaders[r[h]]=u}),this.removedCellMetas.forEach(u=>{let[h,d,f]=u;e.setCellMetaObject(h,d,f)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(c,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function Ld(t,e,n){return(e=wDe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wDe(t){var e=vDe(t,"string");return typeof e=="symbol"?e:e+""}function vDe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Bk extends Ds{constructor(e){let{index:n,data:i,fixedRowsBottom:r,fixedRowsTop:s,rowIndexesSequence:o,removedCellMetas:a}=e;super("remove_row"),Ld(this,"index",void 0),Ld(this,"data",void 0),Ld(this,"fixedRowsBottom",void 0),Ld(this,"fixedRowsTop",void 0),Ld(this,"rowIndexesSequence",void 0),Ld(this,"removedCellMetas",void 0),this.index=n,this.data=i,this.fixedRowsBottom=r,this.fixedRowsTop=s,this.rowIndexesSequence=o,this.removedCellMetas=a}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(i,r,s,o)=>{const a=()=>{const l=e.toPhysicalRow(i),c=l+r-1,u=Vi(e.getSourceData(l,0,l+r-1,e.countSourceCols()-1));return new Bk({index:l,data:u,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:Z4(e,l,c,0,e.countCols()-1)})};n.done(a,o)})}undo(e,n){const i=e.getSettings(),r=[];i.fixedRowsBottom=this.fixedRowsBottom,i.fixedRowsTop=this.fixedRowsTop,this.data.forEach((s,o)=>{Object.keys(s).forEach(a=>{const l=parseInt(a,10);r.push([this.index+o,isNaN(l)?a:l,s[a]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(s=>{let[o,a,l]=s;e.setCellMetaObject(o,a,l)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(r,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function _z(t,e,n){return(e=bDe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bDe(t){var e=yDe(t,"string");return typeof e=="symbol"?e:e+""}function yDe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wk extends Ds{constructor(e){let{rows:n,finalIndex:i}=e;super("row_move"),_z(this,"rows",void 0),_z(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(i,r)=>{i!==!1&&n.done(()=>new Wk({rows:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),Tk(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(s=>{let{from:o,to:a}=s;o<a&&(a-=1),i.moveRow(a,o)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),i.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function CDe(t,e,n){return(e=SDe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function SDe(t){var e=RDe(t,"string");return typeof e=="symbol"?e:e+""}function RDe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jk extends Ds{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),CDe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(i,r)=>{r||n.done(()=>new jk({cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange,!0)}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0),e.render()}}function _De(t,e){[Ok,Hk,kk,Dk,Nk,Lk,$k,Fk,Vk,Bk,Wk,jk].forEach(n=>n.startRegisteringEvents(t,e))}function EDe(t,e){xDe(t,e),e.add(t)}function xDe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function uM(t,e,n){return(e=TDe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TDe(t){var e=MDe(t,"string");return typeof e=="symbol"?e:e+""}function MDe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hM(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Ez="undoRedo",PDe="undoRedo",ADe=1e3;le.getSingleton().register("beforeUndo");le.getSingleton().register("afterUndo");le.getSingleton().register("beforeRedo");le.getSingleton().register("afterRedo");const xz=new Set;var jb=new WeakSet;class IDe extends et{static get PLUGIN_KEY(){return PDe}static get PLUGIN_PRIORITY(){return ADe}static get SETTING_KEYS(){return!0}constructor(e){super(e),EDe(this,jb),uM(this,"doneActions",[]),uM(this,"undoneActions",[]),uM(this,"ignoreNewActions",!1),_De(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return hM(jb,e,ODe).call(e,...i)}),this.registerShortcuts(),hM(jb,this,HDe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),hM(jb,this,kDe).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),r={runOnlyIf:s=>!s.altKey,group:Ez};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Ez)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const r=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",r,n)===!1)return;const o=e(),a=this.undoneActions.slice();this.doneActions.push(o),this.hot.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",a),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",a,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const i=Vi(n);if(this.hot.runHooks("beforeUndo",i)===!1)return;this.ignoreNewActions=!0;const s=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",s),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.hot.runHooks("afterUndo",i)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const i=Vi(n);if(this.hot.runHooks("beforeRedo",i)===!1)return;this.ignoreNewActions=!0;const s=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",s),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.hot.runHooks("afterRedo",i)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function ODe(t,e){e==="loadData"&&this.clear()}function HDe(){const t=e=>{xz.has(e)||(Ue(ct`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),xz.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function kDe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}const ci="ht-dialog";function DDe(){function t(){return`
      <div data-ref="contentElement" class="${ci}__content"></div>
    `}let e=null;const n={};function i(){const s=Mf`${t()}`;return Object.assign(n,s.refs),e=s.fragment,s}function r(){if(e===null)throw new Error("Compile the template first.");return[]}return{TEMPLATE_NAME:"base",dialogA11YOptions(){return{role:"dialog"}},compile:i,focusableElements:r}}function NDe(t){let{id:e="",title:n="",description:i="",buttons:r=[]}=t;function s(){return`
      <div tabindex="-1" data-ref="contentElement" class="${ci}__content-wrapper-inner">
        <div class="${ci}__content">
          <h2
            id="${e}-dialog-confirm-title"
            class="${ci}__title">${ia(n)}</h2>
          <p
            id="${e}-dialog-confirm-description"
            class="${ci}__description">${ia(i)}</p>
        </div>
        ${r.length>0?`
          <div data-ref="buttonsContainer" class="${ci}__buttons">
            ${r.map(u=>`
              <button class="ht-button ht-button--${u.type}">${ia(u.text)}</button>
            `).join("")}
          </div>
        `:""}
      </div>
    `}let o=null;const a={};function l(){const u=Mf`${s()}`;return Object.assign(a,u.refs),o=u.fragment,u}function c(){if(o===null)throw new Error("Compile the template first.");const{contentElement:u,buttonsContainer:h}=a,d=[];return h?d.push(...Array.from(h.children)):d.push(u),d}return{TEMPLATE_NAME:"confirm",dialogA11YOptions(){return{role:"alertdialog",ariaLabelledby:`${e}-dialog-confirm-title`,ariaDescribedby:i?`${e}-dialog-confirm-description`:void 0}},compile:l,focusableElements:c}}const Cm=new Map([["base",DDe],["confirm",NDe]]);function LDe(t,e){Q4(t,e),e.add(t)}function $d(t,e,n){Q4(t,e),e.set(t,n)}function Q4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kt(t,e){return t.get(XC(t,e))}function Us(t,e,n){return t.set(XC(t,e),n),n}function XC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const $De=`
<div data-ref="dialogElement" class="${ci}">
  <div data-ref="dialogWrapperElement" class="${ci}__content-wrapper">
</div>
`;var dM=new WeakMap,Ei=new WeakMap,fM=new WeakMap,$m=new WeakMap,No=new WeakMap,zb=new WeakMap,gM=new WeakSet;class e6{constructor(e){let{rootElement:n,isRtl:i}=e;LDe(this,gM),$d(this,dM,void 0),$d(this,Ei,void 0),$d(this,fM,!1),$d(this,$m,!1),$d(this,No,Cm.get("base")),$d(this,zb,[]),Us(dM,this,n),Us(fM,this,i),this.install()}useTemplate(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Cm.has(e)||e==="base"){const r=Array.from(Cm.keys()).filter(s=>s!=="base").join(", ");throw new Error(ct`Invalid template: ${e}.\x20
        Valid templates are: ${r}.`)}Us(No,this,Cm.get(e)(i)),Us(zb,this,((n=i.buttons)!==null&&n!==void 0?n:[]).map(r=>r.callback))}useDefaultTemplate(){Us(No,this,Cm.get("base")()),Us(zb,this,[])}install(){var e;if((e=Kt(Ei,this))!==null&&e!==void 0&&e.dialogElement)return;const n=Mf`${$De}`;Us(Ei,this,n.refs);const{dialogElement:i}=Kt(Ei,this);he(i,[Hhe(),["dir",Kt(fM,this)?"rtl":"ltr"]]),i.addEventListener("transitionstart",()=>XC(gM,this,VDe).call(this)),i.addEventListener("transitionend",()=>XC(gM,this,FDe).call(this)),Kt(dM,this).after(n.fragment)}getContainer(){return Kt(Ei,this).dialogElement}getFocusableElements(){return Kt(No,this).focusableElements()}updateDialog(e){let{isVisible:n,content:i,customClassName:r,background:s,contentBackground:o,animation:a,a11y:l}=e;const c=Kt(No,this).compile(),{dialogElement:u,dialogWrapperElement:h}=Kt(Ei,this);h.innerHTML="",h.appendChild(c.fragment),Object.assign(Kt(Ei,this),c.refs);const{contentElement:d,buttonsContainer:f}=Kt(Ei,this);Kt(No,this).TEMPLATE_NAME!=="base"&&Object.assign(l,Kt(No,this).dialogA11YOptions());const g=r?` ${r}`:"",m=s?` ${ci}--background-${s}`:"",p=a?` ${ci}--animation`:"",v=n?` ${ci}--show`:"";u.className=[ci,`${ci}--${Kt(No,this).TEMPLATE_NAME}`,"handsontable",g,m,p,v].join(" "),he(u,[Kt(No,this).TEMPLATE_NAME==="base"?co(-1):void 0]),he(u,[l.role==="alertdialog"?vhe():whe()]),l.ariaLabel&&!l.ariaLabelledby?he(u,[l.ariaLabel?Jr(l.ariaLabel):void 0]):ra(u,"aria-label"),l.ariaLabelledby?he(u,[She(l.ariaLabelledby)]):ra(u,"aria-labelledby"),l.ariaDescribedby?he(u,[Rhe(l.ariaDescribedby)]):ra(u,"aria-describedby");const b=o?` ${ci}__content--background`:"";return q(d,`${ci}__content${b}`),Kt(No,this).TEMPLATE_NAME==="base"?(d.innerHTML="",typeof i=="string"?$c(d,i):(i instanceof HTMLElement||i instanceof DocumentFragment)&&d.appendChild(i)):f&&Array.from(f.children).forEach((R,S)=>{const x=Kt(zb,this)[S];x&&R.addEventListener("click",x)}),this}showDialog(e){const{dialogElement:n}=Kt(Ei,this);return n.style.display="block",e&&n.offsetHeight,q(n,`${ci}--show`),Us($m,this,!1),this}hideDialog(e){const{dialogElement:n}=Kt(Ei,this);return ue(n,`${ci}--show`),(e&&!Kt($m,this)||!e)&&(n.style.display="none"),Us($m,this,!1),this}focusDialog(){Kt(Ei,this).dialogElement.focus()}updateWidth(e){return Kt(Ei,this).dialogElement.style.width=`${e}px`,this}updateHeight(e){return Kt(Ei,this).dialogElement.style.height=`calc(100% - ${e}px)`,this}destroyDialog(){var e;(e=Kt(Ei,this))===null||e===void 0||e.dialogElement.remove(),Us(Ei,this,null)}}function FDe(){const{dialogElement:t}=Kt(Ei,this);Ee(t,`${ci}--show`)||(t.style.display="none")}function VDe(){Us($m,this,!0)}pt(e6,ti);function BDe(t,e){t6(t,e),e.add(t)}function mM(t,e,n){t6(t,e),e.set(t,n)}function t6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wl(t,e,n){return t.set(zu(t,e),n),n}function li(t,e){return t.get(zu(t,e))}function zu(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gc="dialog",WDe=360,hA=gc,JC=`plugin:${gc}`;var bi=new WeakMap,Xd=new WeakMap,Fd=new WeakMap,Vd=new WeakSet;class ZC extends et{constructor(){super(...arguments),BDe(this,Vd),mM(this,bi,null),mM(this,Xd,!1),mM(this,Fd,null)}static get PLUGIN_KEY(){return gc}static get PLUGIN_PRIORITY(){return WDe}static get DEFAULT_SETTINGS(){return{template:null,content:"",customClassName:"",background:"solid",contentBackground:!1,animation:!0,closable:!1,a11y:{role:"dialog",ariaLabel:"Dialog",ariaLabelledby:"",ariaDescribedby:""}}}static get SETTINGS_VALIDATORS(){return{template:e=>Re(e)&&typeof["alert","confirm"].includes(e.type)&&typeof e.title=="string"&&(typeof e?.description>"u"||typeof e?.description=="string")&&(typeof e?.buttons>"u"||Array.isArray(e?.buttons)&&e.buttons.every(n=>typeof n=="object"&&typeof n.text=="string"&&["primary","secondary"].includes(n.type)&&(typeof n.callback>"u"||typeof n.callback=="function"))),content:e=>typeof e=="string"||typeof HTMLElement<"u"&&e instanceof HTMLElement||typeof DocumentFragment<"u"&&e instanceof DocumentFragment,customClassName:e=>typeof e=="string",background:e=>["solid","semi-transparent"].includes(e),contentBackground:e=>typeof e=="boolean",animation:e=>typeof e=="boolean",closable:e=>typeof e=="boolean",a11y:e=>Re(e)&&(typeof e?.role>"u"||["dialog","alertdialog"].includes(e?.role))&&(typeof e?.ariaLabel>"u"||typeof e?.ariaLabel=="string")&&(typeof e?.ariaLabelledby>"u"||typeof e?.ariaLabelledby=="string")&&(typeof e?.ariaDescribedby>"u"||typeof e?.ariaDescribedby=="string")}}isEnabled(){return!!this.hot.getSettings()[gc]}enablePlugin(){this.enabled||(li(bi,this)||Wl(bi,this,new e6({rootElement:this.hot.rootGridElement,isRtl:this.hot.isRtl()})),zu(Vd,this,jDe).call(this),zu(Vd,this,UDe).call(this),this.addHook("afterViewRender",()=>zu(Vd,this,GDe).call(this)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),zu(Vd,this,zDe).call(this),zu(Vd,this,YDe).call(this),super.disablePlugin()}isVisible(){return li(Xd,this)}show(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.enabled){if(this.isVisible()){this.update(e);return}this.hot.runHooks("beforeDialogShow"),this.update(e),li(bi,this).showDialog(this.getSetting("animation")),Wl(Xd,this,!0),this.hot.getFocusScopeManager().activateScope(gc),Wl(Fd,this,this.hot.selection.exportSelection()),this.hot.deselectCell(),this.hot.runHooks("afterDialogShow")}}hide(){var e;this.isVisible()&&(this.hot.runHooks("beforeDialogHide"),li(bi,this).hideDialog(this.getSetting("animation")),Wl(Xd,this,!1),this.hot.getFocusScopeManager().deactivateScope(gc),((e=li(Fd,this))===null||e===void 0?void 0:e.ranges.length)>0?(this.hot.selection.importSelection(li(Fd,this)),this.hot.view.render(),Wl(Fd,this,null)):this.hot.selectCell(0,0),this.hot.runHooks("afterDialogHide"))}update(e){if(!this.enabled)return;this.updatePluginSettings(e);const n=this.getSetting("template");if(n!==ZC.DEFAULT_SETTINGS.template&&this.getSetting("content")!==ZC.DEFAULT_SETTINGS.content)throw new Error("The `template` option cannot be used together with the `content` option.");n?li(bi,this).useTemplate(n.type,{id:this.hot.guid,...n}):li(bi,this).useDefaultTemplate(),li(bi,this).updateDialog({isVisible:this.isVisible(),content:this.getSetting("content"),customClassName:this.getSetting("customClassName"),background:this.getSetting("background"),contentBackground:this.getSetting("contentBackground"),animation:this.getSetting("animation"),a11y:this.getSetting("a11y")})}showAlert(e,n){const{title:i="Alert",description:r}=Re(e)?e:{title:e};this.show({template:{type:"confirm",title:i,description:r,buttons:[{text:this.hot.getTranslatedPhrase(sC),type:"primary",callback:function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return n?.(...o)}}]},contentBackground:!1,background:"solid",animation:!0,closable:!1})}showConfirm(e,n,i){const{title:r="Confirm",description:s}=Re(e)?e:{title:e};this.show({template:{type:"confirm",title:r,description:s,buttons:[{text:this.hot.getTranslatedPhrase(e1),type:"secondary",callback:function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return i?.(...a)}},{text:this.hot.getTranslatedPhrase(sC),type:"primary",callback:function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return n?.(...a)}}]},contentBackground:!0,background:"semi-transparent",animation:!0,closable:!1})}focus(){li(bi,this).focusDialog()}destroy(){var e;(e=li(bi,this))===null||e===void 0||e.destroyDialog(),Wl(bi,this,null),Wl(Xd,this,!1),Wl(Fd,this,null),super.destroy()}}function jDe(){var t;const e=this.hot.getShortcutManager(),n=(t=e.getContext(JC))!==null&&t!==void 0?t:e.addContext(JC);n.addShortcut({keys:[["Escape"]],callback:()=>{this.hide()},runOnlyIf:()=>li(Xd,this)&&this.getSetting("closable"),group:hA}),n.addShortcut({keys:[["Shift","Tab"],["Tab"]],preventDefault:!1,callback:i=>{this.hot._registerTimeout(()=>{i.shiftKey?this.hot.runHooks("dialogFocusPreviousElement"):this.hot.runHooks("dialogFocusNextElement")})},group:hA})}function zDe(){this.hot.getShortcutManager().getContext(JC).removeShortcutsByGroup(hA)}function UDe(){this.hot.getFocusScopeManager().registerScope(gc,li(bi,this).getContainer(),{shortcutsContextName:JC,type:"modal",runOnlyIf:()=>this.isVisible(),onActivate:t=>{const e=this.hot.isListening(),n=li(bi,this).getFocusableElements();n.length>0?t==="tab_from_above"?n.at(0).focus():t==="tab_from_below"&&n.at(-1).focus():t!=="tab_from_above"&&t!=="tab_from_below"&&e&&!li(bi,this).getContainer().contains(this.hot.rootDocument.activeElement)&&li(bi,this).getContainer().focus(),e&&this.hot.runHooks("afterDialogFocus",t==="unknown"?"show":t)}})}function YDe(){this.hot.getFocusScopeManager().unregisterScope(gc)}function GDe(){const{view:t,rootWrapperElement:e,rootWindow:n}=this.hot,i=t.isHorizontallyScrollableByWindow()?t.getTotalTableWidth():t.getWorkspaceWidth();li(bi,this).updateWidth(i);const r=e.querySelector(".hot-display-license-info");if(r){const s=r.offsetHeight,o=Number.parseFloat(n.getComputedStyle(r).marginTop);li(bi,this).updateHeight(s+o)}}function qDe(t){let{id:e,icon:n,title:i,description:r}=t;return`
    <div class="${Uu}__content">
      <i class="${Uu}__icon">${n}</i>
      <div class="${Uu}__text">
        <h2 id="${e}-${rh}-title" class="${Uu}__title">${i}</h2>
        ${r?`<p id="${e}-${rh}-description" class="${Uu}__description">${r}</p>`:""}
      </div>
    </div>
  `}function KDe(t,e){n6(t,e),e.add(t)}function XDe(t,e,n){n6(t,e),e.set(t,n)}function n6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tz(t,e,n){return t.set(zk(t,e),n),n}function Br(t,e){return t.get(zk(t,e))}function zk(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const rh="loading",JDe=350,Uu=`ht-${rh}`;var xi=new WeakMap,Mz=new WeakSet;class ZDe extends et{constructor(){super(...arguments),KDe(this,Mz),XDe(this,xi,null)}static get PLUGIN_KEY(){return rh}static get PLUGIN_PRIORITY(){return JDe}static get DEFAULT_SETTINGS(){return{icon:`<svg class="${Uu}__icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path stroke="currentColor" stroke-width="2" d="M15 8a7 7 0 1 1-3.5-6.062"></path></svg>`,title:void 0,description:""}}static get SETTINGS_VALIDATORS(){return{icon:e=>typeof e=="string",title:e=>typeof e=="string",description:e=>typeof e=="string"}}isEnabled(){return!!this.hot.getSettings()[rh]}enablePlugin(){if(!this.enabled){if(Br(xi,this)===null){var e;Tz(xi,this,this.hot.getPlugin("dialog")),(e=Br(xi,this))!==null&&e!==void 0&&e.isEnabled()||(this.hot.getSettings().dialog=!0),this.hot.addHook("afterDialogFocus",()=>zk(Mz,this,QDe).call(this))}super.enablePlugin()}}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),super.disablePlugin()}isVisible(){var e,n;return(e=(n=Br(xi,this))===null||n===void 0?void 0:n.isVisible())!==null&&e!==void 0?e:!1}show(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.isEnabled()||!Br(xi,this)||!((e=Br(xi,this))!==null&&e!==void 0&&e.isEnabled()))return;if(this.isVisible()){this.update(n);return}this.hot.runHooks("beforeLoadingShow")!==!1&&(this.update(n),Br(xi,this).show(),this.hot.runHooks("afterLoadingShow"))}hide(){var e;!Br(xi,this)||!((e=Br(xi,this))!==null&&e!==void 0&&e.isEnabled())||!this.isVisible()||this.hot.runHooks("beforeLoadingHide")===!1||(Br(xi,this).hide(),this.hot.runHooks("afterLoadingHide"))}update(e){var n,i;if(!this.isEnabled()||!Br(xi,this)||!((n=Br(xi,this))!==null&&n!==void 0&&n.isEnabled()))return;this.updatePluginSettings(e);const r=this.hot.guid,s=this.getSetting("icon"),o=(i=this.getSetting("title"))!==null&&i!==void 0?i:this.hot.getTranslatedPhrase(AH),a=this.getSetting("description"),l=qDe({id:r,icon:s,title:o,description:a});Br(xi,this).update({content:l,customClassName:Uu,background:this.hot.countSourceRows()===0?"solid":"semi-transparent",a11y:{role:"alertdialog",ariaLabelledby:`${r}-${rh}-title`,ariaDescribedby:a?`${r}-${rh}-description`:void 0}})}destroy(){Tz(xi,this,null),super.destroy()}}function QDe(){Br(xi,this).focus()}function Ub(t,e,n){eNe(t,e),e.set(t,n)}function eNe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qt(t,e){return t.get(i6(t,e))}function ka(t,e,n){return t.set(i6(t,e),n),n}function i6(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Qi="ht-empty-data-state",tNe=150,nNe=`<div data-ref="emptyDataStateElement" class="${Qi} handsontable">
  <div class="${Qi}__content-wrapper">
    <div data-ref="emptyDataStateInner" class="${Qi}__content-wrapper-inner"></div>
  </div>
</div>`,iNe=t=>{let{title:e,description:n,buttons:i}=t;return`
  <div class="${Qi}__content">
    ${e?`<h2 class="${Qi}__title">${ia(e)}</h2>`:""}
    ${n?`<p class="${Qi}__description">${ia(n)}</p>`:""}
  </div>
  <div
    data-ref="emptyDataStateButtons"
    class="${Qi}__buttons${i?.length>0?` ${Qi}__buttons--has-buttons`:""}"
  >${i?.length>0?i.map(r=>`<button class="ht-button ht-button--${r.type}">${ia(r.text)}</button>`).join(""):""}</div>`};var pM=new WeakMap,wM=new WeakMap,si=new WeakMap,$r=new WeakMap;class rNe{constructor(e){let{rootElement:n,rootDocument:i}=e;Ub(this,pM,void 0),Ub(this,wM,void 0),Ub(this,si,void 0),Ub(this,$r,void 0),ka(pM,this,n),ka(wM,this,i),this.install()}install(){var e;if((e=qt(si,this))!==null&&e!==void 0&&e.emptyDataStateElement)return;const n=Mf`${nNe}`;ka(si,this,n.refs);const{emptyDataStateInner:i,emptyDataStateElement:r}=qt(si,this);he(i,[co(-1)]),he(r,[co(-1)]),qt(pM,this).after(n.fragment)}getElement(){var e;return(e=qt(si,this))===null||e===void 0?void 0:e.emptyDataStateElement}getFocusableElements(){const{emptyDataStateButtons:e,emptyDataStateInner:n}=qt(si,this),i=Array.from(e?.children);return i.length===0?[n]:i}show(){var e;(e=qt(si,this))!==null&&e!==void 0&&e.emptyDataStateElement&&(qt(si,this).emptyDataStateElement.style.display="block")}hide(){var e,n;(e=qt(si,this))!==null&&e!==void 0&&e.emptyDataStateElement&&((n=qt($r,this))===null||n===void 0||n.remove(),ka($r,this,null),qt(si,this).emptyDataStateElement.style.display="none")}updateContent(e){var n;const{emptyDataStateInner:i}=qt(si,this);let r="";typeof e=="string"?r={title:e}:r={title:e?.title,description:e?.description,buttons:e?.buttons};const s=Mf`${iNe(r)}`;ka(si,this,{...qt(si,this),...s.refs}),i.innerHTML="",i.appendChild(s.fragment),((n=r.buttons)===null||n===void 0?void 0:n.length)>0&&Array.from(qt(si,this).emptyDataStateButtons.children).forEach((o,a)=>{o.addEventListener("click",r.buttons[a].callback)})}updateClassNames(e){const{emptyDataStateElement:n}=qt(si,this);e.countRenderableColumns()>0&&e.getColumnHeadersCount()>0?q(n,`${Qi}--disable-top-border`):ue(n,`${Qi}--disable-top-border`),e.countRenderableRows()>0&&e.getRowHeadersCount()>0?q(n,`${Qi}--disable-inline-border`):ue(n,`${Qi}--disable-inline-border`),e.hasHorizontalScroll()&&!e.isHorizontallyScrollableByWindow()?q(n,`${Qi}--disable-bottom-border`):ue(n,`${Qi}--disable-bottom-border`)}updateSize(e){const{emptyDataStateElement:n}=qt(si,this),i=e.hasHorizontalScroll()?Sn(e.hot.rootDocument):0,r=e.countRenderableRows(),s=e.countRenderableColumns(),o=e.getColumnHeadersCount();if(n.style.top=s>0?`${e.getColumnHeaderHeight()}px`:"0px",n.style.insetInlineStart=r>0?`${e.getRowHeaderWidth()}px`:"0px",r===0)qt($r,this)||(ka($r,this,qt(wM,this).createElement("div")),qt($r,this).classList.add(`${Qi}-placeholder`),e._wt.wtTable.holder.appendChild(qt($r,this))),qt($r,this).style.width="100%",qt($r,this).style.height=`${tNe}px`;else{var a;(a=qt($r,this))===null||a===void 0||a.remove(),ka($r,this,null)}let l=e.getWorkspaceWidth(),c=e.getTableHeight();e.isHorizontallyScrollableByWindow()?s>0?l=e.getTotalTableWidth():r>0&&(l=e.getViewportWidth()):r>0?l=e.getViewportWidth():e.getTableWidth()-e.getRowHeaderWidth()<e.getViewportWidth()&&s>0&&(l=e.getTableWidth()),e.isVerticallyScrollableByWindow()||e.hasVerticalScroll()?s>0?c=e.hot.getTableHeight()-e.getColumnHeaderHeight():c=e.hot.getTableHeight():o>0&&s>0?c=e.getViewportHeight()-i:o>0&&s===0&&(c=e.getWorkspaceHeight()-i),n.style.width=`${l}px`,n.style.height=`${c}px`}destroy(){var e,n;(e=qt(si,this))===null||e===void 0||(e=e.emptyDataStateElement)===null||e===void 0||e.remove(),(n=qt($r,this))===null||n===void 0||n.remove(),ka($r,this,null),ka(si,this,null)}}function sNe(t,e){r6(t,e),e.add(t)}function Sm(t,e,n){r6(t,e),e.set(t,n)}function r6(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _r(t,e,n){return t.set(Mn(t,e),n),n}function cn(t,e){return t.get(Mn(t,e))}function Mn(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Oh="emptyDataState",oNe=370,dA=Object.freeze({UNKNOWN:"unknown",FILTERS:"filters"}),aNe=`plugin:${Oh}`;var ph=new WeakMap,Jn=new WeakMap,Lf=new WeakMap,QC=new WeakMap,yf=new WeakMap,Vn=new WeakSet;class lNe extends et{constructor(){super(...arguments),sNe(this,Vn),Sm(this,ph,!1),Sm(this,Jn,null),Sm(this,Lf,null),Sm(this,QC,!1),Sm(this,yf,null)}static get PLUGIN_KEY(){return Oh}static get PLUGIN_PRIORITY(){return oNe}static get DEFAULT_SETTINGS(){return{message:void 0}}static get SETTINGS_VALIDATORS(){return{message:e=>typeof e=="string"||typeof e=="function"||Re(e)&&(typeof e?.title>"u"||typeof e?.title=="string")&&(typeof e?.description>"u"||typeof e?.description=="string")&&(typeof e?.buttons>"u"||Array.isArray(e?.buttons)&&e?.buttons.every(n=>typeof n=="object"&&typeof n.text=="string"&&typeof n.type=="string"&&["primary","secondary"].includes(n.type)&&typeof n.callback=="function"))||e===void 0}}isEnabled(){return!!this.hot.getSettings()[Oh]}enablePlugin(){this.enabled||(cn(Jn,this)||(_r(Jn,this,new rNe({rootElement:this.hot.rootGridElement,rootDocument:this.hot.rootDocument})),Mn(Vn,this,dNe).call(this),Mn(Vn,this,cNe).call(this),Mn(Vn,this,uNe).call(this)),this.addHook("afterInit",()=>Mn(Vn,this,wNe).call(this)),this.addHook("afterRender",()=>Mn(Vn,this,vNe).call(this)),this.addHook("afterRowSequenceCacheUpdate",()=>Mn(Vn,this,fA).call(this)),this.addHook("afterColumnSequenceCacheUpdate",()=>Mn(Vn,this,fA).call(this)),this.addHook("beforeFilter",e=>Mn(Vn,this,bNe).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),Mn(Vn,this,Uk).call(this),this.isVisible()&&cn(Jn,this).show(),super.updatePlugin()}disablePlugin(){Mn(Vn,this,fNe).call(this),Mn(Vn,this,hNe).call(this),cn(Jn,this).destroy(),_r(Jn,this,null),super.disablePlugin()}isVisible(){return cn(ph,this)}destroy(){var e;_r(ph,this,!1),(e=cn(Jn,this))===null||e===void 0||e.destroy(),_r(Jn,this,null),_r(Lf,this,null),_r(QC,this,!1),_r(yf,this,null),super.destroy()}}function cNe(){this.eventManager.addEventListener(cn(Jn,this).getElement(),"wheel",t=>Mn(Vn,this,pNe).call(this,t))}function uNe(){_r(Lf,this,new MutationObserver(()=>{if(!this.hot)return;const t=cn(Jn,this).getElement();this.hot.rootGridElement.nextElementSibling!==t&&this.hot.rootGridElement.after(t)})),cn(Lf,this).observe(this.hot.rootWrapperElement,{childList:!0})}function hNe(){cn(Lf,this).disconnect(),_r(Lf,this,null)}function dNe(){this.hot.getFocusScopeManager().registerScope(Oh,cn(Jn,this).getElement(),{shortcutsContextName:aNe,runOnlyIf:()=>this.isVisible(),onActivate:t=>{var e;const n=(e=cn(Jn,this))===null||e===void 0?void 0:e.getFocusableElements();n.length>0&&(t==="tab_from_above"?n.at(0).focus():t==="tab_from_below"&&n.at(-1).focus())}})}function fNe(){this.hot.getFocusScopeManager().unregisterScope(Oh)}function Pz(t){var e,n,i;let r;return typeof this.getSetting("message")=="function"?r=this.getSetting("message")(t):r=this.getSetting("message"),typeof r=="string"&&(r={title:r}),!((e=r)!==null&&e!==void 0&&e.title)&&!((n=r)!==null&&n!==void 0&&n.description)&&!((i=r)!==null&&i!==void 0&&i.buttons)&&(r={},t===dA.FILTERS?(r.title=this.hot.getTranslatedPhrase(HH),r.description=this.hot.getTranslatedPhrase(kH),r.buttons=[{text:this.hot.getTranslatedPhrase(DH),type:"secondary",callback:()=>{const s=this.hot.getPlugin("filters");s&&(s.clearConditions(),s.filter())}}]):(r.title=this.hot.getTranslatedPhrase(IH),r.description=this.hot.getTranslatedPhrase(OH))),r}function fA(){this.hot.view&&(this.hot.view.countRenderableColumns()===0||this.hot.view.countRenderableRows()===0?Mn(Vn,this,gNe).call(this):Mn(Vn,this,mNe).call(this))}function gNe(){cn(ph,this)||(this.hot.runHooks("beforeEmptyDataStateShow"),Mn(Vn,this,Uk).call(this),cn(Jn,this).show(),_r(ph,this,!0),_r(yf,this,this.hot.selection.exportSelection()),this.hot.getFocusScopeManager().activateScope(Oh),this.hot.runHooks("afterEmptyDataStateShow"))}function Uk(){cn(QC,this)?cn(Jn,this).updateContent(Mn(Vn,this,Pz).call(this,dA.FILTERS)):cn(Jn,this).updateContent(Mn(Vn,this,Pz).call(this,dA.UNKNOWN))}function mNe(){var t;cn(ph,this)&&(this.hot.runHooks("beforeEmptyDataStateHide"),cn(Jn,this).hide(),_r(ph,this,!1),this.hot.getFocusScopeManager().deactivateScope(Oh),((t=cn(yf,this))===null||t===void 0?void 0:t.ranges.length)>0?(this.hot.selection.importSelection(cn(yf,this)),this.hot.view.render(),_r(yf,this,null)):this.hot.selectCell(0,0),this.hot.runHooks("afterEmptyDataStateHide"))}function pNe(t){const e=Number.isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;e!==0&&this.hot.view.hasHorizontalScroll()&&!this.hot.view.isHorizontallyScrollableByWindow()&&(this.hot.view.setTableScrollPosition({left:this.hot.view.getTableScrollPosition().left+e}),t.preventDefault())}function wNe(){Mn(Vn,this,fA).call(this),this.hot.render()}function vNe(){var t;(t=cn(Jn,this))!==null&&t!==void 0&&t.getElement()&&this.isVisible()&&(cn(Jn,this).updateSize(this.hot.view),cn(Jn,this).updateClassNames(this.hot.view))}function bNe(t){_r(QC,this,t?.length>0),this.isVisible()&&Mn(Vn,this,Uk).call(this)}function yNe(){Qe(tp),Qe(w0e),Qe(np),Qe(X0e),Qe(rRe),Qe(mX),Qe(e_e),Qe(V_e),Qe(y0),Qe(qEe),Qe(yxe),Qe(Pxe),Qe(R0),Qe(hTe),Qe(sPe),Qe($Pe),Qe(hAe),Qe(RAe),Qe(DAe),Qe(YAe),Qe(nIe),Qe(yIe),Qe(PIe),Qe(dOe),Qe(zOe),Qe(KOe),Qe(C1e),Qe(aHe),Qe(LHe),Qe(rke),Qe(fke),Qe(Tke),Qe(Nke),Qe(Gke),Qe(IDe),Qe(ZC),Qe(ZDe),Qe(lNe)}function CNe(){$ye(),aSe(),pSe(),VSe(),yNe()}function SNe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(n){const i=this.first();let r=i.data("handsontable");if(typeof n!="string"){const c=n||{};return r?r.updateSettings(c):(r=new t.Core(i[0],c),i.data("handsontable",r),r.init()),i}let s;if(r)if(typeof r[n]<"u"){for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];s=r[n].call(r,...a),n==="destroy"&&i.removeData()}else throw new Error(`Handsontable do not provide action: ${n}`);return s})}var vM,bM,yM,CM,SM;CNe();SNe(He);He.__GhostTable=hk;He._getListenersCounter=Tde;He._getRegisteredMapsCounter=Tpe;He.EventManager=As;const RNe=[Que,Whe,dpe,cSe,Fhe,tde,ihe,Wde,$he,she,rde,Bde],_Ne=[Jhe,sde];He.helper={};He.dom={};k(RNe,t=>{k(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(He.helper[e]=t[e])})});k(_Ne,t=>{k(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(He.dom[e]=t[e])})});He.cellTypes=(vM=He.cellTypes)!==null&&vM!==void 0?vM:{};k(Nwe(),t=>{He.cellTypes[t]=VH(t)});He.cellTypes.registerCellType=ms;He.cellTypes.getCellType=VH;He.editors=(bM=He.editors)!==null&&bM!==void 0?bM:{};k(Cde(),t=>{He.editors[`${Fi(t)}Editor`]=nC(t)});He.editors.registerEditor=wr;He.editors.getEditor=nC;He.renderers=(yM=He.renderers)!==null&&yM!==void 0?yM:{};k(ife(),t=>{const e=iC(t);t==="base"&&(He.renderers.cellDecorator=e),He.renderers[`${Fi(t)}Renderer`]=e});He.renderers.registerRenderer=Wr;He.renderers.getRenderer=iC;He.validators=(CM=He.validators)!==null&&CM!==void 0?CM:{};k(ofe(),t=>{He.validators[`${Fi(t)}Validator`]=MO(t)});He.validators.registerValidator=Vu;He.validators.getValidator=MO;He.plugins=(SM=He.plugins)!==null&&SM!==void 0?SM:{};k(TO(),t=>{He.plugins[t]=Tw(t)});He.plugins[`${Fi(et.PLUGIN_KEY)}Plugin`]=et;He.plugins.registerPlugin=Qe;He.plugins.getPlugin=Tw;function ENe(){const t=document.getElementById("grid-container"),e=document.getElementById("saveBtn");if(!t||!e)return;console.log("Initializing Handsontable...");const n=Array.from({length:30},()=>["","","","","","",""]),i=new He(t,{data:n,rowHeaders:!0,colHeaders:["HEAT NUMBER","ITEM CODE","COR QTY","KODE PROD","SIZE","CUSTOMER","LINE"],height:"100%",width:"100%",licenseKey:"non-commercial-and-evaluation",stretchH:"last",colWidths:[120,200,60,80,70,100,80],columns:[{data:0,placeholder:"HN-2024-X"},{data:1,placeholder:"1.002.3"},{data:2,type:"numeric"},{data:3,placeholder:"C01"},{data:4,placeholder:'1/2"'},{data:5,placeholder:"ABC"},{data:6,placeholder:"L-001"}],contextMenu:!0,autoWrapRow:!0,autoWrapCol:!0,minSpareRows:5});e.onclick=async()=>{const r=i.getData(),s=[];if(r.forEach(g=>{const m=(g[0]||"").toString().trim(),p=(g[1]||"").toString().trim();m&&p&&s.push({heat_number:m,item_code:p,cor_qty:g[2]||0,kode_produksi:g[3]||"",size:g[4]||"",customer:g[5]||"",line:g[6]||""})}),s.length===0){Xi.fire({icon:"info",title:"No Data",text:"Please enter valid data.",confirmButtonColor:"#2563EB"});return}const o=document.getElementById("heatDateInput"),a=o?o.value:null;if(!a){Xi.fire({icon:"warning",title:"Date Required",text:"Select Heat Date.",confirmButtonColor:"#2563EB"});return}if(!(await Xi.fire({icon:"question",title:"Konfirmasi Tanggal Cor",text:`Apakah tanggal upload cor (${a}) sudah sesuai dengan tanggal heat number?`,position:"top",showCancelButton:!0,confirmButtonColor:"#2563EB",cancelButtonColor:"#d33",confirmButtonText:"Ya, Lanjutkan",cancelButtonText:"Periksa Lagi",reverseButtons:!0})).isConfirmed)return;const c=document.getElementById("import-config");if(!c){console.error("Missing configuration div #import-config"),Xi.fire({icon:"error",title:"Config Error",text:"Page configuration missing."});return}const u=c.dataset.saveUrl,h=c.dataset.redirectUrl,d=document.querySelector('meta[name="csrf-token"]'),f=d?d.getAttribute("content"):"";e.disabled=!0,e.innerHTML='<span class="material-icons animate-spin">sync</span> Saving...';try{const g=await fetch(u,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":f,Accept:"application/json"},body:JSON.stringify({heat_date:a,data:s})});if(!g.ok){const p=await g.text();throw new Error(`Server returned ${g.status}: ${g.statusText}`)}const m=await g.json();if(m.success)if(m.errors&&m.errors.length>0){Xi.fire({icon:"warning",title:"Partial Success",text:m.message,confirmButtonColor:"#2563EB"}),document.getElementById("errorLog").style.display="block";const p=document.getElementById("errorList");p.innerHTML="",m.errors.forEach(v=>{const b=document.createElement("li");b.textContent=v,p.appendChild(b)})}else Xi.fire({icon:"success",title:"Success",text:m.message,confirmButtonColor:"#2563EB"}).then(()=>window.location.href=h);else throw new Error(m.message||"Unknown error")}catch(g){console.error(g),Xi.fire({icon:"error",title:"Import Error",text:g.message||"Import failed without specific error.",confirmButtonColor:"#2563EB"})}finally{e.disabled=!1,e.innerHTML='<span class="material-icons">cloud_upload</span> Save Records'}}}function xNe(){const t=document.getElementById("item-grid-container"),e=document.getElementById("saveItemBtn");if(!t||!e)return;const n=Array.from({length:30},()=>["","","","","","","",""]),i=new He(t,{data:n,rowHeaders:!0,colHeaders:["CODE","NAME","AISI","STANDARD","UNIT WEIGHT","DEPT CODE","CYCLE (SEC)","STATUS"],height:"100%",width:"100%",licenseKey:"non-commercial-and-evaluation",stretchH:"all",columns:[{data:0,placeholder:"1.002.3"},{data:1,placeholder:"Item Name"},{data:2,placeholder:"AISI 304"},{data:3,placeholder:"Standard"},{data:4,type:"numeric"},{data:5,placeholder:"400.1"},{data:6,type:"numeric"},{data:7,type:"dropdown",source:["active","inactive"],defaultValue:"active"}],contextMenu:!0,autoWrapRow:!0,autoWrapCol:!0,minSpareRows:5});e.onclick=async()=>{const r=i.getData(),s=[];if(r.forEach(u=>{const h=(u[0]||"").toString().trim(),d=(u[1]||"").toString().trim();h&&d&&s.push({code:h,name:d,aisi:u[2]||"",standard:u[3]||"",unit_weight:u[4],department_code:(u[5]||"").toString().trim(),cycle_time_sec:u[6]||0,status:(u[7]||"active").toString().trim().toLowerCase()})}),s.length===0){Xi.fire({icon:"info",title:"No Data",text:"Please enter valid data.",confirmButtonColor:"#2563EB"});return}const o=document.getElementById("import-config"),a=o.dataset.saveUrl,l=o.dataset.redirectUrl,c=document.querySelector('meta[name="csrf-token"]').getAttribute("content");e.disabled=!0,e.innerHTML='<span class="material-icons animate-spin">sync</span> Saving...';try{const u=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":c,Accept:"application/json"},body:JSON.stringify({data:s})});if(!u.ok)throw new Error(`Server returned ${u.status}`);const h=await u.json();if(h.success)if(h.errors&&h.errors.length>0){Xi.fire({icon:"warning",title:"Import with Warnings",text:h.message,confirmButtonColor:"#2563EB"}),document.getElementById("errorLog").style.display="block";const d=document.getElementById("errorList");d.innerHTML="",h.errors.forEach(f=>{const g=document.createElement("li");g.textContent=f,d.appendChild(g)})}else Xi.fire({icon:"success",title:"Success",text:h.message,confirmButtonColor:"#2563EB"}).then(()=>window.location.href=l);else throw new Error(h.message||"Unknown error")}catch(u){console.error(u),Xi.fire({icon:"error",title:"Import Error",text:u.message,confirmButtonColor:"#2563EB"})}finally{e.disabled=!1,e.innerHTML='<span class="material-icons">cloud_upload</span> Save Records'}}}window.Alpine=dY;window.Chart=nI;window.Swal=Xi;dY.start();document.addEventListener("DOMContentLoaded",()=>{ENe(),xNe()})});export default TNe();
